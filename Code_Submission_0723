.libPaths()
library(dplyr)
library(sandwich)
library(stargazer)
library(ggplot2)
library(patchwork)
library(weights)
library(xtable)
library(lmtest)
library(ggalluvial)
library(foreign)
library(reshape2)
library(nnet)
library(Weighted.Desc.Stat)
library(aod)
library(glmtoolbox)
library(pscl)
library(AICcmodavg)
library(DescTools)
library(scales) 

#setting the working directory
setwd("C:/Users/carme/Documents/Studium/Master Economics/Master Thesis")
ASFL_org <- readstata13::read.dta13("./Questionnaire & Dataset/Data/oecd_2019_engl_final_official.dta")
ASFL_add<- readstata13::read.dta13("./Questionnaire & Dataset/Data/add_austria-specific.dta")
ASFL_full <- merge (ASFL_org, ASFL_add, by="id")
ASFL <- ASFL_full


###############################################################################
#BASIC SOCIODEMOGRAPHIC CHARACTERISTICS
###############################################################################
##################################EMPLOYMENT##################################
table(ASFL$QD10)
employment1 <-ASFL$QD10 

ASFL <- ASFL %>%
  mutate(employment1=case_when(
    employment1 =="Self-employed [work for myself]"~"Self-employed",
    employment1 =="In paid employment [work for someone else]"~"Employed",
    employment1 =="Looking for work [unemployed]"~"Other",
    employment1 =="Not working and not looking for work"~"Other",
    employment1 =="Retired"~"Other",
    employment1 =="Student"~"Other",
    employment1 =="Apprentice"~"Other",
    employment1 =="Looking after the home"~"Other",
    employment1 =="Other"~"Other"))

employment1_1 <- factor(ASFL$employment1, levels=c("Other","Self-employed","Employed"))
levels(employment1_1)

employment1_2 <- factor(ASFL$employment1, levels=c("Employed","Self-employed", "Other"))
levels(employment1_2)

employment2 <- ASFL$QD10
ASFL <- ASFL %>%
  mutate(employment2=case_when(employment2 =="Self-employed [work for myself]"~"Self-employed",
                               employment2 =="In paid employment [work for someone else]"~"Employed",
                               TRUE ~ NA))
employment2_2 <- as.factor(ASFL$employment2)
levels(employment2_2)
ASFL <- within(ASFL, employment2_2 <- relevel(employment2_2, ref = "Employed"))#in payed employed used as the reference group

employmentfull <- ASFL$QD10
ASFL <- ASFL %>%
  mutate(employmentfull=case_when(
    employmentfull =="In paid employment [work for someone else]"~"Employed",
    employmentfull =="Self-employed [work for myself]"~"Self-employed",
    employmentfull =="Looking for work [unemployed]"~"Unemployed",
    employmentfull =="Not working and not looking for work"~"Not working",
    employmentfull =="Retired"~"Retired",
    employmentfull =="Student"~"Student",
    employmentfull =="Apprentice"~"Apprentice",
    employmentfull =="Looking after the home"~"Home",
    employmentfull =="Other"~"Other"
  ))
employmentfull_full <- as.factor(ASFL$employmentfull)
levels(employmentfull_full)
ASFL <- within(ASFL, employmentfull_full <- relevel(employmentfull_full, ref = "Employed"))

employmentalt <-ASFL$QD10 
ASFL <- ASFL %>%
  mutate(employmentalt=case_when(
    employmentalt =="In paid employment [work for someone else]"~"Employed",
    employmentalt =="Self-employed [work for myself]"~"Self-employed",
    employmentalt =="Looking for work [unemployed]"~"Unemployed",
    employmentalt =="Retired"~"Retired",
    TRUE ~ "Other"
  ))
employmentalt_alt <- as.factor(ASFL$employmentalt)
levels(employmentalt_alt)
ASFL <- within(ASFL, employmentalt_alt <- relevel(employmentalt_alt, ref = "Employed"))


selfemployedd<- ifelse(ASFL$QD10 == "Self-employed [work for myself]", 1, 0)
selfemployedd <- as.numeric(selfemployedd)

employmentunempl <-ASFL$QD10 
ASFL <- ASFL %>%
  mutate(employmentunempl=case_when(
    employmentunempl =="Self-employed [work for myself]"~"Self-employed",
    employmentunempl =="In paid employment [work for someone else]"~"Employed",
    employmentunempl =="Looking for work [unemployed]"~"Employed",
    employmentunempl =="Not working and not looking for work"~"Other",
    employmentunempl =="Retired"~"Other",
    employmentunempl =="Student"~"Other",
    employmentunempl =="Apprentice"~"Other",
    employmentunempl =="Looking after the home"~"Other",
    employmentunempl =="Other"~"Other"))

employmentunempl_1 <- as.factor(ASFL$employmentunempl)
levels(employmentunempl_1)
ASFL <- within(ASFL, employmentunempl_1 <- relevel(employmentunempl_1, ref = "Other"))
employmentunempl_2 <- factor(ASFL$employmentunempl, levels=c("Employed","Self-employed", "Other"))
ASFL<-cbind(ASFL,employment1_1,employment1_2,employment2_2,employmentfull_full,employmentalt_alt, employmentunempl_1,employmentunempl_2)
levels(employmentunempl_2)

##alternative: QF9_11 ##own business as a retirement funding option
summary(ASFL$QF9_11)
retirefundbusinessd <- ifelse(ASFL$QF9_11 == "Yes", 1, 0)
table(retirefundbusinessd)
table(selfemployedd)

employedd<- ifelse(ASFL$QD10 == "In paid employment [work for someone else]", 1, 0) #maybe keep those looking for work?
employedd <- as.numeric(employedd)
unemployedd<- ifelse(ASFL$QD10 == "Looking for work [unemployed]", 1, 0)



ASFL$sevseempl
apprenticed<- ifelse(ASFL$QD10 == "Apprentice", 1, 0)
studentd<- ifelse(ASFL$QD10 == "Student", 1, 0)
otherd<- ifelse(ASFL$QD10 == "Other", 1, 0)
retiredd<- ifelse(ASFL$QD10 == "Retired", 1, 0)
homed <- ifelse(ASFL$QD10 == "Looking after the home", 1, 0)
notactived<-ifelse(ASFL$QD10 == "Not working and not looking for work", 1, 0)

othersd <- unemployedd+apprenticed+studentd+otherd+retiredd+homed+notactived
othersworetd <- unemployedd+apprenticed+studentd+otherd+homed+notactived
otherswounempld <- apprenticed+studentd+otherd+retiredd+homed+notactived
otherswounemplretd <- apprenticed+studentd+otherd+homed+notactived

se <- c("Self-employed [work for myself]")
e <- c("In paid employment [work for someone else]")
eu <- c("In paid employment [work for someone else]","Looking for work [unemployed]")
empl <- c("In paid employment [work for someone else]","Self-employed [work for myself]")
unempl <- c("Looking for work [unemployed]")
oth <- c("Looking for work [unemployed]","Apprentice","Student","Other","Retired","Looking after the home", "Not working and not looking for work")
othworet <- c("Looking for work [unemployed]","Apprentice","Student","Other","Looking after the home", "Not working and not looking for work")
ret <- c("Retired")
stud <- c("Student","Apprentice")
regempl <- c("In paid employment [work for someone else]","Self-employed [work for myself]","Looking for work [unemployed]","Retired")

#QF9_11 - Retirement funding - From the revenues of a business that you own - as a possible robustness check
ASFL$QF9_11
entrepreneurs <- c("Yes")
ASFLentrepreneurs <- ASFL[(ASFL$QF9_11 %in% entrepreneurs),] 
entrepreneursd<-ifelse(ASFL$QF9_11 == "Yes", 1, 0)


ASFLse <- ASFL[(ASFL$QD10 %in% se),] 
summary(ASFLse)
ASFLe <- ASFL[(ASFL$QD10 %in% e),] 
summary(ASFLe)
ASFLeu <-  ASFL[(ASFL$QD10 %in% eu),] 
summary(ASFLeu)
ASFLunempl <-  ASFL[(ASFL$QD10 %in% unempl),] 
summary(ASFLunempl)
ASFLoth <-  ASFL[(ASFL$QD10 %in% oth),] 
summary(ASFLoth)
640+699+79
ASFLempl <- ASFL[(ASFL$QD10 %in% empl),] 
ASFLempl$QD10
ASFLregempl <- ASFL[(ASFL$QD10 %in% regempl),] 
ASFLothworet <-  ASFL[(ASFL$QD10 %in% othworet),] 
summary(ASFLothworet)
ASFLothworet <-  ASFL[(ASFL$QD10 %in% othworet),] 
summary(ASFLothworet)
ASFLstud <-  ASFL[(ASFL$QD10 %in% stud),] 
summary(ASFLstud)
ASFLret <-  ASFL[(ASFL$QD10 %in% ret),] 
summary(ASFLret)


ASFL <- cbind(ASFL,employedd,selfemployedd,entrepreneursd,othersd,othersworetd,otherswounempld,otherd,apprenticed,studentd,retiredd,notactived,homed,unemployedd)
##################################add_employment#########################
summary(ASFL$QF9_10) #still working in pension to fund retirement
summary(ASFL$st1ab) #respondent ever employed
summary(ASFL$st3ab) #person contributing most to household income ever employed

##################################AGE##################################
age<-ASFL$QD7
summary(ASFL$QD7)
age2 <- age^2
rootage <- sqrt(ASFL$QD7)
ASFL["age_group"] = cut(as.numeric(as.character(ASFL$QD7)), c(16, 28, 38, 58, 74, Inf), c("16-28", "29-38", "39-58", "59-74", ">75"), include.lowest=TRUE)
table(ASFL$age_group)
youngmilld<- ifelse(ASFL$age_group == "16-28", 1, 0)
oldmilld<- ifelse(ASFL$age_group == "29-38", 1, 0)
genxd <- ifelse(ASFL$age_group == "39-58", 1, 0)
babyboomd <- ifelse(ASFL$age_group == "59-74", 1, 0)
silgend<- ifelse(ASFL$age_group == ">75", 1, 0)

summary(ASFL$age_group)
ASFL <- cbind(ASFL,age,youngmilld,oldmilld,genxd,babyboomd,silgend,age2,rootage)

youngmill <- c("16-28")
oldmill <- c("29-38")
genx <- c("39-58")
babyboom <- c("59-74")
silgen <- c(">75")

#youngmill<- ASFL[(ASFL$age_group %in% youngmill),] 
#oldmill<- ASFL[(ASFL$age_group %in% oldmill),] 
#genx <- ASFL[(ASFL$age_group %in% genx),] 
#babyboom <- ASFL[(ASFL$age_group %in% babyboom),]
#silgen<- ASFL[(ASFL$age_group %in% silgen),] 

under18 <- c("16","17")
ASFLadult <- ASFL[!(ASFL$QD7 %in% under18),]
ASFLadult<- subset(ASFL, ASFL$QD7 >= "18")
above79 <- c("80","81","82","83","84","85","86","87","88","89","90","93","94","95","97")
ASFLmain <- ASFLadult[!(ASFLadult$QD7 %in% above79),] 
ASFLmain<- subset(ASFLadult, ASFLadult$QD7 <= "79")

##################################GENDER##################################
gender <- ASFL$QD1
table(ASFL$QD1)
ASFL <- ASFL %>%
  mutate(gender=case_when(
    gender =="2"~ "Female",
    gender =="1"~ "Male",
    TRUE ~ "Other"
  ))
maled<- ifelse(ASFL$QD1 == "1", 1, 0)
genderd<- ifelse(ASFL$QD1 == "1", 1, 0) #to avoid problems with the maled dummy in later analysis
femaled <- ifelse(ASFL$QD1 == "2", 1, 0)

male <- c("1")
female <- c("2")


ASFL <- cbind(ASFL,maled,femaled,genderd)

##################################EDUCATION##################################
#################################old_education###################################
ASFL <- ASFL %>% mutate(QD9 = ifelse(is.na(QD9), 0, QD9))
ASFL$QD9
table(ASFL$QD9)
ASFL["educationspecific"] = cut(as.numeric(as.character(ASFL$QD9)), c(0,1, 3, 4, 5, Inf), c("Akademie","Universitary", "Upper secondary", "Lower secondary", "Primary"), include.lowest=TRUE)
table(ASFL$educationspecific)
levels(ASFL$educationspecific)
educationspecific_1 <- factor(ASFL$educationspecific, levels=c("Primary", "Lower secondary", "Upper secondary", "Universitary", "Akademie"))
silgend<- ifelse(ASFL$age_group == ">75", 1, 0)
primary <- c("Primary")
lowersec <- c("Lower secondary")
uppersec <- c("Upper secondary")
university <- c("Universitary")
akademie <- c("Akademie")

primary_1d <- ifelse(ASFL$QD9 == "7", 1, 0)
primary_2d <- ifelse(ASFL$QD9 == "6", 1, 0)
primaryd <- primary_1d+primary_2d
lowersecondaryd<- ifelse(ASFL$QD9 == "5", 1, 0)
uppersecondaryd<- ifelse(ASFL$QD9 == "4", 1, 0)
university_1d<- ifelse(ASFL$QD9 == "2", 1, 0)
university_2d<- ifelse(ASFL$QD9 == "3", 1, 0)
Akademied <- ifelse(ASFL$QD9 == "0", 1, 0)#Akademie!
universityd <- university_1d+university_2d
ASFL["educspecific"] = cut(as.numeric(as.character(ASFL$QD9)), c(0, 3, 4, 5, Inf), c("Universitary", "Upper secondary", "Lower secondary", "Primary"), include.lowest=TRUE)
table(ASFL$educspecific)
levels(ASFL$educspecific)
educspecific_1 <- factor(ASFL$educspecific, levels=c("Primary", "Lower secondary", "Upper secondary", "Universitary"))

ASFL <- cbind(ASFL,primaryd,lowersecondaryd,uppersecondaryd,universityd,Akademied,educspecific_1,educationspecific_1)
levels(ASFL$educspecific_1)
levels(ASFL$educationspecific_1)
#################################new_education###################################
ASFL["education"] = cut(as.numeric(as.character(ASFL$QD9)), c(0,4,Inf), c("Higher", "Lower"), include.lowest=TRUE)
table(ASFL$education)
higheduc<- ifelse(ASFL$education == "Higher", 1, 0)
heduc <- c("Higher")
loweduc<- ifelse(ASFL$education == "Lower", 1, 0)
ASFL <- cbind(ASFL,higheduc,loweduc)
leduc <- c("Lower")

##alternative: excluding all with university/Akademie
tertiary<- c("Universitary","Akademie")


#################################add_education###################################

summary(ASFL$st1g) #highest attained education
table(ASFL_org$QD9) #redefined for OECD! 

summary(ASFL$st3g)

#################################SELF-ASSESSMENT##############################
selfassess <- ASFL$QK1
table(selfassess)
table(ASFL$QK1)
ASFL <- ASFL %>% mutate(saknow_group = case_when(selfassess == "Very high" ~ "High sa",
                                                 selfassess == "Quite high" ~ "High sa",
                                                 selfassess == "About average" ~ "Average sa",
                                                 selfassess == "Very low" ~ "Low sa",
                                                 selfassess == "Quite low" ~ "Low sa",
                                                 selfassess == "Refused" ~ "Ref/Don't know",
                                                 selfassess == "Don't know" ~ "Ref/Don't know"))
ASFL <- ASFL %>% mutate(saknow_group_a = case_when(selfassess == "Very high" ~ "High sa",
                                                   selfassess == "Quite high" ~ "High sa",
                                                   selfassess == "About average" ~ "Average sa",
                                                   selfassess == "Very low" ~ "Low sa",
                                                   selfassess == "Quite low" ~ "Low sa",
                                                   selfassess == TRUE ~ NA))                               
table(ASFL$saknow_group)
saknow_group_1 <- factor(ASFL$saknow_group, levels=c("High sa", "Average sa", "Low sa","Ref/Don't know"))
levels(saknow_group_1)
saknow_group_a_1 <- factor(ASFL$saknow_group_a, levels=c("High sa", "Average sa", "Low sa"))
levels(saknow_group_a_1)

hhsfknow<- ifelse(ASFL$QK1 == "Very high", 1, 0)
hsfknow<- ifelse(ASFL$QK1 == "Quite high", 1, 0)
highsfknow <- hsfknow+hhsfknow
asfknow<- ifelse(ASFL$QK1 == "About average", 1, 0)
lsfknow<- ifelse(ASFL$QK1 == "Quite low", 1, 0)
llsfknow<- ifelse(ASFL$QK1 == "Very low", 1, 0)
lowsfknow <- lsfknow+llsfknow
ASFL <- cbind(ASFL,selfassess,hhsfknow,hsfknow,highsfknow,asfknow,lsfknow,llsfknow,lowsfknow,saknow_group_1,saknow_group_a_1) 

numericsaknow1<- ifelse(ASFL$QK1 == "Very high", 5, 0)
numericsaknow2<- ifelse(ASFL$QK1 == "Quite high", 4, 0)
numericsaknow3<- ifelse(ASFL$QK1 == "About average", 3, 0)
numericsaknow4<- ifelse(ASFL$QK1 == "Quite low", 2, 0)
numericsaknow5<- ifelse(ASFL$QK1 == "Very low", 1, 0)
numericsaknow6<- ifelse(ASFL$QK1 == "Don't know", 3, 0)
numericsaknow7<- ifelse(ASFL$QK1 == "Refused", 3, 0)

numericsaknow<- numericsaknow1+numericsaknow2+numericsaknow3+numericsaknow4+numericsaknow5+numericsaknow6+numericsaknow7
numericsaknow_2<- numericsaknow1+numericsaknow2+numericsaknow3+numericsaknow4+numericsaknow5
table(numericsaknow) #higher score indicates higher self-assessment
table(numericsaknow_2)
ASFL <- cbind(ASFL,numericsaknow,numericsaknow_2) 

#################################LIVING COMMUNITY TYPE##############################
livingcomm <- ASFL$QD3
table(ASFL$QD3)
villaged <- ifelse(ASFL$QD3 == "A village, hamlet or rural area (fewer than 3 000 people)", 1, 0)
smalltownd<- ifelse(ASFL$QD3 == "A small town (3 000 to about 15 000 people)", 1, 0)
largetownd<- ifelse(ASFL$QD3 == "A town (15 000 to about 100 000 people)", 1, 0)
townd <- smalltownd+largetownd
smallcityd<- ifelse(ASFL$QD3 == "A city (100 000 to about 1 000 000 people)", 1, 0)
largecityd<- ifelse(ASFL$QD3 == "A large city (with over 1 000 000 people)", 1, 0)
cityd<- smallcityd+largecityd

ASFL <- ASFL %>% mutate(livingcommgroup = case_when(livingcomm == "A village, hamlet or rural area (fewer than 3 000 people)" ~ "Village",
                                                    livingcomm == "A small town (3 000 to about 15 000 people)" ~ "Town",
                                                    livingcomm == "A town (15 000 to about 100 000 people)" ~ "Town",
                                                    livingcomm == "A city (100 000 to about 1 000 000 people)" ~ "City",
                                                    livingcomm == "A large city (with over 1 000 000 people)" ~ "City"))

livingcommgroup_1 <- factor(ASFL$livingcommgroup, levels=c("Village", "Town", "City"))
ASFL <- cbind(ASFL,livingcommgroup_1)
levels(ASFL$livingcommgroup_1)
table(livingcommgroup_1)

ASFL <- cbind (ASFL, villaged, townd, cityd)
#################################HOUSEHOLD INCOME##############################
hincome <- ASFL$QD13
table(ASFL$QD13)
hincomehighd<- ifelse(ASFL$QD13 == "Y or more a month", 1, 0) 
hincomemiddled<- ifelse(ASFL$QD13 == "Between X and Y a month", 1, 0) 
hincomelowd <- ifelse(ASFL$QD13 == "Up to X a month", 1, 0) 
refincome1 <- ifelse(ASFL$QD13 == "Refused", 1, 0) 
refincome2 <- ifelse(ASFL$QD13 == "Don't know", 1, 0) 
refincomed <- refincome1 + refincome2
ASFL <- cbind(ASFL,hincome,hincomehighd,hincomemiddled,hincomelowd,refincomed) 
ASFL <- ASFL %>% mutate(incomegroup = case_when(hincome == "Refused" ~ "Ref/Don't know",
                                                hincome == "Don't know" ~ "Ref/Don't know",
                                                hincome == "Y or more a month" ~ "High income",
                                                hincome == "Between X and Y a month" ~ "Middle income",
                                                hincome == "Up to X a month" ~ "Low income"))

ASFL <- ASFL %>% mutate(incomegroup_simple = case_when(hincome == "Up to X a month" ~ "Low income",
                                                       hincome == "Between X and Y a month" ~ "Middle income",
                                                       hincome == "Y or more a month" ~ "High income", 
                                                       TRUE ~NA))

incomegroup_1 <- factor(ASFL$incomegroup, levels=c("Ref/Don't know", "Low income", "Middle income", "High income"))
ASFL <- cbind(ASFL, incomegroup_1)
levels(ASFL$incomegroup_1)

incomegroup_simple_1 <- factor(ASFL$incomegroup_simple, levels=c("Low income", "Middle income", "High income"))
ASFL <- cbind(ASFL, incomegroup_simple_1)
levels(ASFL$incomegroup_simple_1)


table(ASFL$incomegroup)
table(ASFL$incomegroup_simple)
incomeequ <- subset(ASFL, select=c("QD13", "QD5_ad"))
incomeequ
partnerhincome <- ifelse(incomeequ$QD5_ad == "2", 1, 0) 
partnerhincome<- subset(incomeequ, incomeequ$QD5_ad == "2")
table(partnerhincome)
table(ASFL$QD13)
table(incomeequ$QD5_ad)
table(incomeequ$QD13)
#################################HOUSEHOLD SIZE & CHILDREN##############################
table(ASFL$QD5_1)
singled <- ifelse(ASFL$QD5_1 == "Yes", 1, 0)
ASFL<- cbind(ASFL, singled)
table(ASFL$QD5_ad) #only those stating that they are not living alone
table(ASFL$QD5_3)
table(ASFL$QD5_4)
table(ASFL$QD5_ch) #only those stating that they are not living alone asked for amount of children
cb18d <- ifelse(ASFL$QD5_3 == "Yes", 1, 0)
ca18d <- ifelse(ASFL$QD5_4 == "Yes", 1, 0)
child <- cb18d+ca18d
childd <- ifelse(child  >= "1", 1, 0)
ASFL <- cbind(ASFL, childd,cb18d,ca18d)
singleparentb18d <- ifelse(ASFL$QD5_ad == "1", 1, 0) #notlivingalone but only 1 person (including respondent themselve) above 18
singleparent_2_1 <- ifelse(ASFL$QD5_ad == "2", 1, 0)
singleparent_2_2 <-ca18d+singleparent_2_1
singleparent_2 <- ifelse(singleparent_2_2 == "2", 1, 0)
singleparentd <- singleparentb18d+singleparent_2
ASFL <- cbind(ASFL, singleparentb18d,singleparentd)
table(ASFL$singleparentd)
##################################FINANCIAL RESILIENCE##################################
finbuff <- ASFL$QF13
table(finbuff)
lfinbuff<- c("Less than a week","At least a week, but not one month","At least one month, but not three months") 
hfinbuff<- c("At least three months, but not six months","Six months or more")

ASFL <- ASFL %>% mutate(finbuff_group = case_when(finbuff == "Less than a week" ~ 'Low',
                                                  finbuff == "At least a week, but not one month" ~ 'Low',
                                                  finbuff == "At least one month, but not three months" ~ 'Average',
                                                  finbuff == "At least three months, but not six months" ~ 'High',
                                                  finbuff == "Six months or more" ~ 'High', 
                                                  finbuff == "Don't know" ~ 'Refusal',
                                                  finbuff == "Refused" ~ 'Refusal'))
table(ASFL$finbuff_group)

numericfinbuff1<- ifelse(ASFL$QF13 == "Refusal", 3, 0)
numericfinbuff2<- ifelse(ASFL$QF13 == "Don't know", 3, 0)
numericfinbuff3<- ifelse(ASFL$QF13 == "At least one month, but not three months", 3, 0)
numericfinbuff4<- ifelse(ASFL$QF13 == "Less than a week", 1, 0)
numericfinbuff5<- ifelse(ASFL$QF13 == "At least a week, but not one month", 2, 0)
numericfinbuff6<- ifelse(ASFL$QF13 == "At least three months, but not six months", 4, 0)
numericfinbuff7<- ifelse(ASFL$QF13 == "Six months or more", 5, 0)

numericfinbuff <- numericfinbuff1+numericfinbuff2+numericfinbuff3+numericfinbuff4+numericfinbuff5+numericfinbuff6+numericfinbuff7
table(numericfinbuff)
ASFL <- cbind(ASFL,numericfinbuff)


lessweekfinbuffd <-ifelse(ASFL$QF13 == "Less than a week", 1, 0)
weekfinbuffd <-ifelse(ASFL$QF13 == "At least a week, but not one month", 1, 0)
monthfinbuffd <-ifelse(ASFL$QF13 == "At least one month, but not three months", 1, 0)
lowfinbuffd <- lessweekfinbuffd+weekfinbuffd+monthfinbuffd
threemonthfinbuffd <-ifelse(ASFL$QF13 == "At least three months, but not six months", 1, 0)
sixmonthfinbuffd <-ifelse(ASFL$QF13 == "Six months or more", 1, 0)
highfinbuffd <-threemonthfinbuffd+sixmonthfinbuffd
ASFL <- cbind(ASFL,lessweekfinbuffd,weekfinbuffd,monthfinbuffd,lowfinbuffd,threemonthfinbuffd,sixmonthfinbuffd,highfinbuffd) 


#########################SOCIODEMOGRAPHIC CHARACTERISTICS##########################################

##################################EMPLOYMENT##################################
############graphic overview#################
empl <- round(c(79/1418,699/1418,494/1418,50/1418,5/1418,23/1418,24/1418,21/1418,23/1418), digits=4)
paste(round(100*empl, 2), "%", sep="")
emplshare <- data.frame("Employment" = c("Self-employed", "Employed","Retired", "Unemployed", "Apprentice", "Student", "Home",  "Not working", "Other"),
                        "amount" = c(79/1418,699/1418,494/1418,50/1418,5/1418,23/1418,24/1418,21/1418,23/1418))
emp_comp <-ggplot(emplshare, aes(x="", y=amount, fill=Employment)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  geom_text(aes(label = c("5.57%" , "49.29%", "34.84%" ,"3.53%","" , "" , "",  "" , "" )),
            position = position_stack(vjust = 0.4))+
  #geom_text(aes(label = c("5.57%" , "49.29%", "34.84%" ,"3.53%","0.35%" , "1.62%" , "1.69%",  "1.48%" , "1.62%" )),
  #    position = position_stack(vjust = 0.4))+
  theme_void()

emplshare2 <- data.frame("Employment" = c("Self-employed", "Employed", "Other", "Retired"),
                         "amount" = c(79/1418,699/1418,146/1418,494/1418))

empl_simple_comp <- ggplot(emplshare2, aes(x="", y=amount, fill=Employment)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  theme_void()


##################################AGE##################################
#absolute comparison
summary(ASFL$QD7)
ASFLse <- ASFL[(ASFL$QD10 %in% se),] 
summary(ASFLse$QD7)
ASFLe <- ASFL[(ASFL$QD10 %in% e),] 
summary(ASFLe$QD7)
ASFLeu <- ASFL[(ASFL$QD10 %in% eu),] 
summary(ASFLeu$QD7)
ASFLoth <-  ASFL[(ASFL$QD10 %in% oth),] 
summary(ASFLoth$QD7)
ASFLothworet <-  ASFL[(ASFL$QD10 %in% othworet),] 
summary(ASFLothworet$QD7)
ASFLret <-  ASFL[(ASFL$QD10 %in% ret),] 
summary(ASFLret$QD7)
ASFLunempl <-  ASFL[(ASFL$QD10 %in% unempl),] 
summary(ASFLunempl$QD7)
ASFLentrepreneurs <-  ASFL[(ASFL$QF9_11 %in% entrepreneurs),] 
summary(ASFLentrepreneurs$QD7)


#age group comparison
#full sample
ASFL$QD7
ASFL["age_group"] = cut(as.numeric(as.character(ASFL$QD7)), c(16, 28, 38, 58, 74, Inf), c("16-28", "29-38", "39-58", "59-74", ">75"), include.lowest=TRUE)
youngmill_f<- ifelse(ASFL$age_group == "16-28", 1, 0)
oldmill_f<- ifelse(ASFL$age_group == "29-38", 1, 0)
genx_f <- ifelse(ASFL$age_group == "39-58", 1, 0)
babyboom_f <- ifelse(ASFL$age_group == "59-74", 1, 0)
silentgen_f<- ifelse(ASFL$age_group == ">75", 1, 0)
summary(ASFL$age_group)
#158/1418, 198/1418, 515/1418, 354/1418, 193/1418

#self-employed
summary(ASFLse$QD7)
ASFLse["age_group"] = cut(as.numeric(as.character(ASFLse$QD7)), c(16, 28, 38, 58, 74, Inf), c("16-28", "29-38", "39-58", "59-74", ">75"), include.lowest=TRUE)
youngmill_se<- ifelse(ASFLse$age_group == "16-28", 1, 0)
oldmill_se<- ifelse(ASFLse$age_group == "29-38", 1, 0)
genx_se<- ifelse(ASFLse$age_group == "39-58", 1, 0)
babyboom_se <- ifelse(ASFLse$age_group == "59-74", 1, 0)
silentgen_se<- ifelse(ASFLse$age_group == ">75", 1, 0)
summary(ASFLse$age_group)
summary(ASFLse$age_group)/79

#employed
#e
summary(ASFLe$QD7)
ASFLe["age_group"] = cut(as.numeric(as.character(ASFLe$QD7)), c(16, 28, 38, 58, 74, Inf), c("16-28", "29-38", "39-58", "59-74", ">75"), include.lowest=TRUE)
youngmill_e<- ifelse(ASFLe$age_group == "16-28", 1, 0)
oldmill_e<- ifelse(ASFLe$age_group == "29-38", 1, 0)
genx_e <- ifelse(ASFLe$age_group == "39-58", 1, 0)
babyboom_e <- ifelse(ASFLe$age_group == "59-74", 1, 0)
silentgen_e<- ifelse(ASFLe$age_group == ">75", 1, 0)
summary(ASFLe$age_group)
summary(ASFLe$age_group)/699
#e+u
summary(ASFLeu$QD7)
ASFLeu["age_group"] = cut(as.numeric(as.character(ASFLeu$QD7)), c(16, 28, 38, 58, 74, Inf), c("16-28", "29-38", "39-58", "59-74", ">75"), include.lowest=TRUE)
youngmill_eu<- ifelse(ASFLeu$age_group == "16-28", 1, 0)
oldmill_eu<- ifelse(ASFLeu$age_group == "29-38", 1, 0)
genx_eu <- ifelse(ASFLeu$age_group == "39-58", 1, 0)
babyboom_eu <- ifelse(ASFLeu$age_group == "59-74", 1, 0)
silentgen_eu<- ifelse(ASFLeu$age_group == ">75", 1, 0)
summary(ASFLeu$age_group)
#123/749, 174/749, 414/749, 37/749, 1/749

#others
summary(ASFLoth$QD7)
ASFLoth["age_group"] = cut(as.numeric(as.character(ASFLoth$QD7)), c(16, 28, 38, 58, 74, Inf), c("16-28", "29-38", "39-58", "59-74", ">75"), include.lowest=TRUE)
youngmill_eu<- ifelse(ASFLoth$age_group == "16-28", 1, 0)
oldmill_eu<- ifelse(ASFLoth$age_group == "29-38", 1, 0)
genx_eu <- ifelse(ASFLoth$age_group == "39-58", 1, 0)
babyboom_eu <- ifelse(ASFLoth$age_group == "59-74", 1, 0)
silentgen_eu<- ifelse(ASFLoth$age_group == ">75", 1, 0)
summary(ASFLoth$age_group)
#44/640,30/640,66/640,308/640,192/640

#retired
summary(ASFLret$QD7)
table(ASFLret$age_group)
table(ASFLret$age_group)/494
#othersworetired
summary(ASFLothworet$QD7)
table(ASFLothworet$age_group)
table(ASFLothworet$age_group)/146
#unemployed
summary(ASFLunempl$QD7)
table(ASFLunempl$age_group)
table(ASFLunempl$age_group)/50
#entrepreneurs
summary(ASFLentrepreneurs$QD7)
table(ASFLentrepreneurs$age_group)
table(ASFLentrepreneurs$age_group)/19
###age group comparison plot 
gencomp <- data.frame(status=rep(c('Self-employed', 'Employees'), each=5),
                      age=rep(c('Young millennials', 'Old millennials', 'Generation X', 'Baby boomers', 'Silent generation ' ), times=2),
                      share=c(0/79,5/79,63/79,11/79,0/79, 114/699,163/699,386/699,35/699,1/699))
gencomp$status<- factor(gencomp$status, levels=c('Self-employed', 'Employees'))
gencomp$age<- factor(gencomp$age, levels=c('Young millennials', 'Old millennials', 'Generation X', 'Baby boomers', 'Silent generation '))
ggplot(gencomp, aes(fill=age, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+ 
  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
##new
gencomp <- data.frame(status=rep(c('Self-employed', 'Employees'), each=5),
                      age=rep(c(  'Silent generation ', 'Baby boomers','Generation X', 'Old millennials','Young millennials' ), times=2),
                      share=c(0/79,11/79,63/79,5/79,0/79,1/699 ,35/699,386/699,163/699,114/699))
gencomp$status<- factor(gencomp$status, levels=c('Self-employed', 'Employees'))
gencomp$age<- factor(gencomp$age, levels=c(  'Silent generation ', 'Baby boomers','Generation X', 'Old millennials','Young millennials'))
ggplot(gencomp, aes(fill=age, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+ 
  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))

###with others
gencomp <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=5),
                      age=rep(c('Young millennials', 'Old millennials', 'Generation X', 'Baby boomers', 'Silent generation ' ), times=3),
                      share=c(0/79,5/79,63/79,11/79,0/79, 114/699,163/699,386/699,35/699,1/699,44/640,30/640,66/640,308/640,192/640))
gencomp$status<- factor(gencomp$status, levels=c('Self-employed', 'Employed','Others'))
gencomp$age<- factor(gencomp$age, levels=c('Young millennials', 'Old millennials', 'Generation X', 'Baby boomers', 'Silent generation '))
ggplot(gencomp, aes(fill=age, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Employment status")


##################################GENDER##################################
table(ASFL$QD1)
#full
female_f <- ifelse(ASFL$QD1 == "2", 1, 0)
female_f
male_f <- ifelse(ASFL$QD1 == "1", 1, 0)
male_f

#self-employed
table(ASFLse$QD1)
table(ASFLse$QD1)/79
female_se <- ifelse(ASFLse$QD1 == "2", 1, 0)
female_se
male_se <- ifelse(ASFLse$QD1 == "1", 1, 0)
male_se

#employed
table(ASFLe$QD1)
table(ASFLe$QD1)/699
female_e <- ifelse(ASFLe$QD1 == "2", 1, 0)
female_e
male_e <- ifelse(ASFLe$QD1 == "1", 1, 0)
male_e
#e+u
table(ASFLeu$QD1)
female_eu <- ifelse(ASFLeu$QD1 == "2", 1, 0)
female_eu
male_eu <- ifelse(ASFLeu$QD1 == "1", 1, 0)
male_eu

#others
table(ASFLoth$QD1)
female_oth <- ifelse(ASFLoth$QD1 == "2", 1, 0)
female_oth
male_oth <- ifelse(ASFLoth$QD1 == "1", 1, 0)
male_oth
#retired
table(ASFLret$QD1)
table(ASFLret$QD1)/494
#otherswithout retired
table(ASFLothworet$QD1)
table(ASFLothworet$QD1)/146
female_othworet <- ifelse(ASFLothworet$QD1 == "2", 1, 0)
female_othworet
male_othworet <- ifelse(ASFLothworet$QD1 == "1", 1, 0)
male_othworet
#unemployed
table(ASFLunempl$QD1)
table(ASFLunempl$QD1)/50
#entrepreneurs
table(ASFLentrepreneurs$QD1)
table(ASFLentrepreneurs$QD1)/19


#gender comparison plot 
emplstat <- c(rep("Self-employed" , 2) , rep("Employed" , 2) )
gender <- rep(c("Male" , "Female" ) , 2)
value <- abs(c(45/79,34/79,346/699,353/699))
genderplot<- data.frame(gender,emplstat,value)

genderplot$emplstat<- factor(genderplot$emplstat, levels=c('Self-employed', 'Employed'))
genderplot$gender<- factor(genderplot$gender, levels=c('Male','Female'))
ggplot(genderplot, aes(fill=gender, y=value, x=emplstat)) + 
  geom_bar(position="dodge", stat="identity")+ 
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="" ,y="Percentage share",fill="")+
  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
#with others
emplstat <- c(rep("Self-employed" , 2) , rep("Employed" , 2) ,  rep("Others" , 2) )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c(45/79,34/79,346/699,353/699,277/640,363/640))
genderplot<- data.frame(gender,emplstat,value)

genderplot$emplstat<- factor(genderplot$emplstat, levels=c('Self-employed', 'Employed', 'Others'))
genderplot$gender<- factor(genderplot$gender, levels=c('Male','Female'))
ggplot(genderplot, aes(fill=gender, y=value, x=emplstat)) + 
  geom_bar(position="dodge", stat="identity")+ labs(x="" ,y="Percentage share",fill="Gender")


##################################EDUCATION##################################
#oldeduc
table(ASFL$QD9)
table(ASFL_add$st1g)
table(ASFL_org$QD9)
#selfemployed
ASFLse$QD9
ASFLse <- ASFLse %>% mutate(QD9 = ifelse(is.na(QD9), 0, QD9))
primary_se <- ifelse(ASFLse$QD9 == c("6"), 1, 0) ##none with no formal education
lowersecondary_se<- ifelse(ASFLse$QD9 == "5", 1, 0)
uppersecondary_se<- ifelse(ASFLse$QD9 == "4", 1, 0)
university_se_1<- ifelse(ASFLse$QD9 == "2", 1, 0)
university_se_2<- ifelse(ASFLse$QD9 == "3", 1, 0)
university_se <- university_se_1+university_se_2
Akademiese <- ifelse(ASFLse$QD9 == "0", 1, 0)
table(ASFLse$QD9)

#employed
#e
ASFLe$QD9
ASFLe <- ASFLe %>% mutate(QD9 = ifelse(is.na(QD9), 0, QD9))
primary_e_1 <- ifelse(ASFLe$QD9 == "7", 1, 0)
primary_e_2 <- ifelse(ASFLe$QD9 == "6", 1, 0)
primary_e <- primary_e_1+primary_e_2
lowersecondary_e<- ifelse(ASFLe$QD9 == "5", 1, 0)
uppersecondary_e<- ifelse(ASFLe$QD9 == "4", 1, 0)
university_e_1<- ifelse(ASFLe$QD9 == "2", 1, 0)
university_e_2<- ifelse(ASFLe$QD9 == "3", 1, 0)
university_e <- university_e_1+university_e_2
Akademiee <- ifelse(ASFLe$QD9 == "0", 1, 0)
table(ASFLe$QD9)

#e+u
ASFLeu$QD9
ASFLeu <- ASFLeu %>% mutate(QD9 = ifelse(is.na(QD9), 0, QD9))
primary_eu_1 <- ifelse(ASFLeu$QD9 == "7", 1, 0)
primary_eu_2 <- ifelse(ASFLeu$QD9 == "6", 1, 0)
primary_eu <- primary_eu_1+primary_eu_2
lowersecondary_eu<- ifelse(ASFLeu$QD9 == "5", 1, 0)
uppersecondary_eu<- ifelse(ASFLeu$QD9 == "4", 1, 0)
university_eu_1<- ifelse(ASFLeu$QD9 == "2", 1, 0)
university_eu_2<- ifelse(ASFLeu$QD9 == "3", 1, 0)
university_eu <- university_eu_1+university_eu_2
Akademieeu <- ifelse(ASFLeu$QD9 == "0", 1, 0)
table(ASFLeu$QD9)

#others
table(ASFLoth$QD9)
#skip NAs
ASFLoth <- ASFLoth %>% mutate(QD9 = ifelse(is.na(QD9), 0, QD9))
primary_oth_1 <- ifelse(ASFLoth$QD9 == "7", 1, 0)
primary_oth_2 <- ifelse(ASFLoth$QD9 == "6", 1, 0)
primary_oth <- primary_oth_1+primary_oth_2
lowersecondary_oth<- ifelse(ASFLoth$QD9 == "5", 1, 0)
uppersecondary_oth<- ifelse(ASFLoth$QD9 == "4", 1, 0)
university_oth_1<- ifelse(ASFLoth$QD9 == "2", 1, 0)
university_oth_2<- ifelse(ASFLoth$QD9 == "3", 1, 0)
university_oth <- university_oth_1+university_oth_2
Akademieoth <- ifelse(ASFLoth$QD9 == "0", 1, 0)
table(ASFLoth$QD9)
table(ASFLothworet$QD9)

#unemployed
table(ASFLunempl$QD9)
#retired
table(ASFLret$QD9)
#entrepreneurs
table(ASFLentrepreneurs$QD9)


###education comparison plot
###stacked bar chart ##OLD!
educomp <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=4),
                      education=rep(c('At most primary', 'Lower secondary', 'Upper secondary', 'Tertiary'), times=3),
                      share=c(4/77, 39/77, 11/77, 23/77,42/685, 408/685,138/685,97/685,145/620, 362/620,71/620,42/620))
educomp$status<- factor(educomp$status, levels=c('Self-employed', 'Employed','Others'))
educomp$education<- factor(educomp$education, levels=c('At most primary', 'Lower secondary', 'Upper secondary', 'Tertiary'))
ggplot(educomp, aes(fill=education, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Education")

#####new education variable
#refusals
ASFLeduc <- subset(ASFL_full, select=c("QD9", "st1g")) #all refusing visit an "Akademie" - not internationally comparable
educQD9NA <- ifelse(ASFLeduc$st1g == "Akademie (z.B. Pädagogische Hochschule, Sozialakademie, Kolleg usw)", 1, 0)
ASFLeduc <- cbind(ASFLeduc, educQD9NA)

#self-employed 
table(ASFLse$education)
table(ASFLse$education)/79
higheducse <- ifelse(ASFLse$education == "Higher", 1, 0)
loweducse <- ifelse(ASFLse$education == "Lower", 1, 0)
table(ASFLse$educationspecific_1)
table(ASFLse$educationspecific_1)/79

#employed 
table(ASFLe$education)
table(ASFLe$education)/699
higheduce <- ifelse(ASFLe$education == "Higher", 1, 0)
loweduce <- ifelse(ASFLe$education == "Lower", 1, 0)
#e+u
table(ASFLeu$education)
table(ASFLe$educationspecific_1)
table(ASFLe$educationspecific_1)/699

#others 
table(ASFLoth$education)
higheducoth <- ifelse(ASFLoth$education == "Higher", 1, 0)
loweducoth <- ifelse(ASFLoth$education == "Lower", 1, 0)
#retired
table(ASFLret$education)
table(ASFLret$education)/494
table(ASFLret$educationspecific_1)
table(ASFLret$educationspecific_1)/494
#othersworetired
table(ASFLothworet$education)
table(ASFLothworet$education)/146
higheducothworet <- ifelse(ASFLothworet$education == "Higher", 1, 0)
loweducothworet <- ifelse(ASFLothworet$education == "Lower", 1, 0)
table(ASFLothworet$educationspecific_1)
table(ASFLothworet$educationspecific_1)/146
#unemployed 
table(ASFLunempl$education)
table(ASFLunempl$education)/50
table(ASFLunempl$educationspecific_1)
table(ASFLunempl$educationspecific_1)/50
#entrepreneurs
table(ASFLentrepreneurs$education)
table(ASFLentrepreneurs$education)/19
table(ASFLentrepreneurs$educationspecific_1)
table(ASFLentrepreneurs$educationspecific_1)/19


#comparison plots
educomp <- data.frame(status=rep(c('Self-employed', 'Employed'), each=2),
                      education=rep(c('Higher', 'Lower'), times=2),
                      share=c(36/79, 43/79,249/699, 450/699))
educomp$status<- factor(educomp$status, levels=c('Self-employed', 'Employed'))
educomp$education<- factor(educomp$education, levels=c('Higher', 'Lower'))
ggplot(educomp, aes(fill=education, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  scale_fill_manual(values=c("green",
                             "purple"))+
  labs(x="",y="Percentage share",fill="") +
  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))



##################################HOUSEHOLD SIZE##################################
#full
table(ASFL$QD5_1)
471/(947+471)
single_f <- ifelse(ASFL$QD5_1 == "Yes", 1, 0)
#self-employed
table(ASFLse$QD5_1)
table(ASFLse$QD5_1)/79
23/(56+23)
table(ASFLse$QD5_2)
table(ASFLse$QD5_ad)
single_se <- ifelse(ASFLse$QD5_1 == "Yes", 1, 0)
#employed
table(ASFLe$QD5_1)
table(ASFLe$QD5_1)/699
table(ASFLe$QD5_2)
table(ASFLe$QD5_ad)
single_e <- ifelse(ASFLe$QD5_1 == "Yes", 1, 0)
#e+u
table(ASFLeu$QD5_1)
single_eu <- ifelse(ASFLeu$QD5_1 == "Yes", 1, 0)
218/(531+218)
#others
table(ASFLoth$QD5_1)
single_oth <- ifelse(ASFLoth$QD5_1 == "Yes", 1, 0)
252/(252+388)
#retired
table(ASFLret$QD5_1)
table(ASFLret$QD5_1)/494
#others without retired
table(ASFLothworet$QD5_1)
table(ASFLothworet$QD5_1)/146
single_othworet <- ifelse(ASFLothworet$QD5_1 == "Yes", 1, 0)
50/(50+96)
#unemployed
table(ASFLunempl$QD5_1)
table(ASFLunempl$QD5_1)/50
#entrepreneurs
table(ASFLentrepreneurs$QD5_1)
table(ASFLentrepreneurs$QD5_1)/19

##################################children##################################
#full
table(ASFL$QD5_3) #children below 18
table(ASFL$QD5_4)  #children above 18
cb18_f <- ifelse(ASFL$QD5_3 == "Yes", 1, 0)
ca18_f <- ifelse(ASFL$QD5_4 == "Yes", 1, 0)
child_f <- cb18_f+ca18_f
child_f <- ifelse(child_f  >= "1", 1, 0)
table(cb18_f)
table(ca18_f)
table(child_f)
351/(1418)

#self-employed
table(ASFLse$QD5_3)
table(ASFLse$QD5_4)
table(ASFLse$QD5_ch)
table(ASFLse$singleparentd)
singleparentse <- ifelse(ASFLse$singleparentd == "1", 1, 0)
singleparentu18se <- ifelse(ASFLse$QD5_ad == "1", 1, 0)
cb18_se <- ifelse(ASFLse$QD5_3 == "Yes", 1, 0)
ca18_se <- ifelse(ASFLse$QD5_4 == "Yes", 1, 0)
child_se <- cb18_se+ca18_se
child_se  <- ifelse(child_se  >= "1", 1, 0)
table(cb18_se)
table(ca18_se)
table(child_se)
table(ASFLse$childd)
table(ASFLse$childd)/79

#employed
table(ASFLe$QD5_3)
table(ASFLe$QD5_4)
table(ASFLe$QD5_ch)
table(ASFLe$singleparentd)
singleparente <- ifelse(ASFLe$singleparentd == "1", 1, 0)
singleparentu18e <- ifelse(ASFLe$QD5_ad == "1", 1, 0)
cb18_e <- ifelse(ASFLe$QD5_3 == "Yes", 1, 0)
ca18_e <- ifelse(ASFLe$QD5_4 == "Yes", 1, 0)
child_e <- cb18_e+ca18_e
child_e  <- ifelse(child_e  >= "1", 1, 0)
table(cb18_e)
table(ca18_e)
table(child_e)
table(ASFLe$childd)
table(ASFLe$childd)/699

#e+u
table(ASFLeu$QD5_3)
table(ASFLeu$QD5_4)
table(ASFLeu$QD5_ch)
table(ASFLeu$singleparentd)
cb18_eu <- ifelse(ASFLeu$QD5_3 == "Yes", 1, 0)
ca18_eu <- ifelse(ASFLeu$QD5_4 == "Yes", 1, 0)
child_eu <- cb18_eu+ca18_eu
child_eu  <- ifelse(child_eu  >= "1", 1, 0)
table(cb18_eu)
table(ca18_eu)
table(child_eu)
245/699

#others
table(ASFLoth$QD5_3)
table(ASFLoth$QD5_4)
table(ASFLoth$QD5_ch)
table(ASFLoth$singleparentd)
cb18_oth <- ifelse(ASFLoth$QD5_3 == "Yes", 1, 0)
ca18_oth <- ifelse(ASFLoth$QD5_4 == "Yes", 1, 0)
child_oth <- cb18_oth+ca18_oth
child_oth  <- ifelse(child_oth  >= "1", 1, 0)
table(cb18_oth)
table(ca18_oth)
table(child_oth)
77/640

#retired
table(ASFLret$cb18d)
table(ASFLret$ca18d)
table(ASFLret$childd)
table(ASFLret$childd)/494
table(ASFLret$singleparentd)

#others without retired
table(ASFLothworet$QD5_3)
table(ASFLothworet$QD5_4)
table(ASFLothworet$childd)
table(ASFLothworet$childd)/146
table(ASFLothworet$singleparentd)
cb18_othworet <- ifelse(ASFLothworet$QD5_3 == "Yes", 1, 0)
ca18_othworet <- ifelse(ASFLothworet$QD5_4 == "Yes", 1, 0)
child_othworet <- cb18_othworet+ca18_othworet
child_othworet  <- ifelse(child_othworet  >= "1", 1, 0)
table(cb18_othworet)
table(ca18_othworet)
table(child_othworet)
table(child_othworet)/146
#unemployed
table(ASFLunempl$cb18d)
table(ASFLunempl$ca18d)
table(ASFLunempl$childd)
table(ASFLunempl$childd)/50
table(ASFLunempl$singleparentd)
#entrepreneurs
table(ASFLentrepreneurs$cb18d)
table(ASFLentrepreneurs$ca18d)
table(ASFLentrepreneurs$childd)
table(ASFLentrepreneurs$childd)/19
table(ASFLentrepreneurs$singleparentd)

#sole and with children comparison plot
household <- c(rep("Single household" , 2) , rep("Children" , 2), rep("Single parent" , 2))
emplstat <- rep(c("Self-employed" , "Employed" ) , 3)
value <- abs(c(23/79,196/699,29/79,245/699,3/79,34/699))
householdplot<- data.frame(household,emplstat,value)
householdplot$household<- factor(householdplot$household, levels=c("Single household","Children","Single parent"))
householdplot$emplstat<- factor(householdplot$emplstat, levels=c('Self-employed', 'Employed'))
ggplot(householdplot, aes(fill=emplstat, y=value, x=household)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Percentage share", fill = "Employment status")

#with others
household <- c(rep("Single household" , 3) , rep("Children" , 3) )
emplstat <- rep(c("Self-employed" , "Employed","Others" ) , 2)
value <- abs(c(23/79,196/699,252/640,29/79,245/699,77/640))
householdplot<- data.frame(household,emplstat,value)
householdplot$household<- factor(householdplot$household, levels=c("Single household","Children"))
householdplot$emplstat<- factor(householdplot$emplstat, levels=c('Self-employed', 'Employed','Others'))
ggplot(householdplot, aes(fill=emplstat, y=value, x=household)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Percentage share", fill = "Employment status")
#################################LIVING COMMUNITY TYPE##############################

#self-employed 
table(ASFLse$QD3)
village_se <- ifelse(ASFLse$QD3 == "A village, hamlet or rural area (fewer than 3 000 people)", 1, 0)
smalltown_se<- ifelse(ASFLse$QD3 == "A small town (3 000 to about 15 000 people)", 1, 0)
largetown_se<- ifelse(ASFLse$QD3 == "A town (15 000 to about 100 000 people)", 1, 0)
town_se <- smalltown_se+largetown_se
smallcity_se<- ifelse(ASFLse$QD3 == "A city (100 000 to about 1 000 000 people)", 1, 0)
largecity_se<- ifelse(ASFLse$QD3 == "A large city (with over 1 000 000 people)", 1, 0)
city_se<- smallcity_se+largecity_se


#employed 
table(ASFLe$QD3)
village_e <- ifelse(ASFLe$QD3 == "A village, hamlet or rural area (fewer than 3 000 people)", 1, 0)
smalltown_e<- ifelse(ASFLe$QD3 == "A small town (3 000 to about 15 000 people)", 1, 0)
largetown_e<- ifelse(ASFLe$QD3 == "A town (15 000 to about 100 000 people)", 1, 0)
town_e <- smalltown_e+largetown_e
smallcity_e<- ifelse(ASFLe$QD3 == "A city (100 000 to about 1 000 000 people)", 1, 0)
largecity_e<- ifelse(ASFLe$QD3 == "A large city (with over 1 000 000 people)", 1, 0)
city_e<- smallcity_e+largecity_e

#e+u
table(ASFLeu$QD3)
#others
table(ASFLoth$QD3)
village_oth <- ifelse(ASFLoth$QD3 == "A village, hamlet or rural area (fewer than 3 000 people)", 1, 0)
smalltown_oth<- ifelse(ASFLoth$QD3 == "A small town (3 000 to about 15 000 people)", 1, 0)
largetown_oth<- ifelse(ASFLoth$QD3 == "A town (15 000 to about 100 000 people)", 1, 0)
town_oth <- smalltown_oth+largetown_oth
smallcity_oth<- ifelse(ASFLoth$QD3 == "A city (100 000 to about 1 000 000 people)", 1, 0)
largecity_oth<- ifelse(ASFLoth$QD3 == "A large city (with over 1 000 000 people)", 1, 0)
city_oth<- smallcity_oth+largecity_oth

#othersworetired
table(ASFLothworet$QD3)
village_othworet <- ifelse(ASFLothworet$QD3 == "A village, hamlet or rural area (fewer than 3 000 people)", 1, 0)
smalltown_othworet<- ifelse(ASFLothworet$QD3 == "A small town (3 000 to about 15 000 people)", 1, 0)
largetown_othworet<- ifelse(ASFLothworet$QD3 == "A town (15 000 to about 100 000 people)", 1, 0)
town_othworet <- smalltown_othworet+largetown_othworet
smallcity_othworet<- ifelse(ASFLothworet$QD3 == "A city (100 000 to about 1 000 000 people)", 1, 0)
largecity_othworet<- ifelse(ASFLothworet$QD3 == "A large city (with over 1 000 000 people)", 1, 0)
city_othworet<- smallcity_othworet+largecity_othworet

#unemployed
table(ASFLunempl$QD3)
#retired
table(ASFLret$QD3)
#entrepreneurs
table(ASFLentrepreneurs$QD3)

table(ASFLse$livingcommgroup_1)
table(ASFLse$livingcommgroup_1)/79
table(ASFLe$livingcommgroup_1)
table(ASFLe$livingcommgroup_1)/699
table(ASFLret$livingcommgroup_1)
table(ASFLret$livingcommgroup_1)/494
table(ASFLothworet$livingcommgroup_1)
table(ASFLothworet$livingcommgroup_1)/146
table(ASFLunempl$livingcommgroup_1)
table(ASFLunempl$livingcommgroup_1)/50
table(ASFLentrepreneurs$livingcommgroup_1)
table(ASFLentrepreneurs$livingcommgroup_1)/19

####living community comparison plot
###stacked bar chart 
livingcomm <- data.frame(status=rep(c('Self-employed', 'Employed'), each=3),
                         community=rep(c("Village","Town","City"), times=2),
                         share=c(20/79,25/79,34/79,198/699,258/699,243/699))
livingcomm$status<- factor(livingcomm$status, levels=c('Self-employed', 'Employed'))
livingcomm$community<- factor(livingcomm$community, levels=c("Village","Town","City"))
ggplot(livingcomm, aes(fill=community, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="") +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))


##################################HOUSEHOLD INCOME##################################
#after tax
#full
ASFL$QD13
below2000_f<- ifelse(ASFL$QD13 == "Up to X a month", 1, 0)
between_f<- ifelse(ASFL$QD13 == "Between X and Y a month", 1, 0)
above3300_f<- ifelse(ASFL$QD13 == "Y or more a month", 1, 0)
table(ASFL$QD13)
# 482/1302,508/1302,312/1302

#self-employed
table(ASFLse$QD13)
below2000_se<- ifelse(ASFLse$QD13 == "Up to X a month", 1, 0)
between_se<- ifelse(ASFLse$QD13 == "Between X and Y a month", 1, 0)
above3300_se<- ifelse(ASFLse$QD13 == "Y or more a month", 1, 0)
table(ASFLse$QD13)
#15/69, 18/69, 36/69 

#employed
table(ASFLe$QD13)
below2000_e<- ifelse(ASFLe$QD13 == "Up to X a month", 1, 0)
between_e<- ifelse(ASFLe$QD13 == "Between X and Y a month", 1, 0)
above3300_e<- ifelse(ASFLe$QD13 == "Y or more a month", 1, 0)
table(ASFLe$QD13)
#171/647,264/647,212/647

#e+u
table(ASFLeu$QD13)
below2000_eu<- ifelse(ASFLeu$QD13 == "Up to X a month", 1, 0)
between_eu<- ifelse(ASFLeu$QD13 == "Between X and Y a month", 1, 0)
above3300_eu<- ifelse(ASFLeu$QD13 == "Y or more a month", 1, 0)
table(ASFLeu$QD13)

#others
table(ASFLoth$QD13)
below2000_oth<- ifelse(ASFLoth$QD13 == "Up to X a month", 1, 0)
between_oth<- ifelse(ASFLoth$QD13 == "Between X and Y a month", 1, 0)
above3300_oth<- ifelse(ASFLoth$QD13 == "Y or more a month", 1, 0)
table(ASFLoth$QD13)
#296/586,226/586,64/586 

#others without retired
table(ASFLothworet$QD13)
below2000_othworet<- ifelse(ASFLothworet$QD13 == "Up to X a month", 1, 0)
between_othworet<- ifelse(ASFLothworet$QD13 == "Between X and Y a month", 1, 0)
above3300_othworet<- ifelse(ASFLothworet$QD13 == "Y or more a month", 1, 0)
table(ASFLothworet$QD13)
#75/126,39/126,12/126

table(ASFLse$incomegroup_1)
table(ASFLse$incomegroup_1)/79
table(ASFLe$incomegroup_1)
table(ASFLe$incomegroup_1)/699
table(ASFLret$incomegroup_1)
table(ASFLret$incomegroup_1)/494
table(ASFLothworet$incomegroup_1)
table(ASFLothworet$incomegroup_1)/146
table(ASFLunempl$incomegroup_1)
table(ASFLunempl$incomegroup_1)/50
table(ASFLentrepreneurs$incomegroup_1)
table(ASFLentrepreneurs$incomegroup_1)/19


####household income comparison plot 
hincomecomp <- data.frame(status=rep(c('Self-employed', 'Employed'), each=4),
                          income=rep(c('3.000 or more','Between 2.000 and 3.000','Up to 2.000', 'Ref/Don`t know'), times=2),
                          share=c( 36/79, 18/79, 15/79,10/79,212/699,264/699,171/699,52/699))
hincomecomp$status<- factor(hincomecomp$status, levels=c('Self-employed', 'Employed'))
hincomecomp$income<- factor(hincomecomp$income, levels=c('3.000 or more','Between 2.000 and 3.000','Up to 2.000', 'Ref/Don`t know'))
ggplot(hincomecomp, aes(fill=income, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))

###with others
hincomecomp <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=3),
                          income=rep(c('Up to 2.000', 'Between 2.000 and 3.000', '3.000 or more'), times=3),
                          share=c(15/69, 18/69, 36/69,171/647,264/647,212/647,296/586,226/586,64/586))
hincomecomp$status<- factor(hincomecomp$status, levels=c('Self-employed', 'Employed','Others'))
hincomecomp$income<- factor(hincomecomp$income, levels=c('Up to 2.000', 'Between 2.000 and 3.000', '3.000 or more'))
ggplot(hincomecomp, aes(fill=income, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Household income in euros")


##################################SELF-RATED FINANCIAL KNOWLEDGE##################################
#full
selfassess_f <- ASFL$QK1
ASFL$QK1
dontknow_f <- ifelse(ASFL$QK1 == "Don't know", 1, 0)
hhsfknow_f<- ifelse(ASFL$QK1 == "Very high", 1, 0)
hsfknow_f<- ifelse(ASFL$QK1 == "Quite high", 1, 0)
highsfknow_f <- hhsfknow_f+hsfknow_f
asfknow_f<- ifelse(ASFL$QK1 == "About average", 1, 0)
lsfknow_f<- ifelse(ASFL$QK1 == "Quite low", 1, 0)
llsfknow_f<- ifelse(ASFL$QK1 == "Very low", 1, 0)
lowsfknow_f <- lsfknow_f+llsfknow_f
summary(ASFL$QK1)
wpct(ASFL$QK1, weight=ASFL$wght, na.rm=TRUE)
0.095532863+0.299779639 #high
0.404055791 #about average
0.128320735+0.047541960    #low
0.015297688   +0.009471324   #dont know
13+23+143+428+573+178+60


#self-employed
selfassess_se <-ASFLse$QK1
hhsfknow_se<- ifelse(ASFLse$QK1 == "Very high", 1, 0)
hsfknow_se<- ifelse(ASFLse$QK1 == "Quite high", 1, 0)
highsfknow_se <- hhsfknow_se+hsfknow_se
asfknow_se<- ifelse(ASFLse$QK1 == "About average", 1, 0)
lsfknow_se<- ifelse(ASFLse$QK1 == "Quite low", 1, 0)
llsfknow_se<- ifelse(ASFLse$QK1 == "Very low", 1, 0)
lowsfknow_se <- lsfknow_se+llsfknow_se
summary(ASFLse$QK1)
wpct(ASFLse$QK1, weight=ASFLse$wght, na.rm=TRUE)

ASFLsem <- ASFLse[(ASFLse$QD1 %in% male),] 
ASFLsef <- ASFLse[(ASFLse$QD1 %in% female),] 
summary(ASFLsem$QK1)
wpct(ASFLsem$QK1, weight=ASFLsem$wght, na.rm=TRUE)
summary(ASFLsef$QK1)
wpct(ASFLsef$QK1, weight=ASFLsef$wght, na.rm=TRUE)

#employed
selfassess_e <- ASFLe$QK1
hhsfknow_e<- ifelse(ASFLe$QK1 == "Very high", 1, 0)
hsfknow_e<- ifelse(ASFLe$QK1 == "Quite high", 1, 0)
highsfknow_e <- hhsfknow_e+hsfknow_e
asfknow_e<- ifelse(ASFLe$QK1 == "About average", 1, 0)
lsfknow_e<- ifelse(ASFLe$QK1 == "Quite low", 1, 0)
llsfknow_e<- ifelse(ASFLe$QK1 == "Very low", 1, 0)
lowsfknow_e <- lsfknow_e+llsfknow_e
summary(ASFLe$QK1)
wpct(ASFLe$QK1, weight=ASFLe$wght, na.rm=TRUE)
#e+u
selfassess_eu <- ASFLeu$QK1
hhsfknow_eu<- ifelse(ASFLeu$QK1 == "Very high", 1, 0)
hsfknow_eu<- ifelse(ASFLeu$QK1 == "Quite high", 1, 0)
highsfknow_eu <- hhsfknow_eu+hsfknow_eu
asfknow_eu<- ifelse(ASFLeu$QK1 == "About average", 1, 0)
lsfknow_eu<- ifelse(ASFLeu$QK1 == "Quite low", 1, 0)
llsfknow_eu<- ifelse(ASFLeu$QK1 == "Very low", 1, 0)
lowsfknow_eu <- lsfknow_eu+llsfknow_eu
summary(ASFLeu$QK1)
wpct(ASFLeu$QK1, weight=ASFLeu$wght, na.rm=TRUE)

#others
selfassess_oth <- ASFLoth$QK1
hhsfknow_oth<- ifelse(ASFLoth$QK1 == "Very high", 1, 0)
hsfknow_oth<- ifelse(ASFLoth$QK1 == "Quite high", 1, 0)
highsfknow_oth <- hhsfknow_oth+hsfknow_oth
asfknow_oth<- ifelse(ASFLoth$QK1 == "About average", 1, 0)
lsfknow_oth<- ifelse(ASFLoth$QK1 == "Quite low", 1, 0)
llsfknow_oth<- ifelse(ASFLoth$QK1 == "Very low", 1, 0)
lowsfknow_oth <- lsfknow_oth+llsfknow_oth
summary(ASFLoth$QK1)
wpct(ASFLoth$QK1, weight=ASFLoth$wght, na.rm=TRUE)

#others without retired
selfassess_othworet <- ASFLothworet$QK1
hhsfknow_othworet<- ifelse(ASFLothworet$QK1 == "Very high", 1, 0)
hsfknow_othworet<- ifelse(ASFLothworet$QK1 == "Quite high", 1, 0)
highsfknow_othworet <- hhsfknow_othworet+hsfknow_othworet
asfknow_othworet<- ifelse(ASFLothworet$QK1 == "About average", 1, 0)
lsfknow_othworet<- ifelse(ASFLothworet$QK1 == "Quite low", 1, 0)
llsfknow_othworet<- ifelse(ASFLothworet$QK1 == "Very low", 1, 0)
lowsfknow_othworet <- lsfknow_othworet+llsfknow_othworet
summary(ASFLothworet$QK1)
wpct(ASFLothworet$QK1, weight=ASFLothworet$wght, na.rm=TRUE)

#unemployed
table(ASFLunempl$QK1)
#retired
table(ASFLret$QK1)
#entrepreneurs
table(ASFLentrepreneurs$QK1)

table(ASFLse$QK1)/79
table(ASFLe$QK1)/699
table(ASFLret$QK1)/494
table(ASFLothworet$QK1)/146
table(ASFLunempl$QK1)/50
table(ASFLentrepreneurs$QK1)/19

#self-rated knowledge simple comparison plot
#unweighted
selfratedknow <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=3),
                            selfassessment=rep(c('Low', 'Average', 'High'), times=3),
                            share=c(3/75,27/75,45/75,92/682,291/682,299/682, 143/625,255/625, 227/625))
selfratedknow$selfassessment<- factor(selfratedknow$selfassessment, levels=c('Low', 'Average', 'High'))
selfratedknow$status<- factor(selfratedknow$status, levels=c('Self-employed', 'Employed','Others'))
ggplot(selfratedknow, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Self-assessed financial knowledge")
#weighted with others
selfratedknow <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=4),
                            selfassessment=rep(c('Ref/Don´t know','Low', 'Average', 'High'), times=3),
                            share=c(0.04768587,0.04254538,0.34443552,0.5653332,0.02188622,0.1390004,0.4149923,0.4241211,0.02553137,0.2407209,0.3976323,0.3361154))
selfratedknow$selfassessment<- factor(selfratedknow$selfassessment, levels=c('Ref/Don´t know','Low', 'Average', 'High'))
selfratedknow$status<- factor(selfratedknow$status, levels=c('Self-employed', 'Employed','Others'))
ggplot(selfratedknow, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Self-assessed financial knowledge")

#weighted
selfratedknow <- data.frame(status=rep(c('Self-employed', 'Employed'), each=4),
                            selfassessment=rep(c('Ref/Don´t know','Low', 'Average', 'High'), times=2),
                            share=c(0.04768587,0.04254538,0.34443552,0.5653332,0.02188622,0.1390004,0.4149923,0.4241211))
selfratedknow$selfassessment<- factor(selfratedknow$selfassessment, levels=c('Ref/Don´t know','Low', 'Average', 'High'))
selfratedknow$status<- factor(selfratedknow$status, levels=c('Self-employed', 'Employed'))
ggplot(selfratedknow, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))

#self-rated knowledge specific comparison plot
#unweighted
selfratedknow_specific <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=6),
                                     selfassessment=rep(c('Ref/Don´t know','Very low','Quite low', 'Average', 'Quite high', 'Very high'), times=3),
                                     share=c(4/79,2/79, 1/79, 27/79,34/79, 11/79,17/699,17/699,79/699,291/699,219/699,80/699,15/640,41/640,102/640,255/640,175/640,52/640))
selfratedknow_specific$selfassessment<- factor(selfratedknow_specific$selfassessment, levels=c('Ref/Don´t know','Very low','Quite low', 'Average', 'Quite high', 'Very high'))
selfratedknow_specific$status<- factor(selfratedknow_specific$status, levels=c('Self-employed', 'Employed','Others'))
ggplot(selfratedknow_specific, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Self-assessed financial knowledge")
#weighted with others
selfratedknow_specific <- data.frame(status=rep(c('Self-employed', 'Employed','Others'), each=6),
                                     selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=3),
                                     share=c(0.11731588,0.44801736,0.34443552,0.01013686,0.03240852,0.04768587,0.109634073,0.314487009,0.414992278,0.115507818,0.023492600,0.02188622,0.07449853,0.26161683,0.39763232,0.16015121,0.08056974,0.02553137))
selfratedknow_specific$selfassessment<- factor(selfratedknow_specific$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknow_specific$status<- factor(selfratedknow_specific$status, levels=c('Self-employed', 'Employed','Others'))
ggplot(selfratedknow_specific, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Self-assessed financial knowledge")

#weighted
selfratedknow_specific <- data.frame(status=rep(c('Self-employed', 'Employed'), each=6),
                                     selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=2),
                                     share=c(0.11731588,0.44801736,0.34443552,0.01013686,0.03240852,0.04768587,0.109634073,0.314487009,0.414992278,0.115507818,0.023492600,0.02188622))
selfratedknow_specific$selfassessment<- factor(selfratedknow_specific$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknow_specific$status<- factor(selfratedknow_specific$status, levels=c('Self-employed', 'Employed'))
ggplot(selfratedknow_specific, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="") +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))



#self-rated knowledge specific gender comparison plot
#unweighted
selfratedknowgender <- data.frame(gender=rep(c('Male', 'Female'), each=6),
                                  selfassessment=rep(c('Don´t know','Very low','Quite low', 'Average', 'Quite high', 'Very high'), times=2),
                                  share=c(2/45,0/45,0/45,13/45,24/45,6/45,2/34,2/34,1/34,14/34,10/34,5/34))
selfratedknowgender$selfassessment<- factor(selfratedknowgender$selfassessment, levels=c('Don´t know','Very low','Quite low', 'Average', 'Quite high', 'Very high'))
selfratedknowgender$gender<- factor(selfratedknowgender$gender, levels=c('Male', 'Female'))
ggplot(selfratedknowgender, aes(fill=selfassessment, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="Self-assessed financial knowledge")

#weighted
#self-employed
selfratedknowgender <- data.frame(gender=rep(c('Male', 'Female'), each=6),
                                  selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=2),
                                  share=c(0.12388988, 0.55073307, 0.29503202,0,0,0.03034502,  0.10765274, 0.29703540,0.41705377,0.02503704, 0.08004583,0.07317521 ))

selfratedknowgender$selfassessment<- factor(selfratedknowgender$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknowgender$gender<- factor(selfratedknowgender$gender, levels=c('Male', 'Female'))
ggplot(selfratedknowgender, aes(fill=selfassessment, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))

#employed
selfratedknowgender <- data.frame(gender=rep(c('Male', 'Female'), each=6),
                                  selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=2),
                                  share=c(0.123241627 ,0.356358811 ,0.410727526,0.073273932, 0.012593160,0.02380494,0.095011378 , 0.269491520, 0.419575185,0.160892403, 0.035205152 , 0.01982436))

selfratedknowgender$selfassessment<- factor(selfratedknowgender$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknowgender$gender<- factor(selfratedknowgender$gender, levels=c('Male', 'Female'))
ggplot(selfratedknowgender, aes(fill=selfassessment, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))

###############################################################################
#FINANCIAL LITERACY & ADDITIONAL INDICATORS
###############################################################################
#########################MAIN FINANCIAL LITERACY INDICATORS##########################################

#QK1 - self-rated knowledge #does not add to financial literacy score
#se: descriptive statistics
summary(ASFL$QK1)
wpct(ASFL$QK1, weight=ASFL$wght, na.rm=TRUE)
0.095532863+0.299779639#high
0.404055791 #average
0.128320735+0.047541960 #low
0.009471324+0.015297688#dont know

wpct(ASFLse$QK1, weight=ASFLse$wght, na.rm=TRUE)
summary(ASFLse$QK1)
table(ASFLse$QK1)/79
ASFLsem <- ASFLse[(ASFLse$QD1 %in% male),]
ASFLsef <- ASFLse[(ASFLse$QD1 %in% female),]
wpct(ASFLsem$QK1, weight=ASFLsem$wght, na.rm=TRUE)
summary(ASFLsem$QK1)
wpct(ASFLsef$QK1, weight=ASFLsef$wght, na.rm=TRUE)
summary(ASFLsef$QK1)

wpct(ASFLe$QK1, weight=ASFLe$wght, na.rm=TRUE)
summary(ASFLe$QK1)
summary(ASFLe$QK1)/699
ASFLem <- ASFLe[(ASFLe$QD1 %in% male),]
ASFLef <- ASFLe[(ASFLe$QD1 %in% female),]
summary(ASFLem$QK1)
wpct(ASFLem$QK1, weight=ASFLem$wght, na.rm=TRUE)
summary(ASFLef$QK1)
wpct(ASFLef$QK1, weight=ASFLef$wght, na.rm=TRUE)

#QK2 - equal splitting #does not add to financial literacy score
table(ASFL$QK2)
QK2f<- ifelse(ASFL$QK2 == "200", 1, 0)
table(QK2f)
summary(ASFLse$QK2)
QK2se<- ifelse(ASFLse$QK2 == "200", 1, 0)
table(QK2se)
QK2e<- ifelse(ASFLe$QK2 == "200", 1, 0)
table(QK2e)
summary(ASFLeu$QK2)
QK2oth<- ifelse(ASFLoth$QK2 == "200", 1, 0)
table(QK2oth)

####################FINANCIAL KNOWLEDGE SCORE#############################
#QK3 - *OECD - time value of money
summary(ASFL$QK3)
wpct(ASFL$QK3, weight=ASFL$wght, na.rm=TRUE)
0.079752816+0.653954112 #correct
0.002064761+0.013762686+0.042886767 #dont know/irrelevant/refused
1-0.7337069-0.05871421 #incorrect

summary(ASFLse$QK3)
wpct(ASFLse$QK3, weight=ASFLse$wght, na.rm=TRUE) #0.8812004,0.06277662,0.05602298
0.77712780 +0.10407263 #correct
1-(0.05602298+0.8812004)#incorrect 
0.05602298 #dont know/irrelevant
wpct(ASFLsem$QK3, weight=ASFLsem$wght, na.rm=TRUE)
0.83180017  +0.06566565
1-0.01546969 -   0.8974658                                           
wpct(ASFLsef$QK3, weight=ASFLsef$wght, na.rm=TRUE)
0.69676483 +0.16052710
1-0.11563233-    0.8572919                                      

summary(ASFLe$QK3)
wpct(ASFLe$QK3, weight=ASFLe$wght, na.rm=TRUE)#0.7227266,0.2387096,0.03856385
0.650157593 +0.072568991 #correct
1-(0.7227266+0.03856385)#incorrect 
0.001668598 +0.008530523 +0.028364729 #dont know/irrelevant
wpct(ASFLem$QK3, weight=ASFLem$wght, na.rm=TRUE)
0.077892090 +0.662530957 
0.003221358   +0.005212802 + 0.024882410      
1-0.03331657-0.8572919
wpct(ASFLef$QK3, weight=ASFLef$wght, na.rm=TRUE)
0.01209575 + 0.03210683 
0.06684878 +0.63686116                      
1-0.7037099-0.04420258

summary(ASFLoth$QK3)
wpct(ASFLoth$QK3, weight=ASFLoth$wght, na.rm=TRUE)#0.7288287,0.1860751,0.08509625
0.085890743+0.642937970#correct
1-(0.7288287+0.08509625)#incorrect 
0.002843489 +0.022301557+0.059951203#dont know/irrelevant

summary(ASFLothworet$QK3)
wpct(ASFLothworet$QK3, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant
summary(ASFL$QK3)
QK3_1 <- ifelse(ASFL$QK3 == "Or, less than they could buy today", 1, 0)
QK3_2 <- ifelse(ASFL$QK3 == "It depends on the types of things that they want to buy", 1, 0)
QK3f<- QK3_1+QK3_2
table(QK3f)

summary(ASFLse$QK3)
QK3_1se <- ifelse(ASFLse$QK3 == "Or, less than they could buy today", 1, 0)
QK3_2se <- ifelse(ASFLse$QK3 == "It depends on the types of things that they want to buy", 1, 0)
QK3se<- QK3_1se+QK3_2se
table(QK3se)

summary(ASFLe$QK3)
QK3_1e <- ifelse(ASFLe$QK3 == "Or, less than they could buy today", 1, 0)
QK3_2e <- ifelse(ASFLe$QK3 == "It depends on the types of things that they want to buy", 1, 0)
QK3e<- QK3_1e+QK3_2e
table(QK3e)

summary(ASFLoth$QK3)
QK3_1oth <- ifelse(ASFLoth$QK3 == "Or, less than they could buy today", 1, 0)
QK3_2oth <- ifelse(ASFLoth$QK3 == "It depends on the types of things that they want to buy", 1, 0)
QK3oth<- QK3_1oth+QK3_2oth
table(QK3oth)

#QK4 - *OECD - interest paid on a loan
table(ASFL$QK4)
wpct(ASFL$QK4, weight=ASFL$wght, na.rm=TRUE)
0.8896527640#correct
0.0374343030+0.0264719756+0.0234817298#dont know/irrelevant/refused
1-0.8896527640-0.08738801 #incorrect
(52+41+33)/1418
(16+1+5+3+1+1+1)/1418
1264/1418 #89% according to OECD

table(ASFLse$QK4)
wpct(ASFLse$QK4, weight=ASFLse$wght, na.rm=TRUE)#0.970574832,0.007966968,0.0214582
0.970574832 #correct
0.007966968 #incorrect 
0.006653903+0.014804297#dont know/irrelevant
wpct(ASFLsem$QK4, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QK4, weight=ASFLsef$wght, na.rm=TRUE)

table(ASFLe$QK4)
wpct(ASFLe$QK4, weight=ASFLe$wght, na.rm=TRUE)#0.897261034,0.03466621,0.06807276
0.897261034#correct
1-(0.897261034+0.06807276)#incorrect 
0.021111471+0.021588658+0.025372634#dont know/irrelevant
wpct(ASFLem$QK4, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QK4, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$QK4)
wpct(ASFLoth$QK4, weight=ASFLoth$wght, na.rm=TRUE)#0.8693630648,0.009771735,0.1208652      
0.8693630648  #correct
1-(0.1208652+0.8693630648)#incorrect 
0.0578566151+0.0353428495+0.0276657225#dont know/irrelevant

table(ASFLothworet$QK4)
wpct(ASFLothworet$QK4, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant
QK4f<- ifelse(ASFL$QK4 == "0", 1, 0)
table(QK4f)
QK4se<- ifelse(ASFLse$QK4 == "0", 1, 0)
table(QK4se)
QK4e<- ifelse(ASFLe$QK4 == "0", 1, 0)
table(QK4e)
QK4oth<- ifelse(ASFLoth$QK4 == "0", 1, 0)
table(QK4oth)


#QK5 - *OECD - interest plus principal
table(ASFL$QK5)
wpct(ASFL$QK5, weight=ASFL$wght, na.rm=TRUE)
0.7855571881#correct
0.0958051578+0.0309178571+0.0070958973#dont know/irrelevant/refused
1-0.1338189-0.7855572#incorrect
0.0958051578+0.0309178571+0.0070958973 

summary(ASFLse$QK5)
wpct(ASFLse$QK5, weight=ASFLse$wght, na.rm=TRUE)#0.911007520,0.025367278,0.0636252
0.911007520       #correct
0.025367278 #incorrect 
0.0636252#dont know/irrelevant
wpct(ASFLsem$QK5, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QK5, weight=ASFLsef$wght, na.rm=TRUE)

summary(ASFLe$QK5)
wpct(ASFLe$QK5, weight=ASFLe$wght, na.rm=TRUE)#0.7892900880,0.1056407,0.1050692
0.7892900880#correct
1-(0.1050692+0.7892900880)#incorrect 
0.0712881232+0.0279016771+0.0058794117#dont know/irrelevant
wpct(ASFLem$QK5, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QK5, weight=ASFLef$wght, na.rm=TRUE)

summary(ASFLoth$QK5)
wpct(ASFLoth$QK5, weight=ASFLoth$wght, na.rm=TRUE)#0.7645187980,0.0554447,0.1800365      
0.7645187980#correct
1-(0.1800365+0.7645187980)#incorrect 
0.1328077169+0.0388111377+0.0084176501#dont know/irrelevant

summary(ASFLothworet$QK5)
wpct(ASFLothworet$QK5, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant

QK5f<- ifelse(ASFL$QK5 == "102", 1, 0)
table(QK5f)
QK5se<- ifelse(ASFLse$QK5 == "102", 1, 0)
table(QK5se)
QK5sem<- ifelse(ASFLsem$QK5 == "102", 1, 0)
QK5sef<- ifelse(ASFLsef$QK5 == "102", 1, 0)


QK5e<- ifelse(ASFLe$QK5 == "102", 1, 0)
QK5em<- ifelse(ASFLem$QK5 == "102", 1, 0)
QK5ef<- ifelse(ASFLef$QK5 == "102", 1, 0)
table(QK5e)
QK5eu<- ifelse(ASFLeu$QK5 == "102", 1, 0)
table(QK5eu)
QK5oth<- ifelse(ASFLoth$QK5 == "102", 1, 0)
table(QK5oth)
QK5othworet<- ifelse(ASFLothworet$QK5 == "102", 1, 0)
table(QK5othworet)

#QK6 - *OECD - compound interest 
summary(ASFL$QK6) 
wpct(ASFL$QK6, weight=ASFL$wght, na.rm=TRUE)#0.4903881,0.365513,0.1440989
0.535301109#correct
0.004409244+0.018203732+0.076572892 #dont know/irrelevant/refused
1-0.535301109-0.09918587#incorrect

summary(ASFLse$QK6)
wpct(ASFLse$QK6, weight=ASFLse$wght, na.rm=TRUE)
0.178534126 +0.130571101 #incorrect 
wpct(ASFLsem$QK6, weight=ASFLsem$wght, na.rm=TRUE)
0.16649831+0.18025887 
wpct(ASFLsef$QK6, weight=ASFLsef$wght, na.rm=TRUE)
0.19622559+0.05753498

summary(ASFLe$QK6)
wpct(ASFLe$QK6, weight=ASFLe$wght, na.rm=TRUE)  
0.280932800+0.063492648+0.007347740  #incorrect 
wpct(ASFLem$QK6, weight=ASFLem$wght, na.rm=TRUE) 
0.007426559 +0.054086592 + 0.281542631
wpct(ASFLef$QK6, weight=ASFLef$wght, na.rm=TRUE) 
0.007263041 +0.073600407 +0.280277475

summary(ASFLoth$QK6)
wpct(ASFLoth$QK6, weight=ASFLoth$wght, na.rm=TRUE)
0.324732739 +0.053209114 +0.012614148 #incorrect 

summary(ASFLothworet$QK6)
wpct(ASFLothworet$QK6, weight=ASFLothworet$wght, na.rm=TRUE)


#relevel to avoid errors
#ASFL$QK6 <- 
levels(ASFL$QK6) <- c("Irrelevant answer","Refused","Don't know","More than eur110","Exactly eur110","Less than eur110","Or is it impossible to tell from the information given")
levels(ASFL$QK6)

QK6relevel <- ASFL$QK6
ASFL <- ASFL %>%
  mutate(QK6relevel=case_when(
    QK6relevel =="Don't know"~ "Don't know",
    QK6relevel =="Irrelevant answer"~ "Irrelevant answer",
    QK6relevel =="Refused"~ "Refused",
    QK6relevel =="More than ???110"~ "More than eur110",
    QK6relevel =="Exactly ???110"~ "Exactly eur110",
    QK6relevel =="Less than ???110"~ "Less than eur110",
    QK6relevel =="Or is it impossible to tell from the information given"~ "Or is it impossible to tell from the information given"
  ))
table(ASFL$QK6relevel)

ASFLse <- ASFL[(ASFL$QD10 %in% se),] 
summary(ASFLse)
ASFLsem <- ASFLse[(ASFLse$QD1 %in% male),] 
ASFLsef <- ASFLse[(ASFLse$QD1 %in% female),] 
ASFLe <- ASFL[(ASFL$QD10 %in% e),] 
summary(ASFLe)
ASFLem <- ASFLe[(ASFLe$QD1 %in% male),] 
ASFLef <- ASFLe[(ASFLe$QD1 %in% female),] 
ASFLeu <-  ASFL[(ASFL$QD10 %in% eu),] 
summary(ASFLeu)
ASFLunempl <-  ASFL[(ASFL$QD10 %in% unempl),] 
summary(ASFLunempl)
ASFLoth <-  ASFL[(ASFL$QD10 %in% oth),] 
summary(ASFLoth)
ASFLempl <- ASFL[(ASFL$QD10 %in% empl),] 
ASFLempl$QD10
ASFLregempl <- ASFL[(ASFL$QD10 %in% regempl),] 
ASFLothworet <-  ASFL[(ASFL$QD10 %in% othworet),] 
summary(ASFLothworet)
ASFLothworet <-  ASFL[(ASFL$QD10 %in% othworet),] 
summary(ASFLothworet)
ASFLstud <-  ASFL[(ASFL$QD10 %in% stud),] 
summary(ASFLstud)
ASFLret <-  ASFL[(ASFL$QD10 %in% ret),] 
summary(ASFLret)

QK6f<- ifelse(ASFL$QK6 == "More than eur110", 1, 0)
QK6se<- ifelse(ASFLse$QK6 == "More than eur110", 1, 0)
table(QK6se)
QK6sem<- ifelse(ASFLsem$QK6 == "More than eur110", 1, 0)
QK6sef<- ifelse(ASFLsef$QK6 == "More than eur110", 1, 0)
QK6e<- ifelse(ASFLe$QK6 == "More than eur110", 1, 0)
table(QK6e)
QK6em<- ifelse(ASFLem$QK6 == "More than eur110", 1, 0)
QK6ef<- ifelse(ASFLef$QK6 == "More than eur110", 1, 0)
QK6eu<- ifelse(ASFLeu$QK6 == "More than eur110", 1, 0)
table(QK6eu)
QK6oth<- ifelse(ASFLoth$QK6 == "More than eur110", 1, 0)
table(QK6oth)
QK6othworet<- ifelse(ASFLothworet$QK6 == "More than eur110", 1, 0)
table(QK6othworet)

###QK5 + QK6
QK56f <- QK5f+QK6f
table(QK56f)
wpct(QK56f, weight=ASFL$wght, na.rm=TRUE)#0.4903881#correct

QK6fn <- ifelse(QK56f == "2",1, 0)
table(QK6fn)
702/1418 

QK56se <- QK5se+QK6se
QK56sem <- QK5sem+QK6sem
QK56sef <- QK5sef+QK6sef
table(QK56se)
wpct(QK56se, weight=ASFLse$wght, na.rm=TRUE)
wpct(QK56sem, weight=ASFLsem$wght, na.rm=TRUE)
0.62289779 #correct
wpct(QK56sef, weight=ASFLsef$wght, na.rm=TRUE)
0.6661936 #correct
QK6sen <- ifelse(QK56se == "2",1, 0) 
QK6semn <- ifelse(QK56sem == "2",1, 0)
QK6sefn <- ifelse(QK56sef == "2",1, 0)
wpct(QK56se, weight=ASFLse$wght, na.rm=TRUE) #0.64042716,0.3091052,0.05046764
1-(0.64042716 +0.3091052)

QK56e <- QK5e+QK6e
table(QK56e)
QK56em <- QK5em+QK6em
QK56ef <- QK5ef+QK6ef
wpct(QK56e, weight=ASFLe$wght, na.rm=TRUE)
wpct(QK56em, weight=ASFLem$wght, na.rm=TRUE)
wpct(QK56ef, weight=ASFLef$wght, na.rm=TRUE)
QK6en <- ifelse(QK56e == "2",1, 0) #0.5221745,0.3517732,0.1274378
QK6emn <- ifelse(QK56em == "2",1, 0)
QK6efn <- ifelse(QK56ef == "2",1, 0)
table(QK6en)
365/699
1-(0.5207890 +0.3517732)

QK56eu <- QK5eu+QK6eu
table(QK56eu)
wpct(QK56eu, weight=ASFLeu$wght, na.rm=TRUE)
QK6eun <- ifelse(QK56eu == "2",1, 0)
table(QK6eun)
379/749

QK56oth <- QK5oth+QK6oth
table(QK56oth)
wpct(QK56oth, weight=ASFLoth$wght, na.rm=TRUE)
QK6othn <- ifelse(QK56oth == "2",1, 0)#0.4317166,0.390556,0.1777274
table(QK6othn)
1-(0.4317166+0.390556)

QK56othworet <- QK5othworet+QK6othworet
table(QK56othworet)
wpct(QK56othworet, weight=ASFLothworet$wght, na.rm=TRUE)
QK6othworetn <- ifelse(QK56othworet == "2",1, 0)
table(QK6othworetn)

#QK7_1 - *OECD - risk and return
table(ASFL$QK7_1)
wpct(ASFL$QK7_1, weight=ASFL$wght, na.rm=TRUE)#0.9166026,0.03135837,0.05203899
0.916602640#correct
0.050442460+0.001596526#dont know/irrelevant/refused
1-0.916602640-0.05203899#incorrect

table(ASFLse$QK7_1)
wpct(ASFLse$QK7_1, weight=ASFLse$wght, na.rm=TRUE)#0.90143273,0.03396225, 0.06460503 
0.90143273 #correct
0.03396225 #incorrect 
0.06460503 #dont know/irrelevant
wpct(ASFLsem$QK7_1, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QK7_1, weight=ASFLsef$wght, na.rm=TRUE)


table(ASFLe$QK7_1)
wpct(ASFLe$QK7_1, weight=ASFLe$wght, na.rm=TRUE)#0.9070270072 ,0.0443046011 ,0.04866839
0.9070270072 #correct
0.0443046011 #incorrect 
1-(0.0443046011 +0.9070270072)#dont know/irrelevant
wpct(ASFLem$QK7_1, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QK7_1, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$QK7_1)
wpct(ASFLoth$QK7_1, weight=ASFLoth$wght, na.rm=TRUE)#0.930935147,0.014295340,0.05476951
0.930935147 #correct
0.014295340#incorrect 
1-(0.014295340+0.930935147)#dont know/irrelevant

table(ASFLothworet$QK7_1)
wpct(ASFLothworet$QK7_1, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant

QK7_1f<- ifelse(ASFL$QK7_1 == "1", 1, 0) #1=TRUE
table(QK7_1f)
QK7_1se<- ifelse(ASFLse$QK7_1 == "1", 1, 0)
table(QK7_1se)
QK7_1e<- ifelse(ASFLe$QK7_1 == "1", 1, 0)
table(QK7_1e)
QK7_1eu<- ifelse(ASFLeu$QK7_1 == "1", 1, 0)
table(QK7_1eu)
QK7_1oth<- ifelse(ASFLoth$QK7_1 == "1", 1, 0)
table(QK7_1oth)

#QK7_2 - *OECD - inflation definition
table(ASFL$QK7_2)
wpct(ASFL$QK7_2, weight=ASFL$wght, na.rm=TRUE)#0.8889704,0.04507601,0.06595359
0.888970397 #correct
0.061969977+0.003983608#dont know/irrelevant/refused
1-0.888970397-0.06595359#incorrect

table(ASFLse$QK7_2)
wpct(ASFLse$QK7_2, weight=ASFLse$wght, na.rm=TRUE)#0.91822943,0.03238426,0.04938631 
0.91822943 #correct
0.03238426 #incorrect 
0.04938631 #dont know/irrelevant
wpct(ASFLsem$QK7_2, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QK7_2, weight=ASFLsef$wght, na.rm=TRUE)

table(ASFLe$QK7_2)
wpct(ASFLe$QK7_2, weight=ASFLe$wght, na.rm=TRUE)#0.887358506,0.052169972 ,0.06047152
0.887358506 #correct
0.052169972 #incorrect 
1-(0.052169972 +0.887358506)#dont know/irrelevant
wpct(ASFLem$QK7_2, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QK7_2, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$QK7_2)
wpct(ASFLoth$QK7_2, weight=ASFLoth$wght, na.rm=TRUE)#0.887270979,0.037551181 ,0.07517784
0.887270979 #correct
0.037551181 #incorrect 
1-(0.887270979+0.037551181 ) #dont know/irrelevant

table(ASFLothworet$QK7_2)
wpct(ASFLothworet$QK7_2, weight=ASFLothworet$wght, na.rm=TRUE)#0.809610297,0.080652478,0.1097372
0.809610297#correct
0.080652478 #incorrect 
1-(0.809610297+0.080652478)#dont know/irrelevant

QK7_2f<- ifelse(ASFL$QK7_2 == "1", 1, 0)
table(QK7_2f)
QK7_2se<- ifelse(ASFLse$QK7_2 == "1", 1, 0)
table(QK7_2se)
QK7_2e<- ifelse(ASFLe$QK7_2 == "1", 1, 0)
table(QK7_2e)
QK7_2eu<- ifelse(ASFLeu$QK7_2 == "1", 1, 0)
table(QK7_2eu)

#QK7_3 - *OECD - diversification
table(ASFL$QK7_3)
wpct(ASFL$QK7_3, weight=ASFL$wght, na.rm=TRUE)#0.61300273,0.1526371,0.2343602
0.61300273 #correct
0.22363099+0.01072922#dont know/irrelevant/refused
1-0.61300273-0.2343602#incorrect

table(ASFLse$QK7_3)
wpct(ASFLse$QK7_3, weight=ASFLse$wght, na.rm=TRUE)#0.77142812,0.13102772,0.09754416 
0.77142812 #correct
0.13102772 #incorrect 
0.09754416 #dont know/irrelevant
wpct(ASFLsem$QK7_3, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QK7_3, weight=ASFLsef$wght, na.rm=TRUE)

table(ASFLe$QK7_3)
wpct(ASFLe$QK7_3, weight=ASFLe$wght, na.rm=TRUE)#0.667234442,0.162267278,0.1704983
0.667234442 #correct
0.162267278 #incorrect 
1-(0.667234442 +0.162267278 )#dont know/irrelevant
wpct(ASFLem$QK7_3, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QK7_3, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$QK7_3)
wpct(ASFLoth$QK7_3, weight=ASFLoth$wght, na.rm=TRUE)#0.52245783,0.14298805,0.3345541
0.52245783 #correct
0.14298805 #incorrect 
1-(0.52245783+0.14298805 ) #dont know/irrelevant

table(ASFLothworet$QK7_3)
wpct(ASFLothworet$QK7_3, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant


QK7_3f<- ifelse(ASFL$QK7_3 == "1", 1, 0)
table(QK7_3f)
QK7_3se<- ifelse(ASFLse$QK7_3 == "1", 1, 0)
table(QK7_3se)
QK7_3e<- ifelse(ASFLe$QK7_3 == "1", 1, 0)
table(QK7_3e)
QK7_3eu<- ifelse(ASFLeu$QK7_3 == "1", 1, 0)
table(QK7_3eu)

#S58 - non-OECD - real interest
table(ASFL$S58)
wpct(ASFL$S58, weight=ASFL$wght, na.rm=TRUE)#0.778428892,0.1463434,0.07522774
0.778428892 #correct
0.001358319+0.018599573+0.055269846#dont know/irrelevant/refused
1-0.778428892-0.07522774#incorrect

table(ASFLse$S58)
wpct(ASFLse$S58, weight=ASFLse$wght, na.rm=TRUE)#0.93873646,0.01444696,0.04681658      
0.93873646 #correct
0.01444696      #incorrect 
0.04681658      #dont know/irrelevant
wpct(ASFLsem$S58, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$S58, weight=ASFLsef$wght, na.rm=TRUE)

table(ASFLe$S58)
wpct(ASFLe$S58, weight=ASFLe$wght, na.rm=TRUE)#0.77005123,0.1758667,0.05408207
0.77005123#correct
0.04638901+0.12947764      #incorrect 
1-(0.77005123+0.1758667)#dont know/irrelevant
wpct(ASFLem$S58, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$S58, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$S58)
wpct(ASFLoth$S58, weight=ASFLoth$wght, na.rm=TRUE)#0.768531697 ,0.1252482,0.1062201
0.768531697 #correct
0.096712743+0.028535412        #incorrect 
1-(0.768531697 +0.1252482) #dont know/irrelevant

table(ASFLothworet$S58)
wpct(ASFLothworet$S58, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant

S58f<- ifelse(ASFL$S58 == "Less than today", 1, 0)
table(S58f)
S58se<- ifelse(ASFLse$S58 == "Less than today", 1, 0)
table(S58se)
S58e<- ifelse(ASFLe$S58 == "Less than today", 1, 0)
table(S58e)
S58eu<- ifelse(ASFLeu$S58 == "Less than today", 1, 0)
table(S58eu)


#QK7_4add - non-OECD - overdrawing a account 
table(ASFL$QK7_4add)
wpct(ASFL$QK7_4add, weight=ASFL$wght, na.rm=TRUE)#0.685109119,0.1647971,0.1500938
0.685109119 #correct
0.009036726 +0.141057048 #dont know/irrelevant/refused
1-0.685109119-0.1500938#incorrect

table(ASFLse$QK7_4add)
wpct(ASFLse$QK7_4add, weight=ASFLse$wght, na.rm=TRUE)#0.7227731 ,0.1404427 ,0.1367842 
0.7227731 #correct
0.1404427 #incorrect 
0.1367842 #dont know/irrelevant
wpct(ASFLsem$QK7_4add, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QK7_4add, weight=ASFLsef$wght, na.rm=TRUE)

table(ASFLe$QK7_4add)
wpct(ASFLe$QK7_4add, weight=ASFLe$wght, na.rm=TRUE)#0.740998033 ,0.174713123,0.08428884
0.740998033 #correct
0.174713123 #incorrect 
1-(0.174713123 +0.740998033 )#dont know/irrelevant
wpct(ASFLem$QK7_4add, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QK7_4add, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$QK7_4add)
wpct(ASFLoth$QK7_4add, weight=ASFLoth$wght, na.rm=TRUE)#0.60803253 ,0.15513368 ,0.2368338
0.60803253 #correct
0.15513368 #incorrect 
1-(0.60803253+0.15513368 )#dont know/irrelevant

table(ASFLothworet$QK7_4add)
wpct(ASFLothworet$QK7_4add, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant


QK7_4addf<- ifelse(ASFL$QK7_4add == "False", 1, 0)
table(QK7_4addf)
QK7_4addse<- ifelse(ASFLse$QK7_4add == "False", 1, 0)
table(QK7_4addse)
QK7_4adde<- ifelse(ASFLe$QK7_4add == "False", 1, 0)
table(QK7_4adde)
QK7_4addeu<- ifelse(ASFLeu$QK7_4add == "False", 1, 0)
table(QK7_4addeu)

#EB3 - non-OECD - exchange rate
table(ASFL$EB3)
wpct(ASFL$EB3, weight=ASFL$wght, na.rm=TRUE)#0.6917723,0.1276094,0.1806183
0.691772328#correct
0.005521473+0.013842803+0.161254056#dont know/irrelevant/refused
1-0.691772328-0.1806183#incorrect

table(ASFLse$EB3)
wpct(ASFLse$EB3, weight=ASFLse$wght, na.rm=TRUE)#0.87447672,0.04876289,0.07676039             
0.87447672             #correct
1-(0.87447672+0.07676039)#incorrect 
0.07676039             #dont know/irrelevant
wpct(ASFLsem$EB3, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$EB3, weight=ASFLsef$wght, na.rm=TRUE)

table(ASFLe$EB3)
wpct(ASFLe$EB3, weight=ASFLe$wght, na.rm=TRUE)#0.703229118 ,0.159618,0.1371529
0.703229118 #correct
0.083257430            +0.076360531 #incorrect 
1-(0.159618+0.703229118)#dont know/irrelevant
wpct(ASFLem$EB3, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$EB3, weight=ASFLef$wght, na.rm=TRUE)

table(ASFLoth$EB3)
wpct(ASFLoth$EB3, weight=ASFLoth$wght, na.rm=TRUE)#0.653354147,0.09644592,0.2501999
0.653354147 #correct
0.038369373+0.058076548#incorrect 
1-(0.653354147+0.09644592)#dont know/irrelevant

table(ASFLothworet$EB3)
wpct(ASFLothworet$EB3, weight=ASFLothworet$wght, na.rm=TRUE)
#correct
#incorrect 
#dont know/irrelevant

EB3f<- ifelse(ASFL$EB3 == "Increases", 1, 0)
table(EB3f)
EB3se<- ifelse(ASFLse$EB3 == "Increases", 1, 0)
table(EB3se)
EB3e<- ifelse(ASFLe$EB3 == "Increases", 1, 0)
table(EB3e)
EB3eu<- ifelse(ASFLeu$EB3 == "Increases", 1, 0)
table(EB3eu)

ASFL1 <- cbind(ASFL,QK3f,QK4f,QK5f,QK6fn,QK56f,QK7_1f,QK7_2f,QK7_3f,S58f,QK7_4addf,EB3f)
#create financial knowledge score (score 0-7).
fin_know <- (QK3f+QK4f+QK5f+QK6fn+QK7_1f+QK7_2f+QK7_3f)

ASFL1 <- cbind(ASFL1,fin_know)
summary(ASFL1$fin_know)
table(ASFL1$fin_know)
weighted.mean(ASFL1$fin_know,ASFL1$wght)#5.3 - according to OECD (2020)
wpct(ASFL1$fin_know, weight=ASFL1$wght, na.rm=TRUE)

#dummyvariables
ASFL1 <- ASFL1 %>% mutate(fin_know_group = case_when(fin_know >= 6  & fin_know <= 7 ~ 'High fk',
                                                     fin_know >= 4  & fin_know <6  ~ 'Average fk',
                                                     fin_know >= 0  & fin_know < 4 ~ 'Low fk'))
table(ASFL1$fin_know_group)
fin_know_group_1 <- factor(ASFL1$fin_know_group, levels=c("High fk","Average fk", "Low fk"))
levels(fin_know_group_1)


highfinknowd <- ifelse(ASFL1$fin_know_group == "High", 1, 0)
highfinknowd <- as.numeric(highfinknowd)
averagefinknowd <- ifelse(ASFL1$fin_know_group == "Average", 1, 0)
lowfinknowd <- ifelse(ASFL1$fin_know_group == "Low", 1, 0)
ASFL1 <- cbind(ASFL1,lowfinknowd,averagefinknowd,highfinknowd,fin_know_group_1)
##############austria specific additional financial knowledge!

#old: QK3_1+QK4+QK5+QK6+QK7_1+QK7_2+QK7_3+S58+QK7_4add+EB3
fin_know_add <- (QK3f+QK4f+QK5f+QK6fn+QK7_1f+QK7_2f+QK7_3f+S58f+QK7_4addf+EB3f)
table(fin_know_add)
ASFL1 <- cbind(ASFL1,fin_know_add)
weighted.mean(ASFL1$fin_know_add,ASFL1$wght)
wpct(ASFL1$fin_know_add, weight=ASFL1$wght, na.rm=TRUE)

#dummyvariables
ASFL1 <- ASFL1 %>% mutate(fin_know_add_group = case_when(fin_know_add >= 8  & fin_know_add <= 10 ~ 'High fk',
                                                         fin_know_add >= 5  & fin_know_add <8  ~ 'Average fk',
                                                         fin_know_add >= 0  & fin_know_add < 5 ~ 'Low fk'))

table(ASFL1$fin_know_add)
fin_know_add_group_1 <- factor(ASFL1$fin_know_add_group, levels=c("High fk", "Average fk", "Low fk"))
levels(fin_know_add_group_1)

highfinknowaddd <- ifelse(ASFL1$fin_know_add_group == "high", 1, 0)
averagefinknowaddd <- ifelse(ASFL1$fin_know_add_group == "average", 1, 0)
lowfinknowaddd <- ifelse(ASFL1$fin_know_add_group == "low", 1, 0)
ASFL1 <- cbind(ASFL1,lowfinknowaddd,averagefinknowaddd,highfinknowaddd)

####################FINANCIAL ATTITUDE SCORE#############################
#recode Refused, Not relevant and donÂ´t know to 3
#more satisfying to spend than to save money
summary(ASFL$QS1_1)
QS1_1 <-ASFL$QS1_1
QS1_1_1_rec <- ifelse(QS1_1== "Refused", 3, 0)
QS1_1_2_rec <- ifelse(QS1_1 == "Not relevant", 3, 0)
QS1_1_3_rec <- ifelse(QS1_1 == "Don't know", 3, 0)

QS1_1_1 <- ifelse(QS1_1 == "Completely agree",1, 0)
QS1_1_2 <- ifelse(QS1_1 == "2",2, 0)
QS1_1_3 <- ifelse(QS1_1 == "3",3, 0)
QS1_1_4 <- ifelse(QS1_1 == "4",4, 0)
QS1_1_5 <- ifelse(QS1_1 == "Completely disagree",5, 0)
QS1_1f <- QS1_1_1_rec+QS1_1_2_rec+QS1_1_3_rec+QS1_1_1+QS1_1_2+QS1_1_3+QS1_1_4+QS1_1_5
QS1_1f
table(QS1_1f)
summary(QS1_1f) 
ASFL1 <- cbind(ASFL1, QS1_1f)
weighted.mean(ASFL1$QS1_1f, ASFL1$wght)#mean:3.1 - according to Fessler et al (2020)

#money there to be spent
summary(ASFL$QS1_3)
QS1_3 <-ASFL$QS1_3
QS1_3_1_rec <- ifelse(QS1_3== "Refused", 3, 0)
QS1_3_2_rec <- ifelse(QS1_3 == "Not relevant", 3, 0)
QS1_3_3_rec <- ifelse(QS1_3 == "Don't know", 3, 0)

QS1_3_1 <- ifelse(QS1_3 == "Completely agree",1, 0)
QS1_3_2 <- ifelse(QS1_3 == "2",2, 0)
QS1_3_3 <- ifelse(QS1_3 == "3",3, 0)
QS1_3_4 <- ifelse(QS1_3 == "4",4, 0)
QS1_3_5 <- ifelse(QS1_3 == "Completely disagree",5, 0)
QS1_3f <- QS1_3_1_rec+QS1_3_2_rec+QS1_3_3_rec+QS1_3_1+QS1_3_2+QS1_3_3+QS1_3_4+QS1_3_5
QS1_3f
table(QS1_3f)
summary(QS1_3f)
ASFL1 <- cbind(ASFL1, QS1_3f)
weighted.mean(QS1_3f, ASFL1$wght)

#live for today and let tommorow take care of itself
summary(ASFL$QS3_11)
QS3_11 <-ASFL$QS3_11
QS3_11_1_rec <- ifelse(QS3_11== "Refused", 3, 0)
QS3_11_2_rec <- ifelse(QS3_11 == "Not relevant", 3, 0)
QS3_11_3_rec <- ifelse(QS3_11 == "Don't know", 3, 0)

QS3_11_1 <- ifelse(QS3_11 == "Completely",1, 0)
QS3_11_2 <- ifelse(QS3_11 == "2",2, 0)
QS3_11_3 <- ifelse(QS3_11 == "3",3, 0)
QS3_11_4 <- ifelse(QS3_11 == "4",4, 0)
QS3_11_5 <- ifelse(QS3_11 == "Not at all",5, 0)
QS3_11f <- QS3_11_1_rec+QS3_11_2_rec+QS3_11_3_rec+QS3_11_1+QS3_11_2+QS3_11_3+QS3_11_4+QS3_11_5
QS3_11f
table(QS3_11f)
summary(QS3_11f) 
ASFL1 <- cbind(ASFL1, QS3_11f)
weighted.mean(QS3_11f, ASFL1$wght)#mean:3.6 - according to Fessler et al (2020)

fin_att <- (QS1_1f+QS1_3f+QS3_11f)/3
ASFL2 <- cbind(ASFL1,fin_att)


#mean
summary(ASFL2$fin_att)
weighted.mean(ASFL2$fin_att, ASFL2$wght) #3.1 - according to OECD (2020)

table(ASFL2$fin_att)
wpct(ASFL2$fin_att, weight=ASFL2$wght, na.rm=TRUE)
fin_attr<- round(ASFL2$fin_att)
ASFL2 <- cbind(ASFL2, fin_attr)
wpct(ASFL2$fin_attr, weight=ASFL2$wght, na.rm=TRUE)
weighted.mean(ASFL2$fin_attr, ASFL2$wght)
#OECD benchmark: more than 3 (out of 5)
#dummy variables 
ASFL2 <- ASFL2 %>% mutate(fin_att_group = case_when(fin_att >4  & fin_att <= 5 ~ "High fa",
                                                    fin_att > 3  & fin_att <=4  ~ "Average fa",
                                                    fin_att >= 0  & fin_att <=3  ~ "Low fa"))

fin_att_group_1 <- factor(ASFL2$fin_att_group, levels=c("High fa", "Average fa","Low fa"))
levels(fin_att_group_1)


highfinattd <- ifelse(ASFL2$fin_att_group == "High fa", 1, 0)
middlefinattd<- ifelse(ASFL2$fin_att_group == "Average fa", 1, 0)
hfinattd <-  highfinattd+middlefinattd
lowfinattd <- ifelse(ASFL2$fin_att_group == "Low fa", 1, 0)
ASFL2 <- cbind(ASFL2,highfinattd,lowfinattd,hfinattd,fin_att_group_1)
table(ASFL2$highfinattd)
wpct(ASFL2$highfinattd, weight=ASFL2$wght, na.rm=TRUE)#49% - according to OECD(2020)
####################FINANCIAL BEHAVIOUR SCORE#######################
###########Budgeting#################
summary(ASFL$QF1_a)
QF1_a <- ifelse(ASFL$QF1_a == "Yes", 1, 0)
summary(ASFL$QF1)
QF1_1_1<- ifelse(ASFL$QF1 == c("You make these decisions by yourself"), 1, 0)
QF1_1_2<- ifelse(ASFL$QF1 == c("You make these decisions with someone else"), 1, 0)
QF1_1 <- QF1_1_1+QF1_1_2
QF1 <- QF1_1 + QF1_a
table(QF1)
QF1fin <- ifelse(QF1 >= "1", 1, 0) #personally or jointly responsible QF1_a OR QF1

ASFL_full$QF2_1
QF2_1<- ifelse(ASFL$QF2_1 == "Yes", 1, 0)
QF2_2<- ifelse(ASFL$QF2_2 == "Yes", 1, 0)
QF2_3<- ifelse(ASFL$QF2_3 == "Yes", 1, 0)
QF2_4<- ifelse(ASFL$QF2_4 == "Yes", 1, 0)
QF2_5<- ifelse(ASFL$QF2_5 == "Yes", 1, 0)
QF2_6<- ifelse(ASFL$QF2_6 == "Yes", 1, 0)
table(ASFL$QF2_99)#Refused

QF2 <- QF2_1 + QF2_2 + QF2_3 + QF2_4 + QF2_5 + QF2_6
table(QF2)
QF2fin <- ifelse(QF2 >= "2", 1, 0)
table(QF2fin) #keeping track of money - at least 2 Yes

QF_Bud <- QF1fin+QF2fin
QF_Budfin<-  ifelse(QF_Bud == "2", 1, 0) #only if responsible and keeping track of money
#alternative: QF_Budfin <- QF1fin*QF2fin
table(QF_Budfin)
QF_Budfin

####QF3 - Active saving#############
table(ASFL$QF3)
QF3_1<- ifelse(ASFL$QF3_1 == "Yes", 1, 0)
QF3_2<- ifelse(ASFL$QF3_2 == "Yes", 1, 0)
QF3_3<- ifelse(ASFL$QF3_3 == "Yes", 1, 0)
#QF3_4<- ifelse(ASFL$QF3_4 == "Yes", 1, 0)
QF3_5<- ifelse(ASFL$QF3_5 == "Yes", 1, 0)
QF3_6<- ifelse(ASFL$QF3_6 == "Yes", 1, 0)
QF3_7<- ifelse(ASFL$QF3_7 == "Yes", 1, 0)
QF3_8<- ifelse(ASFL$QF3_8 == "Yes", 1, 0)
table(ASFL$QF3_97)
table(ASFL$QF3_99)#Refused
QF3_99<- ifelse(ASFL$QF3_99 == "Yes", 1, 0)
QF3_99
QF3<- QF3_1+QF3_2+QF3_3+QF3_5+QF3_6+QF3_7+QF3_8 #alternative with QF3_8 (new)
table(QF3)
QF3fin <- ifelse(QF3 >= "1", 1, 0)
#alternative: QF3fin <- ifelse(QF3 > "0", 1, 0)
table(QF3fin) #active saving - at least 1 yes
ASFL2 <- cbind(ASFL2,QF3fin)
weighted.mean(ASFL2$QF3fin,ASFL2$wght)
ASFL2adult <- ASFL2[!(ASFL2$QD7 %in% under18),] 
weighted.mean(ASFL2adult$QF3fin,ASFL2adult$wght)

####Avoiding borrowing to make ends meet###########
###did not borror OR did not face a shortfall
#######QF11#####################
##preliminary check for QF12
#not meeting costs in the past year 
summary(ASFL$QF11)
wpct(ASFL$QF11, weight=ASFL$wght, na.rm=TRUE)
0.13952561 #shortfall experience#according to yes
QF11a <-  ifelse(ASFL$QF11 == "No", 1, 0)
table(QF11a)
#take all refused/NA/dont know as 1 - only take those "did not borrow to make ends meet out
QF11b<-  ifelse(ASFL$QF11 == "Yes", 0, 1)
table(QF11b)

#######QF12#####################
#Access credit by using existing contacts or resources 
ASFL$QF12_3_1 #recode NAs
ASFL <- ASFL %>% mutate(QF12_3_1 = ifelse(is.na(QF12_3_1), 0, QF12_3_1))
ASFL$QF12_3_1
QF12_3_1 <- ifelse(ASFL$QF12_3_1 == c("4"), 1, 0) #yes response
table(QF12_3_1)
ASFL <- ASFL %>% mutate(QF12_3_2 = ifelse(is.na(QF12_3_2), 0, QF12_3_2))
ASFL$QF12_3_2
QF12_3_2 <- ifelse(ASFL$QF12_3_2 == c("4"), 1, 0)
ASFL <- ASFL %>% mutate(QF12_3_3 = ifelse(is.na(QF12_3_3), 0, QF12_3_3))
ASFL$QF12_3_3
QF12_3_3 <- ifelse(ASFL$QF12_3_3 == c("4"), 1, 0)
ASFL <- ASFL %>% mutate(QF12_3_4 = ifelse(is.na(QF12_3_4), 0, QF12_3_4))
ASFL$QF12_3_4
QF12_3_4 <-ifelse(ASFL$QF12_3_4 == c("4"), 1, 0)
ASFL <- ASFL %>% mutate(QF12_3_5 = ifelse(is.na(QF12_3_5), 0, QF12_3_5))
ASFL$QF12_3_5
QF12_3_5 <- ifelse(ASFL$QF12_3_5 == c("4"), 1, 0)
ASFL <- ASFL %>% mutate(QF12_3_6 = ifelse(is.na(QF12_3_6), 0, QF12_3_6))
ASFL$QF12_3_6
QF12_3_6 <- ifelse(ASFL$QF12_3_6 == c("4"), 1, 0)


QF12_3 <- QF12_3_1+QF12_3_2+QF12_3_3+QF12_3_4+QF12_3_6
table(QF12_3)
QF12_3fin<- ifelse(QF12_3 == "0", 1, 0) #not borrow 
QF12_3fin
table(QF12_3fin)

ASFL <- ASFL %>% mutate(QF12_4_1 = ifelse(is.na(QF12_4_1), 0, QF12_4_1))
ASFL$QF12_4_1
QF12_4_1 <- ifelse(ASFL$QF12_4_1 == "4", 1, 0)
ASFL <- ASFL %>% mutate(QF12_4_2 = ifelse(is.na(QF12_4_2), 0, QF12_4_2))
ASFL$QF12_4_2
QF12_4_2 <- ifelse(ASFL$QF12_4_2 == "4", 1, 0)

QF12_4 <- QF12_4_1+QF12_4_2
QF12_4fin<- ifelse(QF12_4 == "0", 1, 0)
table(QF12_4fin)

ASFL <- ASFL %>% mutate(QF12_5_1 = ifelse(is.na(QF12_5_1), 0, QF12_5_1))
ASFL$QF12_5_1
QF12_5_1 <-ASFL$QF12_5_1<- ifelse(ASFL$QF12_5_1 == "4", 1, 0)
ASFL <- ASFL %>% mutate(QF12_5_6 = ifelse(is.na(QF12_5_6), 0, QF12_5_6))
ASFL$QF12_5_6
QF12_5_6 <-ifelse(ASFL$QF12_5_6 == "4", 1, 0)

QF12_5 <- QF12_5_1+QF12_5_6
QF12_5fin<- ifelse(QF12_5 == "0", 1, 0)
table(QF12_5fin)

ASFL <- ASFL %>% mutate(QF12_6_1 = ifelse(is.na(QF12_6_1), 0, QF12_6_1))
ASFL$QF12_6_1
QF12_6_1 <-ASFL$QF12_6_1<- ifelse(ASFL$QF12_6_1 == "4", 1, 0)
ASFL <- ASFL %>% mutate(QF12_6_2 = ifelse(is.na(QF12_6_2), 0, QF12_6_2))
ASFL$QF12_6_2
QF12_6_2<- ifelse(ASFL$QF12_6_2 == "4", 1, 0)

QF12_6 <- QF12_6_1+QF12_6_2
QF12_6fin<- ifelse(QF12_6 == "0", 1, 0) #no at all any option
table(QF12_6fin)

table(ASFL$QF12_7_1)
ASFL <- ASFL %>% mutate(QF12_7_1o = ifelse(is.na(QF12_7_1o), 0, QF12_7_1o))
table(ASFL$QF12_7_1o)
QF12_7_1_1<- ifelse(ASFL$QF12_7_1o == "Geld von meiner Mutter", 1, 0)
QF12_7_1_2<- ifelse(ASFL$QF12_7_1o == "Momentan helfen mir meine Eltern und Geschwister, da ich gerade arbeitslos bin. Bin auch sehr froh darÃ¼ber, so kann ich auch ein bisschen sparen", 1, 0)
QF12_7_1_3<- ifelse(ASFL$QF12_7_1o == "Verwandte um UnterstÃ¼tzung bitten", 1, 0)
QF12_7 <- QF12_7_1_1+QF12_7_1_2+QF12_7_1_3
QF12_7fin<- ifelse(QF12_7 == "0", 1, 0)
table(QF12_7fin)

##final QF12 ->not consider QF12_1, QF12_2 as not borrowing
#table(QF12_1fin)
QF12 <- QF12_3fin+QF12_4fin+QF12_5fin+QF12_6fin
QF12
QF12fin <- ifelse(QF12 == "4", 1, 0)  #filter out all without
QF12fin
table(QF12fin)
ASFL2 <- cbind(ASFL2,QF12fin)

QF12_a <- QF12_3fin+QF12_4fin+QF12_5fin+QF12_6fin+QF12_7fin
QF12_afin <- ifelse(QF12_a == "5", 1, 0)  #filter out all without
QF12_afin
table(QF12_afin)
#additionally considering QF11
table(QF11a) #noshortfall
QFMEM1 <- QF11a+QF12fin #with QF11 as filtering
QFMEM1fin <- ifelse(QFMEM1 >= "1", 1, 0) #did not face a shortfall or did not borrow
table(QFMEM1fin) #same as Q12fin
table(QF11b) #notyestoshortfall
QFMEM2 <- QF11b+QF12fin 
QFMEM2fin <- ifelse(QFMEM2 >= "1", 1, 0)
table(QFMEM2fin) #same as QFMEM1fin #same as Q12fin



#try to shop around (score 0,1 or 2)
#1 for Qprod2 (I considered several or I looked around but there were no others)
table(ASFL$Qprod2)
table(ASFL_org$Qprod2)
ASFL <- ASFL %>% mutate(Qprod2 = ifelse(is.na(Qprod2), 0, Qprod2))
ASFL$Qprod2
Qprod2_1<- ifelse(ASFL$Qprod2 == c("4"), 1, 0)
Qprod2_2<- ifelse(ASFL$Qprod2 == c("7"), 1, 0)
Qprod2fin <- Qprod2_1+Qprod2_2
table(Qprod2fin) #always 1 

#2 for Best-buy guidance / Recommendation from independent financial advise
ASFL <- ASFL %>% mutate(Qprod3_INT_1 = ifelse(is.na(Qprod3_INT_1), 0, Qprod3_INT_1))
ASFL$Qprod3_INT_1
ASFL_org$Qprod3_INT_1
Qprod3_INT_1<- ifelse(ASFL$Qprod3_INT_1 == "5", 1, 0)
Qprod3_INT_1
ASFL <- ASFL %>% mutate(Qprod3_INT_2 = ifelse(is.na(Qprod3_INT_2), 0, Qprod3_INT_2))
ASFL$Qprod3_INT_2
ASFL_org$Qprod3_INT_2
Qprod3_INT_2<- ifelse(ASFL$Qprod3_INT_2 == "5", 1, 0)
Qprod3_INT_2

Qprod_D2 <- Qprod3_INT_1+Qprod3_INT_2
table(Qprod_D2)
Qprod_D2fin<- ifelse(Qprod_D2 >= "1", 2, 0) #2 if yet at any (Best-buy guidance / Recommendation from independent financial adviser
table(Qprod_D2fin) 

#1 for information from an advert or brochure, recommendation from friends etc., information from bank staff, or other information
ASFL$Qprod3_INT_3
ASFL <- ASFL %>% mutate(Qprod3_INT_3 = ifelse(is.na(Qprod3_INT_3), 0, Qprod3_INT_3))
Qprod3_INT_3<- ifelse(ASFL$Qprod3_INT_3 == "5", 1, 0)
ASFL <- ASFL %>% mutate(Qprod3_INT_4 = ifelse(is.na(Qprod3_INT_4), 0, Qprod3_INT_4))
Qprod3_INT_4<- ifelse(ASFL$Qprod3_INT_4 == "5", 1, 0)
ASFL <- ASFL %>% mutate(Qprod3_INT_5 = ifelse(is.na(Qprod3_INT_5), 0, Qprod3_INT_5))
Qprod3_INT_5<- ifelse(ASFL$Qprod3_INT_5 == "5", 1, 0)
ASFL <- ASFL %>% mutate(Qprod3_INT_6 = ifelse(is.na(Qprod3_INT_6), 0, Qprod3_INT_6))
Qprod3_INT_6<- ifelse(ASFL$Qprod3_INT_6 == "5", 1, 0)


Qprod_D2_1 <- Qprod3_INT_3+Qprod3_INT_4+Qprod3_INT_5+Qprod3_INT_6
table(Qprod_D2_1)
Qprod_D2_1fin<- ifelse(Qprod_D2_1 >= "1", 1, 0)
table(Qprod_D2_1fin)

Qprod_D1<- Qprod_D2_1fin + Qprod2fin
table(Qprod_D1)
Qprod_D1fin<- ifelse(Qprod_D1 >= "1", 1, 0)
Qprod_D1fin

Qprod <- Qprod_D1fin+ Qprod_D2fin
table(Qprod)
Qprod[Qprod == "2"] <- "1" #Qprod=2 in 35 cases # can only arise if  Qprod_D2_1fin AND Qprod2fin are 0 cause otherwise 3
Qprod[Qprod == "3"] <- "2"
Qprodfin <- as.numeric(Qprod)
table(Qprodfin)
#2 indicates "Shopped around and used independent info or advice
#1 indicates "Some attempt to make informed decision" 
#0 indicates "'Not shopped around and no attempt make informed decisions (including no recent product choice)"
ASFL2 <- cbind(ASFL2,Qprodfin)

#alternative:
Qprod_a <- Qprod_D1fin+ Qprod_D2fin
table(Qprod_a)
#Qprod=2 in 35 cases # can only arise if  Qprod_D2_1fin AND Qprod2fin are 0 cause otherwise 3
Qprod_a[Qprod_a == "3"] <- "2"
Qprod_a
Qprod_afin <- as.numeric(Qprod_a)
Qprod_afin
table(Qprod_afin)

#watch on financial affairs
QS1_5 <-ASFL$QS1_5
QS1_5_1 <- ifelse(QS1_5== "Completely agree", 1, 0)
QS1_5_2 <- ifelse(QS1_5 == "2", 1, 0)
QS1_5 <- QS1_5_1+QS1_5_2
QS1_5
wpct(ASFL$QS1_5, weight=ASFL$wght, na.rm=TRUE)
0.452681202+0.379732221       #83.2% - according to OECD (2020)    

#strieving to achieve long-term goals
QS1_8 <-ASFL$QS1_8
QS1_8
QS1_8_1 <- ifelse(QS1_8 == "Completely agree", 1, 0)
QS1_8_2 <- ifelse(QS1_8 == "2", 1, 0)
QS1_8 <- QS1_8_1+QS1_8_2
QS1_8
wpct(ASFL$QS1_8, weight=ASFL$wght, na.rm=TRUE)
0.157922728 +0.373263409  #53.1% - according to OECD (2020)      

#Considered purchases
QS2_3 <-ASFL$QS2_3
QS2_3
QS2_3_1 <- ifelse(QS2_3 == "Always", 1, 0)
QS2_3_2 <- ifelse(QS2_3 == "2", 1, 0)
QS2_3 <- QS2_3_1+QS2_3_2
QS2_3
wpct(ASFL$QS2_3, weight=ASFL$wght, na.rm=TRUE)
0.346975153+0.317067745 #66.4% - according to OECD (2020)  

#Paying bills on time
QS2_5 <-ASFL$QS2_5
QS2_5
QS2_5_1 <- ifelse(QS2_5 == "Always", 1, 0)
QS2_5_2 <- ifelse(QS2_5 == "2", 1, 0)
QS2_5 <- QS2_5_1+QS2_5_2
QS2_5
wpct(ASFL$QS2_5, weight=ASFL$wght, na.rm=TRUE)
0.595069198+0.250236243 #84.5% - according to OECD (2020) 

fin_beh <- QF_Budfin+QF12fin+QF3fin+Qprodfin+QS1_5+QS1_8+QS2_3+QS2_5 
ASFL3 <- cbind(ASFL2,fin_beh)
weighted.mean(ASFL3$fin_beh, ASFL3$wght)#OECD - average: 6.0
wpct(ASFL3$fin_beh, weight=ASFL3$wght, na.rm=TRUE)
#QF12fin equal to QFMEM
fin_beh2 <- QF_Budfin+QF12_afin+QF3fin+Qprodfin+QS1_5+QS1_8+QS2_3+QS2_5 
weighted.mean(fin_beh2, ASFL$wght)
fin_beh3 <-QF_Budfin+QF11a+QF3fin+Qprodfin+QS1_5+QS1_8+QS2_3+QS2_5
weighted.mean(fin_beh3, ASFL$wght)
fin_beh4 <-QF_Budfin+QF11b+QF3fin+Qprodfin+QS1_5+QS1_8+QS2_3+QS2_5
weighted.mean(fin_beh4, ASFL$wght)
fin_beh5 <- QF_Budfin+QF12fin+QF3fin+Qprod_afin+QS1_5+QS1_8+QS2_3+QS2_5 #QF12fin alone equal to combination of QF11/QF12
weighted.mean(fin_beh5, ASFL$wght)
#QF12fin equal to QFMEM
fin_beh6 <- QF_Budfin+QF12_afin+QF3fin+Qprod_afin+QS1_5+QS1_8+QS2_3+QS2_5 
weighted.mean(fin_beh6, ASFL$wght)
fin_beh7 <-QF_Budfin+QF11a+QF3fin+Qprod_afin+QS1_5+QS1_8+QS2_3+QS2_5
weighted.mean(fin_beh3, ASFL$wght)
fin_beh8 <-QF_Budfin+QF11b+QF3fin+Qprod_afin+QS1_5+QS1_8+QS2_3+QS2_5
weighted.mean(fin_beh4, ASFL$wght)

#dummy variables #6 is the officially reported benchmark
ASFL3 <- ASFL3 %>% mutate(fin_beh_group = case_when(fin_beh >=6  & fin_beh <= 9 ~ "High fb",
                                                    fin_beh >=4   & fin_beh <6  ~ "Average fb",
                                                    fin_beh >= 0  & fin_beh <4  ~ "Low fb"))
fin_beh_group_1 <- factor(ASFL3$fin_beh_group, levels=c("High fb","Average fb", "Low fb"))
levels(fin_beh_group_1)

highfinbehd <- ifelse(ASFL3$fin_beh_group == "High fb", 1, 0)
averagefinbehd <- ifelse(ASFL3$fin_beh_group == "Average fb", 1, 0)
lowfinbehd <- ifelse(ASFL3$fin_beh_group == "Low fb", 1, 0)
ASFL3 <- cbind(ASFL3,highfinbehd,averagefinbehd,lowfinbehd,fin_beh_group_1)
table(ASFL3$fin_beh)

##at least 6 (out of 9)
wpct(ASFL3$highfinbehd, weight=ASFL$wght, na.rm=TRUE) #64.4% - OECD: 64.5%

#################MAIN FINANCIAL LITERACY INDICATORS COMPARISONS##################################
############financial scores according to financial cushion######
ASFLlfinbuff <- ASFL3[(ASFL3$QF13 %in% lfinbuff),] 
summary(ASFLlfinbuff)
ASFLhfinbuff <- ASFL3[(ASFL3$QF13 %in% hfinbuff),] 
summary(ASFLhfinbuff)
weighted.mean(ASFLlfinbuff$fin_know,ASFLlfinbuff$wght) #OECD:5.0
weighted.mean(ASFLhfinbuff$fin_know,ASFLhfinbuff$wght) #OECD:5.8

weighted.mean(ASFLlfinbuff$fin_know_add,ASFLlfinbuff$wght) 
weighted.mean(ASFLhfinbuff$fin_know_add,ASFLhfinbuff$wght) 

weighted.mean(ASFLlfinbuff$fin_att,ASFLlfinbuff$wght) #OECD:2.9
weighted.mean(ASFLhfinbuff$fin_att,ASFLhfinbuff$wght) #OECD:3.2

weighted.mean(ASFLlfinbuff$fin_beh,ASFLlfinbuff$wght) #OECD:5.4
weighted.mean(ASFLhfinbuff$fin_beh,ASFLhfinbuff$wght) #OECD:6.4


ASFL3m <- ASFL3[(ASFL3$QD1 %in% male),]
ASFL3f <- ASFL3[(ASFL3$QD1 %in% female),]
ASFL3se <- ASFL3[(ASFL3$QD10 %in% se),]
ASFL3entrepreneurs <- ASFL3[(ASFL3$QF9_11 %in% entrepreneurs),] 
ASFL3sem <- ASFL3se[(ASFL3se$QD1 %in% male),]
ASFL3sef <- ASFL3se[(ASFL3se$QD1 %in% female),]
ASFL3seoldmill <- ASFL3se[(ASFL3se$age_group %in% oldmill),]
ASFL3segenx <- ASFL3se[(ASFL3se$age_group %in% genx),]
ASFL3sebabyboom <- ASFL3se[(ASFL3se$age_group %in% babyboom),]
ASFL3seprimary<- subset(ASFL3se, ASFL3se$primaryd == "1")
ASFL3selsecondary<- subset(ASFL3se, ASFL3se$lowersecondaryd == "1")
ASFL3seusecondary<- subset(ASFL3se, ASFL3se$uppersecondaryd == "1")
ASFL3seuniversity<- subset(ASFL3se, ASFL3se$universityd == "1")
ASFL3seAkademie<- subset(ASFL3se, ASFL3se$Akademied == "1")
ASFL3sehigheduc<- subset(ASFL3se, ASFL3se$higheduc == "1")
ASFL3seloweduc<- subset(ASFL3se, ASFL3se$loweduc == "1")



ASFL3e <- ASFL3[(ASFL3$QD10 %in% e),]
ASFL3em <- ASFL3e[(ASFL3e$QD1 %in% male),]
ASFL3ef <- ASFL3e[(ASFL3e$QD1 %in% female),]
ASFL3eyoungmill <- ASFL3e[(ASFL3e$age_group %in% youngmill),]
ASFL3eoldmill <- ASFL3e[(ASFL3e$age_group %in% oldmill),]
ASFL3egenx <- ASFL3e[(ASFL3e$age_group %in% genx),]
ASFL3ebabyboom <- ASFL3e[(ASFL3e$age_group %in% babyboom),]
ASFL3esilent <- ASFL3e[(ASFL3e$age_group %in% silgen),]
ASFL3eprimary<- subset(ASFL3e, ASFL3e$primaryd == "1")
ASFL3elsecondary<- subset(ASFL3e, ASFL3e$lowersecondaryd == "1")
ASFL3eusecondary<- subset(ASFL3e, ASFL3e$uppersecondaryd == "1")
ASFL3euniversity<- subset(ASFL3e, ASFL3e$universityd == "1")
ASFL3eAkademie<- subset(ASFL3e, ASFL3e$Akademied == "1")
ASFL3ehigheduc<- subset(ASFL3e, ASFL3e$higheduc == "1")
ASFL3eloweduc<- subset(ASFL3e, ASFL3e$loweduc == "1")


ASFL3unempl <- ASFL3[(ASFL3$QD10 %in% unempl),]
ASFL3oth <- ASFL3[(ASFL3$QD10 %in% oth),]
ASFL3othworet <- ASFL3[(ASFL3$QD10 %in% othworet),]
ASFL3ret <- ASFL3[(ASFL3$QD10 %in% ret),]
ASFL3entrepreneurs <- ASFL3[(ASFL3$QF9_11 %in% entrepreneurs),]

ASFL3adult <- ASFL3[!(ASFL3$QD7 %in% under18),] 
ASFL3main <- ASFL3adult[!(ASFL3adult$QD7 %in% above79),] 
#################FINANCIAL KNOWLEDGE############################
weighted.mean(ASFL3se$fin_know, ASFL3se$wght)
wpct(ASFL3se$fin_know, weight=ASFL3se$wght, na.rm=TRUE)
weighted.mean(ASFL3se$fin_know_add, ASFL3se$wght)
wpct(ASFL3se$fin_know_add, weight=ASFL3se$wght, na.rm=TRUE)

#alternative for entrepreneuers
weighted.mean(ASFL3entrepreneurs$fin_know, ASFL3entrepreneurs$wght)
wpct(ASFL3entrepreneurs$fin_know, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)
weighted.mean(ASFL3entrepreneurs$fin_know_add, ASFL3entrepreneurs$wght)
wpct(ASFL3entrepreneurs$fin_know_add, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)

weighted.mean(ASFL3sem$fin_know, ASFL3sem$wght)
wpct(ASFL3sem$fin_know, weight=ASFL3sem$wght, na.rm=TRUE)
weighted.mean(ASFL3sem$fin_know_add, ASFL3sem$wght)
wpct(ASFL3sem$fin_know_add, weight=ASFL3sem$wght, na.rm=TRUE)
weighted.mean(ASFL3sef$fin_know, ASFL3sef$wght)
wpct(ASFL3sef$fin_know, weight=ASFL3sef$wght, na.rm=TRUE)
weighted.mean(ASFL3sef$fin_know_add, ASFL3sef$wght)
wpct(ASFL3sef$fin_know_add, weight=ASFL3sef$wght, na.rm=TRUE)

weighted.mean(ASFL3seoldmill$fin_know, ASFL3seoldmill$wght)
weighted.mean(ASFL3segenx$fin_know, ASFL3segenx$wght)
weighted.mean(ASFL3sebabyboom$fin_know, ASFL3sebabyboom$wght)

weighted.mean(ASFL3seprimary$fin_know, ASFL3seprimary$wght)
weighted.mean(ASFL3selsecondary$fin_know, ASFL3selsecondary$wght)
weighted.mean(ASFL3seusecondary$fin_know, ASFL3seusecondary$wght)
weighted.mean(ASFL3seuniversity$fin_know, ASFL3seuniversity$wght)
weighted.mean(ASFL3seAkademie$fin_know, ASFL3seAkademie$wght)

weighted.mean(ASFL3sehigheduc$fin_know, ASFL3sehigheduc$wght)
weighted.mean(ASFL3seloweduc$fin_know, ASFL3seloweduc$wght)
weighted.mean(ASFL3e$fin_know, ASFL3e$wght)
wpct(ASFL3e$fin_know, weight=ASFL3e$wght, na.rm=TRUE)
weighted.mean(ASFL3e$fin_know_add, ASFL3e$wght)
wpct(ASFL3e$fin_know_add, weight=ASFL3e$wght, na.rm=TRUE)
weighted.mean(ASFL3em$fin_know, ASFL3em$wght)
wpct(ASFL3em$fin_know, weight=ASFL3em$wght, na.rm=TRUE)
weighted.mean(ASFL3em$fin_know_add, ASFL3em$wght)
wpct(ASFL3em$fin_know_add, weight=ASFL3em$wght, na.rm=TRUE)
weighted.mean(ASFL3ef$fin_know, ASFL3ef$wght)
wpct(ASFL3ef$fin_know, weight=ASFL3ef$wght, na.rm=TRUE)
weighted.mean(ASFL3ef$fin_know_add, ASFL3ef$wght)
wpct(ASFL3ef$fin_know_add, weight=ASFL3ef$wght, na.rm=TRUE)

weighted.mean(ASFL3eyoungmill$fin_know, ASFL3eyoungmill$wght)
weighted.mean(ASFL3eoldmill$fin_know, ASFL3eoldmill$wght)
weighted.mean(ASFL3egenx$fin_know, ASFL3egenx$wght)
weighted.mean(ASFL3ebabyboom$fin_know, ASFL3ebabyboom$wght)
weighted.mean(ASFL3esilent$fin_know, ASFL3esilent$wght)

weighted.mean(ASFL3eprimary$fin_know, ASFL3eprimary$wght)
weighted.mean(ASFL3elsecondary$fin_know, ASFL3elsecondary$wght)
weighted.mean(ASFL3eusecondary$fin_know, ASFL3eusecondary$wght)
weighted.mean(ASFL3euniversity$fin_know, ASFL3euniversity$wght)
weighted.mean(ASFL3eAkademie$fin_know, ASFL3eAkademie$wght)

weighted.mean(ASFL3ehigheduc$fin_know, ASFL3ehigheduc$wght)
weighted.mean(ASFL3eloweduc$fin_know, ASFL3eloweduc$wght)


weighted.mean(ASFL3unempl$fin_know, ASFL3unempl$wght)
wpct(ASFL3unempl$fin_know, weight=ASFL3unempl$wght, na.rm=TRUE)
weighted.mean(ASFL3unempl$fin_know_add, ASFL3unempl$wght)
wpct(ASFL3unempl$fin_know_add, weight=ASFL3unempl$wght, na.rm=TRUE)


weighted.mean(ASFL3oth$fin_know, ASFL3oth$wght)
wpct(ASFL3oth$fin_know, weight=ASFL3oth$wght, na.rm=TRUE)
weighted.mean(ASFL3oth$fin_know_add, ASFL3oth$wght)
wpct(ASFL3oth$fin_know_add, weight=ASFL3oth$wght, na.rm=TRUE)

weighted.mean(ASFL3othworet$fin_know, ASFL3othworet$wght)
weighted.mean(ASFL3othworet$fin_know_add, ASFL3othworet$wght)
weighted.mean(ASFL3ret$fin_know, ASFL3ret$wght)
weighted.mean(ASFL3ret$fin_know_add, ASFL3ret$wght)
weighted.mean(ASFL3entrepreneurs$fin_know, ASFL3entrepreneurs$wght)
weighted.mean(ASFL3entrepreneurs$fin_know_add, ASFL3entrepreneurs$wght)

#################FINANCIAL BEHAVIOUR############################
weighted.mean(ASFL3se$fin_beh, ASFL3se$wght)
wpct(ASFL3se$fin_beh, weight=ASFL3se$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3se$highfinbehd, weight=ASFL3se$wght, na.rm=TRUE)
0.25663641+ 0.32160377+ 0.19495995 +0.08650040

weighted.mean(ASFL3sem$fin_beh, ASFL3sem$wght)
wpct(ASFL3sem$fin_beh, weight=ASFL3sem$wght, na.rm=TRUE)
weighted.mean(ASFL3sef$fin_beh, ASFL3sef$wght)
wpct(ASFL3sef$fin_beh, weight=ASFL3sef$wght, na.rm=TRUE)

weighted.mean(ASFL3seoldmill$fin_beh, ASFL3seoldmill$wght)
weighted.mean(ASFL3segenx$fin_beh, ASFL3segenx$wght)
weighted.mean(ASFL3sebabyboom$fin_beh, ASFL3sebabyboom$wght)

weighted.mean(ASFL3seprimary$fin_beh, ASFL3seprimary$wght)
weighted.mean(ASFL3selsecondary$fin_beh, ASFL3selsecondary$wght)
weighted.mean(ASFL3seusecondary$fin_beh, ASFL3seusecondary$wght)
weighted.mean(ASFL3seuniversity$fin_beh, ASFL3seuniversity$wght)
weighted.mean(ASFL3seAkademie$fin_beh, ASFL3seAkademie$wght)

weighted.mean(ASFL3sehigheduc$fin_beh, ASFL3sehigheduc$wght)
weighted.mean(ASFL3seloweduc$fin_beh, ASFL3seloweduc$wght)

weighted.mean(ASFL3e$fin_beh, ASFL3e$wght)
wpct(ASFL3e$fin_beh, weight=ASFL3e$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3e$highfinbehd, weight=ASFL3e$wght, na.rm=TRUE)
0.207614159+ 0.256683235 +0.156425619+ 0.067654273

weighted.mean(ASFL3em$fin_beh, ASFL3em$wght)
weighted.mean(ASFL3ef$fin_beh, ASFL3ef$wght)

weighted.mean(ASFL3eyoungmill$fin_beh, ASFL3eyoungmill$wght)
weighted.mean(ASFL3eoldmill$fin_beh, ASFL3eoldmill$wght)
weighted.mean(ASFL3egenx$fin_beh, ASFL3egenx$wght)
weighted.mean(ASFL3ebabyboom$fin_beh, ASFL3ebabyboom$wght)
weighted.mean(ASFL3esilent$fin_beh, ASFL3esilent$wght)

weighted.mean(ASFL3eprimary$fin_beh, ASFL3eprimary$wght)
weighted.mean(ASFL3elsecondary$fin_beh, ASFL3elsecondary$wght)
weighted.mean(ASFL3eusecondary$fin_beh, ASFL3eusecondary$wght)
weighted.mean(ASFL3euniversity$fin_beh, ASFL3euniversity$wght)
weighted.mean(ASFL3eAkademie$fin_beh, ASFL3eAkademie$wght)

weighted.mean(ASFL3ehigheduc$fin_beh, ASFL3ehigheduc$wght)
weighted.mean(ASFL3eloweduc$fin_beh, ASFL3eloweduc$wght)

weighted.mean(ASFL3unempl$fin_beh, ASFL3unempl$wght)
wpct(ASFL3unempl$fin_beh, weight=ASFL3unempl$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3unempl$highfinbehd, weight=ASFL3unempl$wght, na.rm=TRUE)
0.08844081+ 0.05688295+0.09301589+ 0.01961089 

weighted.mean(ASFL3oth$fin_beh, ASFL3oth$wght)
wpct(ASFL3oth$fin_beh, weight=ASFL3oth$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3oth$highfinbehd, weight=ASFL3oth$wght, na.rm=TRUE)
0.315679231 +0.148020779+ 0.073619369 +0.020499409

weighted.mean(ASFL3othworet$fin_beh, ASFL3othworet$wght)
wpct(ASFL3othworet$fin_beh, weight=ASFL3othworet$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3othworet$highfinbehd, weight=ASFL3othworet$wght, na.rm=TRUE)
0.23166765+0.10562645+ 0.12766133 +0.03626127 
weighted.mean(ASFL3ret$fin_beh, ASFL3ret$wght)
wpct(ASFL3ret$fin_beh, weight=ASFL3ret$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3ret$highfinbehd, weight=ASFL3ret$wght, na.rm=TRUE)
0.353916248+ 0.167316125 +0.049022722 +0.013325559

weighted.mean(ASFL3entrepreneurs$fin_beh, ASFL3entrepreneurs$wght)
wpct(ASFL3entrepreneurs$fin_beh, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)
#at least 6 (out of 9)
wpct(ASFL3entrepreneurs$highfinbehd, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)
0.27275762+ 0.14895857 +0.07713576 

#################FINANCIAL ATTITUDE############################
weighted.mean(ASFL3se$fin_att, ASFL3se$wght)
wpct(ASFL3se$fin_att, weight=ASFL3se$wght, na.rm=TRUE)
#more than 3 (out of 5)
wpct(ASFL3se$hfinattd, weight=ASFL3se$wght, na.rm=TRUE)
0.147164521+0.249522741+ 0.112254614+0.022341435+0.063615729

weighted.mean(ASFL3sem$fin_att, ASFL3sem$wght)
wpct(ASFL3sem$fin_att, weight=ASFL3sem$wght, na.rm=TRUE)
weighted.mean(ASFL3sef$fin_att, ASFL3sef$wght)
wpct(ASFL3sef$fin_att, weight=ASFL3sef$wght, na.rm=TRUE)

weighted.mean(ASFL3seoldmill$fin_att, ASFL3seoldmill$wght)
weighted.mean(ASFL3segenx$fin_att, ASFL3segenx$wght)
weighted.mean(ASFL3sebabyboom$fin_att, ASFL3sebabyboom$wght)

weighted.mean(ASFL3seprimary$fin_att, ASFL3seprimary$wght)
weighted.mean(ASFL3selsecondary$fin_att, ASFL3selsecondary$wght)
weighted.mean(ASFL3seusecondary$fin_att, ASFL3seusecondary$wght)
weighted.mean(ASFL3seuniversity$fin_att, ASFL3seuniversity$wght)
weighted.mean(ASFL3seAkademie$fin_att, ASFL3seAkademie$wght)

weighted.mean(ASFL3sehigheduc$fin_att, ASFL3sehigheduc$wght)
weighted.mean(ASFL3seloweduc$fin_att, ASFL3seloweduc$wght)

weighted.mean(ASFL3e$fin_att, ASFL3e$wght)
wpct(ASFL3e$fin_att, weight=ASFL3e$wght, na.rm=TRUE)
#more than 3 (out of 5)
wpct(ASFL3e$hfinattd, weight=ASFL3e$wght, na.rm=TRUE)
0.166338157+0.156959210+0.130576429 +0.038484449+0.013488896+0.008336541

weighted.mean(ASFL3em$fin_att, ASFL3em$wght)
weighted.mean(ASFL3ef$fin_att, ASFL3ef$wght)

weighted.mean(ASFL3eyoungmill$fin_att, ASFL3eyoungmill$wght)
weighted.mean(ASFL3eoldmill$fin_att, ASFL3eoldmill$wght)
weighted.mean(ASFL3egenx$fin_att, ASFL3egenx$wght)
weighted.mean(ASFL3ebabyboom$fin_att, ASFL3ebabyboom$wght)
weighted.mean(ASFL3esilent$fin_att, ASFL3esilent$wght)

weighted.mean(ASFL3eprimary$fin_att, ASFL3eprimary$wght)
weighted.mean(ASFL3elsecondary$fin_att, ASFL3elsecondary$wght)
weighted.mean(ASFL3eusecondary$fin_att, ASFL3eusecondary$wght)
weighted.mean(ASFL3euniversity$fin_att, ASFL3euniversity$wght)
weighted.mean(ASFL3eAkademie$fin_att, ASFL3eAkademie$wght)

weighted.mean(ASFL3ehigheduc$fin_att, ASFL3ehigheduc$wght)
weighted.mean(ASFL3eloweduc$fin_att, ASFL3eloweduc$wght)

weighted.mean(ASFL3unempl$fin_att, ASFL3unempl$wght)
wpct(ASFL3unempl$fin_att, weight=ASFL3unempl$wght, na.rm=TRUE)
#more than 3 (out of 5)
wpct(ASFL3unempl$hfinattd, weight=ASFL3unempl$wght, na.rm=TRUE)


weighted.mean(ASFL3oth$fin_att, ASFL3oth$wght)
wpct(ASFL3oth$fin_att, weight=ASFL3oth$wght, na.rm=TRUE)
#more than 3 (out of 5)
wpct(ASFL3oth$highfinattd, weight=ASFL3oth$wght, na.rm=TRUE)
0.12486003+0.13201014+0.11105601+ 0.04013580+0.02619993+0.01077725

weighted.mean(ASFL3othworet$fin_att, ASFL3othworet$wght)
#more than 3 (out of 5)
wpct(ASFL3othworet$highfinattd, weight=ASFL3othworet$wght, na.rm=TRUE)

weighted.mean(ASFL3ret$fin_att, ASFL3ret$wght)
#more than 3 (out of 5)
wpct(ASFL3ret$highfinattd, weight=ASFL3ret$wght, na.rm=TRUE)

weighted.mean(ASFL3entrepreneurs$fin_att, ASFL3entrepreneurs$wght)
#more than 3 (out of 5)
wpct(ASFL3entrepreneurs$highfinattd, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)
#############################################################################################
#########################ADDITIONAL FINANCIAL LITERACY INDICATORS##########################################

################FINANCIAL RESILIENCE#######################################
####################- Availability of savings, experience of stress, prudence in planning and budgeting
#financial buffer - covering at least three months in case of a job loss (proxy for wealth)
#full
summary(ASFL$QF13)
table(ASFL3$highfinbuffd)
#ALTERNATIVE I: financial safety buffer #take all Refused/Not relevant, no own income/Dont know as "Yes" -> "No" incdicating higher risk 
#LR1 - Do you have a financial safety buffer?-> managing expenditure shock without having to borrow from family/friends
##"NO" means no financial buffer
summary(ASFL$LR1)
savebuffd <- ifelse(ASFL$LR1 == "Yes",1, 0)
table(savebuffd)
nosavebuffd <- ifelse(ASFL$LR1 == "No",1, 0)
table(nosavebuffd)
ASFL3 <- cbind(ASFL3,nosavebuffd,savebuffd)

#ALTERNATIVE II
#QF4 - And if you, personally, faced a major expense today - equivalent to your own monthly income - would you be able to pay it without borrowing the money or asking family or friends to help?
##"NO" means no financial buffer
summary(ASFL$QF4)
expensecovd <- ifelse(ASFL$QF4 == "Yes",1, 0)
table(expensecovd)
noexpensecovd <- ifelse(ASFL$QF4 == "No",1, 0)
table(noexpensecovd)
ASFL3 <- cbind(ASFL3,noexpensecovd,expensecovd)


ASFL3se <- ASFL3[(ASFL3$QD10 %in% se),] 
summary(ASFL3se)
ASFL3e <- ASFL3[(ASFL3$QD10 %in% e),] 
summary(ASFL3e)
ASFL3eu <-  ASFL3[(ASFL3$QD10 %in% eu),] 
summary(ASFL3eu)
ASFL3unempl <-  ASFL3[(ASFL3$QD10 %in% unempl),] 
summary(ASFL3unempl)
ASFL3oth <-  ASFL3[(ASFL3$QD10 %in% oth),] 
summary(ASFL3oth)
ASFL3empl <- ASFL3[(ASFL3$QD10 %in% empl),] 
summary(ASFL3empl)
ASFL3othworet <-  ASFL3[(ASFL3$QD10 %in% othworet),] 
summary(ASFL3othworet)
ASFL3othworet <-  ASFL3[(ASFL3$QD10 %in% othworet),] 
summary(ASFL3othworet)
ASFL3stud <-  ASFL3[(ASFL3$QD10 %in% stud),] 
summary(ASFL3stud)
ASFL3ret <-  ASFL3[(ASFL3$QD10 %in% ret),] 
summary(ASFL3ret)
ASFL3entrepreneurs <-  ASFL3[(ASFL3$QF9_11 %in% entrepreneurs),] 
summary(ASFL3entrepreneurs)

#self-employed
table(ASFLse$QF13)
wpct(ASFLse$QF13, weight=ASFLse$wght, na.rm=TRUE)
table(ASFLse$highfinbuffd)
wpct(ASFL3se$highfinbuffd, weight=ASFL3se$wght, na.rm=TRUE)

table(ASFL3se$savebuffd)
wpct(ASFL3se$savebuffd, weight=ASFL3se$wght, na.rm=TRUE)
table(ASFL3se$expensecovd)
wpct(ASFL3se$expensecovd, weight=ASFL3se$wght, na.rm=TRUE)
#employed
table(ASFL3e$QF13)
wpct(ASFLe$QF13, weight=ASFLe$wght, na.rm=TRUE)
table(ASFL3e$highfinbuffd)
wpct(ASFL3e$highfinbuffd, weight=ASFL3e$wght, na.rm=TRUE)

table(ASFL3e$savebuffd)
wpct(ASFL3e$savebuffd, weight=ASFL3e$wght, na.rm=TRUE)
table(ASFL3e$expensecovd)
wpct(ASFL3e$expensecovd, weight=ASFL3e$wght, na.rm=TRUE)
#employed + unemployed
table(ASFLeu$highfinbuffd)
wpct(ASFLeu$QF13, weight=ASFLeu$wght, na.rm=TRUE)

#retired
table(ASFL3ret$QF13)
wpct(ASFL3ret$QF13, weight=ASFL3ret$wght, na.rm=TRUE)
table(ASFL3ret$highfinbuffd)
wpct(ASFL3ret$highfinbuffd, weight=ASFL3ret$wght, na.rm=TRUE)

table(ASFL3ret$savebuffd)
wpct(ASFL3ret$savebuffd, weight=ASFL3ret$wght, na.rm=TRUE)
table(ASFL3ret$expensecovd)
wpct(ASFL3ret$expensecovd, weight=ASFL3ret$wght, na.rm=TRUE)

#othworet
table(ASFL3othworet$QF13)
wpct(ASFL3othworet$QF13, weight=ASFL3othworet$wght, na.rm=TRUE)
table(ASFL3othworet$highfinbuffd)
wpct(ASFL3othworet$highfinbuffd, weight=ASFL3othworet$wght, na.rm=TRUE)

table(ASFL3othworet$savebuffd)
wpct(ASFL3othworet$savebuffd, weight=ASFL3othworet$wght, na.rm=TRUE)
table(ASFL3othworet$expensecovd)
wpct(ASFL3othworet$expensecovd, weight=ASFL3othworet$wght, na.rm=TRUE)
#unemployed
table(ASFL3unempl$QF13)
wpct(ASFL3unempl$QF13, weight=ASFL3unempl$wght, na.rm=TRUE)
table(ASFL3unempl$highfinbuffd)
wpct(ASFL3unempl$highfinbuffd, weight=ASFL3unempl$wght, na.rm=TRUE)

table(ASFL3unempl$savebuffd)
wpct(ASFL3unempl$savebuffd, weight=ASFL3unempl$wght, na.rm=TRUE)
table(ASFL3unempl$expensecovd)
wpct(ASFL3unempl$expensecovd, weight=ASFL3unempl$wght, na.rm=TRUE)

#entrepreneurs
table(ASFL3entrepreneurs$QF13)
wpct(ASFL3entrepreneurs$QF13, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)
table(ASFL3entrepreneurs$highfinbuffd)
wpct(ASFL3entrepreneurs$highfinbuffd, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)

table(ASFL3entrepreneurs$savebuffd)
wpct(ASFL3entrepreneurs$savebuffd, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)
table(ASFL3entrepreneurs$expensecovd)
wpct(ASFL3entrepreneurs$expensecovd, weight=ASFL3entrepreneurs$wght, na.rm=TRUE)

#############falling victim to fraud ################################
#Qprod4_
table(ASFL$Qprod4_1.x)
fraud_1 <- ifelse(ASFL$Qprod4_1.x == "1", 1, 0)
fraud_2 <- ifelse(ASFL$Qprod4_2.x == "1", 1, 0)
fraud_3 <- ifelse(ASFL$Qprod4_3.x == "1", 1, 0)
fraud_4 <- ifelse(ASFL$Qprod4_4.x == "1", 1, 0)
fraud_5 <- ifelse(ASFL$Qprod4_5.x == "1", 1, 0)
fraud_6 <- ifelse(ASFL$Qprod4_6.x == "1", 1, 0)
fraud_7 <- ifelse(ASFL$Qprod4_7.x == "1", 1, 0)
fraud_8 <- ifelse(ASFL$Qprod4_8.x == "1", 1, 0)
fraud_9 <- ifelse(ASFL$Qprod4_9.x == "1", 1, 0)
#austria-specific!
fraud_10 <- ifelse(ASFL$Qprod4_10 == "1", 1, 0)
fraud_11 <- ifelse(ASFL$Qprod4_11 == "1", 1, 0)
fraud_12 <- ifelse(ASFL$Qprod4_12 == "1", 1, 0)

finfraud <- fraud_1+fraud_2+fraud_3+fraud_4+fraud_5+fraud_6+fraud_7+fraud_8+fraud_9+fraud_10+fraud_11+fraud_12
table(finfraud)
ASFL3 <- cbind(ASFL3,finfraud,fraud_1,fraud_2,fraud_3,fraud_4,fraud_5,fraud_6,fraud_7,fraud_8,fraud_9,fraud_10,fraud_11,fraud_12)
finfraudd <- ifelse(ASFL3$finfraud > "0", 1, 0)
ASFL3 <- cbind(ASFL3, finfraudd)

#sample analysis
ASFL3se <- ASFL3[(ASFL3$QD10 %in% se),]
ASFL3e <- ASFL3[(ASFL3$QD10 %in% e),]
ASFL3eu <- ASFL3[(ASFL3$QD10 %in% eu),]
ASFL3oth <- ASFL3[(ASFL3$QD10 %in% oth),]

table(ASFL3se$finfraudd)
table(ASFL3se$finfraud)
table(ASFL3e$finfraudd)
table(ASFL3e$finfraud)
table(ASFL3oth$finfraudd)
table(ASFL3oth$finfraud)

table(ASFL3$fraud_1)
45/1418#not weighted by OECD!
table(ASFL3se$fraud_1)
table(ASFL3e$fraud_1)
table(ASFL3oth$fraud_1)

table(ASFL3$fraud_2)
15/1418
table(ASFL3se$fraud_2)
table(ASFL3e$fraud_2)
table(ASFL3oth$fraud_2)

table(ASFL3$fraud_3)
14/1418
table(ASFL3se$fraud_3)
table(ASFL3e$fraud_3)
table(ASFL3oth$fraud_3)

table(ASFL3$fraud_4)
68/1418
table(ASFL3se$fraud_4)
table(ASFL3e$fraud_4)
table(ASFL3oth$fraud_4)

table(ASFL3$fraud_5)
30/1418
table(ASFL3se$fraud_5)
table(ASFL3e$fraud_5)
table(ASFL3oth$fraud_5)

table(ASFL3$fraud_6)
13/1418
table(ASFL3se$fraud_6)
table(ASFL3e$fraud_6)
table(ASFL3oth$fraud_6)

table(ASFL3$fraud_7)
87/1418
table(ASFL3se$fraud_7)
table(ASFL3e$fraud_7)
table(ASFL3oth$fraud_7)

table(ASFL3$fraud_8)
29/1418
table(ASFL3se$fraud_8)
table(ASFL3e$fraud_8)
table(ASFL3oth$fraud_8)

table(ASFL3$fraud_9)
11/1418
table(ASFL3se$fraud_9)
table(ASFL3e$fraud_9)
table(ASFL3oth$fraud_9)

table(ASFL3$fraud_10)
table(ASFL3se$fraud_10)
table(ASFL3e$fraud_10)
table(ASFL3oth$fraud_10)

table(ASFL3$fraud_11)
table(ASFL3se$fraud_11)
table(ASFL3e$fraud_11)
table(ASFL3oth$fraud_11)

table(ASFL3$fraud_12)
table(ASFL3se$fraud_12)
table(ASFL3e$fraud_12)
table(ASFL3oth$fraud_12)


#############FINANCIAL STRESS AND CONCERNS##################
#QF11;QS2_1;QS3_9;QS3_10

shortfall <-ifelse(ASFL$QF11 == "Yes", 1, 0)

QS2_1_1 <- ifelse(ASFL$QS2_1 == "Always", 1, 0)
QS2_1_2 <- ifelse(ASFL$QS2_1 == "2", 1, 0)
finstress1 <- QS2_1_1+QS2_1_2
table(finstress1)
#I tend to worry about paying my normal living expense
wpct(finstress1, weight=ASFL$wght, na.rm=TRUE)

summary(ASFL$QS3_9)
QS3_9_1 <- ifelse(ASFL$QS3_9 == "Completely", 1, 0)
QS3_9_2 <- ifelse(ASFL$QS3_9 == "2", 1, 0)
finstress2 <- QS3_9_1+QS3_9_2
finwellbeing3 <-QS3_9_1+QS3_9_2
table(finstress2)
#I am concerned that my money won't last
wpct(finstress2, weight=ASFL$wght, na.rm=TRUE)

summary(ASFL$QS3_10)
QS3_10_1 <- ifelse(ASFL$QS3_10 == "Completely", 1, 0)
QS3_10_2 <- ifelse(ASFL$QS3_10 == "2", 1, 0)
finstress3 <- QS3_10_1+QS3_10_2
finwellbeing2 <- QS3_10_1+QS3_10_2
table(finstress3)
#I am just getting by financially
wpct(finstress3, weight=ASFL$wght, na.rm=TRUE)

ASFL3 <- cbind(ASFL3,shortfall,finstress1,finstress2,finstress3)


################FINANCIAL WELL-BEING - Having control over money, ability to pursue life goals, lack of financial stress
#score from 0 to 20
#0 complete agreement
#all dont know/not relevant/refused also taken as 0

#My finances control my life.
summary(ASFL$QS2_2)
QS2_2_1 <- ifelse(ASFL$QS2_2 == "Never", 4, 0)
QS2_2_2 <- ifelse(ASFL$QS2_2 == "4", 3, 0)
QS2_2_3 <- ifelse(ASFL$QS2_2 == "3", 2, 0)
QS2_2_4 <- ifelse(ASFL$QS2_2 == "2", 1, 0)
QS2_2_5 <- ifelse(ASFL$QS2_2 == "Always", 1, 0)
QS2_2 <- QS2_2_1+QS2_2_2+QS2_2_3+QS2_2_4
table(QS2_2)
wpct(QS2_2, weight=ASFL$wght, na.rm=TRUE)
finwellbeing1 <- QS2_2_1+QS2_2_2

#I have money left over at the end of the month.
summary(ASFL$QS2_4)
QS2_4_1 <- ifelse(ASFL$QS2_4 == "Always", 4, 0)
QS2_4_2 <- ifelse(ASFL$QS2_4 == "2", 3, 0)
QS2_4_3 <- ifelse(ASFL$QS2_4 == "3", 2, 0)
QS2_4_4 <- ifelse(ASFL$QS2_4 == "4", 1, 0)
QS2_4<- QS2_4_1+QS2_4_2+QS2_4_3+QS2_4_4
QS2_4
wpct(QS2_4, weight=ASFL$wght, na.rm=TRUE)
finwellbeing2 <- QS2_4_1+QS2_4_2
finwellbeing2d <- 1-(QS2_4_1+QS2_4_2)
#Because of my money situation, I feel like I will never have the things I want in life.
summary(ASFL$QS3_3)
QS3_3_1 <- ifelse(ASFL$QS3_3 == "Not at all", 4, 0)
QS3_3_2 <- ifelse(ASFL$QS3_3 == "4", 3, 0)
QS3_3_3 <- ifelse(ASFL$QS3_3 == "3", 2, 0)
QS3_3_4 <- ifelse(ASFL$QS3_3 == "2", 1, 0)
QS3_3<- QS3_3_1+QS3_3_2+QS3_3_3+QS3_3_4
QS3_3
wpct(QS3_3, weight=ASFL$wght, na.rm=TRUE)
finwellbeing3 <- QS3_3_1+QS3_3_2
finwellbeing3d <- 1-(QS3_3_1+QS3_3_2)
#I am concerned that my money won't last.
summary(ASFL$QS3_9)
QS3_9_1 <- ifelse(ASFL$QS3_9 == "Not at all", 4, 0)
QS3_9_2 <- ifelse(ASFL$QS3_9 == "4", 3, 0)
QS3_9_3 <- ifelse(ASFL$QS3_9 == "3", 2, 0)
QS3_9_4 <- ifelse(ASFL$QS3_9 == "2", 1, 0)
QS3_9 <- QS3_9_1+QS3_9_2+QS3_9_3+QS3_9_4
QS3_9
wpct(QS3_9, weight=ASFL$wght, na.rm=TRUE)
finwellbeing4 <- QS3_9_1+QS3_9_2
finwellbeing4d <- 1-(QS3_9_1+QS3_9_2)
#I am just getting by financially
summary(ASFL$QS3_10)
QS3_10_1 <- ifelse(ASFL$QS3_10 == "Not at all", 4, 0)
QS3_10_2 <- ifelse(ASFL$QS3_10 == "4", 3, 0)
QS3_10_3 <- ifelse(ASFL$QS3_10 == "3", 2, 0)
QS3_10_4 <- ifelse(ASFL$QS3_10 == "2", 1, 0)
QS3_10 <- QS3_10_1+QS3_10_2+QS3_10_3+QS3_10_4
QS3_10
wpct(QS3_10, weight=ASFL$wght, na.rm=TRUE)
finwellbeing5 <- QS3_10_1+QS3_10_2
finwellbeing5d <- 1-(QS3_10_1+QS3_10_2)
#not in OECD/INFE but Toolkit: QS1_4,7,10 ; QS2_1 ; QS3_11
finwellbeing <- QS2_2+ QS2_4 + QS3_3 + QS3_9 + QS3_10


ASFL4 <- cbind(ASFL3,finwellbeing, finwellbeing1,finwellbeing2,finwellbeing3,finwellbeing4,finwellbeing5)
ASFL4
summary(ASFL4$finwellbeing)
table(ASFL4$finwellbeing)
weighted.mean(ASFL4$finwellbeing, ASFL4$wght) #11.4
wpct(ASFL4$finwellbeing, weight=ASFL4$wght, na.rm=TRUE)



#dummyvariables 
finwellbeing1d <- ifelse(ASFL4$finwellbeing1 > "0", 1, 0)
finwellbeing2d <- ifelse(ASFL4$finwellbeing2 > "0", 1, 0)
finwellbeing3d <- ifelse(ASFL4$finwellbeing3 > "0", 1, 0)
finwellbeing4d <- ifelse(ASFL4$finwellbeing4 > "0", 1, 0)
finwellbeing5d <- ifelse(ASFL4$finwellbeing5 > "0", 1, 0)
ASFL4 <- cbind(ASFL4,finwellbeing1d,finwellbeing2d,finwellbeing3d,finwellbeing4d,finwellbeing5d)
#groups
ASFL4 <- ASFL4 %>% mutate(fin_wellbeing_group = case_when(finwellbeing >= 16  & finwellbeing <= 20 ~ 'Highwb',
                                                          finwellbeing >= 10  & finwellbeing <16  ~ 'Averagewb',
                                                          finwellbeing >= 0  & finwellbeing < 10 ~ 'Lowwb'))
table(ASFL4$fin_wellbeing_group)


################FINANCIAL INCLUSION ##############################
####product use
#aware of at least 5 financial products
p1a1<- ifelse(ASFL$Qprod1a_1 == "1", 1, 0)
p1a2<- ifelse(ASFL$Qprod1a_2 == "1", 1, 0)
p1a3<- ifelse(ASFL$Qprod1a_3 == "1", 1, 0)
p1a5<- ifelse(ASFL$Qprod1a_5 == "1", 1, 0)
p1a6<- ifelse(ASFL$Qprod1a_6 == "1", 1, 0)
p1a7<- ifelse(ASFL$Qprod1a_7 == "Yes", 1, 0)
p1a8<- ifelse(ASFL$Qprod1a_8 == "Yes", 1, 0)
p1a9<- ifelse(ASFL$Qprod1a_9 == "1", 1, 0)
p1a10<- ifelse(ASFL$Qprod1a_10 == "1", 1, 0)
p1a11<- ifelse(ASFL$Qprod1a_11 == "1", 1, 0)
p1a12<- ifelse(ASFL$Qprod1a_12 == "1", 1, 0)
p1a13<- ifelse(ASFL$Qprod1a_13 == "1", 1, 0)
p1a14<- ifelse(ASFL$Qprod1a_14 == "1", 1, 0)
p1a15<- ifelse(ASFL$Qprod1a_15 == "1", 1, 0)
p1aadd1<- ifelse(ASFL$Qprod1a_add_1 == "Yes", 1, 0)
p1aadd2<- ifelse(ASFL$Qprod1a_add_2 == "True", 1, 0)
p1aadd3<- ifelse(ASFL$Qprod1a_add_3 == "True", 1, 0)
p1aadd4<- ifelse(ASFL$Qprod1a_add_4 == "True", 1, 0)
p1aadd5<- ifelse(ASFL$Qprod1a_add_5 == "True", 1, 0)

produse <- p1a1+p1a2+p1a3+p1a5+p1a6+p1a7+p1a8+p1a9+p1a10+p1a11+p1a12+p1a13+p1a14+p1a15+p1aadd1+p1aadd2+p1aadd3+p1aadd4+p1aadd5
table(produse)
summary(produse)
ASFL5 <- cbind(ASFL4,produse)


####################################product holding ###################################################

#holds a savings investment or retirement product
table(ASFL_org$Qprod1b_1)
ASFL <- ASFL %>% mutate(Qprod1b_1 = ifelse(is.na(Qprod1b_1), 0, Qprod1b_1))
ASFL$Qprod1b_1
p1b1 <- ifelse(ASFL$Qprod1b_1 == "1", 1, 0)
table(p1b1)

ASFL <- ASFL %>% mutate(Qprod1b_2 = ifelse(is.na(Qprod1b_2), 0, Qprod1b_2))
ASFL$Qprod1b_2
p1b2 <- ifelse(ASFL$Qprod1b_2 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_8 = ifelse(is.na(Qprod1b_8), 0, Qprod1b_8))
ASFL$Qprod1b_8
p1b8 <- ifelse(ASFL$Qprod1b_8 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_11 = ifelse(is.na(Qprod1b_11), 0, Qprod1b_11))
ASFL$Qprod1b_11
p1b11 <- ifelse(ASFL$Qprod1b_11 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_12 = ifelse(is.na(Qprod1b_12), 0, Qprod1b_12))
ASFL$Qprod1b_12
p1b12 <- ifelse(ASFL$Qprod1b_12 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_add_2 = ifelse(is.na(Qprod1b_add_2), 0, Qprod1b_add_2))
ASFL$Qprod1b_add_2
p1badd2 <- ifelse(ASFL$Qprod1b_add_2 == "4", 1, 0)

savinre <- p1b1+p1b2+p1b8+p1b11+p1b12+p1badd2
table(savinre) #internationally very high in comparison - only 50% average
savinred <- ifelse(savinre >= "1", 1, 0)
table(savinred)
ASFL5 <- cbind(ASFL5,savinre,savinred)
wpct(ASFL5$savinre, weight=ASFL5$wght, na.rm=TRUE)
wpct(ASFL5$savinred, weight=ASFL5$wght, na.rm=TRUE)
1-0.11614094 #89% - according to OECD (2020)

###Holds a current account debit card mobile payment facility or payment card
ASFL <- ASFL %>% mutate(Qprod1b_7 = ifelse(is.na(Qprod1b_7), 0, Qprod1b_7))
ASFL$Qprod1b_7
p1b7 <- ifelse(ASFL$Qprod1b_7 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_13 = ifelse(is.na(Qprod1b_13), 0, Qprod1b_13))
ASFL$Qprod1b_13
p1b13 <- ifelse(ASFL$Qprod1b_13 == "1", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_14 = ifelse(is.na(Qprod1b_14), 0, Qprod1b_14))
ASFL$Qprod1b_14
p1b14 <- ifelse(ASFL$Qprod1b_14 == "3", 1, 0)

payprod <- p1b7+p1b13+p1b14
table(payprod)
payprodd <- ifelse(payprod >= "1", 1, 0)
table(payprodd)
ASFL5 <- cbind(ASFL5,payprod,payprodd)
wpct(ASFL5$payprod, weight=ASFL5$wght, na.rm=TRUE)
1-0.02037268   #98% - according to OECD (2020)

#Holds any insurance product
ASFL <- ASFL %>% mutate(Qprod1b_10 = ifelse(is.na(Qprod1b_10), 0, Qprod1b_10))
ASFL$Qprod1b_10
p1b10 <- ifelse(ASFL$Qprod1b_10 == "3", 1, 0)
table(p1b10)  
ASFL5 <- cbind(ASFL5,p1b10)
wpct(ASFL5$p1b10, weight=ASFL5$wght, na.rm=TRUE) #75% - according to OECD (2020)

###Holds any credit product
ASFL_org$Qprod1b_3
ASFL <- ASFL %>% mutate(Qprod1b_3 = ifelse(is.na(Qprod1b_3), 0, Qprod1b_3))
ASFL$Qprod1b_3
p1b3 <- ifelse(ASFL$Qprod1b_3 == "1", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_add_4 = ifelse(is.na(Qprod1b_add_4), 0, Qprod1b_add_4))
ASFL$Qprod1b_add_4
p1badd4 <- ifelse(ASFL$Qprod1b_add_4 == "4", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_5 = ifelse(is.na(Qprod1b_5), 0, Qprod1b_5))
ASFL$Qprod1b_5
p1b5 <- ifelse(ASFL$Qprod1b_5 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_6 = ifelse(is.na(Qprod1b_6), 0, Qprod1b_6))
ASFL$Qprod1b_6
p1b6 <- ifelse(ASFL$Qprod1b_6 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_9 = ifelse(is.na(Qprod1b_9), 0, Qprod1b_9))
ASFL$Qprod1b_9
p1b9 <- ifelse(ASFL$Qprod1b_9 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_add_1 = ifelse(is.na(Qprod1b_add_1), 0, Qprod1b_add_1))
ASFL$Qprod1b_add_1
p1badd1 <- ifelse(ASFL$Qprod1b_add_1 == "3", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_add_3 = ifelse(is.na(Qprod1b_add_3), 0, Qprod1b_add_3))
ASFL$Qprod1b_add_3
p1badd3 <- ifelse(ASFL$Qprod1b_add_3 == "4", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_add_5 = ifelse(is.na(Qprod1b_add_5), 0, Qprod1b_add_5))
ASFL$Qprod1b_add_5
p1badd5 <- ifelse(ASFL$Qprod1b_add_5 == "4", 1, 0)

ASFL <- ASFL %>% mutate(Qprod1b_15 = ifelse(is.na(Qprod1b_15), 0, Qprod1b_15))
ASFL$Qprod1b_15
p1b15 <- ifelse(ASFL$Qprod1b_15 == "1", 1, 0)

credp <- p1b3+p1badd4+p1b5+p1b6+p1b9+p1b15+p1badd1+p1badd3+p1badd5
table(credp)
credpd <- ifelse(credp >= "1", 1, 0)
ASFL5 <- cbind(ASFL5,credp,credpd)
wpct(ASFL5$credp, weight=ASFL5$wght, na.rm=TRUE)
wpct(ASFL5$credpd, weight=ASFL5$wght, na.rm=TRUE)
1-0.4320583510 #57% - according to OECD (2020)

#financialproductholding 
finprodholding <- savinre+payprod+p1b10+credp
ASFL5 <- cbind(ASFL5, finprodholding)
###bought a product in the past year #recently chosen
#highest number (3 or 4) indicates Â´Yes after exluding NAs
#recent choice
ASFL <- ASFL %>% mutate(Qprod1c_1 = ifelse(is.na(Qprod1c_1), 0, Qprod1c_1))
ASFL$Qprod1c_1
RC1 <- ifelse(ASFL$Qprod1c_1 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_2 = ifelse(is.na(Qprod1c_2), 0, Qprod1c_2))
ASFL$Qprod1c_2
RC2 <- ifelse(ASFL$Qprod1c_2 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_3 = ifelse(is.na(Qprod1c_3), 0, Qprod1c_3))
ASFL$Qprod1c_3
RC3 <- ifelse(ASFL$Qprod1c_3 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_5 = ifelse(is.na(Qprod1c_5), 0, Qprod1c_5))
ASFL$Qprod1c_5
RC5 <- ifelse(ASFL$Qprod1c_5 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_6 = ifelse(is.na(Qprod1c_6), 0, Qprod1c_6))
ASFL$Qprod1c_6
RC6 <- ifelse(ASFL$Qprod1c_6 == "1",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_7 = ifelse(is.na(Qprod1c_7), 0, Qprod1c_7))
ASFL$Qprod1c_7
RC7 <- ifelse(ASFL$Qprod1c_7 == "1",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_8 = ifelse(is.na(Qprod1c_8), 0, Qprod1c_8))
ASFL$Qprod1c_8
RC8 <- ifelse(ASFL$Qprod1c_8 == "1",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_9 = ifelse(is.na(Qprod1c_9), 0, Qprod1c_9))
ASFL$Qprod1c_9
RC9 <- ifelse(ASFL$Qprod1c_9 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_10 = ifelse(is.na(Qprod1c_10), 0, Qprod1c_10))
ASFL$Qprod1c_10
RC10 <- ifelse(ASFL$Qprod1c_10 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_11 = ifelse(is.na(Qprod1c_11), 0, Qprod1c_11))
ASFL$Qprod1c_11
RC11 <- ifelse(ASFL$Qprod1c_11 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_12 = ifelse(is.na(Qprod1c_12), 0, Qprod1c_12))
ASFL$Qprod1c_12
RC12 <- ifelse(ASFL$Qprod1c_12 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_13 = ifelse(is.na(Qprod1c_13), 0, Qprod1c_13))
ASFL$Qprod1c_13
RC13 <- ifelse(ASFL$Qprod1c_13 == "1",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_14 = ifelse(is.na(Qprod1c_14), 0, Qprod1c_14))
ASFL$Qprod1c_14
RC14 <- ifelse(ASFL$Qprod1c_14 == "1",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_15 = ifelse(is.na(Qprod1c_15), 0, Qprod1c_15))
ASFL$Qprod1c_15
RC15 <- ifelse(ASFL$Qprod1c_15 == "2",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_add_1 = ifelse(is.na(Qprod1c_add_1), 0, Qprod1c_add_1))
ASFL$Qprod1c_add_1
RCadd1 <- ifelse(ASFL$Qprod1c_add_1 == "4",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_add_2 = ifelse(is.na(Qprod1c_add_2), 0, Qprod1c_add_2))
ASFL$Qprod1c_add_2
RCadd2 <- ifelse(ASFL$Qprod1c_add_2 == "4",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_add_3 = ifelse(is.na(Qprod1c_add_3), 0, Qprod1c_add_3))
ASFL$Qprod1c_add_3
RCadd3 <- ifelse(ASFL$Qprod1c_add_3 == "4",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_add_4 = ifelse(is.na(Qprod1c_add_4), 0, Qprod1c_add_4))
ASFL$Qprod1c_add_4
RCadd4 <- ifelse(ASFL$Qprod1c_add_4 == "3",1, 0)

ASFL <- ASFL %>% mutate(Qprod1c_add_5 = ifelse(is.na(Qprod1c_add_5), 0, Qprod1c_add_5))
ASFL$Qprod1c_add_5
RCadd5 <- ifelse(ASFL$Qprod1c_add_5 == "4",1, 0)

recentchoice <- RC1+RC2+RC3+RC5+RC6+RC7+RC8+RC9+RC10+RC11+RC12+RC13+RC14+RC15+RCadd1+RCadd2+RCadd3+RCadd4+RCadd5
table(recentchoice)
recentchoiced <- ifelse(recentchoice >= "1", 1, 0)
ASFL5 <- cbind(ASFL5,recentchoice,recentchoiced)
wpct(ASFL5$recentchoice, weight=ASFL5$wght, na.rm=TRUE)
wpct(ASFL5$recentchoiced, weight=ASFL5$wght, na.rm=TRUE)
1-0.5886103437 #41% - according to OECD (2020)

###turned to family/friends to borrow and save
#QF3_3 and QF12_3_1 from before <- NAs already excluded!
#full
#QF3_3_borrow <- ifelse(ASFL$QF3_3 == "Yes", 1, 0)
ASFL <- ASFL %>% mutate(QF12_2_3 = ifelse(is.na(QF12_2_3), 0, QF12_2_3))
QF12_2_3 <- ifelse(ASFL$QF12_2_3 == "4", 1, 0)
QF12_3_1 <- ifelse(ASFL$QF12_3_1 == "4", 1, 0)

#famfriend <- QF3_3+QF12_3_1+QF12_2_3
famfriend <- QF3_3+QF12_3_1+QF12_2_3
famfriend
table(famfriend)
famfriend[famfriend == "2"] <- "1"
famfriend <- as.numeric(famfriend)
ASFL5 <- cbind(ASFL5,famfriend)
wpct(ASFL5$famfriend, weight=ASFL$wght) #13% - according to OECD (2020)


#################ADDITIONAL FINANCIAL LITERACY INDICATORS COMPARISONS##################################
ASFL5m <- ASFL5[(ASFL5$QD1 %in% male),]
ASFL5f <- ASFL5[(ASFL5$QD1 %in% female),]
ASFL5hfinbuff <- ASFL5[(ASFL5$QF13 %in% hfinbuff),]
ASFL5lfinbuff <- ASFL5[(ASFL5$QF13 %in% lfinbuff),]

ASFL5se <- ASFL5[(ASFL5$QD10 %in% se),]
ASFL5sehfinbuff <- ASFL5se[(ASFL5se$QF13 %in% hfinbuff),]
ASFL5selfinbuff <- ASFL5se[(ASFL5se$QF13 %in% lfinbuff),]
ASFL5sem <- ASFL5se[(ASFL5se$QD1 %in% male),]
ASFL5sef <- ASFL5se[(ASFL5se$QD1 %in% female),]
ASFL5oth <- ASFL5[(ASFL5$QD10 %in% oth),]

ASFL5e <- ASFL5[(ASFL5$QD10 %in% e),]
ASFL5em <- ASFL5e[(ASFL5e$QD1 %in% male),]
ASFL5ef <- ASFL5e[(ASFL5e$QD1 %in% female),]
ASFL5unempl <- ASFL5[(ASFL5$QD10 %in% unempl),]

ASFL5oth <- ASFL5[(ASFL5$QD10 %in% oth),]
ASFL5othworet <- ASFL5[(ASFL5$QD10 %in% othworet),]
ASFL5ret <- ASFL5[(ASFL5$QD10 %in% ret),]
ASFL5entrepreneurs <- ASFL5[(ASFL5$QF9_11 %in% entrepreneurs),]
#################total financial resilience comparison############################
wpct(ASFL5m$highfinbuffd, weight=ASFL5m$wght, na.rm=TRUE)
wpct(ASFL5m$sixmonthfinbuffd, weight=ASFL5m$wght, na.rm=TRUE)
wpct(ASFL5m$shortfall, weight=ASFL5m$wght, na.rm=TRUE)
wpct(ASFL5m$finstress1, weight=ASFL5m$wght, na.rm=TRUE)
wpct(ASFL5m$finstress2, weight=ASFL5m$wght, na.rm=TRUE)
wpct(ASFL5m$finstress3, weight=ASFL5m$wght, na.rm=TRUE)

wpct(ASFL5m$finfraudd, weight=ASFL5m$wght, na.rm=TRUE)

wpct(ASFL5f$highfinbuffd, weight=ASFL5f$wght, na.rm=TRUE)
wpct(ASFL5f$sixmonthfinbuffd, weight=ASFL5f$wght, na.rm=TRUE)
wpct(ASFL5f$shortfall, weight=ASFL5f$wght, na.rm=TRUE)
wpct(ASFL5f$finstress1, weight=ASFL5f$wght, na.rm=TRUE)
wpct(ASFL5f$finstress2, weight=ASFL5f$wght, na.rm=TRUE)
wpct(ASFL5f$finstress3, weight=ASFL5f$wght, na.rm=TRUE)

wpct(ASFL5f$finfraudd, weight=ASFL5f$wght, na.rm=TRUE)

wpct(ASFL5se$highfinbuffd, weight=ASFL5se$wght, na.rm=TRUE) #more than three months
wpct(ASFL5se$sixmonthfinbuffd, weight=ASFL5se$wght, na.rm=TRUE) #more than six months
wpct(ASFL5se$shortfall, weight=ASFL5se$wght, na.rm=TRUE)
wpct(ASFL5se$finstress1, weight=ASFL5se$wght, na.rm=TRUE)
wpct(ASFL5se$finstress2, weight=ASFL5se$wght, na.rm=TRUE)
wpct(ASFL5se$finstress3, weight=ASFL5se$wght, na.rm=TRUE)

wpct(ASFL5se$finfraudd, weight=ASFL5se$wght, na.rm=TRUE)

wpct(ASFL5sem$highfinbuffd, weight=ASFL5sem$wght, na.rm=TRUE) #more than three months
wpct(ASFL5sem$sixmonthfinbuffd, weight=ASFL5sem$wght, na.rm=TRUE) #more than six months
wpct(ASFL5sem$shortfall, weight=ASFL5sem$wght, na.rm=TRUE)
wpct(ASFL5sem$finstress1, weight=ASFL5sem$wght, na.rm=TRUE)
wpct(ASFL5sem$finstress2, weight=ASFL5sem$wght, na.rm=TRUE)
wpct(ASFL5sem$finstress3, weight=ASFL5sem$wght, na.rm=TRUE)

wpct(ASFL5sem$finfraudd, weight=ASFL5sem$wght, na.rm=TRUE)

wpct(ASFL5sef$highfinbuffd, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$sixmonthfinbuffd, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$shortfall, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$finstress1, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$finstress2, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$finstress3, weight=ASFL5sef$wght, na.rm=TRUE)

wpct(ASFL5sef$finfraudd, weight=ASFL5sef$wght, na.rm=TRUE)


wpct(ASFL5e$highfinbuffd, weight=ASFL5e$wght, na.rm=TRUE)
wpct(ASFL5e$sixmonthfinbuffd, weight=ASFL5e$wght, na.rm=TRUE)
wpct(ASFL5e$shortfall, weight=ASFL5e$wght, na.rm=TRUE)
wpct(ASFL5e$finstress1, weight=ASFL5e$wght, na.rm=TRUE)
wpct(ASFL5e$finstress2, weight=ASFL5e$wght, na.rm=TRUE)
wpct(ASFL5e$finstress3, weight=ASFL5e$wght, na.rm=TRUE)

wpct(ASFL5e$finfraudd, weight=ASFL5e$wght, na.rm=TRUE)

wpct(ASFL5em$highfinbuffd, weight=ASFL5em$wght, na.rm=TRUE)
wpct(ASFL5em$sixmonthfinbuffd, weight=ASFL5em$wght, na.rm=TRUE)
wpct(ASFL5em$shortfall, weight=ASFL5em$wght, na.rm=TRUE)
wpct(ASFL5em$finstress1, weight=ASFL5em$wght, na.rm=TRUE)
wpct(ASFL5em$finstress2, weight=ASFL5em$wght, na.rm=TRUE)
wpct(ASFL5em$finstress3, weight=ASFL5em$wght, na.rm=TRUE)

wpct(ASFL5em$finfraudd, weight=ASFL5em$wght, na.rm=TRUE)

wpct(ASFL5ef$highfinbuffd, weight=ASFL5ef$wght, na.rm=TRUE)
wpct(ASFL5ef$sixmonthfinbuffd, weight=ASFL5ef$wght, na.rm=TRUE)
wpct(ASFL5ef$shortfall, weight=ASFL5ef$wght, na.rm=TRUE)
wpct(ASFL5ef$finstress1, weight=ASFL5ef$wght, na.rm=TRUE)
wpct(ASFL5ef$finstress2, weight=ASFL5ef$wght, na.rm=TRUE)
wpct(ASFL5ef$finstress3, weight=ASFL5ef$wght, na.rm=TRUE)

wpct(ASFL5ef$finfraudd, weight=ASFL5ef$wght, na.rm=TRUE)

wpct(ASFL5unempl$highfinbuffd, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$sixmonthfinbuffd, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$shortfall, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finstress1, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finstress2, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finstress3, weight=ASFL5unempl$wght, na.rm=TRUE)

wpct(ASFL5unempl$finfraudd, weight=ASFL5unempl$wght, na.rm=TRUE)

wpct(ASFL5oth$highfinbuffd, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$sixmonthfinbuffd, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$shortfall, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finstress1, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finstress2, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finstress3, weight=ASFL5oth$wght, na.rm=TRUE)

wpct(ASFL5oth$finfraudd, weight=ASFL5oth$wght, na.rm=TRUE)


wpct(ASFL5othworet$highfinbuffd, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$sixmonthfinbuffd, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$shortfall, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finstress1, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finstress2, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finstress3, weight=ASFL5othworet$wght, na.rm=TRUE)

wpct(ASFL5othworet$finfraudd, weight=ASFL5othworet$wght, na.rm=TRUE)


wpct(ASFL5ret$highfinbuffd, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$sixmonthfinbuffd, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$shortfall, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finstress1, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finstress2, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finstress3, weight=ASFL5ret$wght, na.rm=TRUE)

wpct(ASFL5ret$finfraudd, weight=ASFL5ret$wght, na.rm=TRUE)

wpct(ASFL5entrepreneurs$highfinbuffd, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$sixmonthfinbuffd, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$shortfall, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finstress1, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finstress2, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finstress3, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)

wpct(ASFL5entrepreneurs$finfraudd, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)


#################total financial inclusion comparison############################
wpct(ASFL5se$produse, weight=ASFL5se$wght, na.rm=TRUE)
1-0.009898962-0.021408774
wpct(ASFL5se$savinre, weight=ASFL5se$wght, na.rm=TRUE)
1-0.09229320 
wpct(ASFL5se$payprod, weight=ASFL5se$wght, na.rm=TRUE)
wpct(ASFL5se$p1b10, weight=ASFL5se$wght, na.rm=TRUE)
wpct(ASFL5se$credp, weight=ASFL5se$wght, na.rm=TRUE)
1-0.13404446 
wpct(ASFL5se$finprodholding, weight=ASFL5se$wght, na.rm=TRUE)
weighted.mean(ASFL5se$finprodholding, ASFL5se$wght)
wpct(ASFL5se$recentchoice, weight=ASFL5se$wght, na.rm=TRUE)
1-0.46595312 
wpct(ASFL5se$famfriend, weight=ASFL5se$wght,na.rm=TRUE)

ASFL5sem <- ASFL5se[(ASFL5se$QD1 %in% male),]
wpct(ASFL5sem$produse, weight=ASFL5sem$wght, na.rm=TRUE)
1-0.01663340- 0.01517251
wpct(ASFL5sem$savinre, weight=ASFL5sem$wght, na.rm=TRUE)
1-0.06101732 
wpct(ASFL5sem$payprod, weight=ASFL5sem$wght, na.rm=TRUE)
wpct(ASFL5sem$p1b10, weight=ASFL5sem$wght, na.rm=TRUE)
wpct(ASFL5sem$credp, weight=ASFL5sem$wght, na.rm=TRUE)
1-0.06886512 
wpct(ASFL5sem$recentchoice, weight=ASFL5sem$wght, na.rm=TRUE)
1-0.32043103 
wpct(ASFL5sem$famfriend, weight=ASFL5sem$wght,na.rm=TRUE)

ASFL5sef <- ASFL5se[(ASFL5se$QD1 %in% female),]
wpct(ASFL5sef$produse, weight=ASFL5sef$wght, na.rm=TRUE)
1-0.03057546 
wpct(ASFL5sef$savinre, weight=ASFL5sef$wght, na.rm=TRUE)
1-0.13826565  
wpct(ASFL5sef$payprod, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$p1b10, weight=ASFL5sef$wght, na.rm=TRUE)
wpct(ASFL5sef$credp, weight=ASFL5sef$wght, na.rm=TRUE)
1-0.22985166 
wpct(ASFL5sef$recentchoice, weight=ASFL5sef$wght, na.rm=TRUE)
1-0.67985622  
wpct(ASFL5sef$famfriend, weight=ASFL5sef$wght,na.rm=TRUE)


ASFL5e <- ASFL5[(ASFL5$QD10 %in% e),]
wpct(ASFL5e$produse, weight=ASFL5e$wght, na.rm=TRUE)
1-0.013245258 -0.010562546- 0.028141207
wpct(ASFL5e$savinre, weight=ASFL5e$wght, na.rm=TRUE)
1-0.08266264 
wpct(ASFL5e$payprod, weight=ASFL5e$wght, na.rm=TRUE)
1-0.009812379  
wpct(ASFL5e$p1b10, weight=ASFL5e$wght, na.rm=TRUE)
wpct(ASFL5e$credp, weight=ASFL5e$wght, na.rm=TRUE)
1-0.2872825616 
wpct(ASFL5e$finprodholding, weight=ASFL5e$wght, na.rm=TRUE)
weighted.mean(ASFL5e$finprodholding, ASFL5e$wght)
wpct(ASFL5e$recentchoice, weight=ASFL5e$wght, na.rm=TRUE)
1-0.4686712937 
wpct(ASFL5e$famfriend, weight=ASFL5e$wght,na.rm=TRUE)


ASFL5em <- ASFL5e[(ASFL5e$QD1 %in% male),]
wpct(ASFL5em$produse, weight=ASFL5em$wght, na.rm=TRUE)
1-0.012434899- 0.016887064- 0.027976337
wpct(ASFL5em$savinre, weight=ASFL5em$wght, na.rm=TRUE)
1-0.08514439  
wpct(ASFL5em$payprod, weight=ASFL5em$wght, na.rm=TRUE)
1-0.004802508 
wpct(ASFL5em$p1b10, weight=ASFL5em$wght, na.rm=TRUE)
wpct(ASFL5em$credp, weight=ASFL5em$wght, na.rm=TRUE)
1-0.244355104  
wpct(ASFL5em$recentchoice, weight=ASFL5em$wght, na.rm=TRUE)
1-0.433069410  
wpct(ASFL5em$famfriend, weight=ASFL5em$wght,na.rm=TRUE)

ASFL5ef <- ASFL5e[(ASFL5e$QD1 %in% female),]
wpct(ASFL5ef$produse, weight=ASFL5ef$wght, na.rm=TRUE)
1-0.014116070- 0.003766211- 0.028318376
wpct(ASFL5ef$savinre, weight=ASFL5ef$wght, na.rm=TRUE)
1-0.07999574  
wpct(ASFL5ef$payprod, weight=ASFL5ef$wght, na.rm=TRUE)
1-0.01519599 
wpct(ASFL5ef$p1b10, weight=ASFL5ef$wght, na.rm=TRUE)
wpct(ASFL5ef$credp, weight=ASFL5ef$wght, na.rm=TRUE)
1-0.333412459  
wpct(ASFL5ef$recentchoice, weight=ASFL5ef$wght, na.rm=TRUE)
1-0.506929121   
wpct(ASFL5ef$famfriend, weight=ASFL5ef$wght,na.rm=TRUE)

ASFL5unempl <- ASFL5[(ASFL5$QD10 %in% unempl),]
wpct(ASFL5unempl$produse, weight=ASFL5unempl$wght, na.rm=TRUE)
1-0.02030828 -0.04754515- 0.01676906- 0.01877133
wpct(ASFL5unempl$savinre, weight=ASFL5unempl$wght, na.rm=TRUE)
1-0.48168187  
wpct(ASFL5unempl$payprod, weight=ASFL5unempl$wght, na.rm=TRUE)
1-0.02385717   
wpct(ASFL5unempl$p1b10, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$credp, weight=ASFL5unempl$wght, na.rm=TRUE)
1-0.69319268  
wpct(ASFL5unempl$finprodholding, weight=ASFL5unempl$wght, na.rm=TRUE)
weighted.mean(ASFL5unempl$finprodholding, ASFL5unempl$wght)
wpct(ASFL5unempl$recentchoice, weight=ASFL5unempl$wght, na.rm=TRUE)
1-0.60441327  
wpct(ASFL5unempl$famfriend, weight=ASFL5unempl$wght,na.rm=TRUE)


ASFL5oth <- ASFL5[(ASFL5$QD10 %in% oth),]
wpct(ASFL5oth$produse, weight=ASFL5oth$wght, na.rm=TRUE)
1-0.005500922 -0.007719099 -0.023412552 -0.034910974 -0.020833509
wpct(ASFL5oth$savinre, weight=ASFL5oth$wght, na.rm=TRUE)
1-0.162477257  
wpct(ASFL5oth$payprod, weight=ASFL5oth$wght, na.rm=TRUE)
1-0.036649870 
wpct(ASFL5oth$p1b10, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$credp, weight=ASFL5oth$wght, na.rm=TRUE)
1-0.6576287329 
wpct(ASFL5oth$finprodholding, weight=ASFL5oth$wght, na.rm=TRUE)
weighted.mean(ASFL5oth$finprodholding, ASFL5oth$wght)
wpct(ASFL5oth$recentchoice, weight=ASFL5oth$wght, na.rm=TRUE)
1-0.759425470 
wpct(ASFL5oth$famfriend, weight=ASFL5oth$wght,na.rm=TRUE)

ASFL5othworet <- ASFL5[(ASFL5$QD10 %in% othworet),]
wpct(ASFL5othworet$produse, weight=ASFL5othworet$wght, na.rm=TRUE)
1-0.014309649 -0.016596644 -0.028121471 -0.033892776- 0.021953299
wpct(ASFL5othworet$savinre, weight=ASFL5othworet$wght, na.rm=TRUE)
1-  0.30774273 
wpct(ASFL5othworet$payprod, weight=ASFL5othworet$wght, na.rm=TRUE)
1- 0.086388782 
wpct(ASFL5othworet$p1b10, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$credp, weight=ASFL5othworet$wght, na.rm=TRUE)
1- 0.72332066 
wpct(ASFL5othworet$finprodholding, weight=ASFL5othworet$wght, na.rm=TRUE)
weighted.mean(ASFL5othworet$finprodholding, ASFL5othworet$wght)
wpct(ASFL5othworet$recentchoice, weight=ASFL5othworet$wght, na.rm=TRUE)
1- 0.524159000 
wpct(ASFL5othworet$famfriend, weight=ASFL5othworet$wght,na.rm=TRUE)

ASFL5ret <- ASFL5[(ASFL5$QD10 %in% ret),]
wpct(ASFL5ret$produse, weight=ASFL5ret$wght, na.rm=TRUE)
1-0.001491719 -0.003678575- 0.021269336- 0.035374397- 0.020323848
wpct(ASFL5ret$savinre, weight=ASFL5ret$wght, na.rm=TRUE)
1-0.09636115   
wpct(ASFL5ret$payprod, weight=ASFL5ret$wght, na.rm=TRUE)
1- 0.01401171 
wpct(ASFL5ret$p1b10, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$credp, weight=ASFL5ret$wght, na.rm=TRUE)
1- 0.627729720 
wpct(ASFL5ret$finprodholding, weight=ASFL5ret$wght, na.rm=TRUE)
weighted.mean(ASFL5ret$finprodholding, ASFL5ret$wght)
wpct(ASFL5ret$recentchoice, weight=ASFL5ret$wght, na.rm=TRUE)
1- 0.86650461 
wpct(ASFL5ret$famfriend, weight=ASFL5ret$wght,na.rm=TRUE)

ASFL5entrepreneurs <- ASFL5[(ASFL5$QF9_11 %in% entrepreneurs),]
wpct(ASFL5entrepreneurs$produse, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
1-0.04087746- 0.02257407
wpct(ASFL5entrepreneurs$savinre, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
1-  0.16960143 
wpct(ASFL5entrepreneurs$payprod, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$p1b10, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$credp, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
1- 0.33198734 
wpct(ASFL5entrepreneurs$finprodholding, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
weighted.mean(ASFL5entrepreneurs$finprodholding, ASFL5entrepreneurs$wght)
wpct(ASFL5entrepreneurs$recentchoice, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
1- 0.72953345 
wpct(ASFL5entrepreneurs$famfriend, weight=ASFL5entrepreneurs$wght,na.rm=TRUE)

#################total financial well-being comparison############################
wpct(ASFL5se$finwellbeing, weight=ASFL5se$wght,na.rm=TRUE)
weighted.mean(ASFL5se$finwellbeing, ASFL5se$wght)
wpct(ASFL5sem$finwellbeing, weight=ASFL5sem$wght,na.rm=TRUE)
weighted.mean(ASFL5sem$finwellbeing, ASFL5sem$wght)
wpct(ASFL5sef$finwellbeing, weight=ASFL5sef$wght,na.rm=TRUE)
weighted.mean(ASFL5sef$finwellbeing, ASFL5sef$wght)

wpct(ASFL5e$finwellbeing, weight=ASFL5e$wght,na.rm=TRUE)
weighted.mean(ASFL5e$finwellbeing, ASFL5e$wght)
weighted.mean(ASFL5em$finwellbeing, ASFL5em$wght)
weighted.mean(ASFL5ef$finwellbeing, ASFL5ef$wght)

wpct(ASFL5unempl$finwellbeing, weight=ASFL5unempl$wght,na.rm=TRUE)
weighted.mean(ASFL5unempl$finwellbeing, ASFL5unempl$wght)
wpct(ASFL5oth$finwellbeing, weight=ASFL5oth$wght,na.rm=TRUE)
weighted.mean(ASFL5oth$finwellbeing, ASFL5oth$wght)
wpct(ASFL5othworet$finwellbeing, weight=ASFL5othworet$wght,na.rm=TRUE)
weighted.mean(ASFL5othworet$finwellbeing, ASFL5othworet$wght)
wpct(ASFL5ret$finwellbeing, weight=ASFL5ret$wght,na.rm=TRUE)
weighted.mean(ASFL5ret$finwellbeing, ASFL5ret$wght)
wpct(ASFL5entrepreneurs$finwellbeing, weight=ASFL5entrepreneurs$wght,na.rm=TRUE)
weighted.mean(ASFL5entrepreneurs$finwellbeing, ASFL5entrepreneurs$wght)

#adopted financial well-being score

wpct(ASFL5se$finwellbeing1d, weight=ASFL5se$wght,na.rm=TRUE)
wpct(ASFL5se$finwellbeing2d, weight=ASFL5se$wght,na.rm=TRUE)
wpct(ASFL5se$finwellbeing3d, weight=ASFL5se$wght,na.rm=TRUE)
wpct(ASFL5se$finwellbeing4d, weight=ASFL5se$wght,na.rm=TRUE)
wpct(ASFL5se$finwellbeing5d, weight=ASFL5se$wght,na.rm=TRUE)

wpct(ASFL5sem$finwellbeing1d, weight=ASFL5sem$wght,na.rm=TRUE)
wpct(ASFL5sem$finwellbeing2d, weight=ASFL5sem$wght,na.rm=TRUE)
wpct(ASFL5sem$finwellbeing3d, weight=ASFL5sem$wght,na.rm=TRUE)
wpct(ASFL5sem$finwellbeing4d, weight=ASFL5sem$wght,na.rm=TRUE)
wpct(ASFL5sem$finwellbeing5d, weight=ASFL5sem$wght,na.rm=TRUE)

wpct(ASFL5sef$finwellbeing1d, weight=ASFL5sef$wght,na.rm=TRUE)
wpct(ASFL5sef$finwellbeing2d, weight=ASFL5sef$wght,na.rm=TRUE)
wpct(ASFL5sef$finwellbeing3d, weight=ASFL5sef$wght,na.rm=TRUE)
wpct(ASFL5sef$finwellbeing4d, weight=ASFL5sef$wght,na.rm=TRUE)
wpct(ASFL5sef$finwellbeing5d, weight=ASFL5sef$wght,na.rm=TRUE)

wpct(ASFL5e$finwellbeing1d, weight=ASFL5e$wght,na.rm=TRUE)
wpct(ASFL5e$finwellbeing2d, weight=ASFL5e$wght,na.rm=TRUE)
wpct(ASFL5e$finwellbeing3d, weight=ASFL5e$wght,na.rm=TRUE)
wpct(ASFL5e$finwellbeing4d, weight=ASFL5e$wght,na.rm=TRUE)
wpct(ASFL5e$finwellbeing5d, weight=ASFL5e$wght,na.rm=TRUE)


wpct(ASFL5em$finwellbeing1d, weight=ASFL5em$wght,na.rm=TRUE)
wpct(ASFL5em$finwellbeing2d, weight=ASFL5em$wght,na.rm=TRUE)
wpct(ASFL5em$finwellbeing3d, weight=ASFL5em$wght,na.rm=TRUE)
wpct(ASFL5em$finwellbeing4d, weight=ASFL5em$wght,na.rm=TRUE)
wpct(ASFL5em$finwellbeing5d, weight=ASFL5em$wght,na.rm=TRUE)

wpct(ASFL5ef$finwellbeing1d, weight=ASFL5ef$wght,na.rm=TRUE)
wpct(ASFL5ef$finwellbeing2d, weight=ASFL5ef$wght,na.rm=TRUE)
wpct(ASFL5ef$finwellbeing3d, weight=ASFL5ef$wght,na.rm=TRUE)
wpct(ASFL5ef$finwellbeing4d, weight=ASFL5ef$wght,na.rm=TRUE)
wpct(ASFL5ef$finwellbeing5d, weight=ASFL5ef$wght,na.rm=TRUE)

wpct(ASFL5unempl$finwellbeing1d, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finwellbeing2d, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finwellbeing3d, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finwellbeing4d, weight=ASFL5unempl$wght, na.rm=TRUE)
wpct(ASFL5unempl$finwellbeing5d, weight=ASFL5unempl$wght, na.rm=TRUE)

wpct(ASFL5oth$finwellbeing1d, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finwellbeing2d, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finwellbeing3d, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finwellbeing4d, weight=ASFL5oth$wght, na.rm=TRUE)
wpct(ASFL5oth$finwellbeing5d, weight=ASFL5oth$wght, na.rm=TRUE)

wpct(ASFL5othworet$finwellbeing1d, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finwellbeing2d, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finwellbeing3d, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finwellbeing4d, weight=ASFL5othworet$wght, na.rm=TRUE)
wpct(ASFL5othworet$finwellbeing5d, weight=ASFL5othworet$wght, na.rm=TRUE)

wpct(ASFL5ret$finwellbeing1d, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finwellbeing2d, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finwellbeing3d, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finwellbeing4d, weight=ASFL5ret$wght, na.rm=TRUE)
wpct(ASFL5ret$finwellbeing5d, weight=ASFL5ret$wght, na.rm=TRUE)


wpct(ASFL5entrepreneurs$finwellbeing1d, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finwellbeing2d, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finwellbeing3d, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finwellbeing4d, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL5entrepreneurs$finwellbeing5d, weight=ASFL5entrepreneurs$wght, na.rm=TRUE)


#############################MAIN FINANCIAL LITERACY SCORE (without additional indicators)#########################
finlit <- fin_know+fin_att+fin_beh
finlitadd <- fin_know_add+fin_att+fin_beh
summary(finlit)
table(finlit)
ASFL6 <- cbind(ASFL5, finlit, finlitadd)
weighted.mean(ASFL6$finlit, ASFL6$wght) #14.4 - according to OECD (2020)
wpct(ASFL6$finlit, weight=ASFL6$wght,na.rm=TRUE)
finlitr <- round(ASFL6$finlit)
ASFL6 <- cbind(ASFL6, finlitr)
wpct(ASFL6$finlitr, weight=ASFL6$wght, na.rm=TRUE)
weighted.mean(ASFL6$finlitr, ASFL6$wght)

weighted.mean(ASFL6$finlitadd, ASFL6$wght) 
wpct(ASFL6$finlitadd, weight=ASFL6$wght,na.rm=TRUE)
finlitaddr <- round(ASFL6$finlitadd)
ASFL6 <- cbind(ASFL6, finlitaddr)
wpct(ASFL6$finlitaddr, weight=ASFL6$wght, na.rm=TRUE)
weighted.mean(ASFL6$finlitaddr, ASFL6$wght)

#dummy variables 
ASFL6 <- ASFL6 %>% mutate(finlit_group = case_when(finlit >=17  & finlit <= 20.66666666666667 ~ "High fl",
                                                   finlit >=14   & finlit <17  ~ "Average fl",
                                                   finlit >= 0  & finlit <14  ~ "Low fl"))
table(ASFL6$finlit_group)

finlit_group_1 <- factor(ASFL6$finlit_group, levels=c("High fl","Average fl", "Low fl"))
levels(finlit_group_1)


highfinlitd <- ifelse(ASFL6$finlit_group == "High fl", 1, 0)
averagefinlitd <- ifelse(ASFL6$finlit_group == "Average fl", 1, 0)
lowfinlitd <- ifelse(ASFL6$finlit_group == "Low fl", 1, 0)
ASFL6 <- cbind(ASFL6,highfinlitd,averagefinlitd,lowfinlitd,finlit_group_1)
table(ASFL6$highfinlitd)
table(ASFL6$averagefinlitd)
table(ASFL6$lowfinlitd)
table(ASFL6$finlit_group_1)



###main financial literacy indicator comparison
ASFL6se <- ASFL6[(ASFL6$QD10 %in% se),]
weighted.mean(ASFL6se$finlit, ASFL6se$wght)
weighted.mean(ASFL6se$finlitadd, ASFL6se$wght)
wpct(ASFL6se$finlit, weight=ASFL6se$wght, na.rm=TRUE)
wpct(ASFL6se$finlitadd, weight=ASFL6se$wght, na.rm=TRUE)
ASFL6e <- ASFL6[(ASFL6$QD10 %in% e),]
weighted.mean(ASFL6e$finlit, ASFL6e$wght)
weighted.mean(ASFL6e$finlitadd, ASFL6e$wght)
wpct(ASFL6e$finlit, weight=ASFL6e$wght, na.rm=TRUE)
wpct(ASFL6e$finlitadd, weight=ASFL6e$wght, na.rm=TRUE)
ASFL6eu <- ASFL6[(ASFL6$QD10 %in% eu),]
ASFL6unempl <- ASFL6[(ASFL6$QD10 %in% unempl),]
weighted.mean(ASFL6unempl$finlit, ASFL6unempl$wght)
weighted.mean(ASFL6unempl$finlitadd, ASFL6unempl$wght)
wpct(ASFL6unempl$finlit, weight=ASFL6unempl$wght, na.rm=TRUE)
wpct(ASFL6unempl$finlitadd, weight=ASFL6unempl$wght, na.rm=TRUE)
ASFL6oth <- ASFL6[(ASFL6$QD10 %in% oth),]
weighted.mean(ASFL6oth$finlit, ASFL6oth$wght)
weighted.mean(ASFL6oth$finlitadd, ASFL6oth$wght)
wpct(ASFL6oth$finlit, weight=ASFL6oth$wght, na.rm=TRUE)
wpct(ASFL6oth$finlitadd, weight=ASFL6oth$wght, na.rm=TRUE)
ASFL6othworet <- ASFL6[(ASFL6$QD10 %in% othworet),]
weighted.mean(ASFL6othworet$finlit, ASFL6othworet$wght)
weighted.mean(ASFL6othworet$finlitadd, ASFL6othworet$wght)
wpct(ASFL6othworet$finlit, weight=ASFL6othworet$wght, na.rm=TRUE)
wpct(ASFL6othworet$finlitadd, weight=ASFL6othworet$wght, na.rm=TRUE)
ASFL6ret <- ASFL6[(ASFL6$QD10 %in% ret),]
weighted.mean(ASFL6ret$finlit, ASFL6ret$wght)
weighted.mean(ASFL6ret$finlitadd, ASFL6ret$wght)
wpct(ASFL6ret$finlit, weight=ASFL6ret$wght, na.rm=TRUE)
wpct(ASFL6ret$finlitadd, weight=ASFL6ret$wght, na.rm=TRUE)
ASFL6entrepreneurs <- ASFL6[(ASFL6$QF9_11 %in% entrepreneurs),]
weighted.mean(ASFL6entrepreneurs$finlit, ASFL6entrepreneurs$wght)
weighted.mean(ASFL6entrepreneurs$finlitadd, ASFL6entrepreneurs$wght)
wpct(ASFL6entrepreneurs$finlit, weight=ASFL6entrepreneurs$wght, na.rm=TRUE)
wpct(ASFL6entrepreneurs$finlitadd, weight=ASFL6entrepreneurs$wght, na.rm=TRUE)
weighted.mean(ASFL6entrepreneurs$finlitadd, ASFL6entrepreneurs$wght)

ASFL6m <- ASFL6[(ASFL6$QD1 %in% male),]
ASFL6f <- ASFL6[(ASFL6$QD1 %in% female),]
weighted.mean(ASFL6m$finlit, ASFL6m$wght) #14.6
weighted.mean(ASFL6f$finlit, ASFL6f$wght) #14.2
ASFL6sem <- ASFL6se[(ASFL6se$QD1 %in% male),]
ASFL6sef <- ASFL6se[(ASFL6se$QD1 %in% female),]
weighted.mean(ASFL6sem$finlit, ASFL6sem$wght) 
weighted.mean(ASFL6sef$finlit, ASFL6sef$wght)
ASFL6em <- ASFL6e[(ASFL6e$QD1 %in% male),]
ASFL6ef <- ASFL6e[(ASFL6e$QD1 %in% female),]
weighted.mean(ASFL6em$finlit, ASFL6em$wght) 
weighted.mean(ASFL6ef$finlit, ASFL6ef$wght)

#########financial cushion and financial indicators - high or low financial savings
ASFL6hfinbuff <- ASFL6[(ASFL6$QF13 %in% hfinbuff),]
ASFL6lfinbuff <- ASFL6[(ASFL6$QF13 %in% lfinbuff),]

###financial resilience specific below or above three months
#fullsample
weighted.mean(ASFL6hfinbuff$finlit,ASFL6hfinbuff$wght)#according to OECD
weighted.mean(ASFL6lfinbuff$finlit,ASFL6lfinbuff$wght)

weighted.mean(ASFL6hfinbuff$fin_know,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$fin_know,ASFL6lfinbuff$wght)

weighted.mean(ASFL6hfinbuff$fin_beh,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$fin_beh,ASFL6lfinbuff$wght)

weighted.mean(ASFL6hfinbuff$fin_att,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$fin_att,ASFL6lfinbuff$wght)
#financial stress and concern 
weighted.mean(ASFL6hfinbuff$shortfall,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$shortfall,ASFL6lfinbuff$wght)
weighted.mean(ASFL6hfinbuff$finstress1,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$finstress1,ASFL6lfinbuff$wght)
weighted.mean(ASFL6hfinbuff$finstress2,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$finstress2,ASFL6lfinbuff$wght)
weighted.mean(ASFL6hfinbuff$finstress3,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$finstress3,ASFL6lfinbuff$wght)

weighted.mean(ASFL6hfinbuff$finfraudd,ASFL6hfinbuff$wght)
weighted.mean(ASFL6lfinbuff$finfraudd,ASFL6lfinbuff$wght)

##########################self-employed##########################
ASFL6sehfinbuff <- ASFL6se[(ASFL6se$QF13 %in% hfinbuff),]
ASFL6selfinbuff <- ASFL6se[(ASFL6se$QF13 %in% lfinbuff),]
ASFL6semhfinbuff <- ASFL6sem[(ASFL6sem$QF13 %in% hfinbuff),]
ASFL6semlfinbuff <- ASFL6sem[(ASFL6sem$QF13 %in% lfinbuff),]
ASFL6sefhfinbuff <- ASFL6sef[(ASFL6sef$QF13 %in% hfinbuff),]
ASFL6seflfinbuff <- ASFL6sef[(ASFL6sef$QF13 %in% lfinbuff),]
#high financial savings
weighted.mean(ASFL6sehfinbuff$finlit,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$finlit,ASFL6selfinbuff$wght)

weighted.mean(ASFL6sehfinbuff$fin_know,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$fin_know,ASFL6selfinbuff$wght)

weighted.mean(ASFL6sehfinbuff$fin_beh,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$fin_beh,ASFL6selfinbuff$wght)

weighted.mean(ASFL6sehfinbuff$fin_att,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$fin_att,ASFL6selfinbuff$wght)


weighted.mean(ASFL6semhfinbuff$finlit,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$finlit,ASFL6semlfinbuff$wght)

weighted.mean(ASFL6semhfinbuff$fin_know,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$fin_know,ASFL6semlfinbuff$wght)

weighted.mean(ASFL6semhfinbuff$fin_beh,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$fin_beh,ASFL6semlfinbuff$wght)

weighted.mean(ASFL6semhfinbuff$fin_att,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$fin_att,ASFL6semlfinbuff$wght)


weighted.mean(ASFL6sefhfinbuff$finlit,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$finlit,ASFL6seflfinbuff$wght)

weighted.mean(ASFL6sefhfinbuff$fin_know,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$fin_know,ASFL6seflfinbuff$wght)

weighted.mean(ASFL6sefhfinbuff$fin_beh,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$fin_beh,ASFL6seflfinbuff$wght)

weighted.mean(ASFL6sefhfinbuff$fin_att,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$fin_att,ASFL6seflfinbuff$wght)

#financial stress and concern 
weighted.mean(ASFL6sehfinbuff$shortfall,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$shortfall,ASFL6selfinbuff$wght)
weighted.mean(ASFL6sehfinbuff$finstress1,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$finstress1,ASFL6selfinbuff$wght)
weighted.mean(ASFL6sehfinbuff$finstress2,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$finstress2,ASFL6selfinbuff$wght)
weighted.mean(ASFL6sehfinbuff$finstress3,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$finstress3,ASFL6selfinbuff$wght)

weighted.mean(ASFL6sehfinbuff$finfraudd,ASFL6sehfinbuff$wght)
weighted.mean(ASFL6selfinbuff$finfraudd,ASFL6selfinbuff$wght)


weighted.mean(ASFL6semhfinbuff$shortfall,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$shortfall,ASFL6semlfinbuff$wght)
weighted.mean(ASFL6semhfinbuff$finstress1,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$finstress1,ASFL6semlfinbuff$wght)
weighted.mean(ASFL6semhfinbuff$finstress2,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$finstress2,ASFL6semlfinbuff$wght)
weighted.mean(ASFL6semhfinbuff$finstress3,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$finstress3,ASFL6semlfinbuff$wght)

weighted.mean(ASFL6semhfinbuff$finfraudd,ASFL6semhfinbuff$wght)
weighted.mean(ASFL6semlfinbuff$finfraudd,ASFL6semlfinbuff$wght)


weighted.mean(ASFL6sefhfinbuff$shortfall,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$shortfall,ASFL6seflfinbuff$wght)
weighted.mean(ASFL6sefhfinbuff$finstress1,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$finstress1,ASFL6seflfinbuff$wght)
weighted.mean(ASFL6sefhfinbuff$finstress2,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$finstress2,ASFL6seflfinbuff$wght)
weighted.mean(ASFL6sefhfinbuff$finstress3,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$finstress3,ASFL6seflfinbuff$wght)

weighted.mean(ASFL6sefhfinbuff$finfraudd,ASFL6sefhfinbuff$wght)
weighted.mean(ASFL6seflfinbuff$finfraudd,ASFL6seflfinbuff$wght)

##########################employed##########################
ASFL6ehfinbuff <- ASFL6e[(ASFL6e$QF13 %in% hfinbuff),]
ASFL6elfinbuff <- ASFL6e[(ASFL6e$QF13 %in% lfinbuff),]
ASFL6emhfinbuff <- ASFL6em[(ASFL6em$QF13 %in% hfinbuff),]
ASFL6emlfinbuff <- ASFL6em[(ASFL6em$QF13 %in% lfinbuff),]
ASFL6efhfinbuff <- ASFL6ef[(ASFL6ef$QF13 %in% hfinbuff),]
ASFL6eflfinbuff <- ASFL6ef[(ASFL6ef$QF13 %in% lfinbuff),]
#high financial savings
weighted.mean(ASFL6ehfinbuff$finlit,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$finlit,ASFL6elfinbuff$wght)

weighted.mean(ASFL6ehfinbuff$fin_know,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$fin_know,ASFL6elfinbuff$wght)

weighted.mean(ASFL6ehfinbuff$fin_beh,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$fin_beh,ASFL6elfinbuff$wght)

weighted.mean(ASFL6ehfinbuff$fin_att,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$fin_att,ASFL6elfinbuff$wght)


weighted.mean(ASFL6emhfinbuff$finlit,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$finlit,ASFL6emlfinbuff$wght)

weighted.mean(ASFL6emhfinbuff$fin_know,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$fin_know,ASFL6emlfinbuff$wght)

weighted.mean(ASFL6emhfinbuff$fin_beh,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$fin_beh,ASFL6emlfinbuff$wght)

weighted.mean(ASFL6emhfinbuff$fin_att,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$fin_att,ASFL6emlfinbuff$wght)


weighted.mean(ASFL6efhfinbuff$finlit,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$finlit,ASFL6eflfinbuff$wght)

weighted.mean(ASFL6efhfinbuff$fin_know,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$fin_know,ASFL6eflfinbuff$wght)

weighted.mean(ASFL6efhfinbuff$fin_beh,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$fin_beh,ASFL6eflfinbuff$wght)

weighted.mean(ASFL6efhfinbuff$fin_att,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$fin_att,ASFL6eflfinbuff$wght)

#financial stress and concern 
weighted.mean(ASFL6ehfinbuff$shortfall,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$shortfall,ASFL6elfinbuff$wght)
weighted.mean(ASFL6ehfinbuff$finstress1,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$finstress1,ASFL6elfinbuff$wght)
weighted.mean(ASFL6ehfinbuff$finstress2,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$finstress2,ASFL6elfinbuff$wght)
weighted.mean(ASFL6ehfinbuff$finstress3,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$finstress3,ASFL6elfinbuff$wght)

weighted.mean(ASFL6ehfinbuff$finfraudd,ASFL6ehfinbuff$wght)
weighted.mean(ASFL6elfinbuff$finfraudd,ASFL6elfinbuff$wght)


weighted.mean(ASFL6emhfinbuff$shortfall,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$shortfall,ASFL6emlfinbuff$wght)
weighted.mean(ASFL6emhfinbuff$finstress1,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$finstress1,ASFL6emlfinbuff$wght)
weighted.mean(ASFL6emhfinbuff$finstress2,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$finstress2,ASFL6emlfinbuff$wght)
weighted.mean(ASFL6emhfinbuff$finstress3,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$finstress3,ASFL6emlfinbuff$wght)

weighted.mean(ASFL6emhfinbuff$finfraudd,ASFL6emhfinbuff$wght)
weighted.mean(ASFL6emlfinbuff$finfraudd,ASFL6emlfinbuff$wght)


weighted.mean(ASFL6efhfinbuff$shortfall,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$shortfall,ASFL6eflfinbuff$wght)
weighted.mean(ASFL6efhfinbuff$finstress1,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$finstress1,ASFL6eflfinbuff$wght)
weighted.mean(ASFL6efhfinbuff$finstress2,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$finstress2,ASFL6eflfinbuff$wght)
weighted.mean(ASFL6efhfinbuff$finstress3,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$finstress3,ASFL6eflfinbuff$wght)

weighted.mean(ASFL6efhfinbuff$finfraudd,ASFL6efhfinbuff$wght)
weighted.mean(ASFL6eflfinbuff$finfraudd,ASFL6eflfinbuff$wght)


##############################GENDER DIFFERENCES financial indicators ############

###selfemployed
ASFL6sem <- ASFL6se[(ASFL6se$QD1 %in% male),]
ASFL6sef <- ASFL6se[(ASFL6se$QD1 %in% female),]
#male
weighted.mean(ASFL6sem$finlit,ASFL6sem$wght)
weighted.mean(ASFL6sem$fin_know,ASFL6sem$wght)
weighted.mean(ASFL6sem$fin_know_add,ASFL6sem$wght)
weighted.mean(ASFL6sem$fin_beh,ASFL6sem$wght)
weighted.mean(ASFL6sem$fin_att,ASFL6sem$wght)

wpct(ASFL6sem$produse,ASFL6sem$wght, na.rm=TRUE)
1-0.01663340- 0.01517251
wpct(ASFL6sem$savinred,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$payprodd,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$p1b10,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$credpd,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$recentchoiced,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$famfriend,ASFL6sem$wght, na.rm=TRUE)

weighted.mean(ASFL6sem$finwellbeing,ASFL6sem$wght)

wpct(ASFL6sem$QF13,ASFL6sem$wght, na.rm=TRUE)
0.21019579  +0.54237185  
wpct(ASFL6sem$finfraudd,ASFL6sem$wght, na.rm=TRUE)

wpct(ASFL6sem$shortfall,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$finstress1,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$finstress2,ASFL6sem$wght, na.rm=TRUE)
wpct(ASFL6sem$finstress3,ASFL6sem$wght, na.rm=TRUE)

#female
weighted.mean(ASFL6sef$finlit,ASFL6sef$wght)
weighted.mean(ASFL6sef$fin_know,ASFL6sef$wght)
weighted.mean(ASFL6sef$fin_know_add,ASFL6sef$wght)
weighted.mean(ASFL6sef$fin_beh,ASFL6sef$wght)
weighted.mean(ASFL6sef$fin_att,ASFL6sef$wght)

wpct(ASFL6sef$produse,ASFL6sef$wght, na.rm=TRUE)
1-0.03057546 
wpct(ASFL6sef$savinred,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$payprodd,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$p1b10,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$credpd,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$recentchoiced,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$famfriend,ASFL6sef$wght, na.rm=TRUE)

weighted.mean(ASFL6sef$finwellbeing,ASFL6sef$wght)

wpct(ASFL6sef$QF13,ASFL6sef$wght, na.rm=TRUE)
0.21569250   +0.32039232  
wpct(ASFL6sef$finfraudd,ASFL6sef$wght, na.rm=TRUE)

wpct(ASFL6sef$shortfall,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$finstress1,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$finstress2,ASFL6sef$wght, na.rm=TRUE)
wpct(ASFL6sef$finstress3,ASFL6sef$wght, na.rm=TRUE)

##employed
#male
weighted.mean(ASFL6em$finlit,ASFL6em$wght)
weighted.mean(ASFL6em$fin_know,ASFL6em$wght)
weighted.mean(ASFL6em$fin_know_add,ASFL6em$wght)
weighted.mean(ASFL6em$fin_beh,ASFL6em$wght)
weighted.mean(ASFL6em$fin_att,ASFL6em$wght)

wpct(ASFL6em$produse,ASFL6em$wght, na.rm=TRUE)
1-0.012434899 -0.016887064- 0.027976337
wpct(ASFL6em$savinred,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$payprodd,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$p1b10,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$credpd,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$recentchoiced,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$famfriend,ASFL6em$wght, na.rm=TRUE)

weighted.mean(ASFL6em$finwellbeing,ASFL6em$wght)

wpct(ASFL6em$QF13,ASFL6em$wght, na.rm=TRUE)
0.21320536  +0.30795281  
wpct(ASFL6em$finfraudd,ASFL6em$wght, na.rm=TRUE)

wpct(ASFL6em$shortfall,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$finstress1,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$finstress2,ASFL6em$wght, na.rm=TRUE)
wpct(ASFL6em$finstress3,ASFL6em$wght, na.rm=TRUE)

#females
weighted.mean(ASFL6ef$finlit,ASFL6ef$wght)
weighted.mean(ASFL6ef$fin_know,ASFL6ef$wght)
weighted.mean(ASFL6ef$fin_know_add,ASFL6ef$wght)
weighted.mean(ASFL6ef$fin_beh,ASFL6ef$wght)
weighted.mean(ASFL6ef$fin_att,ASFL6ef$wght)

wpct(ASFL6ef$produse,ASFL6ef$wght, na.rm=TRUE)
1-0.014116070 -0.003766211 -0.028318376
wpct(ASFL6ef$savinred,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$payprodd,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$p1b10,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$credpd,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$recentchoiced,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$famfriend,ASFL6ef$wght, na.rm=TRUE)

weighted.mean(ASFL6ef$finwellbeing,ASFL6ef$wght)

wpct(ASFL6ef$QF13,ASFL6ef$wght, na.rm=TRUE)
0.25480653  +0.25635277  
wpct(ASFL6ef$finfraudd,ASFL6ef$wght, na.rm=TRUE)

wpct(ASFL6ef$shortfall,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$finstress1,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$finstress2,ASFL6ef$wght, na.rm=TRUE)
wpct(ASFL6ef$finstress3,ASFL6ef$wght, na.rm=TRUE)

##############################EDUCATION DIFFERENCES financial indicators ############
###selfemployed
ASFL6sehigheduc <- ASFL6se[(ASFL6se$education %in% heduc),]
ASFL6seloweduc <- ASFL6se[(ASFL6se$education %in% leduc),]
#higheducation
weighted.mean(ASFL6sehigheduc$finlit,ASFL6sehigheduc$wght)
weighted.mean(ASFL6sehigheduc$fin_know,ASFL6sehigheduc$wght)
weighted.mean(ASFL6sehigheduc$fin_know_add,ASFL6sehigheduc$wght)
weighted.mean(ASFL6sehigheduc$fin_beh,ASFL6sehigheduc$wght)
weighted.mean(ASFL6sehigheduc$fin_att,ASFL6sehigheduc$wght)

wpct(ASFL6sehigheduc$produse,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$savinred,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$payprodd,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$p1b10,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$credpd,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$recentchoiced,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$famfriend,ASFL6sehigheduc$wght, na.rm=TRUE)

weighted.mean(ASFL6sehigheduc$finwellbeing,ASFL6sehigheduc$wght)

wpct(ASFL6sehigheduc$QF13,ASFL6sehigheduc$wght, na.rm=TRUE)
0.30488454 +0.47935957 
wpct(ASFL6sehigheduc$finfraudd,ASFL6sehigheduc$wght, na.rm=TRUE)

wpct(ASFL6sehigheduc$shortfall,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$finstress1,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$finstress2,ASFL6sehigheduc$wght, na.rm=TRUE)
wpct(ASFL6sehigheduc$finstress3,ASFL6sehigheduc$wght, na.rm=TRUE)

#loweducation
weighted.mean(ASFL6seloweduc$finlit,ASFL6seloweduc$wght)
weighted.mean(ASFL6seloweduc$fin_know,ASFL6seloweduc$wght)
weighted.mean(ASFL6seloweduc$fin_know_add,ASFL6seloweduc$wght)
weighted.mean(ASFL6seloweduc$fin_beh,ASFL6seloweduc$wght)
weighted.mean(ASFL6seloweduc$fin_att,ASFL6seloweduc$wght)

wpct(ASFL6seloweduc$produse,ASFL6seloweduc$wght, na.rm=TRUE)
1-0.01729779- 0.03741043
wpct(ASFL6seloweduc$savinred,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$payprodd,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$p1b10,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$credpd,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$recentchoiced,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$famfriend,ASFL6seloweduc$wght, na.rm=TRUE)

weighted.mean(ASFL6seloweduc$finwellbeing,ASFL6seloweduc$wght)

wpct(ASFL6seloweduc$QF13,ASFL6seloweduc$wght, na.rm=TRUE)
0.15267947  +0.44715041 
wpct(ASFL6seloweduc$finfraudd,ASFL6seloweduc$wght, na.rm=TRUE)

wpct(ASFL6seloweduc$shortfall,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$finstress1,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$finstress2,ASFL6seloweduc$wght, na.rm=TRUE)
wpct(ASFL6seloweduc$finstress3,ASFL6seloweduc$wght, na.rm=TRUE)

##employed
ASFL6ehigheduc <- ASFL6e[(ASFL6e$education %in% heduc),]
ASFL6eloweduc <- ASFL6e[(ASFL6e$education %in% leduc),]
#higheducation
weighted.mean(ASFL6ehigheduc$finlit,ASFL6ehigheduc$wght)
weighted.mean(ASFL6ehigheduc$fin_know,ASFL6ehigheduc$wght)
weighted.mean(ASFL6ehigheduc$fin_know_add,ASFL6ehigheduc$wght)
weighted.mean(ASFL6ehigheduc$fin_beh,ASFL6ehigheduc$wght)
weighted.mean(ASFL6ehigheduc$fin_att,ASFL6ehigheduc$wght)

wpct(ASFL6ehigheduc$produse,ASFL6ehigheduc$wght, na.rm=TRUE)
1-0.013230582- 0.005814360- 0.004625973
wpct(ASFL6ehigheduc$savinred,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$payprodd,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$p1b10,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$credpd,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$recentchoiced,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$famfriend,ASFL6ehigheduc$wght, na.rm=TRUE)

weighted.mean(ASFL6ehigheduc$finwellbeing,ASFL6ehigheduc$wght)

wpct(ASFL6ehigheduc$QF13,ASFL6ehigheduc$wght, na.rm=TRUE)
0.263778084 +0.435235931 
wpct(ASFL6ehigheduc$finfraudd,ASFL6ehigheduc$wght, na.rm=TRUE)

wpct(ASFL6ehigheduc$shortfall,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$finstress1,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$finstress2,ASFL6ehigheduc$wght, na.rm=TRUE)
wpct(ASFL6ehigheduc$finstress3,ASFL6ehigheduc$wght, na.rm=TRUE)

#loweducation
weighted.mean(ASFL6eloweduc$finlit,ASFL6eloweduc$wght)
weighted.mean(ASFL6eloweduc$fin_know,ASFL6eloweduc$wght)
weighted.mean(ASFL6eloweduc$fin_know_add,ASFL6eloweduc$wght)
weighted.mean(ASFL6eloweduc$fin_beh,ASFL6eloweduc$wght)
weighted.mean(ASFL6eloweduc$fin_att,ASFL6eloweduc$wght)

wpct(ASFL6eloweduc$produse,ASFL6eloweduc$wght, na.rm=TRUE)
1-0.01371346- 0.01316100- 0.04016817
wpct(ASFL6eloweduc$savinred,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$payprodd,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$p1b10,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$credpd,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$recentchoiced,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$famfriend,ASFL6eloweduc$wght, na.rm=TRUE)

weighted.mean(ASFL6eloweduc$finwellbeing,ASFL6eloweduc$wght)

wpct(ASFL6eloweduc$QF13,ASFL6eloweduc$wght, na.rm=TRUE)
0.22102786 +0.21036784 
wpct(ASFL6eloweduc$finfraudd,ASFL6eloweduc$wght, na.rm=TRUE)

wpct(ASFL6eloweduc$shortfall,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$finstress1,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$finstress2,ASFL6eloweduc$wght, na.rm=TRUE)
wpct(ASFL6eloweduc$finstress3,ASFL6eloweduc$wght, na.rm=TRUE)


##############################EDUCATION specific DIFFERENCES financial indicators ############
####self-employed
ASFL6seprimary <- ASFL6se[(ASFL6se$educationspecific_1 %in% primary ),]
ASFL6selowersec <- ASFL6se[(ASFL6se$educationspecific_1 %in% lowersec),]
ASFL6seuppersec <- ASFL6se[(ASFL6se$educationspecific_1 %in% uppersec),]
ASFL6seuniversity <- ASFL6se[(ASFL6se$educationspecific_1 %in% university),]
ASFL6seAkademie <- ASFL6se[(ASFL6se$educationspecific_1 %in% akademie),]

#primary
weighted.mean(ASFL6seprimary$finlit,ASFL6seprimary$wght)
weighted.mean(ASFL6seprimary$fin_know,ASFL6seprimary$wght)
weighted.mean(ASFL6seprimary$fin_know_add,ASFL6seprimary$wght)
weighted.mean(ASFL6seprimary$fin_beh,ASFL6seprimary$wght)
weighted.mean(ASFL6seprimary$fin_att,ASFL6seprimary$wght)

wpct(ASFL6seprimary$produse,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$savinred,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$payprodd,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$p1b10,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$credpd,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$recentchoiced,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$famfriend,ASFL6seprimary$wght, na.rm=TRUE)

weighted.mean(ASFL6seprimary$finwellbeing,ASFL6seprimary$wght)

wpct(ASFL6seprimary$QF13,ASFL6seprimary$wght, na.rm=TRUE)
0.3187349 +0.4075343
wpct(ASFL6seprimary$finfraudd,ASFL6seprimary$wght, na.rm=TRUE)

wpct(ASFL6seprimary$shortfall,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$finstress1,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$finstress2,ASFL6seprimary$wght, na.rm=TRUE)
wpct(ASFL6seprimary$finstress3,ASFL6seprimary$wght, na.rm=TRUE)
#lowersec
weighted.mean(ASFL6selowersec$finlit,ASFL6selowersec$wght)
weighted.mean(ASFL6selowersec$fin_know,ASFL6selowersec$wght)
weighted.mean(ASFL6selowersec$fin_know_add,ASFL6selowersec$wght)
weighted.mean(ASFL6selowersec$fin_beh,ASFL6selowersec$wght)
weighted.mean(ASFL6selowersec$fin_att,ASFL6selowersec$wght)

wpct(ASFL6selowersec$produse,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$savinred,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$payprodd,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$p1b10,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$credpd,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$recentchoiced,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$famfriend,ASFL6selowersec$wght, na.rm=TRUE)

weighted.mean(ASFL6selowersec$finwellbeing,ASFL6selowersec$wght)

wpct(ASFL6selowersec$QF13,ASFL6selowersec$wght, na.rm=TRUE)
0.13552516 +0.45124295 
wpct(ASFL6selowersec$finfraudd,ASFL6selowersec$wght, na.rm=TRUE)

wpct(ASFL6selowersec$shortfall,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$finstress1,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$finstress2,ASFL6selowersec$wght, na.rm=TRUE)
wpct(ASFL6selowersec$finstress3,ASFL6selowersec$wght, na.rm=TRUE)
#uppersec
weighted.mean(ASFL6seuppersec$finlit,ASFL6seuppersec$wght)
weighted.mean(ASFL6seuppersec$fin_know,ASFL6seuppersec$wght)
weighted.mean(ASFL6seuppersec$fin_know_add,ASFL6seuppersec$wght)
weighted.mean(ASFL6seuppersec$fin_beh,ASFL6seuppersec$wght)
weighted.mean(ASFL6seuppersec$fin_att,ASFL6seuppersec$wght)

wpct(ASFL6seuppersec$produse,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$savinred,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$payprodd,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$p1b10,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$credpd,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$recentchoiced,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$famfriend,ASFL6seuppersec$wght, na.rm=TRUE)

weighted.mean(ASFL6seuppersec$finwellbeing,ASFL6seuppersec$wght)

wpct(ASFL6seuppersec$QF13,ASFL6seuppersec$wght, na.rm=TRUE)
0.42679387+ 0.34847433
wpct(ASFL6seuppersec$finfraudd,ASFL6seuppersec$wght, na.rm=TRUE)

wpct(ASFL6seuppersec$shortfall,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$finstress1,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$finstress2,ASFL6seuppersec$wght, na.rm=TRUE)
wpct(ASFL6seuppersec$finstress3,ASFL6seuppersec$wght, na.rm=TRUE)
#university
weighted.mean(ASFL6seuniversity$finlit,ASFL6seuniversity$wght)
weighted.mean(ASFL6seuniversity$fin_know,ASFL6seuniversity$wght)
weighted.mean(ASFL6seuniversity$fin_know_add,ASFL6seuniversity$wght)
weighted.mean(ASFL6seuniversity$fin_beh,ASFL6seuniversity$wght)
weighted.mean(ASFL6seuniversity$fin_att,ASFL6seuniversity$wght)

wpct(ASFL6seuniversity$produse,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$savinred,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$payprodd,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$p1b10,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$credpd,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$recentchoiced,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$famfriend,ASFL6seuniversity$wght, na.rm=TRUE)

weighted.mean(ASFL6seuniversity$finwellbeing,ASFL6seuniversity$wght)

wpct(ASFL6seuniversity$QF13,ASFL6seuniversity$wght, na.rm=TRUE)
0.24005966 +0.54895735 
wpct(ASFL6seuniversity$finfraudd,ASFL6seuniversity$wght, na.rm=TRUE)

wpct(ASFL6seuniversity$shortfall,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$finstress1,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$finstress2,ASFL6seuniversity$wght, na.rm=TRUE)
wpct(ASFL6seuniversity$finstress3,ASFL6seuniversity$wght, na.rm=TRUE)

#Akademie
weighted.mean(ASFL6seAkademie$finlit,ASFL6seAkademie$wght)
weighted.mean(ASFL6seAkademie$fin_know,ASFL6seAkademie$wght)
weighted.mean(ASFL6seAkademie$fin_know_add,ASFL6seAkademie$wght)
weighted.mean(ASFL6seAkademie$fin_beh,ASFL6seAkademie$wght)
weighted.mean(ASFL6seAkademie$fin_att,ASFL6seAkademie$wght)

wpct(ASFL6seAkademie$produse,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$savinred,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$payprodd,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$p1b10,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$credpd,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$recentchoiced,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$famfriend,ASFL6seAkademie$wght, na.rm=TRUE)

weighted.mean(ASFL6seAkademie$finwellbeing,ASFL6seAkademie$wght)

wpct(ASFL6seAkademie$QF13,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$finfraudd,ASFL6seAkademie$wght, na.rm=TRUE)

wpct(ASFL6seAkademie$shortfall,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$finstress1,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$finstress2,ASFL6seAkademie$wght, na.rm=TRUE)
wpct(ASFL6seAkademie$finstress3,ASFL6seAkademie$wght, na.rm=TRUE)



####employed
ASFL6eprimary <- ASFL6e[(ASFL6e$educationspecific_1 %in% primary ),]
ASFL6elowersec <- ASFL6e[(ASFL6e$educationspecific_1 %in% lowersec),]
ASFL6euppersec <- ASFL6e[(ASFL6e$educationspecific_1 %in% uppersec),]
ASFL6euniversity <- ASFL6e[(ASFL6e$educationspecific_1 %in% university),]
ASFL6eAkademie <- ASFL6e[(ASFL6e$educationspecific_1 %in% akademie),]

#primary
weighted.mean(ASFL6eprimary$finlit,ASFL6eprimary$wght)
weighted.mean(ASFL6eprimary$fin_know,ASFL6eprimary$wght)
weighted.mean(ASFL6eprimary$fin_know_add,ASFL6eprimary$wght)
weighted.mean(ASFL6eprimary$fin_beh,ASFL6eprimary$wght)
weighted.mean(ASFL6eprimary$fin_att,ASFL6eprimary$wght)

wpct(ASFL6eprimary$produse,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$savinred,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$payprodd,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$p1b10,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$credpd,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$recentchoiced,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$famfriend,ASFL6eprimary$wght, na.rm=TRUE)

weighted.mean(ASFL6eprimary$finwellbeing,ASFL6eprimary$wght)

wpct(ASFL6eprimary$QF13,ASFL6eprimary$wght, na.rm=TRUE)
0.19168158 +0.09249590 
wpct(ASFL6eprimary$finfraudd,ASFL6eprimary$wght, na.rm=TRUE)

wpct(ASFL6eprimary$shortfall,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$finstress1,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$finstress2,ASFL6eprimary$wght, na.rm=TRUE)
wpct(ASFL6eprimary$finstress3,ASFL6eprimary$wght, na.rm=TRUE)
#lowersec
weighted.mean(ASFL6elowersec$finlit,ASFL6elowersec$wght)
weighted.mean(ASFL6elowersec$fin_know,ASFL6elowersec$wght)
weighted.mean(ASFL6elowersec$fin_know_add,ASFL6elowersec$wght)
weighted.mean(ASFL6elowersec$fin_beh,ASFL6elowersec$wght)
weighted.mean(ASFL6elowersec$fin_att,ASFL6elowersec$wght)

wpct(ASFL6elowersec$produse,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$savinred,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$payprodd,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$p1b10,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$credpd,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$recentchoiced,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$famfriend,ASFL6elowersec$wght, na.rm=TRUE)

weighted.mean(ASFL6elowersec$finwellbeing,ASFL6elowersec$wght)

wpct(ASFL6elowersec$QF13,ASFL6elowersec$wght, na.rm=TRUE)
0.224149710 +0.222907045 
wpct(ASFL6elowersec$finfraudd,ASFL6elowersec$wght, na.rm=TRUE)

wpct(ASFL6elowersec$shortfall,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$finstress1,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$finstress2,ASFL6elowersec$wght, na.rm=TRUE)
wpct(ASFL6elowersec$finstress3,ASFL6elowersec$wght, na.rm=TRUE)
#uppersec
weighted.mean(ASFL6euppersec$finlit,ASFL6euppersec$wght)
weighted.mean(ASFL6euppersec$fin_know,ASFL6euppersec$wght)
weighted.mean(ASFL6euppersec$fin_know_add,ASFL6euppersec$wght)
weighted.mean(ASFL6euppersec$fin_beh,ASFL6euppersec$wght)
weighted.mean(ASFL6euppersec$fin_att,ASFL6euppersec$wght)

wpct(ASFL6euppersec$produse,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$savinred,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$payprodd,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$p1b10,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$credpd,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$recentchoiced,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$famfriend,ASFL6euppersec$wght, na.rm=TRUE)

weighted.mean(ASFL6euppersec$finwellbeing,ASFL6euppersec$wght)

wpct(ASFL6euppersec$QF13,ASFL6euppersec$wght, na.rm=TRUE)
0.268391781 +0.385514835 
wpct(ASFL6euppersec$finfraudd,ASFL6euppersec$wght, na.rm=TRUE)

wpct(ASFL6euppersec$shortfall,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$finstress1,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$finstress2,ASFL6euppersec$wght, na.rm=TRUE)
wpct(ASFL6euppersec$finstress3,ASFL6euppersec$wght, na.rm=TRUE)
#university
weighted.mean(ASFL6euniversity$finlit,ASFL6euniversity$wght)
weighted.mean(ASFL6euniversity$fin_know,ASFL6euniversity$wght)
weighted.mean(ASFL6euniversity$fin_know_add,ASFL6euniversity$wght)
weighted.mean(ASFL6euniversity$fin_beh,ASFL6euniversity$wght)
weighted.mean(ASFL6euniversity$fin_att,ASFL6euniversity$wght)

wpct(ASFL6euniversity$produse,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$savinred,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$payprodd,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$p1b10,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$credpd,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$recentchoiced,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$famfriend,ASFL6euniversity$wght, na.rm=TRUE)

weighted.mean(ASFL6euniversity$finwellbeing,ASFL6euniversity$wght)

wpct(ASFL6euniversity$QF13,ASFL6euniversity$wght, na.rm=TRUE)
0.255844736 +0.520732388 
wpct(ASFL6euniversity$finfraudd,ASFL6euniversity$wght, na.rm=TRUE)

wpct(ASFL6euniversity$shortfall,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$finstress1,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$finstress2,ASFL6euniversity$wght, na.rm=TRUE)
wpct(ASFL6euniversity$finstress3,ASFL6euniversity$wght, na.rm=TRUE)

#Akademie
weighted.mean(ASFL6eAkademie$finlit,ASFL6eAkademie$wght)
weighted.mean(ASFL6eAkademie$fin_know,ASFL6eAkademie$wght)
weighted.mean(ASFL6eAkademie$fin_know_add,ASFL6eAkademie$wght)
weighted.mean(ASFL6eAkademie$fin_beh,ASFL6eAkademie$wght)
weighted.mean(ASFL6eAkademie$fin_att,ASFL6eAkademie$wght)

wpct(ASFL6eAkademie$produse,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$savinred,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$payprodd,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$p1b10,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$credpd,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$recentchoiced,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$famfriend,ASFL6eAkademie$wght, na.rm=TRUE)

weighted.mean(ASFL6eAkademie$finwellbeing,ASFL6eAkademie$wght)

wpct(ASFL6eAkademie$QF13,ASFL6eAkademie$wght, na.rm=TRUE)
0.1727468 + 0.3185088 
wpct(ASFL6eAkademie$finfraudd,ASFL6eAkademie$wght, na.rm=TRUE)

wpct(ASFL6eAkademie$shortfall,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$finstress1,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$finstress2,ASFL6eAkademie$wght, na.rm=TRUE)
wpct(ASFL6eAkademie$finstress3,ASFL6eAkademie$wght, na.rm=TRUE)



##############################AGE DIFFERENCES financial indicators ############
##self-employed
ASFL6seoldmill <- ASFL6se[(ASFL6se$age_group %in% oldmill),]
ASFL6segenx <- ASFL6se[(ASFL6se$age_group %in% genx),]
ASFL6sebabyboom <- ASFL6se[(ASFL6se$age_group %in% babyboom),]
#old millennials
weighted.mean(ASFL6seoldmill$finlit,ASFL6seoldmill$wght)
weighted.mean(ASFL6seoldmill$fin_know,ASFL6seoldmill$wght)
weighted.mean(ASFL6seoldmill$fin_know_add,ASFL6seoldmill$wght)
weighted.mean(ASFL6seoldmill$fin_beh,ASFL6seoldmill$wght)
weighted.mean(ASFL6seoldmill$fin_att,ASFL6seoldmill$wght)

wpct(ASFL6seoldmill$produse,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$savinred,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$payprodd,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$p1b10,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$credpd,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$recentchoiced,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$famfriend,ASFL6seoldmill$wght, na.rm=TRUE)

weighted.mean(ASFL6seoldmill$finwellbeing,ASFL6seoldmill$wght)

wpct(ASFL6seoldmill$QF13,ASFL6seoldmill$wght, na.rm=TRUE)
0.6419943 +0.2088144 
wpct(ASFL6seoldmill$finfraudd,ASFL6seoldmill$wght, na.rm=TRUE)

wpct(ASFL6seoldmill$shortfall,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$finstress1,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$finstress2,ASFL6seoldmill$wght, na.rm=TRUE)
wpct(ASFL6seoldmill$finstress3,ASFL6seoldmill$wght, na.rm=TRUE)


wpct(ASFL6seoldmill$QK1,ASFL6seoldmill$wght, na.rm=TRUE)

#generationx
weighted.mean(ASFL6segenx$finlit,ASFL6segenx$wght)
weighted.mean(ASFL6segenx$fin_know,ASFL6segenx$wght)
weighted.mean(ASFL6segenx$fin_know_add,ASFL6segenx$wght)
weighted.mean(ASFL6segenx$fin_beh,ASFL6segenx$wght)
weighted.mean(ASFL6segenx$fin_att,ASFL6segenx$wght)

wpct(ASFL6segenx$produse,ASFL6segenx$wght, na.rm=TRUE)
1-0.01100897 
wpct(ASFL6segenx$savinred,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$payprodd,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$p1b10,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$credpd,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$recentchoiced,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$famfriend,ASFL6segenx$wght, na.rm=TRUE)

weighted.mean(ASFL6segenx$finwellbeing,ASFL6segenx$wght)

wpct(ASFL6segenx$QF13,ASFL6segenx$wght, na.rm=TRUE)

wpct(ASFL6segenx$finfraudd,ASFL6segenx$wght, na.rm=TRUE)

wpct(ASFL6segenx$shortfall,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$finstress1,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$finstress2,ASFL6segenx$wght, na.rm=TRUE)
wpct(ASFL6segenx$finstress3,ASFL6segenx$wght, na.rm=TRUE)

wpct(ASFL6segenx$QK1,ASFL6segenx$wght, na.rm=TRUE)

#babyboomer
weighted.mean(ASFL6sebabyboom$finlit,ASFL6sebabyboom$wght)
weighted.mean(ASFL6sebabyboom$fin_know,ASFL6sebabyboom$wght)
weighted.mean(ASFL6sebabyboom$fin_know_add,ASFL6sebabyboom$wght)
weighted.mean(ASFL6sebabyboom$fin_beh,ASFL6sebabyboom$wght)
weighted.mean(ASFL6sebabyboom$fin_att,ASFL6sebabyboom$wght)

wpct(ASFL6sebabyboom$produse,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$savinred,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$payprodd,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$p1b10,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$credpd,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$recentchoiced,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$famfriend,ASFL6sebabyboom$wght, na.rm=TRUE)

weighted.mean(ASFL6sebabyboom$finwellbeing,ASFL6sebabyboom$wght)

wpct(ASFL6sebabyboom$QF13,ASFL6sebabyboom$wght, na.rm=TRUE)

wpct(ASFL6sebabyboom$finfraudd,ASFL6sebabyboom$wght, na.rm=TRUE)

wpct(ASFL6sebabyboom$shortfall,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$finstress1,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$finstress2,ASFL6sebabyboom$wght, na.rm=TRUE)
wpct(ASFL6sebabyboom$finstress3,ASFL6sebabyboom$wght, na.rm=TRUE)

wpct(ASFL6sebabyboom$QK1,ASFL6sebabyboom$wght, na.rm=TRUE)

##employed
ASFL6eyoungmill <- ASFL6e[(ASFL6e$age_group %in% youngmill),]
ASFL6eoldmill <- ASFL6e[(ASFL6e$age_group %in% oldmill),]
ASFL6egenx <- ASFL6e[(ASFL6e$age_group %in% genx),]
ASFL6ebabyboom <- ASFL6e[(ASFL6e$age_group %in% babyboom),]
ASFL6esilgen <- ASFL6e[(ASFL6e$age_group %in% silgen),]
#young millennials 
weighted.mean(ASFL6eyoungmill$finlit,ASFL6eyoungmill$wght)
weighted.mean(ASFL6eyoungmill$fin_know,ASFL6eyoungmill$wght)
weighted.mean(ASFL6eyoungmill$fin_know_add,ASFL6eyoungmill$wght)
weighted.mean(ASFL6eyoungmill$fin_beh,ASFL6eyoungmill$wght)
weighted.mean(ASFL6eyoungmill$fin_att,ASFL6eyoungmill$wght)

wpct(ASFL6eyoungmill$produse,ASFL6eyoungmill$wght, na.rm=TRUE)
1-0.026067015- 0.026186010- 0.025585653
wpct(ASFL6eyoungmill$savinred,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$payprodd,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$p1b10,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$credpd,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$recentchoiced,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$famfriend,ASFL6eyoungmill$wght, na.rm=TRUE)

weighted.mean(ASFL6eyoungmill$finwellbeing,ASFL6eyoungmill$wght)

wpct(ASFL6eyoungmill$QF13,ASFL6eyoungmill$wght, na.rm=TRUE)

wpct(ASFL6eyoungmill$finfraudd,ASFL6eyoungmill$wght, na.rm=TRUE)

wpct(ASFL6eyoungmill$shortfall,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$finstress1,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$finstress2,ASFL6eyoungmill$wght, na.rm=TRUE)
wpct(ASFL6eyoungmill$finstress3,ASFL6eyoungmill$wght, na.rm=TRUE)

wpct(ASFL6eyoungmill$QK1,ASFL6eyoungmill$wght, na.rm=TRUE)
#old millennials
weighted.mean(ASFL6eoldmill$finlit,ASFL6eoldmill$wght)
weighted.mean(ASFL6eoldmill$fin_know,ASFL6eoldmill$wght)
weighted.mean(ASFL6eoldmill$fin_know_add,ASFL6eoldmill$wght)
weighted.mean(ASFL6eoldmill$fin_beh,ASFL6eoldmill$wght)
weighted.mean(ASFL6eoldmill$fin_att,ASFL6eoldmill$wght)

wpct(ASFL6eoldmill$produse,ASFL6eoldmill$wght, na.rm=TRUE)
1-0.006780411 -0.017789871
wpct(ASFL6eoldmill$savinred,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$payprodd,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$p1b10,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$credpd,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$recentchoiced,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$famfriend,ASFL6eoldmill$wght, na.rm=TRUE)

weighted.mean(ASFL6eoldmill$finwellbeing,ASFL6eoldmill$wght)

wpct(ASFL6eoldmill$QF13,ASFL6eoldmill$wght, na.rm=TRUE)
0.22887376 +0.21982290 
wpct(ASFL6eoldmill$finfraudd,ASFL6eoldmill$wght, na.rm=TRUE)

wpct(ASFL6eoldmill$shortfall,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$finstress1,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$finstress2,ASFL6eoldmill$wght, na.rm=TRUE)
wpct(ASFL6eoldmill$finstress3,ASFL6eoldmill$wght, na.rm=TRUE)

wpct(ASFL6eoldmill$QK1,ASFL6eoldmill$wght, na.rm=TRUE)

#generationx
weighted.mean(ASFL6egenx$finlit,ASFL6egenx$wght)
weighted.mean(ASFL6egenx$fin_know,ASFL6egenx$wght)
weighted.mean(ASFL6egenx$fin_know_add,ASFL6egenx$wght)
weighted.mean(ASFL6egenx$fin_beh,ASFL6egenx$wght)
weighted.mean(ASFL6egenx$fin_att,ASFL6egenx$wght)

wpct(ASFL6egenx$produse,ASFL6egenx$wght, na.rm=TRUE)
1-0.012434426- 0.008529126 -0.034150325
wpct(ASFL6egenx$savinred,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$payprodd,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$p1b10,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$credpd,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$recentchoiced,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$famfriend,ASFL6egenx$wght, na.rm=TRUE)

weighted.mean(ASFL6egenx$finwellbeing,ASFL6egenx$wght)

wpct(ASFL6egenx$QF13,ASFL6egenx$wght, na.rm=TRUE)
0.253681795 +0.337342456
wpct(ASFL6egenx$finfraudd,ASFL6egenx$wght, na.rm=TRUE)

wpct(ASFL6egenx$shortfall,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$finstress1,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$finstress2,ASFL6egenx$wght, na.rm=TRUE)
wpct(ASFL6egenx$finstress3,ASFL6egenx$wght, na.rm=TRUE)

wpct(ASFL6egenx$QK1,ASFL6egenx$wght, na.rm=TRUE)

#babyboomer
weighted.mean(ASFL6ebabyboom$finlit,ASFL6ebabyboom$wght)
weighted.mean(ASFL6ebabyboom$fin_know,ASFL6ebabyboom$wght)
weighted.mean(ASFL6ebabyboom$fin_know_add,ASFL6ebabyboom$wght)
weighted.mean(ASFL6ebabyboom$fin_beh,ASFL6ebabyboom$wght)
weighted.mean(ASFL6ebabyboom$fin_att,ASFL6ebabyboom$wght)

wpct(ASFL6ebabyboom$produse,ASFL6ebabyboom$wght, na.rm=TRUE)
1-0.02667173- 0.02760791
wpct(ASFL6ebabyboom$savinred,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$payprodd,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$p1b10,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$credpd,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$recentchoiced,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$famfriend,ASFL6ebabyboom$wght, na.rm=TRUE)

weighted.mean(ASFL6ebabyboom$finwellbeing,ASFL6ebabyboom$wght)

wpct(ASFL6ebabyboom$QF13,ASFL6ebabyboom$wght, na.rm=TRUE)
0.18205470+0.59163253 
wpct(ASFL6ebabyboom$finfraudd,ASFL6ebabyboom$wght, na.rm=TRUE)

wpct(ASFL6ebabyboom$shortfall,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$finstress1,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$finstress2,ASFL6ebabyboom$wght, na.rm=TRUE)
wpct(ASFL6ebabyboom$finstress3,ASFL6ebabyboom$wght, na.rm=TRUE)

wpct(ASFL6ebabyboom$QK1,ASFL6ebabyboom$wght, na.rm=TRUE)

#silentgeneration
weighted.mean(ASFL6esilgen$finlit,ASFL6esilgen$wght)
weighted.mean(ASFL6esilgen$fin_know,ASFL6esilgen$wght)
weighted.mean(ASFL6esilgen$fin_know_add,ASFL6esilgen$wght)
weighted.mean(ASFL6esilgen$fin_beh,ASFL6esilgen$wght)
weighted.mean(ASFL6esilgen$fin_att,ASFL6esilgen$wght)

wpct(ASFL6esilgen$produse,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$savinred,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$payprodd,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$p1b10,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$credpd,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$recentchoiced,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$famfriend,ASFL6esilgen$wght, na.rm=TRUE)

weighted.mean(ASFL6esilgen$finwellbeing,ASFL6esilgen$wght)

wpct(ASFL6esilgen$QF13,ASFL6esilgen$wght, na.rm=TRUE)

wpct(ASFL6esilgen$finfraudd,ASFL6esilgen$wght, na.rm=TRUE)

wpct(ASFL6esilgen$shortfall,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$finstress1,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$finstress2,ASFL6esilgen$wght, na.rm=TRUE)
wpct(ASFL6esilgen$finstress3,ASFL6esilgen$wght, na.rm=TRUE)

wpct(ASFL6esilgen$QK1,ASFL6esilgen$wght, na.rm=TRUE)


####################RISK BEHAVIOUR#############################
#1 variable 
HFCSrisk <- ASFL$HFCS1
table(ASFL$HFCS1)
wpct(ASFL$HFCS1, weight=ASFL$wght, na.rm=TRUE)
HFCSrisk1<- ifelse(ASFL$HFCS1 == "I am prepared to take substantial financial risks expecting to earn substantial returns", 1, 0)
HFCSrisk2<- ifelse(ASFL$HFCS1 == "I am prepared to take above average financial risks expecting to earn above average returns", 1, 0)
HFCSriskd <- HFCSrisk1 + HFCSrisk2
HFCSrisk3<- ifelse(ASFL$HFCS1 == "I am prepared to take average financial risks expecting to earn average returns", 1, 0)
HFCSrisk4<- ifelse(ASFL$HFCS1 == "I am not willing to take any financial risk", 1, 0)
HFCSnriskd <- HFCSrisk3 + HFCSrisk4
table(HFCSriskd)
table(HFCSnriskd)
#alternative - only "no" as no
HFCSriskad <- HFCSrisk1 +HFCSrisk2+HFCSrisk3
HFCSnriskad <- HFCSrisk4
table(HFCSriskad)
table(HFCSnriskad)
riskad <- c("I am prepared to take substantial financial risks expecting to earn substantial returns","I am prepared to take above average financial risks expecting to earn above average returns","I am prepared to take average financial risks expecting to earn average returns")
riskd <- c("I am prepared to take substantial financial risks expecting to earn substantial returns","I am prepared to take above average financial risks expecting to earn above average returns")
nriskad <- c("I am not willing to take any financial risk")
nriskd <- c("I am prepared to take average financial risks expecting to earn average returns","I am not willing to take any financial risk")

HFCSnriskad <- HFCSrisk4
table(HFCSriskad)
table(HFCSnriskad)
ASFL7 <- cbind(ASFL6,HFCSrisk,HFCSrisk1,HFCSrisk2,HFCSrisk3,HFCSrisk4,HFCSriskd,HFCSnriskd,HFCSriskad,HFCSnriskad)


ASFL7 <- ASFL7 %>% mutate(HFCSrisk_group = case_when(HFCSrisk == "I am prepared to take substantial financial risks expecting to earn substantial returns" ~"Substantial" ,
                                                     HFCSrisk == "I am prepared to take above average financial risks expecting to earn above average returns" ~ "High",
                                                     HFCSrisk == "I am prepared to take average financial risks expecting to earn average returns" ~ "Average",
                                                     HFCSrisk == "I am not willing to take any financial risk" ~ "No"))
table(ASFL7$HFCSrisk_group)
HFCSrisk_group_1 <- as.factor(ASFL7$HFCSrisk_group)
levels(HFCSrisk_group_1)
ASFL7 <- within(ASFL7, HFCSrisk_group_1 <- relevel(HFCSrisk_group_1, ref = "No"))

ASFL7 <- ASFL7 %>% mutate(HFCSrisk_groupsankey = case_when(HFCSrisk == "I am prepared to take substantial financial risks expecting to earn substantial returns" ~"Substantial risk" ,
                                                           HFCSrisk == "I am prepared to take above average financial risks expecting to earn above average returns" ~ "High risk",
                                                           HFCSrisk == "I am prepared to take average financial risks expecting to earn average returns" ~ "Average risk",
                                                           HFCSrisk == "I am not willing to take any financial risk" ~ "No risk"))
table(ASFL7$HFCSrisk_groupsankey)
HFCSrisk_group_2 <- as.factor(ASFL7$HFCSrisk_groupsankey)
levels(HFCSrisk_group_2)
ASFL7 <- within(ASFL7, HFCSrisk_group_2 <- relevel(HFCSrisk_group_2, ref = "No risk"))


ASFL7 <- ASFL7 %>% mutate(HFCSriskad_1 = case_when(HFCSriskad == "0" ~"No" ,
                                                   HFCSriskad == "1" ~"At least average"))
table(ASFL7$HFCSriskad_1)
HFCSriskad_2 <- factor(ASFL7$HFCSriskad_1, levels=c("No","At least average"))
ASFL7 <- cbind(ASFL7, HFCSriskad_2)

numericHFCS1<- ifelse(ASFL$HFCS1 == "I am prepared to take substantial financial risks expecting to earn substantial returns", 4, 0)
numericHFCS2<- ifelse(ASFL$HFCS1 == "I am prepared to take above average financial risks expecting to earn above average returns", 3, 0)
numericHFCS3<- ifelse(ASFL$HFCS1 == "I am prepared to take average financial risks expecting to earn average returns", 2, 0)
numericHFCS4<- ifelse(ASFL$HFCS1 == "I am not willing to take any financial risk", 1, 0)

numericHFCSrisk <- numericHFCS1+numericHFCS2+numericHFCS3+numericHFCS4
table(numericHFCSrisk)
ASFL7 <- cbind(ASFL7,numericHFCSrisk)


ASFL7se <- ASFL7[(ASFL7$QD10 %in% se),] 
ASFL7e <- ASFL7[(ASFL7$QD10 %in% e),] 
ASFL7eu <- ASFL7[(ASFL7$QD10 %in% eu),] 
ASFL7oth <-  ASFL7[(ASFL7$QD10 %in% oth),] 
ASFL7othworet <-  ASFL7[(ASFL7$QD10 %in% othworet),] 
ASFL7ret <-  ASFL7[(ASFL7$QD10 %in% ret),] 
ASFL7unempl <-  ASFL7[(ASFL7$QD10 %in% unempl),] 
ASFL7entrepreneurs <-  ASFL7[(ASFL7$QF9_11 %in% entrepreneurs),] 


table(ASFL7se$HFCSrisk_group_1)
table(ASFL7se$HFCSrisk_group_1)/79
table(ASFL7e$HFCSrisk_group_1)
table(ASFL7e$HFCSrisk_group_1)/699
table(ASFL7ret$HFCSrisk_group_1)
table(ASFL7ret$HFCSrisk_group_1)/494
table(ASFL7othworet$HFCSrisk_group_1)
table(ASFL7othworet$HFCSrisk_group_1)/146
table(ASFL7unempl$HFCSrisk_group_1)
table(ASFL7unempl$HFCSrisk_group_1)/50
table(ASFL7entrepreneurs$HFCSrisk_group_1)
table(ASFL7entrepreneurs$HFCSrisk_group_1)/19

###############indicator confidence about retirement planing#################################
retplan <- ASFL$QF8
table(ASFL$QF8)
wpct(ASFL$HFCS1, weight=ASFL$wght, na.rm=TRUE)
QF8_1<- ifelse(ASFL$QF8 == "1 - Very confident", 1, 0)
QF8_2<- ifelse(ASFL$QF8 == "2", 1, 0)
retconf <- QF8_1 + QF8_2
QF8_3 <- ifelse(ASFL$QF8 == "3", 1, 0)
QF8_4<- ifelse(ASFL$QF8 == "4", 1, 0)
QF8_5<- ifelse(ASFL$QF8 == "5 - Not at all confident", 1, 0)
QF8_no<- ifelse(ASFL$QF8 == "Respondent has no retirement plan", 1, 0)
QF8_ref <-  ifelse(ASFL$QF8 == "Refused", 1, 0)
QF8_dok <- ifelse(ASFL$QF8 == "Don't know", 1, 0)
QF8_refdok <- QF8_ref+QF8_dok
table(retconf)
ASFL7 <- cbind(ASFL7,QF8_1,QF8_2,QF8_3,QF8_4,QF8_5,QF8_ref,QF8_dok, QF8_refdok,retconf)

table(ASFLse$QF8)
wpct(ASFLse$QF8, weight=ASFLse$wght, na.rm=TRUE)
wpct(ASFLsem$QF8, weight=ASFLsem$wght, na.rm=TRUE)
wpct(ASFLsef$QF8, weight=ASFLsef$wght, na.rm=TRUE)
table(ASFLe$QF8)
wpct(ASFLe$QF8, weight=ASFLe$wght, na.rm=TRUE)
wpct(ASFLem$QF8, weight=ASFLem$wght, na.rm=TRUE)
wpct(ASFLef$QF8, weight=ASFLef$wght, na.rm=TRUE)
table(ASFLret$QF8)
table(ASFLothworet$QF8)
table(ASFLunempl$QF8)
table(ASFLentrepreneurs$QF8)


table(ASFLse$QF8)/79
table(ASFLe$QF8)/699
table(ASFLret$QF8)/494
table(ASFLothworet$QF8)/146
table(ASFLunempl$QF8)/50
table(ASFLentrepreneurs$QF8)/19

###############designed risk asset holding#################################
#######Risky financial assets - currently holds or used in the last year for active saving###########################
#######Stock, shares & bonds#################
table(ASFL$Qprod1b_11)#stock and shares
table(ASFL$Qprod1b_12)#bonds 
table(ASFL$Qprod1b_15)#crypto
table(ASFL$QF3_5)#bonds and time deposits
table(ASFL$QF3_6)#crypto
table(ASFL$QF3_7)#stock and shares
#recently chose
table(ASFL$Qprod1c_11)#stock and shares
table(ASFL$Qprod1c_12)#bonds 
table(ASFL$Qprod1c_15)#crypto

stockshare <- p1b11 + QF3_7
stockshare_1 <- p1b11 + QF3_7+RC11
stockshared <- ifelse(stockshare >= "1", 1, 0)
stockshare_1d <- ifelse(stockshare_1 >= "1", 1, 0)

bond <- p1b12 + QF3_5
bond_1 <- p1b12 + QF3_5+RC12
bondd <- ifelse(bond >= "1", 1, 0)
bond_1d <- ifelse(bond_1 >= "1", 1, 0)

crypto <- p1b15 + QF3_6 
crypto_1 <-p1b15 + QF3_6 +RC15
cryptod <- ifelse(crypto >= "1", 1, 0)
crypto_1d <- ifelse(crypto_1 >= "1", 1, 0)

ASFL7 <- cbind(ASFL7,stockshared,stockshare_1d,bondd,bond_1d,cryptod,crypto_1d)
table(ASFL7$stockshared)

riskyassets<- p1b11 + p1b12 + p1b15 + QF3_7 + QF3_5 + QF3_6 
table(riskyassets)
riskyassetsd <- ifelse(riskyassets >= "1", 1, 0)
table(riskyassetsd)
riskyassets_1<- p1b11 + p1b12 + p1b15 + QF3_7 + QF3_5 + QF3_6 + RC11+ RC12 + RC15
table(riskyassets_1)
riskyassets_1d <- ifelse(riskyassets_1 >= "1", 1, 0)
table(riskyassets_1d)
ASFL7 <- cbind(ASFL7,riskyassets,riskyassetsd,riskyassets_1,riskyassets_1d)

table(ASFL7se$riskyassetsd)
table(ASFL7se$riskyassetsd)/79
table(ASFL7e$riskyassetsd)
table(ASFL7e$riskyassetsd)/699
table(ASFL7ret$riskyassetsd)
table(ASFL7ret$riskyassetsd)/494
table(ASFL7othworet$riskyassetsd)
table(ASFL7othworet$riskyassetsd)/146
table(ASFL7unempl$riskyassetsd)
table(ASFL7unempl$riskyassetsd)/50
table(ASFL7entrepreneurs$riskyassetsd)
table(ASFL7entrepreneurs$riskyassetsd)/19


ASFL7 <- ASFL7 %>% mutate(riskyassets_group = case_when(riskyassetsd == "0" ~"No" ,
                                                        riskyassetsd == "1" ~"At least one"))
table(ASFL7$riskyassets_group)
riskyassets1_group <- factor(ASFL7$riskyassets_group, levels=c("At least one","No"))
riskyassets2_group <- factor(ASFL7$riskyassets_group, levels=c("No","At least one"))
ASFL7 <- cbind(ASFL7, riskyassets1_group,riskyassets2_group)


####RISK ATTITUDE I am prepared to risk some of my own money when saving or making an investment
summary(ASFL$QS1_2)
QS1_2 <-ASFL$QS1_2
QS1_2_1_rec <- ifelse(QS1_2== "Refused", 1, 0)
QS1_2_2_rec <- ifelse(QS1_2 == "Not relevant", 1, 0)
QS1_2_3_rec <- ifelse(QS1_2 == "Don't know", 1, 0)

QS1_2_1 <- ifelse(QS1_2 == "Completely agree",1, 0)
QS1_2_2 <- ifelse(QS1_2 == "2",1, 0)
QS1_2risk <- QS1_2_1 + QS1_2_2
QS1_2_3 <- ifelse(QS1_2 == "3",1, 0)
QS1_2neithernor <- QS1_2_1_rec+QS1_2_2_rec+QS1_2_3_rec+QS1_2_3
QS1_2_4 <- ifelse(QS1_2 == "4",1, 0)
QS1_2_5 <- ifelse(QS1_2 == "Completely disagree",1, 0)
QS1_2nrisk <- QS1_2_4 + QS1_2_5
table(QS1_2risk)
table(QS1_2nrisk)
table(QS1_2neithernor)
ASFL7 <- cbind(ASFL7,QS1_2risk)

ASFL7 <- ASFL7 %>% mutate(QS1_2risk_group = case_when(QS1_2 == "Refused" ~"Ref/Don't know" ,
                                                      QS1_2 == "Not relevant" ~"Ref/Don't know" ,
                                                      QS1_2 == "Don't know" ~"Ref/Don't know" ,
                                                      QS1_2 == "Completely agree" ~"Substantial risk" ,
                                                      QS1_2 == "2" ~"High risk" ,
                                                      QS1_2 == "3" ~"Average risk" ,
                                                      QS1_2 == "4" ~"Average risk" ,
                                                      QS1_2 == "Completely disagree" ~"No risk"))
table(ASFL7$QS1_2risk_group)
QS1_2risk_group_1 <- factor(ASFL7$QS1_2risk_group, levels=c("No risk","Ref/Don't know","Average risk","High risk","Substantial risk"))
levels(QS1_2risk_group_1)
ASFL7 <- cbind(ASFL7, QS1_2risk_group_1)

numericQS1_2_1<- ifelse(ASFL$QS1_2 == "Completely agree", 4, 0)
numericQS1_2_2<- ifelse(ASFL$QS1_2 == "2", 3, 0)
numericQS1_2_3<- ifelse(ASFL$QS1_2 == "3", 2, 0)
numericQS1_2_4<- ifelse(ASFL$QS1_2 == "4", 2, 0)
numericQS1_2_5<- ifelse(ASFL$QS1_2 == "Completely disagree", 1, 0)


numericQS1_2 <- numericQS1_2_1+numericQS1_2_2+numericQS1_2_3+numericQS1_2_4+numericQS1_2_5
table(numericQS1_2)
ASFL7 <- cbind(ASFL7,numericQS1_2)

#problematic to but into one score - HFCS and assets separately
riskscore <- bondd+stockshared+cryptod+HFCSriskd+QS1_2risk
table(riskscore)
highriskscored <- ifelse(riskscore >= "2", 1, 0)
lowriskscored <- ifelse(riskscore < "2", 1, 0)

ASFL7 <- cbind(ASFL7,highriskscored,lowriskscored)
ASFL7risk <-  ASFL7[(ASFL7$HFCS1 %in% riskad),]
ASFL7nrisk <-  ASFL7[(ASFL7$HFCS1 %in% nriskad),]
ASFL7m <- ASFL7[(ASFL7$QD1 %in% male),]
ASFL7f <- ASFL7[(ASFL7$QD1 %in% female),]
ASFL7mrisk <- ASFL7m[(ASFL7m$HFCS1 %in% riskad),]
ASFL7mnrisk <- ASFL7m[(ASFL7m$HFCS1 %in% nriskad),]
ASFL7frisk <- ASFL7f[(ASFL7f$HFCS1 %in% riskad),]
ASFL7fnrisk <- ASFL7f[(ASFL7f$HFCS1 %in% nriskad),]
ASFL7se <- ASFL7[(ASFL7$QD10 %in% se),] 
ASFL7sem <- ASFL7se[(ASFL7se$QD1 %in% male),]
ASFL7sef <- ASFL7se[(ASFL7se$QD1 %in% female),]
ASFL7e <- ASFL7[(ASFL7$QD10 %in% e),] 
ASFL7em <- ASFL7e[(ASFL7e$QD1 %in% male),]
ASFL7ef <- ASFL7e[(ASFL7e$QD1 %in% female),]
ASFL7eu <- ASFL7[(ASFL7$QD10 %in% eu),] 
ASFL7oth <-  ASFL7[(ASFL7$QD10 %in% oth),] 
ASFL7othworet <-  ASFL7[(ASFL7$QD10 %in% othworet),] 
ASFL7ret <-  ASFL7[(ASFL7$QD10 %in% ret),] 
ASFL7unempl <-  ASFL7[(ASFL7$QD10 %in% unempl),] 
ASFL7entrepreneurs <-  ASFL7[(ASFL7$QF9_11 %in% entrepreneurs),] 

wpct(ASFL7$HFCS1, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$HFCS1, weight=ASFL7se$wght, na.rm=TRUE)
table(ASFL7se$HFCS1)
wpct(ASFL7sem$HFCS1, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$HFCS1, weight=ASFL7sef$wght, na.rm=TRUE)
wpct(ASFL7e$HFCS1, weight=ASFL7e$wght, na.rm=TRUE)
table(ASFL7e$HFCS1)
wpct(ASFL7em$HFCS1, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7ef$HFCS1, weight=ASFL7ef$wght, na.rm=TRUE)
wpct(ASFL7eu$HFCS1, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$HFCS1, weight=ASFL7oth$wght, na.rm=TRUE)
table(ASFL7oth$HFCS1)
wpct(ASFL7othworet$HFCS1, weight=ASFL7othworet$wght, na.rm=TRUE)
wpct(ASFL7ret$HFCS1, weight=ASFL7ret$wght, na.rm=TRUE)


wpct(ASFL7$stockshared, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$stockshared, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$stockshared, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$stockshared, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$stockshared, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7em$stockshared, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7ef$stockshared, weight=ASFL7ef$wght, na.rm=TRUE)

wpct(ASFL7eu$stockshared, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$stockshared, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$stockshared, weight=ASFL7othworet$wght, na.rm=TRUE)

wpct(ASFL7$bondd, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$bondd, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$bondd, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$bondd, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$bondd, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7em$bondd, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7ef$bondd, weight=ASFL7ef$wght, na.rm=TRUE)
wpct(ASFL7eu$bondd, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$bondd, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$bondd, weight=ASFL7othworet$wght, na.rm=TRUE)

wpct(ASFL7$cryptod, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$cryptod, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$cryptod, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$cryptod, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$cryptod, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7em$cryptod, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7ef$cryptod, weight=ASFL7ef$wght, na.rm=TRUE)
wpct(ASFL7eu$cryptod, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$cryptod, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$cryptod, weight=ASFL7othworet$wght, na.rm=TRUE)

table(ASFL7$riskyassets)
table(ASFL7se$riskyassets)
table(ASFL7e$riskyassets)
table(ASFL7eu$riskyassets)
table(ASFL7oth$riskyassets)
wpct(ASFL7$riskyassetsd, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$riskyassetsd, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$riskyassetsd, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$riskyassetsd, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$riskyassetsd, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7em$riskyassetsd, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7ef$riskyassetsd, weight=ASFL7ef$wght, na.rm=TRUE)
wpct(ASFL7eu$riskyassetsd, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$riskyassetsd, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$riskyassetsd, weight=ASFL7othworet$wght, na.rm=TRUE)

wpct(ASFL7$QS1_2risk, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$QS1_2risk, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$QS1_2risk, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$QS1_2risk, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$QS1_2risk, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7eu$QS1_2risk, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$QS1_2risk, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$QS1_2risk, weight=ASFL7othworet$wght, na.rm=TRUE)

wpct(ASFL7$HFCSriskd, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$HFCSriskd, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$HFCSriskd, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$HFCSriskd, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$HFCSriskd, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7eu$HFCSriskd, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$HFCSriskd, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$HFCSriskd, weight=ASFL7othworet$wght, na.rm=TRUE)

wpct(ASFL7$HFCSriskad, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7m$HFCSriskad, weight=ASFL7m$wght, na.rm=TRUE)
wpct(ASFL7f$HFCSriskad, weight=ASFL7f$wght, na.rm=TRUE)
wpct(ASFL7se$HFCSriskad, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$HFCSriskad, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$HFCSriskad, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$HFCSriskad, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7em$HFCSriskad, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7ef$HFCSriskad, weight=ASFL7ef$wght, na.rm=TRUE)
wpct(ASFL7eu$HFCSriskad, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$HFCSriskad, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$HFCSriskad, weight=ASFL7othworet$wght, na.rm=TRUE)

wpct(ASFL7$numericHFCSrisk, weight=ASFL7$wght, na.rm=TRUE)
wpct(ASFL7se$numericHFCSrisk, weight=ASFL7se$wght, na.rm=TRUE)
wpct(ASFL7sem$numericHFCSrisk, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sef$numericHFCSrisk, weight=ASFL7sef$wght, na.rm=TRUE)

wpct(ASFL7e$numericHFCSrisk, weight=ASFL7e$wght, na.rm=TRUE)
wpct(ASFL7eu$numericHFCSrisk, weight=ASFL7eu$wght, na.rm=TRUE)
wpct(ASFL7oth$numericHFCSrisk, weight=ASFL7oth$wght, na.rm=TRUE)
wpct(ASFL7othworet$numericHFCSrisk, weight=ASFL7othworet$wght, na.rm=TRUE)



######financial risk taking sample comparison 
ASFL7se <- ASFL7[(ASFL7$QD10 %in% se),]
ASFL7serisk <- ASFL7se[(ASFL7se$HFCS1 %in% riskad),]
ASFL7senrisk <- ASFL7se[(ASFL7se$HFCS1 %in% nriskad),]
ASFL7sem <- ASFL7se[(ASFL7se$QD1 %in% male),]
ASFL7semrisk <- ASFL7sem[(ASFL7sem$HFCS1 %in% riskad),]
ASFL7semnrisk <- ASFL7sem[(ASFL7sem$HFCS1 %in% nriskad),]
ASFL7sef <- ASFL7se[(ASFL7se$QD1 %in% female),]
ASFL7sefrisk <- ASFL7sef[(ASFL7sef$HFCS1 %in% riskad),]
ASFL7sefnrisk <- ASFL7sef[(ASFL7sef$HFCS1 %in% nriskad),]
ASFL7e <- ASFL7[(ASFL7$QD10 %in% e),]
ASFL7em <- ASFL7e[(ASFL7e$QD1 %in% male),]
ASFL7emrisk <- ASFL7em[(ASFL7em$HFCS1 %in% riskad),]
ASFL7emnrisk <- ASFL7em[(ASFL7em$HFCS1 %in% nriskad),]
ASFL7ef <- ASFL7e[(ASFL7e$QD1 %in% female),]
ASFL7efrisk <- ASFL7ef[(ASFL7ef$HFCS1 %in% riskad),]
ASFL7efnrisk <- ASFL7ef[(ASFL7ef$HFCS1 %in% nriskad),]
ASFL7eu <- ASFL7[(ASFL7$QD10 %in% eu),]
ASFL7oth <- ASFL7[(ASFL7$QD10 %in% oth),]
ASFL7othworet <- ASFL7[(ASFL7$QD10 %in% othworet),]
ASFL7ret <- ASFL7[(ASFL7$QD10 %in% ret),]

#####self-employed
#males
wpct(ASFL7sem$HFCSriskad, weight=ASFL7sem$wght, na.rm=TRUE)
wpct(ASFL7sem$riskyassetsd, weight=ASFL7sem$wght, na.rm=TRUE)

weighted.mean(ASFL7semrisk$finlit, ASFL7semrisk$wght)
weighted.mean(ASFL7semnrisk$finlit, ASFL7semnrisk$wght)
weighted.mean(ASFL7semrisk$fin_know, ASFL7semrisk$wght)
weighted.mean(ASFL7semnrisk$fin_know, ASFL7semnrisk$wght)
weighted.mean(ASFL7semrisk$fin_beh, ASFL7semrisk$wght)
weighted.mean(ASFL7semnrisk$fin_beh, ASFL7semnrisk$wght)
weighted.mean(ASFL7semrisk$fin_att, ASFL7semrisk$wght)
weighted.mean(ASFL7semnrisk$fin_att, ASFL7semnrisk$wght)

weighted.mean(ASFL7semrisk$sixmonthfinbuffd, ASFL7semrisk$wght)
weighted.mean(ASFL7semnrisk$sixmonthfinbuffd, ASFL7semnrisk$wght)

weighted.mean(ASFL7semrisk$finwellbeing, ASFL7semrisk$wght)
weighted.mean(ASFL7semnrisk$finwellbeing, ASFL7semnrisk$wght)
wpct(ASFL7semrisk$finwellbeing2d, weight=ASFL7semrisk$wght, na.rm=TRUE)
wpct(ASFL7semnrisk$finwellbeing2d, weight=ASFL7semnrisk$wght, na.rm=TRUE)
wpct(ASFL7semrisk$finwellbeing3d, weight=ASFL7semrisk$wght, na.rm=TRUE)
wpct(ASFL7semnrisk$finwellbeing3d, weight=ASFL7semnrisk$wght, na.rm=TRUE)
wpct(ASFL7semrisk$HFCSriskad, weight=ASFL7semrisk$wght, na.rm=TRUE)
wpct(ASFL7semnrisk$HFCSriskad, weight=ASFL7semnrisk$wght, na.rm=TRUE)
wpct(ASFL7semrisk$riskyassetsd, weight=ASFL7semrisk$wght, na.rm=TRUE)
wpct(ASFL7semnrisk$riskyassetsd, weight=ASFL7semnrisk$wght, na.rm=TRUE)

#females
wpct(ASFL7sef$HFCSriskad, weight=ASFL7sef$wght, na.rm=TRUE)
wpct(ASFL7sef$riskyassetsd, weight=ASFL7sef$wght, na.rm=TRUE)

weighted.mean(ASFL7sefrisk$finlit, ASFL7sefrisk$wght)
weighted.mean(ASFL7sefnrisk$finlit, ASFL7sefnrisk$wght)
weighted.mean(ASFL7sefrisk$fin_know, ASFL7sefrisk$wght)
weighted.mean(ASFL7sefnrisk$fin_know, ASFL7sefnrisk$wght)
weighted.mean(ASFL7sefrisk$fin_beh, ASFL7sefrisk$wght)
weighted.mean(ASFL7sefnrisk$fin_beh, ASFL7sefnrisk$wght)
weighted.mean(ASFL7sefrisk$fin_att, ASFL7sefrisk$wght)
weighted.mean(ASFL7sefnrisk$fin_att, ASFL7sefnrisk$wght)

weighted.mean(ASFL7sefrisk$sixmonthfinbuffd, ASFL7sefrisk$wght)
weighted.mean(ASFL7sefnrisk$sixmonthfinbuffd, ASFL7sefnrisk$wght)

weighted.mean(ASFL7sefrisk$finwellbeing, ASFL7sefrisk$wght)
weighted.mean(ASFL7sefnrisk$finwellbeing, ASFL7sefnrisk$wght)
wpct(ASFL7sefrisk$finwellbeing2d, weight=ASFL7sefrisk$wght, na.rm=TRUE)
wpct(ASFL7sefnrisk$finwellbeing2d, weight=ASFL7sefnrisk$wght, na.rm=TRUE)
wpct(ASFL7sefrisk$finwellbeing3d, weight=ASFL7sefrisk$wght, na.rm=TRUE)
wpct(ASFL7sefnrisk$finwellbeing3d, weight=ASFL7sefnrisk$wght, na.rm=TRUE)
wpct(ASFL7sefrisk$riskyassetsd, weight=ASFL7sefrisk$wght, na.rm=TRUE)
wpct(ASFL7sefnrisk$riskyassetsd, weight=ASFL7sefnrisk$wght, na.rm=TRUE)


#####employed
#males
wpct(ASFL7em$HFCSriskad, weight=ASFL7em$wght, na.rm=TRUE)
wpct(ASFL7em$riskyassetsd, weight=ASFL7em$wght, na.rm=TRUE)

weighted.mean(ASFL7emrisk$finlit, ASFL7emrisk$wght)
weighted.mean(ASFL7emnrisk$finlit, ASFL7emnrisk$wght)
weighted.mean(ASFL7emrisk$fin_know, ASFL7emrisk$wght)
weighted.mean(ASFL7emnrisk$fin_know, ASFL7emnrisk$wght)
weighted.mean(ASFL7emrisk$fin_beh, ASFL7emrisk$wght)
weighted.mean(ASFL7emnrisk$fin_beh, ASFL7emnrisk$wght)
weighted.mean(ASFL7emrisk$fin_att, ASFL7emrisk$wght)
weighted.mean(ASFL7emnrisk$fin_att, ASFL7emnrisk$wght)

weighted.mean(ASFL7emrisk$sixmonthfinbuffd, ASFL7emrisk$wght)
weighted.mean(ASFL7emnrisk$sixmonthfinbuffd, ASFL7emnrisk$wght)

weighted.mean(ASFL7emrisk$finwellbeing, ASFL7emrisk$wght)
weighted.mean(ASFL7emnrisk$finwellbeing, ASFL7emnrisk$wght)
wpct(ASFL7emrisk$finwellbeing2d, weight=ASFL7emrisk$wght, na.rm=TRUE)
wpct(ASFL7emnrisk$finwellbeing2d, weight=ASFL7emnrisk$wght, na.rm=TRUE)
wpct(ASFL7emrisk$finwellbeing3d, weight=ASFL7emrisk$wght, na.rm=TRUE)
wpct(ASFL7emnrisk$finwellbeing3d, weight=ASFL7emnrisk$wght, na.rm=TRUE)
wpct(ASFL7emrisk$riskyassetsd, weight=ASFL7emrisk$wght, na.rm=TRUE)
wpct(ASFL7emnrisk$riskyassetsd, weight=ASFL7emnrisk$wght, na.rm=TRUE)

#females
wpct(ASFL7ef$HFCSriskad, weight=ASFL7ef$wght, na.rm=TRUE)
wpct(ASFL7ef$riskyassetsd, weight=ASFL7ef$wght, na.rm=TRUE)

weighted.mean(ASFL7efrisk$finlit, ASFL7efrisk$wght)
weighted.mean(ASFL7efnrisk$finlit, ASFL7efnrisk$wght)
weighted.mean(ASFL7efrisk$fin_know, ASFL7efrisk$wght)
weighted.mean(ASFL7efnrisk$fin_know, ASFL7efnrisk$wght)
weighted.mean(ASFL7efrisk$fin_beh, ASFL7efrisk$wght)
weighted.mean(ASFL7efnrisk$fin_beh, ASFL7efnrisk$wght)
weighted.mean(ASFL7efrisk$fin_att, ASFL7efrisk$wght)
weighted.mean(ASFL7efnrisk$fin_att, ASFL7efnrisk$wght)

weighted.mean(ASFL7efrisk$sixmonthfinbuffd, ASFL7efrisk$wght)
weighted.mean(ASFL7efnrisk$sixmonthfinbuffd, ASFL7efnrisk$wght)

weighted.mean(ASFL7efrisk$finwellbeing, ASFL7efrisk$wght)
weighted.mean(ASFL7efnrisk$finwellbeing, ASFL7efnrisk$wght)
wpct(ASFL7efrisk$finwellbeing2d, weight=ASFL7efrisk$wght, na.rm=TRUE)
wpct(ASFL7efnrisk$finwellbeing2d, weight=ASFL7efnrisk$wght, na.rm=TRUE)
wpct(ASFL7efrisk$finwellbeing3d, weight=ASFL7efrisk$wght, na.rm=TRUE)
wpct(ASFL7efnrisk$finwellbeing3d, weight=ASFL7efnrisk$wght, na.rm=TRUE)
wpct(ASFL7efrisk$riskyassetsd, weight=ASFL7efrisk$wght, na.rm=TRUE)
wpct(ASFL7efnrisk$riskyassetsd, weight=ASFL7efnrisk$wght, na.rm=TRUE)

###############################################################################
#CORRELATIONS
###############################################################################
####FINANCIAL LITERACY
###full sample
cor.test(ASFL7$selfemployedd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$refincomed, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)

#intuitive -> runs into finlit! 
cor.test(ASFL7$fin_know, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)

###not running into finlit but financial skills likely to be correlated to financial knowledge
cor.test(ASFL7$numericsaknow, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)

###self-employed
#cor.test(ASFL7se$selfemployedd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$fin_know, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$numericsaknow, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finfraudd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)

###employed
#cor.test(ASFL7e$selfemployedd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$employedd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$fin_know, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$numericsaknow, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finfraudd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)


####SELF-EMPLOYMENT
###full sample
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$fin_know, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$selfemployedd, data=ASFL7, weights=ASFL7$wght)


###EMPLOYMENT
cor.test(ASFL7$employedd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$fin_know, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)

####FINANCIAL KNOWLEDGE
###full sample
#socioeconomic characteristics
cor.test(ASFL7$finlit, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$selfemployedd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$finlit, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)

#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)

###self-employed
#socioeconomic characteristics
cor.test(ASFL7se$finlit, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$selfemployedd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$selfemployedd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7se$numericsaknow, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finfraudd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)

#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)

###risk evaluation restricted on sample of self-employed
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassets, ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght) #correlation between gender and financial risk taking
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$selfemployedd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght) #high correlation!!
cor.test(ASFL7se$riskyassets, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght) #high correlation!! 


###employedd
#socioeconomic characteristics
cor.test(ASFL7e$selfemployedd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$fin_beh, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finlit, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)

#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7e$numericsaknow, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)

####FINANCIAL BEHAVIOUR
###full sample
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$fin_beh, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$finlit, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)

###self employed
#socioeconomic characteristics
#cor.test(ASFL7se$selfemployedd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)


cor.test(ASFL7se$fin_beh, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7se$numericsaknow, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)

#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)

###employedd
#socioeconomic characteristics
cor.test(ASFL7e$selfemployedd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$fin_beh, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7e$numericsaknow, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

###employedd
#socioeconomic characteristics
cor.test(ASFL7e$selfemployedd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$fin_beh, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$finlit, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7e$numericsaknow, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)


####FINANCIAL ATTITUDE
###full sample
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$fin_att, ASFL7$fin_know, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$fin_beh, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$fin_att, data=ASFL7, weights=ASFL7$wght)

###self-employed
#socioeconomic characteristics
#cor.test(ASFL7se$selfemployedd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$fin_att, ASFL7se$fin_know, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$fin_beh, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$finlit, data=ASFL7se, weights=ASFL7se$wght)

#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7se$numericsaknow, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)

#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$fin_att, data=ASFL7se, weights=ASFL7se$wght)

###employed
#socioeconomic characteristics
#cor.test(ASFL7e$selfemployedd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$employedd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$fin_att, ASFL7e$fin_know, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$fin_beh, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)

#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7e$numericsaknow, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finfraudd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$fin_att, data=ASFL7e, weights=ASFL7e$wght)

####SELF-ASSESSED KNOWLEDGE
###full sample
cor.test(ASFL7$selfemployedd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericsaknow, ASFL7$employedd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$fin_know, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$numericsaknow, data=ASFL7, weights=ASFL7$wght)


###self-employed
#cor.test(ASFL7se$selfemployedd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$numericsaknow, ASFL7se$employedd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)


cor.test(ASFL7se$fin_know, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7se$numericsaknow, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finfraudd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$numericsaknow, data=ASFL7se, weights=ASFL7se$wght)

###employed
#cor.test(ASFL7e$selfemployedd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$numericsaknow, ASFL7e$employedd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)


cor.test(ASFL7e$fin_know, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7e$numericsaknow, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$numericsaknow, data=ASFL7e, weights=ASFL7e$wght)


####FINANCIAL CUSHION
###full-sample
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$fin_know, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)

#financial buffer (resilience) full sample
cor.test(ASFL7$numericsaknow, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$numericfinbuff, data=ASFL7, weights=ASFL7$wght)

###alternatives
#1
cor.test(ASFL7$selfemployedd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$finlit, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)

#financial buffer (resilience) full sample
cor.test(ASFL7$numericsaknow, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$savebuffd, data=ASFL7, weights=ASFL7$wght)

#2
cor.test(ASFL7$selfemployedd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$finlit, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)

#financial buffer (resilience) full sample
cor.test(ASFL7$numericsaknow, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$expensecovd, data=ASFL7, weights=ASFL7$wght)


###self-employed
#cor.test(ASFL7se$selfemployedd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$finlit, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericsaknow, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)

###alternatives
#1
#cor.test(ASFL7se$selfemployedd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)


cor.test(ASFL7se$fin_know, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)

#financial buffer (resilience) full sample
cor.test(ASFL7se$numericsaknow, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$savebuffd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finfraudd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$savebuffd, data=ASFL7se, weights=ASFL7se$wght)

#2
cor.test(ASFL7se$selfemployedd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$employedd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)


cor.test(ASFL7se$fin_know, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$expensecovd, data=ASFL7se, weights=ASFL7se$wght)

###employed
#cor.test(ASFL7e$selfemployedd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$employedd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$finlit, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_know, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericsaknow, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)

###alternatives
#1
cor.test(ASFL7e$selfemployedd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)


cor.test(ASFL7e$fin_know, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$numericsaknow, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$savebuffd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$savebuffd, data=ASFL7e, weights=ASFL7e$wght)

#2
cor.test(ASFL7e$selfemployedd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)


cor.test(ASFL7e$fin_know, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)

#financial buffer (resilience) full sample
cor.test(ASFL7e$numericsaknow, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$expensecovd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$expensecovd, data=ASFL7e, weights=ASFL7e$wght)


####RISK-PROPENSITY
###full-sample
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7m$selfemployedd, ASFL7m$HFCSriskad, data=ASFL7m, weights=ASFL7m$wght)
cor.test(ASFL7f$selfemployedd, ASFL7f$HFCSriskad, data=ASFL7f, weights=ASFL7f$wght)

cor.test(ASFL7$employedd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)


cor.test(ASFL7$finlit, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7$numericsaknow, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$HFCSriskad, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)

#alternative
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$hincomelowd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$finlit, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
###not running into finlit but financial skills likely to be correlated to financial knowledge!!
#full sample
cor.test(ASFL7$numericsaknow, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$HFCSriskd, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskd, ASFL7$HFCSriskad, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$HFCSriskd, data=ASFL7, weights=ASFL7$wght)

#alternative2
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$hincomelowd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$finlit, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$numericsaknow, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$QS1_2risk, ASFL7$numericHFCSrisk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskd, ASFL7$QS1_2risk, data=ASFL7, weights=ASFL7$wght)

###self-employed
#socioeconomic characteristics
#cor.test(ASFL7se$selfemployedd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7sem$selfemployedd, ASFL7sem$HFCSriskad, data=ASFL7sem, weights=ASFL7sem$wght)
#cor.test(ASFL7sef$selfemployedd, ASFL7sef$HFCSriskad, data=ASFL7sef, weights=ASFL7sef$wght)

#cor.test(ASFL7se$employedd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)


cor.test(ASFL7se$finlit, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7se$numericsaknow, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finfraudd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)

#risk
cor.test(ASFL7se$HFCSriskad, ASFL7se$numericHFCSrisk, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$numericHFCSrisk, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$numericHFCSrisk, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
###employed
#socioeconomic characteristics
#cor.test(ASFL7e$selfemployedd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7em$selfemployedd, ASFL7em$HFCSriskad, data=ASFL7em, weights=ASFL7em$wght)
#cor.test(ASFL7ef$selfemployedd, ASFL7ef$HFCSriskad, data=ASFL7ef, weights=ASFL7ef$wght)

#cor.test(ASFL7e$employedd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)


cor.test(ASFL7e$finlit, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_know, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)


#not running into finlit but financial skills likely to be correlated to financial knowledge!!
cor.test(ASFL7e$numericsaknow, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$HFCSriskad, ASFL7e$numericHFCSrisk, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$numericHFCSrisk, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$numericHFCSrisk, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)

####RISK-TAKING
###full-sample
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$fin_know, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$numericsaknow, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finfraudd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$riskyassetsd, data=ASFL7, weights=ASFL7$wght)

###self-employed
#cor.test(ASFL7se$selfemployedd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$finlit, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)

#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$numericsaknow, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finfraudd, ASFL7se$riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)


###employed
#cor.test(ASFL7e$selfemployedd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$employedd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)


cor.test(ASFL7e$fin_know, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$numericsaknow, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finfraudd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)

####PRODUCT AWARENESS
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$finprodholding, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$produse, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)

###PRODUCT HOLDING
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$finprodholding, data=ASFL7, weights=ASFL7$wght)

####FINANCIAL FRAUD
cor.test(ASFL7$selfemployedd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$finlit, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)

cor.test(ASFL7$numericsaknow, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$numericfinbuff, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)

#risk
cor.test(ASFL7$numericHFCSrisk, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$HFCSriskd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$riskyassets, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$riskyassetsd, ASFL7$finfraudd, data=ASFL7, weights=ASFL7$wght)

####FINWELLBEING
#socioeconomic characteristics
cor.test(ASFL7$selfemployedd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$age, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$maled, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$loweduc, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$higheduc, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
#cor.test(ASFL7$villaged, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$townd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$cityd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomelowd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomemiddled, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$hincomehighd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singled, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$childd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$singleparentd, ASFL7$finwellbeing, data=ASFL7, weights=ASFL7$wght)


###self-employed
###produse
cor.test(ASFL7se$selfemployedd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$employedd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singleparentd, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$finprodholding, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$produse, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)

###prodholding
cor.test(ASFL7se$selfemployedd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$employedd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericsaknow, ASFL7se$finprodholding, data=ASFL7se, weights=ASFL7se$wght)


#########finwellbeing
cor.test(ASFL7se$selfemployedd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$employedd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$finwellbeing, data=ASFL7se, weights=ASFL7se$wght)

###financial fraud  
#cor.test(ASFL7se$selfemployedd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$employedd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$age, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$maled, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$loweduc, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$higheduc, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$villaged, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$townd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$cityd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomelowd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomemiddled, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$hincomehighd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$singled, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$childd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$finlit, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)

cor.test(ASFL7se$numericsaknow, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$numericfinbuff, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)

#risk
cor.test(ASFL7se$numericHFCSrisk, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$HFCSriskd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
#cor.test(ASFL7se$riskyassets, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$riskyassetsd, ASFL7se$finfraudd, data=ASFL7se, weights=ASFL7se$wght)


########employed
####product awareness
cor.test(ASFL7e$selfemployedd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$finprodholding, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$produse, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
#########prodholding
cor.test(ASFL7e$selfemployedd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$hincomelowd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$finprodholding, data=ASFL7e, weights=ASFL7e$wght)

#########financial fraud  
cor.test(ASFL7e$selfemployedd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomelowd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$finlit, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_know, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)

cor.test(ASFL7e$numericsaknow, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$numericfinbuff, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)

#risk
cor.test(ASFL7e$numericHFCSrisk, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$HFCSriskd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$riskyassets, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$riskyassetsd, ASFL7e$finfraudd, data=ASFL7e, weights=ASFL7e$wght)

###finwellbeing
cor.test(ASFL7e$selfemployedd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$employedd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$age, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$maled, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$loweduc, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$higheduc, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$villaged, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$townd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$cityd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
#cor.test(ASFL7e$hincomelowd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomemiddled, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$hincomehighd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singled, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$childd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$singleparentd, ASFL7e$finwellbeing, data=ASFL7e, weights=ASFL7e$wght)


###EDUCATION DIFFERENCES
#full sample
cor.test(ASFL7$selfemployedd,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$employedd,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finlit,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test( ASFL7$riskyassetsd,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test( ASFL7$numericsaknow,ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding,ASFL7$higheduc,  data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$higheduc, data=ASFL7, weights=ASFL7$wght)
#self-employed
cor.test(ASFL7se$finlit,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test( ASFL7se$riskyassetsd,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test( ASFL7se$numericsaknow,ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding,ASFL7se$higheduc,  data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$higheduc, data=ASFL7se, weights=ASFL7se$wght)
#employed
cor.test(ASFL7e$finlit,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_know,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test( ASFL7e$riskyassetsd,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test( ASFL7e$numericsaknow,ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding,ASFL7e$higheduc,  data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$higheduc, data=ASFL7e, weights=ASFL7e$wght)

###AGE DIFFERENCES
#full sample
cor.test(ASFL7$finlit,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test( ASFL7$riskyassetsd,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test( ASFL7$numericsaknow,ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$age, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding,ASFL7$age,  data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$age, data=ASFL7, weights=ASFL7$wght)
#self-employed
cor.test(ASFL7se$finlit,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test( ASFL7se$riskyassetsd,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test( ASFL7se$numericsaknow,ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding,ASFL7se$age,  data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$age, data=ASFL7se, weights=ASFL7se$wght)
#employed
cor.test(ASFL7e$finlit,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_know,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test( ASFL7e$riskyassetsd,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test( ASFL7e$numericsaknow,ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding,ASFL7e$age,  data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$age, data=ASFL7e, weights=ASFL7e$wght)


###GENDER DIFFERENCES
#full sample
cor.test(ASFL7$finlit,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_know,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_beh,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$fin_att,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$HFCSriskad,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test( ASFL7$riskyassetsd,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test( ASFL7$numericsaknow,ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$produse, ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finprodholding,ASFL7$maled,  data=ASFL7, weights=ASFL7$wght)
cor.test(ASFL7$finwellbeing, ASFL7$maled, data=ASFL7, weights=ASFL7$wght)
#self-employed
cor.test(ASFL7se$finlit,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_know,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_beh,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$fin_att,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$HFCSriskad,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test( ASFL7se$riskyassetsd,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test( ASFL7se$numericsaknow,ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$produse, ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finprodholding,ASFL7se$maled,  data=ASFL7se, weights=ASFL7se$wght)
cor.test(ASFL7se$finwellbeing, ASFL7se$maled, data=ASFL7se, weights=ASFL7se$wght)
#employed
cor.test(ASFL7e$finlit,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_know,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_beh,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$fin_att,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$HFCSriskad,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test( ASFL7e$riskyassetsd,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test( ASFL7e$numericsaknow,ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$produse, ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finprodholding,ASFL7e$maled,  data=ASFL7e, weights=ASFL7e$wght)
cor.test(ASFL7e$finwellbeing, ASFL7e$maled, data=ASFL7e, weights=ASFL7e$wght)


###############################################################################
#PLOTS
###############################################################################
########################PLOTS###########################
#dev.off() ... fixes problems in plotting!

#hex_codes1
#"#F8766D" "#DE8C00" "#B79F00" "#7CAE00" "#00BA38" "#00C08B" "#00BFC4"
#"#00B4F0" "#619CFF" "#C77CFF" "#F564E3" "#FF64B0"

##ggplots
#above: plot1 + plot2 
#beneath: plot1/plot2

#Legende: +theme(legend.position="none") <- instead of none: top, bottom, 

#######################SOCIODEMOGRAPHIC CHARACTERISTICS#######################
##################################EMPLOYMENT##################################
empl <- round(c(79/1418,699/1418,494/1418,50/1418,5/1418,23/1418,24/1418,21/1418,23/1418), digits=4)
paste(round(100*empl, 2), "%", sep="")
emplshare <- data.frame("Employment" = c("Self-employed", "Employee","Retired", "Unemployed", "Apprentice", "Student", "Home",  "Not working", "Other"),
                        "amount" = c(79/1418,699/1418,494/1418,50/1418,5/1418,23/1418,24/1418,21/1418,23/1418))
emp_comp <-ggplot(emplshare, aes(x="", y=amount, fill=Employment)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  geom_text(aes(label = c("5.57%" , "49.29%", "34.84%" ,"3.53%","" , "" , "",  "" , "" )),
            position = position_stack(vjust = 0.4))+
  #geom_text(aes(label = c("5.57%" , "49.29%", "34.84%" ,"3.53%","0.35%" , "1.62%" , "1.69%",  "1.48%" , "1.62%" )),
  #    position = position_stack(vjust = 0.4))+
  theme_void()
emp_comp+theme(legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15))

emplshare2 <- data.frame("Employment" = c("Self-employed", "Employee", "Other", "Retired"),
                         "amount" = c(79/1418,699/1418,146/1418,494/1418))

empl_simple_comp <- ggplot(emplshare2, aes(x="", y=amount, fill=Employment)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  theme_void() +theme(legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15))
empl_simple_comp

##################################AGE##################################
gencomp <- data.frame(status=rep(c('Self-employed', 'Employees'), each=5),
                      age=rep(c('Silent generation','Baby-boomers','Generation X','Old millennials','Young millennials'  ), times=2),
                      share=c(0/79,11/79,63/79,5/79,0/79, 1/699,35/699,386/699,163/699,114/699))
gencomp$status<- factor(gencomp$status, levels=c('Self-employed', 'Employees'))
gencomp$age<- factor(gencomp$age, levels=c('Silent generation','Baby-boomers','Generation X','Old millennials','Young millennials'))
generations_comp <- ggplot(gencomp, aes(fill=age, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")  +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))
generations_comp
##################################GENDER##################################
emplstat <- c(rep("Self-employed" , 2) , rep("Employees" , 2) )
gender <- rep(c("Male" , "Female" ) , 2)
value <- abs(c(45/79,34/79,346/699,353/699))
genderplot<- data.frame(gender,emplstat,value)
genderplot$emplstat<- factor(genderplot$emplstat, levels=c('Self-employed', 'Employees'))
genderplot$gender<- factor(genderplot$gender, levels=c('Male','Female'))
gender_comp <- ggplot(genderplot, aes(fill=gender, y=value, x=emplstat)) + 
  geom_bar(position="dodge", stat="identity")+ 
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="" ,y="Percentage share",fill="")+ theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
gender_comp


##################################EDUCATION##################################
educomp <- data.frame(status=rep(c('Self-employed', 'Employees'), each=2),
                      education=rep(c('Higher', 'Lower'), times=2),
                      share=c(36/79, 43/79,249/699, 450/699))
educomp$status<- factor(educomp$status, levels=c('Self-employed', 'Employees'))
educomp$education<- factor(educomp$education, levels=c('Higher', 'Lower'))
educ_comp <-ggplot(educomp, aes(fill=education, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  scale_fill_manual(values=c("green",
                             "purple"))+
  labs(x="",y="Percentage share",fill="") + theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
educ_comp


#################################LIVING COMMUNITY TYPE##############################
livingcomm <- data.frame(status=rep(c('Self-employed', 'Employees'), each=3),
                         community=rep(c("City","Town","Village"), times=2),
                         share=c(34/79,25/79,20/79,243/699,258/699,198/699))
livingcomm$status<- factor(livingcomm$status, levels=c('Self-employed', 'Employees'))
livingcomm$community<- factor(livingcomm$community, levels=c("City","Town","Village"))
living_comp <- ggplot(livingcomm, aes(fill=community, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+ theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
living_comp

##################################HOUSEHOLD SIZE##################################
#sole and with children comparison plot
household <- c(rep("Single household" , 2) , rep("Children" , 2), rep("Single parent" , 2))
emplstat <- rep(c("Self-employed" , "Employees" ) , 3)
value <- abs(c(23/79,196/699,29/79,245/699,3/79,34/699))
householdplot<- data.frame(household,emplstat,value)
householdplot$household<- factor(householdplot$household, levels=c("Single household","Children","Single parent"))
householdplot$emplstat<- factor(householdplot$emplstat, levels=c('Self-employed', 'Employees'))
household_comp <- ggplot(householdplot, aes(fill=emplstat, y=value, x=household)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Percentage share", fill = "") + theme(legend.position="bottom")+ theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
household_comp

##################################HOUSEHOLD INCOME##################################
hincomecomp <- data.frame(status=rep(c('Self-employed', 'Employees'), each=4),
                          income=rep(c('3.000 or more','Between 2.000 and 3.000','Up to 2.000', 'Ref/Don`t know'), times=2),
                          share=c( 36/79, 18/79, 15/79,10/79,212/699,264/699,171/699,52/699))
hincomecomp$status<- factor(hincomecomp$status, levels=c('Self-employed', 'Employees'))
hincomecomp$income<- factor(hincomecomp$income, levels=c('3.000 or more','Between 2.000 and 3.000','Up to 2.000', 'Ref/Don`t know'))
hincome_comp <-ggplot(hincomecomp, aes(fill=income, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+ theme(legend.position="bottom")+ theme(legend.position="bottom")+ theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13), axis.text = element_text(size = 13))
hincome_comp

##################################SELF-RATED FINANCIAL KNOWLEDGE##################################
#simple
selfratedknow <- data.frame(status=rep(c('Self-employed', 'Employees'), each=4),
                            selfassessment=rep(c('Ref/Don´t know','Low', 'Average', 'High'), times=2),
                            share=c(0.04768587,0.04254538,0.34443552,0.5653332,0.02188622,0.1390004,0.4149923,0.4241211))
selfratedknow$selfassessment<- factor(selfratedknow$selfassessment, levels=c('Ref/Don´t know','Low', 'Average', 'High'))
selfratedknow$status<- factor(selfratedknow$status, levels=c('Self-employed', 'Employees'))
sa_comp <- ggplot(selfratedknow, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
sa_comp

#specific
selfratedknow_specific <- data.frame(status=rep(c('Self-employed', 'Employees'), each=6),
                                     selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=2),
                                     share=c(0.11731588,0.44801736,0.34443552,0.01013686,0.03240852,0.04768587,0.109634073,0.314487009,0.414992278,0.115507818,0.023492600,0.02188622))
selfratedknow_specific$selfassessment<- factor(selfratedknow_specific$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknow_specific$status<- factor(selfratedknow_specific$status, levels=c('Self-employed', 'Employees'))
saspecific_comp <- ggplot(selfratedknow_specific, aes(fill=selfassessment, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))
saspecific_comp

#################Gender specific
#self-employed
selfratedknowgender <- data.frame(gender=rep(c('Male', 'Female'), each=6),
                                  selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=2),
                                  share=c(0.12388988, 0.55073307, 0.29503202,0,0,0.03034502,  0.10765274, 0.29703540,0.41705377,0.02503704, 0.08004583,0.07317521 ))

selfratedknowgender$selfassessment<- factor(selfratedknowgender$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknowgender$gender<- factor(selfratedknowgender$gender, levels=c('Male', 'Female'))
sa_gender_se <- ggplot(selfratedknowgender, aes(fill=selfassessment, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+ theme(legend.position="none")
sa_gender_se

#employed
selfratedknowgender <- data.frame(gender=rep(c('Male', 'Female'), each=6),
                                  selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=2),
                                  share=c(0.123241627 ,0.356358811 ,0.410727526,0.073273932, 0.012593160,0.02380494,0.095011378 , 0.269491520, 0.419575185,0.160892403, 0.035205152 , 0.01982436))

selfratedknowgender$selfassessment<- factor(selfratedknowgender$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
selfratedknowgender$gender<- factor(selfratedknowgender$gender, levels=c('Male', 'Female'))
sa_gender_e<- ggplot(selfratedknowgender, aes(fill=selfassessment, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="",fill="")+ theme(legend.position="none")
sa_gender_e

sa_gender <- sa_gender_se+sa_gender_e
sa_gender <- sa_gender_se+sa_gender_e + plot_layout(guides = "collect")& theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))& guides(fill=guide_legend(nrow=2, byrow=TRUE))
sa_gender


##################################RISK BEHAVIOUR##################################
#####risk propensity
HFCSrisk <- data.frame(status=rep(c('Self-employed', 'Employees'), each=4),
                       Propensity=rep(c('Substantial', 'Above average', 'Average', 'No'), times=2),
                       share=c(0.09569008 ,0.08783484 ,0.37851258 ,0.43796251 ,0.0436851 ,0.1492514,0.3258391 ,0.4812244   ))
HFCSrisk$Propensity<- factor(HFCSrisk$Propensity, levels=c('Substantial', 'Above average', 'Average', 'No'))
HFCSrisk$status<- factor(HFCSrisk$status, levels=c('Self-employed', 'Employees'))
HFCSriskcomp <- ggplot(HFCSrisk, aes(fill=Propensity, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity') +
  # scale_fill_manual(values = c("Substantial", "Above average", "Average", "No")) +
  labs(x="",y = 'Percentage share',fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
HFCSriskcomp

#gender specific
HFCSriskgender <- data.frame(status=rep(c('Male', 'Female'), each=4),
                             HFCSrisk=rep(c('Substantial', 'Above average', 'Average', 'No'), times=2),
                             share=c(0.1423696,0.1174501,0.4206140,0.3195663 ,0.02707574 ,0.04430336 ,0.31662770 ,0.61199320 ))
HFCSriskgender$HFCSrisk<- factor(HFCSriskgender$HFCSrisk, levels=c('Substantial', 'Above average', 'Average', 'No'))
HFCSriskgender$status<- factor(HFCSriskgender$status, levels=c('Male', 'Female'))
HFCSrisk_se <-ggplot(HFCSriskgender, aes(fill=HFCSrisk, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity') +
  # scale_fill_manual(values = c("Substantial", "Above average", "Average", "No")) +
  labs(x="",y = 'Percentage share',fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
HFCSrisk_se

#employed
HFCSriskgender <- data.frame(status=rep(c('Male', 'Female'), each=4),
                             HFCSrisk=rep(c('Substantial', 'Above average', 'Average', 'No'), times=2),
                             share=c(0.05766399 ,0.17860590 ,0.36957689 ,0.39415322 ,0.02866337 ,0.11770697 ,0.27883838 ,0.57479129))
HFCSriskgender$HFCSrisk<- factor(HFCSriskgender$HFCSrisk, levels=c('Substantial', 'Above average', 'Average', 'No'))
HFCSriskgender$status<- factor(HFCSriskgender$status, levels=c('Male', 'Female'))
HFCSrisk_e <- ggplot(HFCSriskgender, aes(fill=HFCSrisk, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity') +
  # scale_fill_manual(values = c("Substantial", "Above average", "Average", "No")) +
  labs(x="",y = 'Percentage share',fill="")  +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
HFCSrisk_e


####risky asset holding
risk <- c(rep("Stocks/shares" , 2) , rep("Bonds" , 2) , rep("Crypto assets" , 2))
emplstat <- rep(c("Self-employed" , "Employees" ) , 3)
value <- abs(c(0.2355855 ,0.1363495  ,0.1235186,0.0873412,0.05656405 ,0.05553866))
riskplot<- data.frame(risk,emplstat,value)
riskplot$risk<- factor(riskplot$risk, levels=c("Stocks/shares","Bonds","Crypto assets"))
riskplot$emplstat<- factor(riskplot$emplstat, levels=c('Self-employed', 'Employees'))
riskyassetcomp <- ggplot(riskplot, aes(fill=emplstat, y=value, x=risk)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Percentage share", fill = "")+  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
riskyassetcomp

#gender specific
#self-employed
risk <- c(rep("Stocks/shares" , 2) , rep("Bonds" , 2) ,  rep("Crypto assets" , 2)  )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c(0.3244025 ,0.1050333 ,0.2075505 , 0, 0.08051489 ,0.0213587 ))
riskplot<- data.frame(risk,gender,value)
riskplot$risk<- factor(riskplot$risk, levels=c("Stocks/shares","Bonds","Crypto assets"))
riskplot$gender<- factor(riskplot$gender, levels=c("Male" , "Female"))
riskyassets_se <- ggplot(riskplot, aes(fill=gender, y=value, x=risk)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x = "",y="Percentage share", fill = "")+  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'), axis.text = element_text(size = 15))
riskyassets_se

#employed
risk <- c(rep("Stocks/shares" , 2) , rep("Bonds" , 2) ,  rep("Crypto assets" , 2)  )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c(0.1948144  ,0.07352301  ,0.1206942  , 0.05150003 , 0.07224161  ,0.03758964  ))
riskplot<- data.frame(risk,gender,value)
riskplot$risk<- factor(riskplot$risk, levels=c("Stocks/shares","Bonds","Crypto assets"))
riskplot$gender<- factor(riskplot$gender, levels=c("Male" , "Female"))
riskyassets_e<- ggplot(riskplot, aes(fill=gender, y=value, x=risk)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x = "",y="Percentage share", fill = "")+  theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
riskyassets_e

#####################Confidence about retirement saving################################
#gender
#self-employed
selfratedretconfidencegender <- data.frame(gender=rep(c('Male', 'Female'), each=7),
                                           confidence=rep(c('Very confident','Confident', 'Neutral', 'Not very confident', 'Not at all confident','No retirement plan','Ref/Don´t know'), times=2),
                                           share=c( 0.26035711, 0.46253090,0.08337192, 0.14224387, 0.05149620,0,0,0.20356250 ,0.32319687 , 0.17386718,0.2141272,0.05334253,0,0.03190366  ))

selfratedretconfidencegender$confidence<- factor(selfratedretconfidencegender$confidence, levels=c('Very confident','Confident', 'Neutral', 'Not very confident', 'Not at all confident','No retirement plan','Ref/Don´t know'))
selfratedretconfidencegender$gender<- factor(selfratedretconfidencegender$gender, levels=c('Male', 'Female'))
retconfidence_se <- ggplot(selfratedretconfidencegender, aes(fill=confidence, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+  theme(legend.position="none")

retconfidence_se

#employed
selfratedretconfidencegender <- data.frame(gender=rep(c('Male', 'Female'), each=7),
                                           confidence=rep(c('Very confident','Confident', 'Neutral', 'Not very confident', 'Not at all confident','No retirement plan','Ref/Don´t know'), times=2),
                                           share=c(0.21553711, 0.40482851, 0.16907384,0.08190972, 0.01778835, 0.09010109, 0.02076138 , 0.174023898, 0.450898769,0.130308129,0.147298208,0.030572816, 0.057930075,0.008968106  ))

selfratedretconfidencegender$confidence<- factor(selfratedretconfidencegender$confidence, levels=c('Very confident','Confident', 'Neutral', 'Not very confident', 'Not at all confident','No retirement plan','Ref/Don´t know'))
selfratedretconfidencegender$gender<- factor(selfratedretconfidencegender$gender, levels=c('Male', 'Female'))
retconfidence_e<- ggplot(selfratedretconfidencegender, aes(fill=confidence, y=share, x=gender)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+  theme(legend.position="none")
retconfidence_e

retconfidence_gender <- retconfidence_se+retconfidence_e + plot_layout(guides = "collect")&theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13), axis.text = element_text(size = 13))& guides(fill=guide_legend(nrow=2, byrow=TRUE))
retconfidence_gender

#######################FINANCIAL CHARACTERISTICS#######################

#######################FINANCIAL KNOWLEDGE#######################
#basic financial knowledge 
finknow <- c(rep("0" , 2),rep("1" ,2) , rep("2" , 2) ,  rep("3" , 2),rep("4" , 2),rep("5" , 2),rep("6" , 2),rep("7" , 2))
emplstat <- rep(c("Self-employed" , "Employed" ) , 8)
value <- abs(c(0,0.00814261,0.02025315,0.02193322,0.02347651,0.04273161,0.02656343,0.07215542,0.02564542,0.11685606,0.14809457,0.14000963,0.28741922,0.28684853,0.46854770,0.31132292))
finknowOECD<- data.frame(finknow,emplstat,value)
finknowOECD$finknow<- factor(finknowOECD$finknow, levels=c('0', '1', '2','3','4','5','6','7'))
finknowOECD$emplstat<- factor(finknowOECD$emplstat, levels=c("Self-employed" , "Employed" ))
finknow_comp <-ggplot(finknowOECD, aes(fill=emplstat, y=value, x=finknow)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="Employment status")+theme(legend.position="none")
finknow_comp


#enlarged financial knowledge
finknow <- c(rep("0" , 2),rep("1" , 2) , rep("2" ,2) ,  rep("3" , 2),rep("4" , 2),rep("5" , 2),rep("6" , 2),rep("7" , 2),rep("8" , 2),rep("9" , 2),rep("10" , 2))
emplstat <- rep(c("Self-employed" , "Employed" ) , 11)
value <- abs(c(0,0.001926869,0.020253150,0.012413192,0.014446959,0.020341872,0.026563430,0.031332812,0.009029548,0.061954325,0.014725101,0.063976149,0.010920319,0.083720361,0.050575388,0.080004069, 0.185755832,0.201836482, 0.291193550,0.210809532,0.376536723,0.231684336))
finknowadd<- data.frame(finknow,emplstat,value)
finknowadd$emplstat<- factor(finknowadd$emplstat, levels=c("Self-employed" , "Employed" ))
finknowadd$finknow<- factor(finknowadd$finknow, levels=c('0','1', '2', '3','4','5','6','7','8','9','10'))
finknow_add_comp <- ggplot(finknowadd, aes(fill=emplstat, y=value, x=finknow)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="Employment status")+theme(legend.position="none")

finknow_add_comp

finknow_comp+finknow_add_comp

#######################Detailed answers to financial knowledge#######################
##according to Chart 4 - Fessler et al (2020) - financial knowledge details #correct incorrect dont know 
#SELF-EMPLOYED - financial knowledge details #correct incorrect dont know 
finknowdetailse <- data.frame(finknow=rep(c('Exchange rate','Overdrawing an account','Real interest', 'Diversification*','Inflation definition*', 'Risk and return*','Compound interest*','Interest plus principal*','Interest on loan*','Time value*'), each=3),
                              status=rep(c('Correct','Incorrect','Ref/Don´t know' ), times=10),
                              share=c(0.87447672,0.04876289,0.07676039, 0.7227731 ,0.1404427 ,0.1367842 ,0.93873646,0.01444696,0.04681658, 0.77142812,0.13102772,0.09754416 , 0.91822943,0.03238426,0.04938631,0.90143273,0.03396225, 0.06460503,0.64042716,0.3091052,0.05046764,0.911007520,0.025367278,0.0636252,0.970574832,0.007966968,0.0214582,0.8812004,0.06277662,0.05602298))
finknowdetailse$finknow<- factor(finknowdetailse$finknow, levels=c('Exchange rate','Overdrawing an account','Real interest', 'Diversification*','Inflation definition*', 'Risk and return*','Compound interest*','Interest plus principal*','Interest on loan*','Time value*'))
finknowdetailse$status<- factor(finknowdetailse$status, levels=c('Correct','Incorrect','Ref/Don´t know' ))
finknowdetailse<-ggplot(finknowdetailse, aes(fill=status, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+
  coord_flip()
finknowdetailse
round(c(0.8812004,0.06277662,0.05602298,0.970574832,0.007966968,0.0214582,0.911007520,0.025367278,0.0636252,0.64042716,0.3091052,0.05046764,0.90143273,0.03396225, 0.06460503 ,0.91822943,0.03238426,0.04938631 ,0.77142812,0.13102772,0.09754416 ,0.93873646,0.01444696,0.04681658,0.7227731 ,0.1404427 ,0.1367842 ,0.87447672,0.04876289,0.07676039), digits=3)
#EMPLOYED - financial knowledge details #correct incorrect dont know
finknowdetaile <- data.frame(finknow=rep(c('Exchange rate','Overdrawing an account','Real interest', 'Diversification*','Inflation definition*', 'Risk and return*','Compound interest*','Interest plus principal*','Interest on loan*','Time value*'), each=3),
                             status=rep(c('Correct','Incorrect','Ref/Don´t know' ), times=10),
                             share=c(0.703229118 ,0.159618,0.1371529, 0.740998033 ,0.174713123,0.08428884,0.77005123,0.1758667,0.05408207,0.667234442,0.162267278,0.1704983,0.887358506,0.052169972 ,0.06047152,0.9070270072 ,0.0443046011 ,0.04866839,0.5221745,0.3517732,0.1274378, 0.7892900880,0.1056407,0.1050692,0.897261034,0.03466621,0.06807276,0.7227266,0.2387096,0.03856385))
finknowdetaile$finknow<- factor(finknowdetaile$finknow, levels=c('Exchange rate','Overdrawing an account','Real interest', 'Diversification*','Inflation definition*', 'Risk and return*','Compound interest*','Interest plus principal*','Interest on loan*','Time value*'))
finknowdetaile$status<- factor(finknowdetaile$status, levels=c('Correct','Incorrect','Ref/Don´t know' ))
finknowdetaile <- ggplot(finknowdetaile, aes(fill=status, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+
  coord_flip()+ theme(panel.grid = element_blank(),
                      axis.text.y = element_blank())
finknowdetaile
round(c(0.7227266,0.2387096,0.03856385,0.897261034,0.03466621,0.06807276,0.7892900880,0.1056407,0.1050692,0.5221745,0.3517732,0.1274378,0.9070270072 ,0.0443046011 ,0.04866839,0.887358506,0.052169972 ,0.06047152,0.667234442,0.162267278,0.1704983,0.77005123,0.1758667,0.05408207,0.740998033 ,0.174713123,0.08428884,0.703229118 ,0.159618,0.1371529), digits=3)

finknowdetail_comp <- finknowdetailse+finknowdetaile + plot_layout(guides = "collect")& theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13), axis.text = element_text(size = 14))
finknowdetail_comp

#GENDER SPECIFIC correct incorrect dont know 
#self-employed
finknowdetailgenderse <- data.frame(finknow=rep(c('Exchange rate_M','Exchange rate_F' ,'Overdrawing an account_M','Overdrawing an account_F','Real interest_M','Real interest_F','Diversification*_M','Diversification*_F','Inflation definition*_M','Inflation definition*_F','Risk and return*_M','Risk and return*_F','Compound interest*_M','Compound interest*_F', 'Interest plus principal*_M','Interest plus principal*_F','Interest on loan*_M','Interest on loan*_F','Time value*_M','Time value*_F'), each=3),
                                    status=rep(c('Correct','Incorrect','Ref/Don´t know' ), times=20),
                                    share=c(0.94007636,0.05992364,0,0.77805172,0.03235769,0.18959059,
                                            0.79478339,0.13380348,0.07141313,0.6169251,0.1502016,0.2328732, 
                                            0.97572452,0.02427548,0,0.8843677,0,0.1156323,
                                            0.81016060,0.17466689,0.01517251,0.71449519,0.06688245,0.21862236,
                                            0.97572452,0.02427548,0,0.83371732,0.04430336,0.12197932, 
                                            0.94293263,0.05706737,0,0.840432,0,0.159568,  
                                            0.62289779,0.3467572,(1-0.3467572-0.62289779),0.6661936 ,0.2537606,(1-0.6661936-0.2537606),  
                                            0.92702989 ,0.04262509 ,(0.01517251+0.01517251),0.8874562 ,0,0.1125438,   
                                            0.98482749,0,0.01517251,0.94962483,0.01967762,(0.01426306+0.01643448),
                                            0.8974658,0.08706451,0.01546969,0.8572919,0.02707577,0.11563233))

finknowdetailgenderse$finknow<- factor(finknowdetailgenderse$finknow, levels=c('Exchange rate_M','Exchange rate_F' ,'Overdrawing an account_M','Overdrawing an account_F','Real interest_M','Real interest_F','Diversification*_M','Diversification*_F','Inflation definition*_M','Inflation definition*_F','Risk and return*_M','Risk and return*_F','Compound interest*_M','Compound interest*_F', 'Interest plus principal*_M','Interest plus principal*_F','Interest on loan*_M','Interest on loan*_F','Time value*_M','Time value*_F'))
finknowdetailgenderse$status<- factor(finknowdetailgenderse$status, levels=c('Correct','Incorrect','Ref/Don´t know' ))
finknowdetail_se <- ggplot(finknowdetailgenderse, aes(fill=status, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+
  coord_flip()
finknowdetail_se 

#employed #proper version
finknowdetailgendere <- data.frame(finknow=rep(c('Exchange rate_M','Exchange rate_F' ,'Overdrawing an account_M','Overdrawing an account_F','Real interest_M','Real interest_F','Diversification*_M','Diversification*_F','Inflation definition*_M','Inflation definition*_F','Risk and return*_M','Risk and return*_F','Compound interest*_M','Compound interest*_F', 'Interest plus principal*_M','Interest plus principal*_F','Interest on loan*_M','Interest on loan*_F','Time value*_M','Time value*_F'), each=3),
                                   status=rep(c('Correct','Incorrect','Ref/Don´t know' ), times=20),
                                   share=c(0.743805912,0.1453599,0.1108342,0.659625245, 0.1749397,  0.1654351 ,
                                           0.7762141 ,0.1376383 ,0.0861476 , 0.703154812 ,0.214553766 ,(0.004494796+ 0.077796626),
                                           0.77442909 ,(0.04688433+0.12413096),(0.01843345 + 0.03612217), 0.765346776 , (0.045856744+ 0.135223186),(0.007405501 +0.046167792),
                                           0.715146681 ,0.144632912 ,(0.008957269 +0.131263138),0.615747892 ,0.181217190 ,(0.001953584+ 0.201081333) ,
                                           0.91308900 ,0.03351947 ,0.05339153 ,0.859708485 ,0.072211819 ,(0.009323992+ 0.058755705),
                                           0.90041254 , 0.03530823 , 0.06427923 ,0.914134923 ,0.053972111 ,(0.001953584 +0.029939382),
                                           0.5534543  ,0.3430558,0.1034899, 0.4856869 , 0.3611409,0.1531722,
                                           0.827807758 ,0.09280624,0.079386,0.747898953 ,0.1194326,0.1326684,
                                           0.922244936 ,(0.020832451+ 0.003951563+ 0.003807905),(0.014539266+ 0.012534812+ 0.022089067),0.870413303 ,(0.030420380+ 0.003554709+ 0.004994470+ 0.002224076 ),(0.028173971 +0.031317930 +0.028901159),
                                           (0.662530957 +0.077892090 ),(0.073554902 +0.152705480),(0.003221358+ 0.005212802+0.024882410),(0.63686116+0.06684878 ),(0.05284933+0.19923814),(0.01209575+0.03210683 )))
finknowdetailgendere$finknow<- factor(finknowdetailgendere$finknow, levels=c('Exchange rate_M','Exchange rate_F' ,'Overdrawing an account_M','Overdrawing an account_F','Real interest_M','Real interest_F','Diversification*_M','Diversification*_F','Inflation definition*_M','Inflation definition*_F','Risk and return*_M','Risk and return*_F','Compound interest*_M','Compound interest*_F', 'Interest plus principal*_M','Interest plus principal*_F','Interest on loan*_M','Interest on loan*_F','Time value*_M','Time value*_F'))
finknowdetailgendere$status<- factor(finknowdetailgendere$status, levels=c('Correct','Incorrect','Ref/Don´t know' ))
finknowdetail_e <-ggplot(finknowdetailgendere, aes(fill=status, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+
  coord_flip()+ theme(panel.grid = element_blank(),
                      axis.text.y = element_blank())
finknowdetail_e

finknowdetail_gendercomp <- finknowdetail_se+finknowdetail_e + plot_layout(guides = "collect")& theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13), axis.text = element_text(size = 14))
finknowdetail_gendercomp


####################SELF-ASSESSMENT & ACTUAL KNOWLEDGE#####################
#graph according to Fessler et al (2020) - probably difficult for self-employed! 
#full
table(ASFL6$fin_know)
f0 <- c("0")
f1 <- c("1")
f2 <- c("2")
f3 <- c("3")
f4 <- c("4")
f5 <- c("5")
f6 <- c("6")
f7 <- c("7")
f8 <- c("8")
f9 <- c("9")
f10 <- c("10")
sa1 <- c("Don't know","Refused")
sa2 <- c("Very low")
sa3 <- c("Quite low")
sa4 <- c("About average")
sa5 <- c("Quite high")
sa6 <- c("Very high")
sa1a <- c("Don't know","Refused")
sa2a <- c("Quite low","Very low")
sa3a <- c("Average")
sa4a <- c("Quite high","Very high")



#SELF-EMPLOYED
table(ASFL6se$fin_know)
#financial knowledge OECD 
ASFL6sef0 <- ASFL6se[(ASFL6se$fin_know %in% f0),] 
table(ASFL6sef0$QK1)
wpct(ASFL6sef0$QK1, weight=ASFL6sef0$wght, na.rm=TRUE)
ASFL6sef1 <- ASFL6se[(ASFL6se$fin_know %in% f1),] 
table(ASFL6sef1$QK1)
wpct(ASFL6sef1$QK1, weight=ASFL6sef1$wght, na.rm=TRUE)
ASFL6sef2 <- ASFL6se[(ASFL6se$fin_know %in% f2),] 
table(ASFL6sef2$QK1)
wpct(ASFL6sef2$QK1, weight=ASFL6sef2$wght, na.rm=TRUE)
ASFL6sef3 <- ASFL6se[(ASFL6se$fin_know %in% f3),] 
table(ASFL6sef3$QK1)
wpct(ASFL6sef3$QK1, weight=ASFL6sef3$wght, na.rm=TRUE)
ASFL6sef4 <- ASFL6se[(ASFL6se$fin_know %in% f4),] 
table(ASFL6sef4$QK1)
wpct(ASFL6sef4$QK1, weight=ASFL6sef4$wght, na.rm=TRUE)
ASFL6sef5 <- ASFL6se[(ASFL6se$fin_know %in% f5),] 
table(ASFL6sef5$QK1)
wpct(ASFL6sef5$QK1, weight=ASFL6sef5$wght, na.rm=TRUE)
ASFL6sef6 <- ASFL6se[(ASFL6se$fin_know %in% f6),] 
table(ASFL6sef6$QK1)
wpct(ASFL6sef6$QK1, weight=ASFL6sef6$wght, na.rm=TRUE)
ASFL6sef7 <- ASFL6se[(ASFL6se$fin_know %in% f7),]
table(ASFL6sef7$QK1)
wpct(ASFL6sef7$QK1, weight=ASFL6sef7$wght, na.rm=TRUE)
#financial knowledge austria-specific
ASFL6sef1 <- ASFL6se[(ASFL6se$fin_know_add %in% f1),] 
table(ASFL6sef1$QK1)
wpct(ASFL6sef1$QK1, weight=ASFL6sef1$wght, na.rm=TRUE)
ASFL6sef2 <- ASFL6se[(ASFL6se$fin_know_add %in% f2),] 
table(ASFL6sef2$QK1)
wpct(ASFL6sef2$QK1, weight=ASFL6sef2$wght, na.rm=TRUE)
ASFL6sef3 <- ASFL6se[(ASFL6se$fin_know_add %in% f3),] 
table(ASFL6sef3$QK1)
wpct(ASFL6sef3$QK1, weight=ASFL6sef3$wght, na.rm=TRUE)
ASFL6sef4 <- ASFL6se[(ASFL6se$fin_know_add %in% f4),] 
table(ASFL6sef4$QK1)
wpct(ASFL6sef4$QK1, weight=ASFL6sef4$wght, na.rm=TRUE)
ASFL6sef5 <- ASFL6se[(ASFL6se$fin_know_add %in% f5),] 
table(ASFL6sef5$QK1)
wpct(ASFL6sef5$QK1, weight=ASFL6sef5$wght, na.rm=TRUE)
ASFL6sef6 <- ASFL6se[(ASFL6se$fin_know_add %in% f6),] 
table(ASFL6sef6$QK1)
wpct(ASFL6sef6$QK1, weight=ASFL6sef6$wght, na.rm=TRUE)
ASFL6sef7 <- ASFL6se[(ASFL6se$fin_know_add %in% f7),]
table(ASFL6sef7$QK1)
wpct(ASFL6sef7$QK1, weight=ASFL6sef7$wght, na.rm=TRUE)
ASFL6sef8 <- ASFL6se[(ASFL6se$fin_know_add %in% f8),]
table(ASFL6sef8$QK1)
wpct(ASFL6sef8$QK1, weight=ASFL6sef8$wght, na.rm=TRUE)
ASFL6sef9 <- ASFL6se[(ASFL6se$fin_know_add %in% f9),]
table(ASFL6sef9$QK1)
wpct(ASFL6sef9$QK1, weight=ASFL6sef9$wght, na.rm=TRUE)
ASFL6sef10 <- ASFL6se[(ASFL6se$fin_know_add %in% f10),]
table(ASFL6sef10$QK1)
wpct(ASFL6sef10$QK1, weight=ASFL6sef10$wght, na.rm=TRUE)


ASFL6sesa1 <- ASFL6se[(ASFL6se$QK1 %in% sa1),]
table(ASFL6sesa1$fin_know)
wpct(ASFL6sesa1$fin_know, weight=ASFL6sesa1$wght, na.rm=TRUE)
ASFL6sesa2 <- ASFL6se[(ASFL6se$QK1 %in% sa2),]
table(ASFL6sesa2$fin_know)
wpct(ASFL6sesa2$fin_know, weight=ASFL6sesa2$wght, na.rm=TRUE)
ASFL6sesa3 <- ASFL6se[(ASFL6se$QK1 %in% sa3),]
table(ASFL6sesa3$fin_know)
wpct(ASFL6sesa3$fin_know, weight=ASFL6sesa3$wght, na.rm=TRUE)
ASFL6sesa4 <- ASFL6se[(ASFL6se$QK1 %in% sa4),]
table(ASFL6sesa4$fin_know)
wpct(ASFL6sesa4$fin_know, weight=ASFL6sesa4$wght, na.rm=TRUE)
ASFL6sesa5 <- ASFL6se[(ASFL6se$QK1 %in% sa5),]
table(ASFL6sesa5$fin_know)
wpct(ASFL6sesa5$fin_know, weight=ASFL6sesa5$wght, na.rm=TRUE)
ASFL6sesa6 <- ASFL6se[(ASFL6se$QK1 %in% sa6),]
table(ASFL6sesa6$fin_know)
wpct(ASFL6sesa6$fin_know, weight=ASFL6sesa6$wght, na.rm=TRUE)


#weighted
finknowsrvsactualse <- data.frame(finknow=rep(c('1', '2', '3','4','5','6','7'), each=6),
                                  selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=7),
                                  share=c(0,0,0,0,1,0, 0.6153794,0,0,0,0,0.3846206 ,0,0,0,0, 0.4575978,0.5424022,0.4258195,0,0.5741805,0,0,0, 0,0.41199686,0.35581963,0.06844854,0,0.16373498,0.1219059,0.4887250,0.3893691,0,0,0,0.1214615,0.5261661,0.3523725,0,0,0))
finknowsrvsactualse$finknow<- factor(finknowsrvsactualse$finknow, levels=c('1', '2', '3','4','5','6','7'))
finknowsrvsactualse$selfassessment<- factor(finknowsrvsactualse$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

savsfk_se <- ggplot(finknowsrvsactualse, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="") +theme(legend.position="none")
savsfk_se
#additional score
finknowsrvsactualseadd <- data.frame(finknow=rep(c('1', '2', '3','4','5','6','7','8','9','10'), each=6),
                                     selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=10),
                                     share=c(0,0,0,0,1,0, 1,0,0,0,0,0 ,0,0,0,0,0.4575978 ,0.5424022 , 0,0,0,0, 0,1, 0,0,1,0,0,0,1,0,0,0,0,0, 0,0.5205521 ,0,0,0,0.4794479,0.06014215,0.29642929,0.58885769,0.05457087,0,0, 0.08196046,0.58286797,0.33517157,0,0,0, 0.1511419,0.5229221,0.3259360,0,0,0))
finknowsrvsactualseadd$finknow<- factor(finknowsrvsactualseadd$finknow, levels=c('1', '2', '3','4','5','6','7','8','9','10'))
finknowsrvsactualseadd$selfassessment<- factor(finknowsrvsactualseadd$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

savsfkadd_se <-ggplot(finknowsrvsactualseadd, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none")
savsfkadd_se

###self-employed gender comparison self-assessed versus actual financial knowledge  - OECD share 
#males
table(ASFL7sem$fin_know)
ASFL7semf1 <- ASFL7sem[(ASFL7sem$fin_know %in% f1),] 
table(ASFL7semf1$QK1)
wpct(ASFL7semf1$QK1, weight=ASFL7semf1$wght, na.rm=TRUE)
ASFL7semf2 <- ASFL7sem[(ASFL7sem$fin_know %in% f2),] 
table(ASFL7semf2$QK1)
wpct(ASFL7semf2$QK1, weight=ASFL7semf2$wght, na.rm=TRUE)
ASFL7semf3 <- ASFL7sem[(ASFL7sem$fin_know %in% f3),] 
table(ASFL7semf3$QK1)
wpct(ASFL7semf3$QK1, weight=ASFL7semf3$wght, na.rm=TRUE)
ASFL7semf4 <- ASFL7sem[(ASFL7sem$fin_know %in% f4),] 
table(ASFL7semf4$QK1)
wpct(ASFL7semf4$QK1, weight=ASFL7semf4$wght, na.rm=TRUE)
ASFL7semf5 <- ASFL7sem[(ASFL7sem$fin_know %in% f5),] 
table(ASFL7semf5$QK1)
wpct(ASFL7semf5$QK1, weight=ASFL7semf5$wght, na.rm=TRUE)
ASFL7semf6 <- ASFL7sem[(ASFL7sem$fin_know %in% f6),] 
table(ASFL7semf6$QK1)
wpct(ASFL7semf6$QK1, weight=ASFL7semf6$wght, na.rm=TRUE)
ASFL7semf7 <- ASFL7sem[(ASFL7sem$fin_know %in% f7),]
table(ASFL7semf7$QK1)
wpct(ASFL7semf7$QK1, weight=ASFL7semf7$wght, na.rm=TRUE)

#males
finknowsrvsactualsemales <- data.frame(finknow=rep(c('1', '2', '3','4','5','6','7'), each=6),
                                       selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=7),
                                       share=c(0,0,0,0,0,0,  0.6153794,0,0,0,0,0.3846206     ,0,0,0,0,0,0     ,1,0,0,0,0,0,   0,0.47004873,0.43142287,0,0,0.09852841       ,0,0.7099677,0.2900323,0,0,0,   0.1594925 ,0.5504949,0.2900126,0,0,0))
finknowsrvsactualsemales$finknow<- factor(finknowsrvsactualsemales$finknow, levels=c('1', '2', '3','4','5','6','7'))
finknowsrvsactualsemales$selfassessment<- factor(finknowsrvsactualsemales$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

savsfk_se_male <-ggplot(finknowsrvsactualsemales, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none")
savsfk_se_male

#females
table(ASFL7sef$fin_know)
ASFL7seff1 <- ASFL7sef[(ASFL7sef$fin_know %in% f1),] 
table(ASFL7seff1$QK1)
wpct(ASFL7seff1$QK1, weight=ASFL7seff1$wght, na.rm=TRUE)
ASFL7seff2 <- ASFL7sef[(ASFL7sef$fin_know %in% f2),] 
table(ASFL7seff2$QK1)
wpct(ASFL7seff2$QK1, weight=ASFL7seff2$wght, na.rm=TRUE)
ASFL7seff3 <- ASFL7sef[(ASFL7sef$fin_know %in% f3),] 
table(ASFL7seff3$QK1)
wpct(ASFL7seff3$QK1, weight=ASFL7seff3$wght, na.rm=TRUE)
ASFL7seff4 <- ASFL7sef[(ASFL7sef$fin_know %in% f4),] 
table(ASFL7seff4$QK1)
wpct(ASFL7seff4$QK1, weight=ASFL7seff4$wght, na.rm=TRUE)
ASFL7seff5 <- ASFL7sef[(ASFL7sef$fin_know %in% f5),] 
table(ASFL7seff5$QK1)
wpct(ASFL7seff5$QK1, weight=ASFL7seff5$wght, na.rm=TRUE)
ASFL7seff6 <- ASFL7sef[(ASFL7sef$fin_know %in% f6),] 
table(ASFL7seff6$QK1)
wpct(ASFL7seff6$QK1, weight=ASFL7seff6$wght, na.rm=TRUE)
ASFL7seff7 <- ASFL7sef[(ASFL7sef$fin_know %in% f7),]
table(ASFL7seff7$QK1)
wpct(ASFL7seff7$QK1, weight=ASFL7seff7$wght, na.rm=TRUE)

finknowsrvsactualsefemales <- data.frame(finknow=rep(c('1', '2', '3','4','5','6','7'), each=6),
                                         selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=7),
                                         share=c(0,0,0,0,1,0,  0,0,0,0,0,0     ,0,0,0,0,0.4575978,0.5424022      ,0,0,1,0,0,0,   0,0.3177529,0.2330821,0.1795709,0,0.2695941       ,0.2882284,0.1868723,0.5248993 ,0,0,0,   0.05170461,0.48154196 ,0.46675343,0,0,0))
finknowsrvsactualsefemales$finknow<- factor(finknowsrvsactualsefemales$finknow, levels=c('1', '2', '3','4','5','6','7'))
finknowsrvsactualsefemales$selfassessment<- factor(finknowsrvsactualsefemales$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
savsfk_se_female<-ggplot(finknowsrvsactualsefemales, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="",fill="")+theme(legend.position="none")
savsfk_se_female

#self-assessed versus actual financial knowledge
#EMPLOYED
table(ASFL6e$fin_know)
f0 <- c("0")
ASFL6ef0 <- ASFL6e[(ASFL6e$fin_know %in% f0),] 
table(ASFL6ef0$QK1)
wpct(ASFL6ef0$QK1, weight=ASFL6ef0$wght, na.rm=TRUE)
ASFL6ef1 <- ASFL6e[(ASFL6e$fin_know %in% f1),] 
table(ASFL6ef1$QK1)
wpct(ASFL6ef1$QK1, weight=ASFL6ef1$wght, na.rm=TRUE)
ASFL6ef2 <- ASFL6e[(ASFL6e$fin_know %in% f2),] 
table(ASFL6ef2$QK1)
wpct(ASFL6ef2$QK1, weight=ASFL6ef2$wght, na.rm=TRUE)
ASFL6ef3 <- ASFL6e[(ASFL6e$fin_know %in% f3),] 
table(ASFL6ef3$QK1)
wpct(ASFL6ef3$QK1, weight=ASFL6ef3$wght, na.rm=TRUE)
ASFL6ef4 <- ASFL6e[(ASFL6e$fin_know %in% f4),] 
table(ASFL6ef4$QK1)
wpct(ASFL6ef4$QK1, weight=ASFL6ef4$wght, na.rm=TRUE)
ASFL6ef5 <- ASFL6e[(ASFL6e$fin_know %in% f5),] 
table(ASFL6ef5$QK1)
wpct(ASFL6ef5$QK1, weight=ASFL6ef5$wght, na.rm=TRUE)
ASFL6ef6 <- ASFL6e[(ASFL6e$fin_know %in% f6),] 
table(ASFL6ef6$QK1)
wpct(ASFL6ef6$QK1, weight=ASFL6ef6$wght, na.rm=TRUE)
ASFL6ef7 <- ASFL6e[(ASFL6e$fin_know %in% f7),]
table(ASFL6ef7$QK1)
wpct(ASFL6ef7$QK1, weight=ASFL6ef7$wght, na.rm=TRUE)

#financial knowledge austria-specific
ASFL6ef0 <- ASFL6e[(ASFL6e$fin_know_add %in% f0),] 
table(ASFL6ef0$QK1)
wpct(ASFL6ef0$QK1, weight=ASFL6ef0$wght, na.rm=TRUE)
ASFL6ef1 <- ASFL6e[(ASFL6e$fin_know_add %in% f1),] 
table(ASFL6ef1$QK1)
wpct(ASFL6ef1$QK1, weight=ASFL6ef1$wght, na.rm=TRUE)
ASFL6ef2 <- ASFL6e[(ASFL6e$fin_know_add %in% f2),] 
table(ASFL6ef2$QK1)
wpct(ASFL6ef2$QK1, weight=ASFL6ef2$wght, na.rm=TRUE)
ASFL6ef3 <- ASFL6e[(ASFL6e$fin_know_add %in% f3),] 
table(ASFL6ef3$QK1)
wpct(ASFL6ef3$QK1, weight=ASFL6ef3$wght, na.rm=TRUE)
ASFL6ef4 <- ASFL6e[(ASFL6e$fin_know_add %in% f4),] 
table(ASFL6ef4$QK1)
wpct(ASFL6ef4$QK1, weight=ASFL6ef4$wght, na.rm=TRUE)
ASFL6ef5 <- ASFL6e[(ASFL6e$fin_know_add %in% f5),] 
table(ASFL6ef5$QK1)
wpct(ASFL6ef5$QK1, weight=ASFL6ef5$wght, na.rm=TRUE)
ASFL6ef6 <- ASFL6e[(ASFL6e$fin_know_add %in% f6),] 
table(ASFL6ef6$QK1)
wpct(ASFL6ef6$QK1, weight=ASFL6ef6$wght, na.rm=TRUE)
ASFL6ef7 <- ASFL6e[(ASFL6e$fin_know_add %in% f7),]
table(ASFL6ef7$QK1)
wpct(ASFL6ef7$QK1, weight=ASFL6ef7$wght, na.rm=TRUE)
ASFL6ef8 <- ASFL6e[(ASFL6e$fin_know_add %in% f8),]
table(ASFL6ef8$QK1)
wpct(ASFL6ef8$QK1, weight=ASFL6ef8$wght, na.rm=TRUE)
ASFL6ef9 <- ASFL6e[(ASFL6e$fin_know_add %in% f9),]
table(ASFL6ef9$QK1)
wpct(ASFL6ef9$QK1, weight=ASFL6ef9$wght, na.rm=TRUE)
ASFL6ef10 <- ASFL6e[(ASFL6e$fin_know_add %in% f10),]
table(ASFL6ef10$QK1)
wpct(ASFL6ef10$QK1, weight=ASFL6ef10$wght, na.rm=TRUE)


#weighted
finknowsrvsactuale <- data.frame(finknow=rep(c('0','1', '2', '3','4','5','6','7'), each=6),
                                 selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=8),
                                 share=c(0.2098396,0.3194787,0.2366402,0.2340415,0,0,0.1141987,0.1217890,0.3336348,0.3072708,0,0.1231066,0.07554566,0.20428725,0.40472719,0.17406951,0.07725223 ,0.06411817,0.08002219,0.18573293,0.41269069,0.19568430,0.11214470,0.01372519,0.07820165,0.25849217,0.42282345,0.17915729,0.03574778,(0.01456135+0.01101631),0.07829734,0.26175988,0.46580907,0.15018534,0.02204253,0.02190585,0.13272466,0.34209866,0.41341018,0.07869608,0.01123968,0.02183074,0.122849521,0.392189095,0.402995932,0.066708399,0.005178042,0.010079010 ))
finknowsrvsactuale$finknow<- factor(finknowsrvsactuale$finknow, levels=c('0', '1', '2', '3','4','5','6','7'))
finknowsrvsactuale$selfassessment<- factor(finknowsrvsactuale$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

savsfk_e <- ggplot(finknowsrvsactuale, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="",fill="")+theme(legend.position="none")
savsfk_e

#weighted enlarged
finknowsrvsactualeadd <- data.frame(finknow=rep(c('0','1', '2', '3','4','5','6','7','8','9','10'), each=6),
                                    selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=11),
                                    share=c(0,0,1,0,0,0,0.2510720,0.2095666,0.3858386,0.1535228,0,0 , 0,0.45679982,0.06117439,0.28816653 ,0,(0.13273732+0.06112194),  0.05862425,0.07782021,0.26011025,0.33726083,0.21842182,0.04776264,   0.04241135,0.11906924,0.48086800,0.26077658,0.08088971,0.01598512,0.09457541  ,0.25886089,0.46880651,0.14895974,0.01294548, 0.01585196,   0.128003746,0.305082015,0.350512828,0.178317765,0.029872562, 0.008211084,0.09355030,0.33611440,0.35136372,0.10160937,0.05199996 ,0.06536225, 0.116581645,0.290227667  , 0.463043096,0.098878986,0.004577588,0.026691018,   0.10935602,0.35367009,0.44382987,0.06296554,0.01529384 ,0.01488465,  0.13474292,0.39126382,0.4083966,0.06559663,0,0))
finknowsrvsactualeadd$finknow<- factor(finknowsrvsactualeadd$finknow, levels=c('0','1', '2', '3','4','5','6','7','8','9','10'))
finknowsrvsactualeadd$selfassessment<- factor(finknowsrvsactualeadd$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
savsfkadd_e <- ggplot(finknowsrvsactualeadd, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="",fill="")+theme(legend.position="none")
savsfkadd_e

###employed gender comparison self-assessed versus actual financial knowledge  - OECD share 
#males
table(ASFL7em$fin_know)
ASFL7emf0 <- ASFL7em[(ASFL7em$fin_know %in% f0),] 
table(ASFL7emf0$QK1)
wpct(ASFL7emf0$QK1, weight=ASFL7emf0$wght, na.rm=TRUE)
ASFL7emf1 <- ASFL7em[(ASFL7em$fin_know %in% f1),] 
table(ASFL7emf1$QK1)
wpct(ASFL7emf1$QK1, weight=ASFL7emf1$wght, na.rm=TRUE)
ASFL7emf2 <- ASFL7em[(ASFL7em$fin_know %in% f2),] 
table(ASFL7emf2$QK1)
wpct(ASFL7emf2$QK1, weight=ASFL7emf2$wght, na.rm=TRUE)
ASFL7emf3 <- ASFL7em[(ASFL7em$fin_know %in% f3),] 
table(ASFL7emf3$QK1)
wpct(ASFL7emf3$QK1, weight=ASFL7emf3$wght, na.rm=TRUE)
ASFL7emf4 <- ASFL7em[(ASFL7em$fin_know %in% f4),] 
table(ASFL7emf4$QK1)
wpct(ASFL7emf4$QK1, weight=ASFL7emf4$wght, na.rm=TRUE)
ASFL7emf5 <- ASFL7em[(ASFL7em$fin_know %in% f5),] 
table(ASFL7emf5$QK1)
wpct(ASFL7emf5$QK1, weight=ASFL7emf5$wght, na.rm=TRUE)
ASFL7emf6 <- ASFL7em[(ASFL7em$fin_know %in% f6),] 
table(ASFL7emf6$QK1)
wpct(ASFL7emf6$QK1, weight=ASFL7emf6$wght, na.rm=TRUE)
ASFL7emf7 <- ASFL7em[(ASFL7em$fin_know %in% f7),]
table(ASFL7emf7$QK1)
wpct(ASFL7emf7$QK1, weight=ASFL7emf7$wght, na.rm=TRUE)

#males
finknowsrvsactualemales <- data.frame(finknow=rep(c('0','1', '2', '3','4','5','6','7'), each=6),
                                      selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=8),
                                      share=c(0, 0.5744791,0.4255209,0,0,0,0.1792174,0,0.4770879,0,0,0.3436948,0, 0.28883572 , 0.32651444,0.28883572, 0,0.09581413, 0.12710670, 0.20135147,0.41051877,0.10462267, 0.13119898,0.02520141 ,0.06401908,0.38737118, 0.30639131, 0.22858886 ,0,0.01362957,0.05314660, 0.25509995, 0.55621984,0.06716284,0.02108105 ,0.04728972,0.15592899,0.37554513,0.40749972,0.03789304,0,0.02313312, 0.14512801,0.41595356,0.39326854 , 0.04564989 ,0,0   ))
finknowsrvsactualemales$finknow<- factor(finknowsrvsactualemales$finknow, levels=c('0','1', '2', '3','4','5','6','7'))
finknowsrvsactualemales$selfassessment<- factor(finknowsrvsactualemales$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

savsfk_e_male <- ggplot(finknowsrvsactualemales, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none")  #alternative mit "Percentage share!
savsfk_e_male
#females
table(ASFL7ef$fin_know)
ASFL7eff0 <- ASFL7ef[(ASFL7ef$fin_know %in% f0),] 
table(ASFL7eff0$QK1)
wpct(ASFL7eff0$QK1, weight=ASFL7eff0$wght, na.rm=TRUE)
ASFL7eff1 <- ASFL7ef[(ASFL7ef$fin_know %in% f1),] 
table(ASFL7eff1$QK1)
wpct(ASFL7eff1$QK1, weight=ASFL7eff1$wght, na.rm=TRUE)
ASFL7eff2 <- ASFL7ef[(ASFL7ef$fin_know %in% f2),] 
table(ASFL7eff2$QK1)
wpct(ASFL7eff2$QK1, weight=ASFL7eff2$wght, na.rm=TRUE)
ASFL7eff3 <- ASFL7ef[(ASFL7ef$fin_know %in% f3),] 
table(ASFL7eff3$QK1)
wpct(ASFL7eff3$QK1, weight=ASFL7eff3$wght, na.rm=TRUE)
ASFL7eff4 <- ASFL7ef[(ASFL7ef$fin_know %in% f4),] 
table(ASFL7eff4$QK1)
wpct(ASFL7eff4$QK1, weight=ASFL7eff4$wght, na.rm=TRUE)
ASFL7eff5 <- ASFL7ef[(ASFL7ef$fin_know %in% f5),] 
table(ASFL7eff5$QK1)
wpct(ASFL7eff5$QK1, weight=ASFL7eff5$wght, na.rm=TRUE)
ASFL7eff6 <- ASFL7ef[(ASFL7ef$fin_know %in% f6),] 
table(ASFL7eff6$QK1)
wpct(ASFL7eff6$QK1, weight=ASFL7eff6$wght, na.rm=TRUE)
ASFL7eff7 <- ASFL7ef[(ASFL7ef$fin_know %in% f7),]
table(ASFL7eff7$QK1)
wpct(ASFL7eff7$QK1, weight=ASFL7eff7$wght, na.rm=TRUE)

finknowsrvsactualefemales <- data.frame(finknow=rep(c('0','1', '2', '3','4','5','6','7'), each=6),
                                        selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=8),
                                        share=c(0.4727384,0,0, 0.5272616,0,0, 0.07791286 ,0.18975753 ,0.25357599, 0.47875361 ,0,0, 0.1084920 ,0.1674147,0.4388366, 0.1240187 , 0.1109428 ,0.0502952, 0.02371057,0.16705364,0.41528823, 0.30459119 , 0.08935637 ,0,0.08897155, 0.16062458 , 0.51123918 ,0.14162016,0.06289378,( 0.01526892 + 0.01938183), 0.10000199,0.26750727 ,0.38778611,0.22183235 , 0.02287227 ,0, 0.10449184 ,0.30140419, 0.42060146 ,0.12834133,0.02491506 ,0.02024612,0.09207769 , 0.35936478,0.41643174  ,0.09579516 , 0.01233014 ,0.02400049))
finknowsrvsactualefemales$finknow<- factor(finknowsrvsactualefemales$finknow, levels=c('0','1', '2', '3','4','5','6','7'))
finknowsrvsactualefemales$selfassessment<- factor(finknowsrvsactualefemales$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

savsfk_e_female<- ggplot(finknowsrvsactualefemales, aes(fill=selfassessment, y=share, x=finknow)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="",fill="")+theme(legend.position="none")
savsfk_e_female



#final sankey plots
savsfk <- savsfk_se+savsfk_e + plot_layout(guides = "collect")& theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13))
savsfk

savsfkadd <- savsfkadd_se+savsfkadd_e + plot_layout(guides = "collect")&theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13))
savsfkadd

savsfkgender_se <- savsfk_se_male+savsfk_se_female + plot_layout(guides = "collect")&theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13))
savsfkgender_se

savsfkgender_e<- savsfk_e_male+savsfk_e_female + plot_layout(guides = "collect")&theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13))
savsfkgender_e

savsfkgender<- savsfk_se_male+savsfk_se_female+savsfk_e_male+savsfk_e_female + plot_layout(guides = "collect")&theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13))
savsfkgender


#########################AGE and SELF-assessed knowledge#############################
#self-employed
ageselfassess_se <- data.frame(age=rep(c('Old millennials', 'Generation X', 'Baby-boomers'), each=6),
                               selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=3),
                               share=c(0.4115508,0.2304435,0.3580057,0,0,0,0.05208442,0.47618474,0.36171944,0.01235902,0.03951299,0.05813939,0.4166801,0.3675882,0.2157317,0,0,0  ))
ageselfassess_se$age<- factor(ageselfassess_se$age, levels=c('Young millennial', 'Old millennials', 'Generation X', 'Baby-boomers','Silent generation'))
ageselfassess_se$selfassessment<- factor(ageselfassess_se$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))

saagegroup_se <- ggplot(ageselfassess_se, aes(fill=selfassessment, y=share, x=age)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none")
saagegroup_se

#employed
ageselfassess_e <- data.frame(age=rep(c('Young millennials', 'Old millennials', 'Generation X', 'Baby boomers','Silent generation'), each=6),
                              selfassessment=rep(c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'), times=5),
                              share=c(0.05840070,0.22247773,0.48925905,0.17573779,0.05412473 ,0,0.10473126,0.34912473,0.35608406,0.13586425,0.02990031 ,0.02429540,0.127932266,0.332388591,0.414106697,0.086343780 ,0.010474480,0.02875419, 0.14525239,0.32658226,0.43337453,0.06825270,0,0.02653811,1,0,0,0,0,0))
ageselfassess_e$age<- factor(ageselfassess_e$age, levels=c('Young millennials', 'Old millennials', 'Generation X', 'Baby boomers','Silent generation'))
ageselfassess_e$selfassessment<- factor(ageselfassess_e$selfassessment, levels=c('Very high','Quite high', 'Average', 'Quite low', 'Very low','Ref/Don´t know'))
saagegroup_e <-ggplot(ageselfassess_e, aes(fill=selfassessment, y=share, x=age)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="",fill="")+theme(legend.position="none")
saagegroup_e

saagegroup <- saagegroup_se+saagegroup_e + plot_layout(guides = "collect")&theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13), axis.text = element_text(size = 13))& guides(fill=guide_legend(nrow=2, byrow=TRUE))
saagegroup


###################################FINANCIAL BEHAVIOUR############################################
finbeh <- c(rep("0" ,2),rep("1" ,2) , rep("2" , 2) ,  rep("3" , 2),rep("4" , 2),rep("5" , 2),rep("6" , 2),rep("7" , 2),rep("8" , 2),rep("9" , 2))
emplstat <- rep(c("Self-employed" , "Employees" ) , 10)
value <- abs(c(0,0.002086541  ,0,0.009026878  ,0,0.023383445 ,0,0.044876836  , 0.03301144 ,0.076993411 ,0.10728803 , 0.155255602  ,0.25663641 ,0.207614159  ,0.32160377 ,0.256683235  ,0.19495995 ,0.156425619  ,0.08650040 ,0.067654273  ))

finbeh<- data.frame(finbeh,emplstat,value)
finbeh$emplstat<- factor(finbeh$emplstat, levels=c("Self-employed" , "Employees"  ))
finbehcomp <- ggplot(finbeh, aes(fill=emplstat, y=value, x=finbeh)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="")
finbehcomp

###################################FINANCIAL ATTITUDE############################################
finatt <- c(rep("1" ,2) , rep("2" , 2) ,  rep("3" , 2),rep("4" , 2),rep("5" , 2))
emplstat <- rep(c("Self-employed" , "Employed" ) , 5)
value <- abs(c(0.009898962,(0.019702185+0.015250336), (0.017642861+0.049240888+0.037445602), (0.030863270+0.080344159+0.066798590) ,(0.128762416+0.162110230+0.147164521),(0.111915009+0.160942769+0.166338157),(0.249522741+0.112254614+0.022341435), (0.156959210+0.130576429+0.038484449),0.063615729,(0.013488896+0.008336541)))
finatt<- data.frame(finatt,emplstat,value)
finatt$emplstat<- factor(finatt$emplstat, levels=c("Self-employed" , "Employed" ))
finattcomp <- ggplot(finatt, aes(fill=emplstat, y=value, x=finatt)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="")

finattcomp

###################################SUBGROUP DIFFERENCES in financial literacy############################################
#####gender comparison main financial literacy scores 

####self-employed
#weighted
finlitcomparison <- c(rep("Knowledge" , 2) , rep("Behaviour" , 2) , rep("Attitude" , 2) )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c(6.161039,5.749211,7.007273,6.489682,3.291648,3.319749))
finlitcomparisongender<- data.frame(finlitcomparison,gender,value)
finlitcomparisongender$finlitcomparison<- factor(finlitcomparisongender$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisongender$gender<- factor(finlitcomparisongender$gender, levels=c("Male" , "Female"))
fingencomp_se <- ggplot(finlitcomparisongender, aes(fill=gender, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'), axis.text = element_text(size = 15))
fingencomp_se
####employed
finlitcomparison <- c(rep("Knowledge" , 2) , rep("Behaviour" , 2) , rep("Attitude" , 2) )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c(5.572578,5.1973,6.2366,6.11386,3.053325,3.177074))
finlitcomparisongender<- data.frame(finlitcomparison,gender,value)
finlitcomparisongender$finlitcomparison<- factor(finlitcomparisongender$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisongender$gender<- factor(finlitcomparisongender$gender, levels=c("Male" , "Female"))
fingencomp_e <-ggplot(finlitcomparisongender, aes(fill=gender, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
fingencomp_e

#####age group comparison main financial literacy scores 

####self-employed
#weighted
finlitcomparison <- c(rep("Knowledge" , 5) , rep("Behaviour" , 5) , rep("Attitude" , 5) )
agegroup <- rep(c("Young millennials", "Old millennials" , "Generation X", "Baby-boomers", "Silent generation" ) , 3)
value <- abs(c(0,6.43318,5.971818,5.915405,0,0,7.404092,6.731798,6.933479,0,0,3.581911,3.324066,3.004795, 0))
finlitcomparisonage<- data.frame(finlitcomparison,agegroup,value)
finlitcomparisonage$finlitcomparison<- factor(finlitcomparisonage$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisonage$agegroup<- factor(finlitcomparisonage$agegroup, levels=c("Young millennials", "Old millennials" , "Generation X", "Baby-boomers", "Silent generation" ))
finagecomp_se <-ggplot(finlitcomparisonage, aes(fill=agegroup, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=13), axis.text = element_text(size = 15))# guides(fill=guide_legend(nrow=2, byrow=TRUE))
finagecomp_se
####employed
finlitcomparison <- c(rep("Knowledge" , 5) , rep("Behaviour" , 5) , rep("Attitude" , 5) )
agegroup <- rep(c("Young millennials", "Old millennials" , "Generation X", "Baby-boomers", "Silent generation" ) , 3)
value <- abs(c(5.070268,5.400707,5.45375, 6.142982,7 ,5.811853,6.211901,6.309896,6.04485,6,2.696193,3.14479, 3.261084,3.055484,2.666667))
finlitcomparisonage<- data.frame(finlitcomparison,agegroup,value)
finlitcomparisonage$finlitcomparison<- factor(finlitcomparisonage$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisonage$agegroup<- factor(finlitcomparisonage$agegroup, levels=c("Young millennials", "Old millennials" , "Generation X", "Baby-boomers", "Silent generation"))
finagecomp_e<- ggplot(finlitcomparisonage, aes(fill=agegroup, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))+guides(fill=guide_legend(nrow=2, byrow=TRUE))
finagecomp_e

######education comparison main financial literacy scores 

####self-employed
finlitcomparison <- c(rep("Knowledge" , 2) , rep("Behaviour" , 2) , rep("Attitude" , 2) )
education <- rep(c("Lower", "Higher" ) , 3)
value <- abs(c(5.651829,6.452496,6.673599,6.963768,3.302335,3.30395))
finlitcomparisoneducation<- data.frame(finlitcomparison,education,value)
finlitcomparisoneducation$finlitcomparison<- factor(finlitcomparisoneducation$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisoneducation$education<- factor(finlitcomparisoneducation$education, levels=c("Lower", "Higher" ))
fineduccomp_se <- ggplot(finlitcomparisoneducation, aes(fill=education, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("green",
                             "purple"))+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
fineduccomp_se
#detailed
finlitcomparison <- c(rep("Knowledge" , 5) , rep("Behaviour" , 5) , rep("Attitude" , 5) )
education <- rep(c("Primary" , "Lower secondary", "Upper secondary", "University" ,"Akademie") , 3)
value <- abs(c(5.810818,5.635405,6.055423,6.657436,6.546933,  5.507917,6.79402,6.331562,7.363234,6,2.759301,3.358433,3.134587,3.390024,3.364622))
finlitcomparisoneducation<- data.frame(finlitcomparison,education,value)
finlitcomparisoneducation$finlitcomparison<- factor(finlitcomparisoneducation$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisoneducation$education<- factor(finlitcomparisoneducation$education, levels=c("Primary" , "Lower secondary", "Upper secondary", "University" ,"Akademie"))
fineducdetailcomp_se<- ggplot(finlitcomparisoneducation, aes(fill=education, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom")
fineducdetailcomp_se
####employed
finlitcomparison <- c(rep("Knowledge" , 2) , rep("Behaviour" , 2) , rep("Attitude" , 2) )
education <- rep(c("Lower", "Higher" ) , 3)
value <- abs(c(5.158952,5.85291,5.896997,6.733201,3.302335,3.267067))
finlitcomparisongender<- data.frame(finlitcomparison,education,value)
finlitcomparisongender$finlitcomparison<- factor(finlitcomparisongender$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisongender$education<- factor(finlitcomparisongender$education, levels=c("Lower", "Higher" ))
fineduccomp_e <- ggplot(finlitcomparisongender, aes(fill=education, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("green",
                             "purple"))+
  labs(x = "",y="Mean score", fill = "")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
fineduccomp_e
#detailed
finlitcomparison <- c(rep("Knowledge" , 5) , rep("Behaviour" , 5) , rep("Attitude" , 5) )
education <- rep(c("Primary" , "Lower secondary", "Upper secondary", "University" ,"Akademie") , 3)
value <- abs(c(4.040015,5.277985,5.80295,5.998981,5.554505,5.437746,5.945852,6.887595,6.474886,6.697646,2.893271,3.05032,3.34524,3.13283,3.26616))
finlitcomparisoneducation<- data.frame(finlitcomparison,education,value)
finlitcomparisoneducation$finlitcomparison<- factor(finlitcomparisoneducation$finlitcomparison, levels=c("Knowledge","Behaviour","Attitude"))
finlitcomparisoneducation$education<- factor(finlitcomparisoneducation$education, levels=c("Primary" , "Lower secondary", "Upper secondary", "University" ,"Akademie"))
fineducdetailcomp_e<- ggplot(finlitcomparisoneducation, aes(fill=education, y=value, x=finlitcomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x = "",y="", fill = "")+theme(legend.position="none")
fineducdetailcomp_e

fineducdetailcomp <- fineducdetailcomp_se+fineducdetailcomp_e + plot_layout(guides = "collect")& theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))&guides(fill=guide_legend(nrow=2, byrow=TRUE))
fineducdetailcomp

###################################FINANCIAL INCLUSION############################################
#####finincl1
finincl1 <- c(rep("Awareness" , 2) , rep("Recent purchase" , 2) , rep("Family & Friends" , 2) )
emplstat <- rep(c("Self-employed" , "Employees" ) , 3)
value <- abs(c((1-0.009898962-0.021408774),(1-0.013245258- 0.010562546 -0.028141207),(1-0.46595312),(1-0.4686712937),0.07881445 ,0.1335889 ))
financialinclusionplot1 <- data.frame(finincl1,emplstat,value)
financialinclusionplot1$finincl1<- factor(financialinclusionplot1$finincl1, levels=c('Awareness', 'Recent purchase', 'Family & Friends'))
financialinclusionplot1$emplstat<- factor(financialinclusionplot1$emplstat, levels=c('Self-employed', 'Employees'))
finincl1comp <- ggplot(financialinclusionplot1, aes(fill=emplstat, y=value, x=finincl1)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15),axis.text = element_text(size = 15))
finincl1comp
#####finincl2
finincl2 <- c(rep("Saving,Investment,Retirement" , 2) , rep("Payment" , 2) , rep("Insurance" , 2) , rep("Credit" , 2))
emplstat <- rep(c("Self-employed" , "Employees"  ) , 4)
value <- abs(c((1-0.09229320 ),(1-0.08266264 ),1,(1-0.009812379 ),0.8830564 ,0.8075743  ,(1-0.13404446 ),(1-0.2872825616 )))
financialinclusionplot2 <- data.frame(finincl2,emplstat,value)
financialinclusionplot2$finincl2<- factor(financialinclusionplot2$finincl2, levels=c('Saving,Investment,Retirement','Payment','Insurance','Credit'))
financialinclusionplot2$emplstat<- factor(financialinclusionplot2$emplstat, levels=c('Self-employed', 'Employees'))
finincl2comp<- ggplot(financialinclusionplot2, aes(fill=emplstat, y=value, x=finincl2)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15),axis.text = element_text(size = 15))
finincl2comp

finincl1comp+finincl2comp+plot_layout(guides = "collect")& theme(legend.position = "bottom")

#gender specific
#self-employed
finincl1 <- c(rep("Awareness" , 2) , rep("Recent purchase" , 2) , rep("Family & Friends" , 2) )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c((1-0.01663340 -0.01517251 ),(1-0.03057546 ),(1-0.32043103 ),(1-0.67985622 ),0.08708959 ,0.06665082 ))
financialinclusionplot1 <- data.frame(finincl1,gender,value)
financialinclusionplot1$finincl1<- factor(financialinclusionplot1$finincl1, levels=c('Awareness', 'Recent purchase', 'Family & Friends'))
financialinclusionplot1$gender<- factor(financialinclusionplot1$gender, levels=c("Male" , "Female"))
finincl1_se <- ggplot(financialinclusionplot1, aes(fill=gender, y=value, x=finincl1)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
finincl1_se

finincl2 <- c(rep("Saving,Investment,Retirement" , 2) , rep("Payment" , 2) , rep("Insurance" , 2) , rep("Credit" , 2))
gender <- rep(c("Male" , "Female" ) , 4)
value <- abs(c((1-0.06101732),(1-0.13826565),1,1, 0.8874382 ,0.8766156, (1-0.06886512),(1-0.22985166)))
financialinclusionplot2 <- data.frame(finincl2,gender,value)
financialinclusionplot2$finincl2<- factor(financialinclusionplot2$finincl2, levels=c('Saving,Investment,Retirement','Payment','Insurance','Credit'))
financialinclusionplot2$gender<- factor(financialinclusionplot2$gender, levels=c("Male" , "Female" ))
finincl2_se <- ggplot(financialinclusionplot2, aes(fill=gender, y=value, x=finincl2)) + 
  geom_bar(position = "dodge", stat="identity",width = 0.8)+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
finincl2_se

finincl_se <-finincl1_se+ finincl2_se+plot_layout(guides = "collect")& theme(legend.position = "bottom")
finincl_se

#employed
finincl1 <- c(rep("Awareness" , 2) , rep("Recent purchase" , 2) , rep("Family & Friends" , 2) )
gender <- rep(c("Male" , "Female" ) , 3)
value <- abs(c(0.9427017,0.9537993,0.5669306 ,0.4930709 ,0.1338034  ,0.1333584  ))
financialinclusionplot1 <- data.frame(finincl1,gender,value)
financialinclusionplot1$finincl1<- factor(financialinclusionplot1$finincl1, levels=c('Awareness', 'Recent purchase', 'Family & Friends'))
financialinclusionplot1$gender<- factor(financialinclusionplot1$gender, levels=c("Male" , "Female"))
finincl1_e<- ggplot(financialinclusionplot1, aes(fill=gender, y=value, x=finincl1)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 15))
finincl1_e

finincl2 <- c(rep("Saving,Investment,Retirement" , 2) , rep("Payment" , 2) , rep("Insurance" , 2) , rep("Credit" , 2))
gender <- rep(c("Male" , "Female" ) , 4)
value <- abs(c(0.91485561, 0.92000426 ,0.995197492,0.98480401 ,0.8113671,0.8034987,0.7556449,0.6665875 ))
financialinclusionplot2 <- data.frame(finincl2,gender,value)
financialinclusionplot2$finincl2<- factor(financialinclusionplot2$finincl2, levels=c('Saving,Investment,Retirement','Payment','Insurance','Credit'))
financialinclusionplot2$gender<- factor(financialinclusionplot2$gender, levels=c("Male" , "Female" ))
finincl2_e<- ggplot(financialinclusionplot2, aes(fill=gender, y=value, x=finincl2)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15),axis.text = element_text(size = 15))
finincl2_e

finincl_e <-finincl1_e+ finincl2_e+plot_layout(guides = "collect")& theme(legend.position = "bottom")
finincl_e

###################################FINANCIAL WELL-BEING############################################
wellbeing <- c(rep("Modest role of finances" , 2),  rep("Saving possibility" , 2),rep("No unaffordable wishes" , 2) , rep("Few concerns" , 2) , rep("Not 'just getting by'" ,2) )
emplstat <- rep(c("Self-employed" , "Employees" ) , 5)
value <- abs(c((1-0.4034880),(1-0.4184430 ),(1-0.5439856 ),(1-0.5721883 ),(1-0.5311104 ),(1-0.5964242 ),(1-0.3706735 ),(1-0.4379736 ),(1-0.4542531 ),(1-0.5839444 )))
wellbeingplotspecific <- data.frame(wellbeing,emplstat,value)
wellbeingplotspecific$wellbeing<- factor(wellbeingplotspecific$wellbeing, levels=c("Modest role of finances","Saving possibility" ,"No unaffordable wishes" ,"Few concerns","Not 'just getting by'" ))
wellbeingplotspecific$emplstat<- factor(wellbeingplotspecific$emplstat, levels=c( "Self-employed" , "Employees"))
finwellbeingcomp <- ggplot(wellbeingplotspecific, aes(fill=emplstat, y=value, x=wellbeing)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),  axis.text = element_text(size = 15))
finwellbeingcomp

#genderspecific
#self-employed
wellbeing <- c(rep("Modest role of finances" , 2),  rep("Saving possibility" , 2),rep("No unaffordable wishes" , 2) , rep("Few concerns" , 2) , rep("Not 'just getting by'" ,2))
gender <- rep(c("Male" , "Female") , 5)
value <- abs(c((1-0.3820748 ),(1-0.4349631  ),(1- 0.5214057 ),(1- 0.5771759 ),(1-0.5227259  ),(1- 0.5434347),(1-0.2648075  ),(1-0.5262860  ),(1- 0.3745896),(1- 0.5713507)))
wellbeingplotspecific <- data.frame(wellbeing,gender,value)
wellbeingplotspecific$wellbeing<- factor(wellbeingplotspecific$wellbeing, levels=c("Modest role of finances","Saving possibility" ,"No unaffordable wishes" ,"Few concerns","Not 'just getting by'" ))
wellbeingplotspecific$gender<- factor(wellbeingplotspecific$gender, levels=c( "Male","Female"))
finwellbeing_se <- ggplot(wellbeingplotspecific, aes(fill=gender, y=value, x=wellbeing)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),  axis.text = element_text(size = 13))
finwellbeing_se
#employed
wellbeing <- c(rep("Modest role of finances" , 2),  rep("Saving possibility" , 2),rep("No unaffordable wishes" , 2) , rep("Few concerns" , 2) , rep("Not 'just getting by'" ,2))
gender <- rep(c("Male" , "Female") , 5)
value <- abs(c((1-0.4378898  ),(1-0.3975455   ),(1- 0.5634224  ),(1- 0.5816081  ),(1-0.6158255   ),(1- 0.5755756 ),(1-0.425242   ),(1-0.4516550   ),(1- 0.5852973 ),(1- 0.5824905 )))
wellbeingplotspecific <- data.frame(wellbeing,gender,value)
wellbeingplotspecific$wellbeing<- factor(wellbeingplotspecific$wellbeing, levels=c("Modest role of finances","Saving possibility" ,"No unaffordable wishes" ,"Few concerns","Not 'just getting by'" ))
wellbeingplotspecific$gender<- factor(wellbeingplotspecific$gender, levels=c( "Male","Female"))
finwellbeing_e<- ggplot(wellbeingplotspecific, aes(fill=gender, y=value, x=wellbeing)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15), axis.text = element_text(size = 13))
finwellbeing_e

###################################FINANCIAL RESILIENCE############################################
finrescomparison <- data.frame(status=rep(c('Self-employed', 'Employees'), each=5),
                               finrel=rep(c('Six months or above','About three months', 'About a month','About a week','Ref/Don´t know'), times=2),
                               share=c(0.452498000,0.212421271,0.185704480,0.078420722,(0.009029548+0.061925979),0.28308054,0.23325797,0.27961888,(0.01497427 +0.10388377),( 0.03132441+0.05386017)))
finrescomparison$finrel<- factor(finrescomparison$finrel, levels=c('Six months or above','About three months', 'About a month','About a week','Ref/Don´t know'))
finrescomparison$status<- factor(finrescomparison$status, levels=c('Self-employed', 'Employees'))
fincushioncomp <- ggplot(finrescomparison, aes(fill=finrel, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")  +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))
fincushioncomp

##gender specific
#self-employed
finrescomparison <- data.frame(status=rep(c('Male','Female'), each=5),
                               finrel=rep(c('Six months or above','About three months', 'About a month','About a week','Ref/Don´t know'), times=2),
                               share=c(0.54237185,0.21019579,0.16438675,0.03180591,(0.01517251+0.03606718),0.32039232,0.21569250,0.21703944,0.14693988,0.09993585))
finrescomparison$finrel<- factor(finrescomparison$finrel, levels=c('Six months or above','About three months', 'About a month','About a week','Ref/Don´t know'))
finrescomparison$status<- factor(finrescomparison$status, levels=c("Male" , "Female" ))
finres_se <- ggplot(finrescomparison, aes(fill=finrel, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")  +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))#+guides(fill=guide_legend(nrow=2, byrow=TRUE))
finres_se

#employed
finrescomparison <- data.frame(status=rep(c('Male','Female'), each=5),
                               finrel=rep(c('Six months or above','About three months', 'About a month','About a week','Ref/Don´t know'), times=2),
                               share=c(0.30795281,0.21320536,0.28929703,(0.01294024+0.09697274),(0.04229011+0.03734170), 0.25635277 ,0.25480653,0.26921872,(0.01716005+0.11131036),(0.01954064+0.07161093)))
finrescomparison$finrel<- factor(finrescomparison$finrel, levels=c('Six months or above','About three months', 'About a month','About a week','Ref/Don´t know'))
finrescomparison$status<- factor(finrescomparison$status, levels=c("Male" , "Female" ))
finres_e<- ggplot(finrescomparison, aes(fill=finrel, y=share, x=status)) + 
  geom_bar(position='stack', stat='identity')+
  labs(x="",y="Percentage share",fill="")  +theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))+
  guides(fill=guide_legend(nrow=2, byrow=TRUE))
finres_e


##############above / below three months accordig to OECD -> impact of financial savings
### self-employed
finrescomparison <- c(rep("Knowledge" , 2) , rep("Behaviour" , 2) , rep("Attitude" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 3)
value <- abs(c(6.03243,6.185474,6.570205,6.926946,3.249507,3.298033))
finresplot <- data.frame(finrescomparison,status,value)
finresplot$status<- factor(finresplot$status, levels=c("Less than three months" , "More than three months" ))
finresplot$finrescomparison<- factor(finresplot$finrescomparison, levels=c("Knowledge","Behaviour","Attitude"))
finresfinlitcomp <- ggplot(finresplot, aes(fill=status, y=value, x=finrescomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Mean score",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15),axis.text = element_text(size = 14))
finresfinlitcomp

finstressconcernfraud <- c(rep("Fraud victim" , 2) , rep("Shortfall" , 2) , rep("Expense worries" , 2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 5)
value <- abs(c(0.08164526,0.2369556,0.1292842,0.02948726,0.1399972,0.01524525,0.2876269,0.1161688,0.3887798,0.1950129))
finstressconcernfraudplot <- data.frame(finstressconcernfraud,status,value)
finstressconcernfraudplot$status<- factor(finstressconcernfraudplot$status, levels=c("Less than three months" , "More than three months" ))
finstressconcernfraudplot$finstressconcernfraud<- factor(finstressconcernfraudplot$finstressconcern, levels=c('Fraud victim', 'Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finresfinstresscomp <- ggplot(finstressconcernfraudplot, aes(fill=status, y=value, x=finstressconcernfraud)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15),axis.text = element_text(size = 14))
finresfinstresscomp

finrescompse <- finresfinlitcomp+finresfinstresscomp + plot_layout(guides = "collect")& theme(legend.position = "bottom")
finrescomp
#gender specific
#males
finstressconcernfraud <- c(rep("Fraud victim" , 2) , rep("Shortfall" , 2) , rep("Expense worries" , 2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 5)
value <- abs(c(0.2150385,0,0.1621157,0.04377732,0.1621157,0,0.2409652,0.07317262,0.3325301,0.1453484))
finstressconcernfraudplot <- data.frame(finstressconcernfraud,status,value)
finstressconcernfraudplot$status<- factor(finstressconcernfraudplot$status, levels=c("Less than three months" , "More than three months" ))
finstressconcernfraudplot$finstressconcernfraud<- factor(finstressconcernfraudplot$finstressconcern, levels=c('Fraud victim', 'Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finresfinstress_semales <- ggplot(finstressconcernfraudplot, aes(fill=status, y=value, x=finstressconcernfraud)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'), axis.text = element_text(size = 15))
finresfinstress_semales
#females
finstressconcernfraud <- c(rep("Fraud victim" , 2) , rep("Shortfall" , 2) , rep("Expense worries" , 2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 5)
value <- abs(c(0.1463335,0.2821809,0.1032716,0,0.1224725,0.0467035,0.3245973,0.2048907,0.4333469,0.2974944))
finstressconcernfraudplot <- data.frame(finstressconcernfraud,status,value)
finstressconcernfraudplot$status<- factor(finstressconcernfraudplot$status, levels=c("Less than three months" , "More than three months" ))
finstressconcernfraudplot$finstressconcernfraud<- factor(finstressconcernfraudplot$finstressconcern, levels=c('Fraud victim', 'Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finresfinstress_sefemales <- ggplot(finstressconcernfraudplot, aes(fill=status, y=value, x=finstressconcernfraud)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none")
finresfinstress_sefemales

###employed
finrescomparison <- c(rep("Knowledge" , 2) , rep("Behaviour" , 2) , rep("Attitude" , 2)  )
status <- rep(c("Less than three months" , "More than three months" ) , 3)
value <- abs(c(4.960896,5.853891,5.494803,6.637096,2.877918,3.291662))
finresplot <- data.frame(finrescomparison,status,value)
finresplot$status<- factor(finresplot$status, levels=c("Less than three months" , "More than three months" ))
finresplot$finrescomparison<- factor(finresplot$finrescomparison, levels=c("Knowledge","Behaviour","Attitude"))
finresfinlitcompe <-ggplot(finresplot, aes(fill=status, y=value, x=finrescomparison)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Mean score",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'), legend.text = element_text(size=15),axis.text = element_text(size = 14))
finresfinlitcompe

finstressconcernfraud <- c(rep("Fraud victim" , 2) , rep("Shortfall" , 2) , rep("Expense worries" , 2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 5)
value <- abs(c(0.1956878, 0.184034,0.2526282,0.0485526,0.1659706,0.05963747,0.3665863,0.08129463,0.4967199,0.1975792))
finstressconcernfraudplot <- data.frame(finstressconcernfraud,status,value)
finstressconcernfraudplot$status<- factor(finstressconcernfraudplot$status, levels=c("Less than three months" , "More than three months" ))
finstressconcernfraudplot$finstressconcernfraud<- factor(finstressconcernfraudplot$finstressconcern, levels=c('Fraud victim', 'Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finresfinstresscompe<- ggplot(finstressconcernfraudplot, aes(fill=status, y=value, x=finstressconcernfraud)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),  axis.text = element_text(size = 14))
finresfinstresscompe

finrescomp <- finresfinlitcompe+finresfinstresscompe + plot_layout(guides = "collect")& theme(legend.position = "bottom")
finrescomp


#gender specific
#males
finstressconcernfraud <- c(rep("Fraud victim" , 2) , rep("Shortfall" , 2) , rep("Expense worries" , 2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 5)
value <- abs(c(0.2169437,0.2718662,0.2058148,0.04160149,0.1456423,0.05148063,0.3568729,0.06805424,0.4941516,0.2088076))
finstressconcernfraudplot <- data.frame(finstressconcernfraud,status,value)
finstressconcernfraudplot$status<- factor(finstressconcernfraudplot$status, levels=c("Less than three months" , "More than three months" ))
finstressconcernfraudplot$finstressconcernfraud<- factor(finstressconcernfraudplot$finstressconcern, levels=c('Fraud victim', 'Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
ggplot(finstressconcernfraudplot, aes(fill=status, y=value, x=finstressconcernfraud)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),  axis.text = element_text(size = 15))
#females
finstressconcernfraud <- c(rep("Fraud victim" , 2) , rep("Shortfall" , 2) , rep("Expense worries" , 2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
status <- rep(c("Less than three months" , "More than three months" ) , 5)
value <- abs(c(0.1727588,0.08780307,0.3031263,0.05616838,0.1878989,0.06857428,0.3770642,0.0958011,0.4994903,0.185277))
finstressconcernfraudplot <- data.frame(finstressconcernfraud,status,value)
finstressconcernfraudplot$status<- factor(finstressconcernfraudplot$status, levels=c("Less than three months" , "More than three months" ))
finstressconcernfraudplot$finstressconcernfraud<- factor(finstressconcernfraudplot$finstressconcern, levels=c('Fraud victim', 'Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
ggplot(finstressconcernfraudplot, aes(fill=status, y=value, x=finstressconcernfraud)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("lightblue",
                             "purple"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="bottom", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),  axis.text = element_text(size = 15))


###correlation plots
#finlitage
#self-employed
ggplot(ASFL7se, aes(x = age , y =finlit )) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(y = "Literacy", x = "Age")+theme(axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))
#employed
ggplot(ASFL7e, aes(x = age , y =finlit )) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(y = "Literacy", x = "Age")+theme(axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))

#wellbeingfincushion
#self-employed
cor.test(ASFL7se$finwellbeing, ASFL7se$numericfinbuff, data=ASFL7se, weights=ASFL7se$wght)
ggplot(ASFL7se, aes(x = numericfinbuff , y =finwellbeing )) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(y = "Well-being", x = "Savings")+theme(axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))
#gender-specific
cor.test(ASFL7sem$finwellbeing, ASFL7sem$numericfinbuff, data=ASFL7sem, weights=ASFL7sem$wght)
ggplot(ASFL7sem, aes(x = numericfinbuff , y =finwellbeing )) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(y = "Well-being", x = "Savings")+theme(axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))


cor.test(ASFL7sef$finwellbeing, ASFL7sef$numericfinbuff, data=ASFL7sef, weights=ASFL7sef$wght)
ggplot(ASFL7sef, aes(x = numericfinbuff , y =finwellbeing )) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(y = "Well-being", x = "Savings")+theme(axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))

#employed
cor.test(ASFL7e$finwellbeing, ASFL7e$numericfinbuff, data=ASFL7e, weights=ASFL7e$wght)
ggplot(ASFL7e, aes(x = numericfinbuff , y =finwellbeing )) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(y = "Well-being", x = "Savings")+theme(axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))


###################################FINANCIAL STRESS AND CONCERN############################################

#weighted with financial fraud
fistr <- c(rep("Fraud victim",2), rep("Shortfall" , 2) , rep("Expense worries" ,2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
emplstat <- rep(c("Self-employed" , "Employees" ) , 5)
value <- abs(c(0.1900837 ,0.2031745 ,0.05375387  ,0.1341993  ,0.04711364 ,0.1048933  ,0.1532124 ,0.2029604  ,0.2506294 ,0.3234968  ))
finstressplot <- data.frame(fistr,emplstat,value)
finstressplot$fistr<- factor(finstressplot$fistr, levels=c('Fraud victim','Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finstressplot$emplstat<- factor(finstressplot$emplstat, levels=c( "Self-employed" , "Employees"))
finstresscomp <- ggplot(finstressplot, aes(fill=emplstat, y=value, x=fistr)) + 
  geom_bar(position="dodge", stat="identity")+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),   axis.text = element_text(size = 15))
finstresscomp

finstresscomp+finwellbeingcomp+plot_layout(guides = "collect")& theme(legend.position = "none")

#self-employed
fistr <- c(rep("Fraud victim",2),rep("Shortfall" , 2) , rep("Expense worries" ,2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
gender <- rep(c("Male","Female" ) , 5)
value <- abs(c(0.1618311 ,0.2316124 ,0.06475131,0.03758872,0.03180591,0.06961449,0.1023429,0.2279855,0.189797,0.340047))
finstressplot <- data.frame(fistr,gender,value)
finstressplot$fistr<- factor(finstressplot$fistr, levels=c('Fraud victim','Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finstressplot$gender <- factor(finstressplot$gender, levels=c("Male","Female"))
finstress_se <- ggplot(finstressplot, aes(fill=gender, y=value, x=fistr)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15),  axis.text = element_text(size = 13))
finstress_se

finstresswellbeingcomp_se <-finstress_se +finwellbeing_se+ plot_layout(guides = "collect")& theme(legend.position = "bottom")
finstresswellbeingcomp_se

#employed
fistr <- c(rep("Fraud victim",2),rep("Shortfall" , 2) , rep("Expense worries" ,2) , rep("Financial concerns" , 2) , rep("´Just getting by´" , 2) )
gender <- rep(c("Male","Female" ) , 5)
value <- abs(c(0.2660002 ,0.1356619 ,0.1090571 ,0.161217 ,0.09430449 ,0.116272 ,0.1816542 ,0.2258561,0.3211303,0.3260398  ))
finstressplot <- data.frame(fistr,gender,value)
finstressplot$fistr<- factor(finstressplot$fistr, levels=c('Fraud victim','Shortfall', 'Expense worries', 'Financial concerns','´Just getting by´'))
finstressplot$gender <- factor(finstressplot$gender, levels=c("Male","Female"))
finstress_e<- ggplot(finstressplot, aes(fill=gender, y=value, x=fistr)) + 
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("grey",
                             "orange"))+
  labs(x="",y="Percentage share",fill="")+theme(legend.position="none", legend.key.width = unit(0.3, 'cm'),legend.text = element_text(size=15), axis.text = element_text(size = 13))
finstress_e


finstresswellbeingcomp_e <-finstress_e+ finwellbeing_e+plot_layout(guides = "collect")& theme(legend.position = "bottom")
finstresswellbeingcomp_e

#####################SANKEY-PLOTS################################
library(ggplot2)
library(ggalluvial)
# Create the Sankey plot#theory:
#skeypl2 <- ggplot(data = frequencies,
#     aes(axis1 = personality,   # First variable on the X-axis
#       axis2 = field, # Second variable on the X-axis
#       axis3 = gender,   # Third variable on the X-axis
#      y = n)) +
# geom_alluvium(aes(fill = gender)) +
# geom_stratum() +
# geom_text(stat = "stratum",
#           aes(label = after_stat(stratum))) +
# scale_fill_viridis_d() +
#  theme_void()
#skeypl2


#sankey plot - self assessed and actual financial knowledge
#####self-employed 
Assessmentse <- ASFL7se$saknow_group_1
Finknowse <- ASFL7se$fin_know_group_1
selfassessfinknowse <- ggplot(data = ASFL7se,
                              aes(axis1 = Assessmentse,# First variable on the X-axis
                                  axis2 = Finknowse, 
                                  y = frequency(Finknowse))) +
  geom_alluvium(aes(fill = Assessmentse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessfinknowse

#males
Assessmentsem <- ASFL7sem$saknow_group_1
Finknowsem <- ASFL7sem$fin_know_group_1
selfassessfinknowsem <- ggplot(data = ASFL7sem,
                               aes(axis1 = Assessmentsem,# First variable on the X-axis
                                   axis2 = Finknowsem, 
                                   y = frequency(Finknowsem))) +
  geom_alluvium(aes(fill = Assessmentsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessfinknowsem

#females
Assessmentsef <- ASFL7sef$saknow_group_1
Finknowsef <- ASFL7sef$fin_know_group_1
selfassessfinknowsef <- ggplot(data = ASFL7sef,
                               aes(axis1 = Assessmentsef,# First variable on the X-axis
                                   axis2 = Finknowsef, 
                                   y = frequency(Finknowsef))) +
  geom_alluvium(aes(fill = Assessmentsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessfinknowsef

#####employed
Assessmente <- ASFL7e$saknow_group_1
Finknowe <- ASFL7e$fin_know_group_1
selfassessfinknowe <- ggplot(data = ASFL7e,
                             aes(axis1 = Assessmente,# First variable on the X-axis
                                 axis2 = Finknowe, 
                                 y = frequency(Finknowe))) +
  geom_alluvium(aes(fill = Assessmente)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessfinknowe
#males
Assessmentem <- ASFL7em$saknow_group_1
Finknowem <- ASFL7em$fin_know_group_1
selfassessfinknowem <- ggplot(data = ASFL7em,
                              aes(axis1 = Assessmentem,# First variable on the X-axis
                                  axis2 = Finknowem, 
                                  y = frequency(Finknowem))) +
  geom_alluvium(aes(fill = Assessmentem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessfinknowem

#females
Assessmentef <- ASFL7ef$saknow_group_1
Finknowef <- ASFL7ef$fin_know_group_1
selfassessfinknowef <- ggplot(data = ASFL7ef,
                              aes(axis1 = Assessmentef,# First variable on the X-axis
                                  axis2 = Finknowef, 
                                  y = frequency(Finknowef))) +
  geom_alluvium(aes(fill = Assessmentef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessfinknowef


sankeysavsfk <- selfassessfinknowse+selfassessfinknowe 
sankeysavsfk

sankeysavsfkgender_se <- selfassessfinknowsem+selfassessfinknowsef 
sankeysavsfkgender_se

sankeysavsfkgender_e<- selfassessfinknowem+selfassessfinknowef 
sankeysavsfkgender_e

savsfkgender<-  selfassessfinknowsem+selfassessfinknowsef +selfassessfinknowem+selfassessfinknowef  
savsfkgender


#####################INTERACTION PLOTS################################
par(mfrow=c(2,2))
par(mfrow=c(2,4))
par(mfrow=c(1,2))
######SELF EMPLOYED
###interaction plot risk financial literacy, gender comparison
interaction.plot(x.factor = ASFL7se$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2,#line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)

###interaction plot risk financial knowledge 
interaction.plot(x.factor = ASFL7se$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_know, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Knowledge",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial behaviour 
interaction.plot(x.factor = ASFL7se$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_beh, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Behaviour",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial attitude 
interaction.plot(x.factor = ASFL7se$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_att, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Attitude",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)

interaction.plot(x.factor = ASFL7se$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2,#line width
                 trace.label =deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial knowledge 
interaction.plot(x.factor = ASFL7se$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_know, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Knowledge",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial behaviour 
interaction.plot(x.factor = ASFL7se$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_beh, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Behaviour",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)

###interaction plot risk financial attitude 
interaction.plot(x.factor = ASFL7se$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_att, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Attitude",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)



###interaction plot risk financial risky asset taking 
interaction.plot(x.factor = ASFL7se$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial knowledge 
interaction.plot(x.factor = ASFL7se$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_know, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Knowledge",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial behaviour 
interaction.plot(x.factor = ASFL7se$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_beh, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Behaviour",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial attitude 
interaction.plot(x.factor = ASFL7se$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$fin_att, #y-axis variable
                 fun = mean, #metric to plot,
                 ylab = "Attitude",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(substitute()),cex.lab= 1.25, cex.axis = 1.25)


######EMPLOYED
###interaction plot risk financial literacy, gender comparison
interaction.plot(x.factor = ASFL7e$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risk propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2,#line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial knowledge 
interaction.plot(x.factor = ASFL7e$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_know, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Knowledge",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial behaviour 
interaction.plot(x.factor = ASFL7e$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_beh, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Behaviour",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial attitude 
interaction.plot(x.factor = ASFL7e$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_att, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Attitude",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)

interaction.plot(x.factor = ASFL7e$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risk propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2,#line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial knowledge 
interaction.plot(x.factor = ASFL7e$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_know, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Knowledge",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial behaviour 
interaction.plot(x.factor = ASFL7e$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_beh, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Behaviour",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial attitude 
interaction.plot(x.factor = ASFL7e$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_att, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Attitude",
                 xlab = "Risky propensity",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)

###interaction plot risk financial risky asset taking 
interaction.plot(x.factor = ASFL7e$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial knowledge 
interaction.plot(x.factor = ASFL7e$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_know, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Knowledge",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial behaviour 
interaction.plot(x.factor = ASFL7e$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_beh, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Behaviour",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
###interaction plot risk financial attitude 
interaction.plot(x.factor = ASFL7e$riskyassets2_group, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$fin_att, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Attitude",
                 xlab = "Risky assets",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(substitute()),cex.lab= 1.25, cex.axis = 1.25)
par(mfrow=c(2,2))
par(mfrow=c(1,2))
###interaction gender and well-being for financial literacy
#self-employed
interaction.plot(x.factor = ASFL7se$finwellbeing, #x-axis variable
                 trace.factor = ASFL7se$gender, #variable for lines
                 response = ASFL7se$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Well-being",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(substitute()),cex.lab= 1.25, cex.axis = 1.25)
interaction.plot(x.factor = ASFL7e$finwellbeing, #x-axis variable
                 trace.factor = ASFL7e$gender, #variable for lines
                 response = ASFL7e$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Well-being",
                 col = c("orange","grey"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(substitute()),cex.lab= 1.25, cex.axis = 1.25)



interaction.plot(x.factor = ASFL7se$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7se$riskyassets2_group, #variable for lines
                 response = ASFL7se$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "",
                 col = c("brown","green"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
interaction.plot(x.factor = ASFL7e$HFCSriskad_2, #x-axis variable
                 trace.factor = ASFL7e$riskyassets2_group, #variable for lines
                 response = ASFL7e$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "",
                 col = c("brown","green"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)

interaction.plot(x.factor = ASFL7se$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7se$riskyassets2_group, #variable for lines
                 response = ASFL7se$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risk propensity",
                 col = c("brown","green"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(),cex.lab= 1.25, cex.axis = 1.25)
interaction.plot(x.factor = ASFL7e$HFCSrisk_group_1, #x-axis variable
                 trace.factor = ASFL7e$riskyassets2_group, #variable for lines
                 response = ASFL7e$finlit, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Literacy",
                 xlab = "Risk propensity",
                 col = c("brown","green"),
                 lty = 1, #line type
                 lwd = 2, #line width
                 trace.label = deparse(substitute(trace.factor)),cex.lab= 1.25, cex.axis = 1.25, cex.main=3.25)

#####################ADDITIONAL SANKEY PLOTS################################

#sankey plot - financial self assessment and risk propensity 
#self-employed
Finriskpropse <- ASFL7se$HFCSrisk_group_2
Finriskpropse <- factor(ASFL7se$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
selfassessriskse<- ggplot(data = ASFL7se,
                          aes(axis1 = Assessmentse,# First variable on the X-axis
                              axis2 = Finriskpropse, 
                              y = frequency(Finriskpropse))) +
  geom_alluvium(aes(fill = Assessmentse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskse

#employed
Finriskprope <- factor(ASFL7e$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
selfassessriske<- ggplot(data = ASFL7e,
                         aes(axis1 = Assessmente,# First variable on the X-axis
                             axis2 = Finriskprope, 
                             y = frequency(Finriskprope))) +
  geom_alluvium(aes(fill = Assessmente)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriske

#sankey plot - financial risk propensity and financial knowledge/literacy (behaviour/attitude)
######################self-employed
#knowledge
riskfinknowse<- ggplot(data = ASFL7se,
                       aes(axis1 = Finriskpropse,# First variable on the X-axis
                           axis2 = Finknowse , 
                           y = frequency(Finknowse))) +
  geom_alluvium(aes(fill = Finriskpropse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowse

finknowriskse<- ggplot(data = ASFL7se,
                       aes(axis1 = Finknowse,# First variable on the X-axis
                           axis2 =  Finriskpropse, 
                           y = frequency(Finriskpropse))) +
  geom_alluvium(aes(fill = Finknowse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

finknowriskse
#literacy
Finlitse <- ASFL7se$finlit_group_1
riskfinlitse<- ggplot(data = ASFL7se,
                      aes(axis1 = Finriskpropse,# First variable on the X-axis
                          axis2 = Finlitse , 
                          y = frequency(Finlitse))) +
  geom_alluvium(aes(fill = Finriskpropse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskfinlitse

#behaviour
Finbehse <- ASFL7se$fin_beh_group_1
riskbehse<- ggplot(data = ASFL7se,
                   aes(axis1 = Finriskpropse,# First variable on the X-axis
                       axis2 = Finbehse , 
                       y = frequency(Finbehse))) +
  geom_alluvium(aes(fill = Finriskpropse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskbehse

#attitude
Finattse <- ASFL7se$fin_att_group_1
riskattse<- ggplot(data = ASFL7se,
                   aes(axis1 = Finriskpropse,# First variable on the X-axis
                       axis2 = Finattse , 
                       y = frequency(Finattse))) +
  geom_alluvium(aes(fill = Finriskpropse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskattse

#selfemployed males
#self-employed
#knowledge
Finriskpropsem <- factor(ASFL7sem$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
riskfinknowsem<- ggplot(data = ASFL7sem,
                        aes(axis1 = Finriskpropsem,# First variable on the X-axis
                            axis2 = Finknowsem , 
                            y = frequency(Finknowsem))) +
  geom_alluvium(aes(fill = Finriskpropsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowsem

Finknowriskpropsem <- factor(ASFL7sem$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
finknowrisksem<- ggplot(data = ASFL7sem,
                        aes(axis1 = Finknowsem,# First variable on the X-axis
                            axis2 =  Finriskpropsem, 
                            y = frequency(Finriskpropsem))) +
  geom_alluvium(aes(fill = Finknowsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowsem
#literacy
Finlitsem <- ASFL7sem$finlit_group_1
riskfinlitsem<- ggplot(data = ASFL7sem,
                       aes(axis1 = Finriskpropsem,# First variable on the X-axis
                           axis2 = Finlitsem , 
                           y = frequency(Finlitsem))) +
  geom_alluvium(aes(fill = Finriskpropsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskfinlitsem


#behaviour
Finbehsem <- ASFL7sem$fin_beh_group_1
riskbehsem<- ggplot(data = ASFL7sem,
                    aes(axis1 = Finriskpropsem,# First variable on the X-axis
                        axis2 = Finbehsem , 
                        y = frequency(Finbehsem))) +
  geom_alluvium(aes(fill = Finriskpropsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskbehsem

#attitude
Finattsem <- ASFL7sem$fin_att_group_1
riskattsem<- ggplot(data = ASFL7sem,
                    aes(axis1 = Finriskpropsem,# First variable on the X-axis
                        axis2 = Finattsem , 
                        y = frequency(Finattsem))) +
  geom_alluvium(aes(fill = Finriskpropsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskattsem

#selfemployed females
#knowledge
Finriskpropsef <- factor(ASFL7sef$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
riskfinknowsef<- ggplot(data = ASFL7sef,
                        aes(axis1 = Finriskpropsef,# First variable on the X-axis
                            axis2 = Finknowsef , 
                            y = frequency(Finknowsef))) +
  geom_alluvium(aes(fill = Finriskpropsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowsef
#literacy
Finlitsef <- ASFL7sef$finlit_group_1
riskfinlitsef<- ggplot(data = ASFL7sef,
                       aes(axis1 = Finriskpropsef,# First variable on the X-axis
                           axis2 = Finlitsef , 
                           y = frequency(Finlitsef))) +
  geom_alluvium(aes(fill = Finriskpropsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskfinlitsef

#behaviour
Finbehsef <- ASFL7sef$fin_beh_group_1
riskbehsef<- ggplot(data = ASFL7sef,
                    aes(axis1 = Finriskpropsef,# First variable on the X-axis
                        axis2 = Finbehsef , 
                        y = frequency(Finbehsef))) +
  geom_alluvium(aes(fill = Finriskpropsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskbehsef

#attitude
Finattsef <- ASFL7sef$fin_att_group_1
riskattsef<- ggplot(data = ASFL7sef,
                    aes(axis1 = Finriskpropsef,# First variable on the X-axis
                        axis2 = Finattsef , 
                        y = frequency(Finattsef))) +
  geom_alluvium(aes(fill = Finriskpropsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskattsef
#####################employed
#knowledge
riskfinknowe<- ggplot(data = ASFL7e,
                      aes(axis1 = Finriskprope,# First variable on the X-axis
                          axis2 = Finknowe , 
                          y = frequency(Finknowe))) +
  geom_alluvium(aes(fill = Finriskprope)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowe

finknowriske<- ggplot(data = ASFL7e,
                      aes(axis1 = Finknowe,# First variable on the X-axis
                          axis2 =  Finriskprope, 
                          y = frequency(Finriskprope))) +
  geom_alluvium(aes(fill = Finknowe)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

finknowriske
#literacy
Finlite <- ASFL7e$finlit_group_1
riskfinlite<- ggplot(data = ASFL7e,
                     aes(axis1 = Finriskprope,# First variable on the X-axis
                         axis2 = Finlite , 
                         y = frequency(Finlite))) +
  geom_alluvium(aes(fill = Finriskprope)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskfinlite

#behaviour
Finbehe <- ASFL7e$fin_beh_group_1
riskbehe<- ggplot(data = ASFL7e,
                  aes(axis1 = Finriskprope,# First variable on the X-axis
                      axis2 = Finbehe , 
                      y = frequency(Finbehe))) +
  geom_alluvium(aes(fill = Finriskprope)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskbehe

#attitude
Finatte <- ASFL7e$fin_att_group_1
riskatte<- ggplot(data = ASFL7e,
                  aes(axis1 = Finriskprope,# First variable on the X-axis
                      axis2 = Finatte , 
                      y = frequency(Finatte))) +
  geom_alluvium(aes(fill = Finriskprope)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskatte

#employed males
#knowledge
Finriskpropem <- factor(ASFL7em$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
riskfinknowem<- ggplot(data = ASFL7em,
                       aes(axis1 = Finriskpropem,# First variable on the X-axis
                           axis2 = Finknowem , 
                           y = frequency(Finknowem))) +
  geom_alluvium(aes(fill = Finriskpropem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowem
#literacy
Finlitem <- ASFL7em$finlit_group_1
riskfinlitem<- ggplot(data = ASFL7em,
                      aes(axis1 = Finriskpropem,# First variable on the X-axis
                          axis2 = Finlitem , 
                          y = frequency(Finlitem))) +
  geom_alluvium(aes(fill = Finriskpropem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskfinlitem


#behaviour
Finbehem <- ASFL7em$fin_beh_group_1
riskbehem<- ggplot(data = ASFL7em,
                   aes(axis1 = Finriskpropem,# First variable on the X-axis
                       axis2 = Finbehem , 
                       y = frequency(Finbehem))) +
  geom_alluvium(aes(fill = Finriskpropem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskbehem

#attitude
Finattem <- ASFL7em$fin_att_group_1
riskattem<- ggplot(data = ASFL7em,
                   aes(axis1 = Finriskpropem,# First variable on the X-axis
                       axis2 = Finattem , 
                       y = frequency(Finattem))) +
  geom_alluvium(aes(fill = Finriskpropem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskattem

#employed females
#knowledge
Finriskpropef <- factor(ASFL7ef$HFCSrisk_group_2, levels=c("Substantial risk", "High risk", "Average risk","No risk"))
riskfinknowef<- ggplot(data = ASFL7ef,
                       aes(axis1 = Finriskpropef,# First variable on the X-axis
                           axis2 = Finknowef , 
                           y = frequency(Finknowef))) +
  geom_alluvium(aes(fill = Finriskpropef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskfinknowef
#literacy
Finlitef <- ASFL7ef$finlit_group_1
riskfinlitef<- ggplot(data = ASFL7ef,
                      aes(axis1 = Finriskpropef,# First variable on the X-axis
                          axis2 = Finlitef , 
                          y = frequency(Finlitef))) +
  geom_alluvium(aes(fill = Finriskpropef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskfinlitef


#behaviour
Finbehef <- ASFL7ef$fin_beh_group_1
riskbehef<- ggplot(data = ASFL7ef,
                   aes(axis1 = Finriskpropef,# First variable on the X-axis
                       axis2 = Finbehef , 
                       y = frequency(Finbehef))) +
  geom_alluvium(aes(fill = Finriskpropef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")
riskbehef

#attitude
Finattef <- ASFL7ef$fin_att_group_1
riskattef<- ggplot(data = ASFL7ef,
                   aes(axis1 = Finriskpropef,# First variable on the X-axis
                       axis2 = Finattef , 
                       y = frequency(Finattef))) +
  geom_alluvium(aes(fill = Finriskpropef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskattef

####sankey plot - financial self-assessment and risky asset taking
#######################self-employed
Finriskassetse <- ASFL7se$riskyassets1_group
selfassessriskassetse<- ggplot(data = ASFL7se,
                               aes(axis1 = Assessmentse,# First variable on the X-axis
                                   axis2 = Finriskassetse, 
                                   y = frequency(Finriskassetse))) +
  geom_alluvium(aes(fill = Assessmentse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskassetse

#riskyassets and knowledge
riskassetfinknowse<- ggplot(data = ASFL7se,
                            aes(axis1 = Finriskassetse,# First variable on the X-axis
                                axis2 = Finknowse , 
                                y = frequency(Finknowse))) +
  geom_alluvium(aes(fill = Finriskassetse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetfinknowse

finknowriskassetse<- ggplot(data = ASFL7se,
                            aes(axis1 = Finknowse,# First variable on the X-axis
                                axis2 =  Finriskassetse, 
                                y = frequency(Finriskassetse))) +
  geom_alluvium(aes(fill = Finknowse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

finknowriskassetse

#literacy
Finlitse <- ASFL7se$finlit_group_1
riskassetfinlitse<- ggplot(data = ASFL7se,
                           aes(axis1 = Finriskassetse,# First variable on the X-axis
                               axis2 = Finlitse , 
                               y = frequency(Finlitse))) +
  geom_alluvium(aes(fill = Finriskassetse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetfinlitse

#behaviour
Finbehse <- ASFL7se$fin_beh_group_1
riskassetbehse<- ggplot(data = ASFL7se,
                        aes(axis1 = Finriskassetse,# First variable on the X-axis
                            axis2 = Finbehse , 
                            y = frequency(Finbehse))) +
  geom_alluvium(aes(fill = Finriskassetse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetbehse

#attitude
Finattse <- ASFL7se$fin_att_group_1
riskassetattse<- ggplot(data = ASFL7se,
                        aes(axis1 = Finriskassetse,# First variable on the X-axis
                            axis2 = Finattse , 
                            y = frequency(Finattse))) +
  geom_alluvium(aes(fill = Finriskassetse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetattse

Finriskassetse <- ASFL7se$riskyassets1_group
selfassessriskassetse<- ggplot(data = ASFL7se,
                               aes(axis1 = Assessmentse,# First variable on the X-axis
                                   axis2 = Finriskassetse, 
                                   y = frequency(Finriskassetse))) +
  geom_alluvium(aes(fill = Assessmentse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskassetse

#riskyassemts and knowledge
#males
Finriskassemtsem <- ASFL7sem$riskyassets1_group
riskassemtfinknowsem<- ggplot(data = ASFL7sem,
                              aes(axis1 = Finriskassemtsem,# First variable on the X-axis
                                  axis2 = Finknowsem , 
                                  y = frequency(Finknowsem))) +
  geom_alluvium(aes(fill = Finriskassemtsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassemtfinknowsem

#literacy
Finlitsem <- ASFL7sem$finlit_group_1
riskassemtfinlitsem<- ggplot(data = ASFL7sem,
                             aes(axis1 = Finriskassemtsem,# First variable on the X-axis
                                 axis2 = Finlitsem , 
                                 y = frequency(Finlitsem))) +
  geom_alluvium(aes(fill = Finriskassemtsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassemtfinlitsem

#behaviour
Finbehsem <- ASFL7sem$fin_beh_group_1
riskassemtbehsem<- ggplot(data = ASFL7sem,
                          aes(axis1 = Finriskassemtsem,# First variable on the X-axis
                              axis2 = Finbehsem , 
                              y = frequency(Finbehsem))) +
  geom_alluvium(aes(fill = Finriskassemtsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassemtbehsem

#attitude
Finattsem <- ASFL7sem$fin_att_group_1
riskassemtattsem<- ggplot(data = ASFL7sem,
                          aes(axis1 = Finriskassemtsem,# First variable on the X-axis
                              axis2 = Finattsem , 
                              y = frequency(Finattsem))) +
  geom_alluvium(aes(fill = Finriskassemtsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassemtattsem

Finriskassetsem <- ASFL7sem$riskyassets1_group
selfassessriskassetsem<- ggplot(data = ASFL7sem,
                                aes(axis1 = Assessmentsem,# First variable on the X-axis
                                    axis2 = Finriskassetsem, 
                                    y = frequency(Finriskassetsem))) +
  geom_alluvium(aes(fill = Assessmentsem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskassetsem



#riskyassefts and knowledge
Finriskasseftsef  <- ASFL7sef$riskyassets1_group
##females
riskasseftfinknowsef<- ggplot(data = ASFL7sef,
                              aes(axis1 = Finriskasseftsef,# First variable on the X-axis
                                  axis2 = Finknowsef , 
                                  y = frequency(Finknowsef))) +
  geom_alluvium(aes(fill = Finriskasseftsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasseftfinknowsef

#literacy
Finlitsef <- ASFL7sef$finlit_group_1
riskasseftfinlitsef<- ggplot(data = ASFL7sef,
                             aes(axis1 = Finriskasseftsef,# First variable on the X-axis
                                 axis2 = Finlitsef , 
                                 y = frequency(Finlitsef))) +
  geom_alluvium(aes(fill = Finriskasseftsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasseftfinlitsef

#behaviour
Finbehsef <- ASFL7sef$fin_beh_group_1
riskasseftbehsef<- ggplot(data = ASFL7sef,
                          aes(axis1 = Finriskasseftsef,# First variable on the X-axis
                              axis2 = Finbehsef , 
                              y = frequency(Finbehsef))) +
  geom_alluvium(aes(fill = Finriskasseftsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasseftbehsef

#attitude
Finattsef <- ASFL7sef$fin_att_group_1
riskasseftattsef<- ggplot(data = ASFL7sef,
                          aes(axis1 = Finriskasseftsef,# First variable on the X-axis
                              axis2 = Finattsef , 
                              y = frequency(Finattsef))) +
  geom_alluvium(aes(fill = Finriskasseftsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasseftattsef

Finriskassetsef <- ASFL7sef$riskyassets1_group
selfassessriskassetsef<- ggplot(data = ASFL7sef,
                                aes(axis1 = Assessmentsef,# First variable on the X-axis
                                    axis2 = Finriskassetsef, 
                                    y = frequency(Finriskassetsef))) +
  geom_alluvium(aes(fill = Assessmentsef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskassetsef


########################employed
Finriskassete <- ASFL7e$riskyassets1_group
selfassessriskassete<- ggplot(data = ASFL7e,
                              aes(axis1 = Assessmente,# First variable on the X-axis
                                  axis2 = Finriskassete, 
                                  y = frequency(Finriskassete))) +
  geom_alluvium(aes(fill = Assessmente)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskassete


#riskyassets and knowledge
riskassetfinknowe<- ggplot(data = ASFL7e,
                           aes(axis1 = Finriskassete ,# First variable on the X-axis
                               axis2 = Finknowe, 
                               y = frequency(Finknowe))) +
  geom_alluvium(aes(fill = Finriskassete)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetfinknowe

finknowriskassete<- ggplot(data = ASFL7e,
                           aes(axis1 = Finknowe ,# First variable on the X-axis
                               axis2 = Finriskassete, 
                               y = frequency(Finriskassete))) +
  geom_alluvium(aes(fill = Finknowe )) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

finknowriskassete

#literacy
Finlite <- ASFL7e$finlit_group_1
riskassetfinlite<- ggplot(data = ASFL7e,
                          aes(axis1 = Finriskassete ,# First variable on the X-axis
                              axis2 = Finlite, 
                              y = frequency(Finlite))) +
  geom_alluvium(aes(fill = Finriskassete)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetfinlite

#behaviour
Finbehe <- ASFL7e$fin_beh_group_1
riskassetbehe<- ggplot(data = ASFL7e,
                       aes(axis1 = Finriskassete ,# First variable on the X-axis
                           axis2 = Finbehe, 
                           y = frequency(Finbehe))) +
  geom_alluvium(aes(fill = Finriskassete)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetbehe

#attitude
Finatte <- ASFL7e$fin_att_group_1
riskassetatte<- ggplot(data = ASFL7e,
                       aes(axis1 = Finriskassete ,# First variable on the X-axis
                           axis2 = Finatte, 
                           y = frequency(Finatte))) +
  geom_alluvium(aes(fill = Finriskassete)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskassetatte

#sankey plot - financial risk propensity and risky asset taking
#Relation between risk propensity and asset holding
#self-employed
Finriskassetse <- ASFL7se$riskyassets1_group
riskpropensityassetse<- ggplot(data = ASFL7se,
                               aes(axis1 = Finriskpropse,# First variable on the X-axis
                                   axis2 = Finriskassetse, 
                                   y = frequency(Finriskassetse))) +
  geom_alluvium(aes(fill = Finriskpropse)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskpropensityassetse

#employed
riskpropensityassete<- ggplot(data = ASFL7e,
                              aes(axis1 = Finriskprope,# First variable on the X-axis
                                  axis2 = Finriskassete, 
                                  y = frequency(Finriskassete))) +
  geom_alluvium(aes(fill = Finriskprope)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskpropensityassete


#riskyassets and knowledge
#males
Finriskasemtem <- ASFL7em$riskyassets1_group
riskasemtfinknowem<- ggplot(data = ASFL7em,
                            aes(axis1 = Finriskasemtem,# First variable on the X-axis
                                axis2 = Finknowem , 
                                y = frequency(Finknowem))) +
  geom_alluvium(aes(fill = Finriskasemtem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasemtfinknowem

#literacy
Finlitem <- ASFL7em$finlit_group_1
riskasemtfinlitem<- ggplot(data = ASFL7em,
                           aes(axis1 = Finriskasemtem,# First variable on the X-axis
                               axis2 = Finlitem , 
                               y = frequency(Finlitem))) +
  geom_alluvium(aes(fill = Finriskasemtem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasemtfinlitem

#behaviour
Finbehem <- ASFL7em$fin_beh_group_1
riskasemtbehem<- ggplot(data = ASFL7em,
                        aes(axis1 = Finriskasemtem,# First variable on the X-axis
                            axis2 = Finbehem , 
                            y = frequency(Finbehem))) +
  geom_alluvium(aes(fill = Finriskasemtem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasemtbehem

#attitude
Finattem <- ASFL7em$fin_att_group_1
riskasemtattem<- ggplot(data = ASFL7em,
                        aes(axis1 = Finriskasemtem,# First variable on the X-axis
                            axis2 = Finattem , 
                            y = frequency(Finattem))) +
  geom_alluvium(aes(fill = Finriskasemtem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskasemtattem

Finriskassetem <- ASFL7em$riskyassets1_group
selfassessriskassetem<- ggplot(data = ASFL7em,
                               aes(axis1 = Assessmentem,# First variable on the X-axis
                                   axis2 = Finriskassetem, 
                                   y = frequency(Finriskassetem))) +
  geom_alluvium(aes(fill = Assessmentem)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

selfassessriskassetem



#riskyassefts and knowledge
##females
Finriskaseftef <- ASFL7ef$riskyassets1_group
riskaseftfinknowef<- ggplot(data = ASFL7ef,
                            aes(axis1 = Finriskaseftef,# First variable on the X-axis
                                axis2 = Finknowef , 
                                y = frequency(Finknowef))) +
  geom_alluvium(aes(fill = Finriskaseftef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskaseftfinknowef

#literacy
Finlitef <- ASFL7ef$finlit_group_1
riskaseftfinlitef<- ggplot(data = ASFL7ef,
                           aes(axis1 = Finriskaseftef,# First variable on the X-axis
                               axis2 = Finlitef , 
                               y = frequency(Finlitef))) +
  geom_alluvium(aes(fill = Finriskaseftef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskaseftfinlitef

#behaviour
Finbehef <- ASFL7ef$fin_beh_group_1
riskaseftbehef<- ggplot(data = ASFL7ef,
                        aes(axis1 = Finriskaseftef,# First variable on the X-axis
                            axis2 = Finbehef , 
                            y = frequency(Finbehef))) +
  geom_alluvium(aes(fill = Finriskaseftef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskaseftbehef

#attitude
Finattef <- ASFL7ef$fin_att_group_1
riskaseftattef<- ggplot(data = ASFL7ef,
                        aes(axis1 = Finriskaseftef,# First variable on the X-axis
                            axis2 = Finattef , 
                            y = frequency(Finattef))) +
  geom_alluvium(aes(fill = Finriskaseftef)) +
  scale_x_discrete(expand = c(0.2, 0.2)) +
  geom_flow() +
  geom_stratum(alpha = 0.1) +
  geom_text(stat = "stratum",
            aes(label = after_stat(stratum))) +
  scale_fill_viridis_d() +
  theme_void()+
  theme(legend.position = "none")

riskaseftattef


###########################EMPLOYMENT REGRESSION###########################
ASFL7se <- ASFL7[(ASFL7$QD10 %in% se),] 
ASFL7e <- ASFL7[(ASFL7$QD10 %in% e),] 
ASFL7eu <- ASFL7[(ASFL7$QD10 %in% eu),] 
empl <- c("In paid employment [work for someone else]","Self-employed [work for myself]")
ASFL7empl <- ASFL7[(ASFL7$QD10 %in% empl),] 
ASFL7oth <-  ASFL7[(ASFL7$QD10 %in% oth),] 
ASFL7othworet <-  ASFL7[(ASFL7$QD10 %in% othworet),] 
ASFL7ret <-  ASFL7[(ASFL7$QD10 %in% ret),] 
ASFL7unempl <-  ASFL7[(ASFL7$QD10 %in% unempl),] 
ASFL7entrepreneurs <-  ASFL7[(ASFL7$QF9_11 %in% entrepreneurs),] 
ASFL7nontertiary <- ASFL7[!(ASFL7$educationspecific_1 %in% tertiary),] 
ASFL7nonprimary <- ASFL7[!(ASFL7$educationspecific_1 %in% primary),]
ASFL7nontertiarye <- ASFL7e[!(ASFL7e$educationspecific_1 %in% tertiary),] 
ASFL7nontertiaryse <- ASFL7se[!(ASFL7se$educationspecific_1 %in% tertiary),] 

finlitempl <- lm(finlit ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl)
coeftest(finlitempl, vcov = vcovHC(finlitempl, type = "HC0"))
#coeftest(finlitempl, vcov. = vcovHC) #alternative - also provides robust standard errors
AIC(finlitempl)
finlitempl2 <- lm(finlit ~ employment2_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl2)
coeftest(finlitempl2, vcov = vcovHC(finlitempl2, type = "HC0"))
AIC(finlitempl2)
finlitempl2_robustness <- lm(finlit ~ employment1_1, data=ASFL7empl, weights=ASFL7empl$wght)#robustness with predefined set
summary(finlitempl2_robustness)
coeftest(finlitempl2_robustness, vcov = vcovHC(finlitempl2_robustness, type = "HC0"))
AIC(finlitempl2_robustness)
finlitempl3 <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght) #excluding others-> smaller sample size
summary(finlitempl3)
coeftest(finlitempl3, vcov = vcovHC(finlitempl3, type = "HC0"))
AIC(finlitempl3)

##residual checking
par(mfrow=(1,2))
plot(finlitempl$residuals, main="Residual plot")
abline(h=0, col="red")
bptest(finlitempl)#heterogeneity issues
qqnorm(finlitempl$residuals, main="QQ-Residual plot") 
qqline(finlitempl$residuals, col="red") 
shapiro.test(finlitempl$residuals) #not normally distributed

finlitempl_full <- lm(finlit ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_full)
coeftest(finlitempl_full, vcov = vcovHC(finlitempl_full, type = "HC0"))
AIC(finlitempl_full)
finknowempl_full <- lm(fin_know ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finknowempl_full)
coeftest(finknowempl_full, vcov = vcovHC(finknowempl_full, type = "HC0"))
AIC(finknowempl_full)
finbehempl_full <- lm(fin_beh ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finbehempl_full)
coeftest(finbehempl_full, vcov = vcovHC(finbehempl_full, type = "HC0"))
AIC(finbehempl_full)
finattempl_full <- lm(fin_att ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finattempl_full)
coeftest(finattempl_full, vcov = vcovHC(finattempl_full, type = "HC0"))
AIC(finattempl_full)


finlitempl_fullalt <- lm(finlit ~ QD10, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_fullalt)
coeftest(finlitempl_fullalt, vcov = vcovHC(finlitempl_fullalt, type = "HC0"))
AIC(finlitempl_fullalt)
finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitsee <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght)
summary(finlitsee)
coeftest(finlitsee, vcov = vcovHC(finlitsee, type = "HC0"))
AIC(finlitsee)

finlitse <- lm(finlit ~ selfemployedd, data=ASFL7, weights=ASFL7$wght)
summary(finlitse)
coeftest(finlitse, vcov = vcovHC(finlitse, type = "HC0"))
AIC(finlitse)
finlite <- lm(finlit ~ employedd, data=ASFL7, weights=ASFL7$wght)
summary(finlite)
coeftest(finlite, vcov = vcovHC(finlite, type = "HC0"))
AIC(finlite)
finlitoth <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght)
summary(finlitoth)
coeftest(finlitoth, vcov = vcovHC(finlitoth, type = "HC0"))
AIC(finlitoth)

#######for individual indicators
fin_knowempl <- lm(fin_know ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_knowempl)
coeftest(fin_knowempl, vcov = vcovHC(fin_knowempl, type = "HC0"))
AIC(fin_knowempl)

fin_behempl <- lm(fin_beh ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_behempl)
coeftest(fin_behempl, vcov = vcovHC(fin_behempl, type = "HC0"))
AIC(fin_behempl)

fin_attempl <- lm(fin_att ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_attempl)
coeftest(fin_attempl, vcov = vcovHC(fin_attempl, type = "HC0"))
AIC(fin_attempl)

###########################REVERSE CAUSALITY EFFECT###########################
revselfempl <- lm(selfemployedd ~ finlit,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(revselfempl)  
exp(coef(revselfempl))
coeftest(revselfempl, vcov = vcovHC(revselfempl, type = "HC0"))
(adjR2(revselfempl))
revselfempl <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(revselfempl)  
coeftest(revselfempl, vcov = vcovHC(revselfempl, type = "HC0"))
(adjR2(revselfempl))

multi_revempl <- multinom(employment1_1 ~  finlit,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revempl)
exp(coef(multi_revempl))
se <- summary(multi_revempl)$coefficients/summary(multi_revempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_revempl, type="text", out="multi_revempl.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revempl, which = c("McFadden"))#PseudoR2(multi_mo, which = c("CoxSnell","Nagelkerke","McFadden"))

multi_revemplfull <- multinom(employment1_1 ~  finlit+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd ,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplfull)
exp(coef(multi_revemplfull))
se <- summary(multi_revemplfull)$coefficients/summary(multi_revemplfull)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_revemplfull, type="text", out="multi_revemplfull.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplfull, which = c("McFadden"))#PseudoR2(multi_mo, which = c("CoxSnell","Nagelkerke","McFadden"))

#simple reverse causality components
multi_revemplknow <- multinom(employment1_1 ~  fin_know,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplknow)
exp(coef(multi_revemplknow))
stargazer(multi_revemplknow, type="text", out="multi_revemplknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplknow, which = c("McFadden"))

multi_revemplbeh <- multinom(employment1_1 ~  fin_beh,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplbeh)
exp(coef(multi_revemplbeh))
stargazer(multi_revemplbeh, type="text", out="multi_revemplbeh.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplbeh, which = c("McFadden"))

multi_revemplatt <- multinom(employment1_1 ~  fin_att,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplatt)
exp(coef(multi_revemplatt))
stargazer(multi_revemplatt, type="text", out="multi_revemplatt.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplatt, which = c("McFadden"))

###########################FINANCIAL RISK EVALUATION###########################
#financial literacy risk propensity HFCSriskad
#full sample
finlitrisk <- lm(finlit ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSriskad,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)
#alternative1 HFCSriskd
#full sample
finlitrisk <- lm(finlit ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))

multi_emplriskalt1 <- multinom(employment1_1 ~  HFCSriskd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplriskalt1)
stargazer(multi_emplriskalt1, type="text", out="multi_emplriskalt1.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplriskalt1, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)

#alternative2 QS1_2risk
#full sample
finlitrisk <- lm(finlit ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  QS1_2risk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)

#alternative numericHFCSrisk
#full sample
finlitrisk <- lm(finlit ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))

multi_emplrisk <- multinom(employment1_1 ~  numericHFCSrisk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative numericQSrisk
#full sample
finlitrisk <- lm(finlit ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~numericQS1_2,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~numericQS1_2,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~numericQS1_2,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~ numericQS1_2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative HFCSriskgroup_1
#full sample
finlitrisk <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSrisk_group_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)


#alternative QS1_2risk_group
#full sample
finlitrisk <- lm(finlit ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know~ QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att~ QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd~ QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~ QS1_2risk_group_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att~ QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)
#rboustness: riskyassets 
#full sample
finlitriskyassets <- lm(finlit ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitriskyassets)  
coeftest(finlitriskyassets, vcov = vcovHC(finlitriskyassets, type = "HC0"))
AIC(finlitriskyassets)
finknowriskyassets <- lm(fin_know ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowriskyassets)  
coeftest(finknowriskyassets, vcov = vcovHC(finknowriskyassets, type = "HC0"))
AIC(finknowriskyassets)
finbehriskyassets <- lm(fin_beh ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght)
summary(finbehriskyassets)  
coeftest(finbehriskyassets, vcov = vcovHC(finbehriskyassets, type = "HC0"))
AIC(finbehriskyassets)
finattriskyassets <- lm(fin_att ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finattriskyassets)  
coeftest(finattriskyassets, vcov = vcovHC(finattriskyassets, type = "HC0"))
AIC(finattriskyassets)

selfemployedriskyassets <- glm(selfemployedd ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedriskyassets)  
coeftest(selfemployedriskyassets, vcov = vcovHC(selfemployedriskyassets, type = "HC0"))
(adjR2(selfemployedriskyassets))
employedriskyassets <- glm(employedd ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedriskyassets)  
coeftest(employedriskyassets, vcov = vcovHC(employedriskyassets, type = "HC0"))

multi_emplriskyassets <- multinom(employment1_1 ~  riskyassetsd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplriskyassets)
stargazer(multi_emplriskyassets, type="text", out="multi_emplriskyassets.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplriskyassets, which = c("McFadden"))

#self-employed
finlitriskyassetsse <- lm(finlit ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskyassetsse)  
coeftest(finlitriskyassetsse, vcov = vcovHC(finlitriskyassetsse, type = "HC0"))
AIC(finlitriskyassetsse)
finknowriskyassetsse <- lm(fin_know ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskyassetsse)  
coeftest(finknowriskyassetsse, vcov = vcovHC(finknowriskyassetsse, type = "HC0"))
AIC(finknowriskyassetsse)
finbehriskyassetsse <- lm(fin_beh ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskyassetsse)  
coeftest(finbehriskyassetsse, vcov = vcovHC(finbehriskyassetsse, type = "HC0"))
AIC(finbehriskyassetsse)
finattriskyassetsse <- lm(fin_att ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskyassetsse)  
coeftest(finattriskyassetsse, vcov = vcovHC(finattriskyassetsse, type = "HC0"))
AIC(finattriskyassetsse)

#employed
finlitriskyassetse <- lm(finlit ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriskyassetse)
coeftest(finlitriskyassetse, vcov = vcovHC(finlitriskyassetse, type = "HC0"))
AIC(finlitriskyassetse)
finknowriskyassetse <- lm(fin_know ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriskyassetse)  
coeftest(finknowriskyassetse, vcov = vcovHC(finknowriskyassetse, type = "HC0"))
AIC(finknowriskyassetse)
finbehriskyassetse <- lm(fin_beh ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriskyassetse)  
coeftest(finbehriskyassetse, vcov = vcovHC(finbehriskyassetse, type = "HC0"))
AIC(finbehriskyassetse)
finattriskyassetse <- lm(fin_att ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriskyassetse)  
coeftest(finattriskyassetse, vcov = vcovHC(finattriskyassetse, type = "HC0"))
AIC(finattriskyassetse)
#higher risk for older?
riskage <- glm(HFCSriskad ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskage)
coeftest(riskage, vcov = vcovHC(riskage, type = "HC0"))
exp(coef(riskage))
AIC(riskage)
PseudoR2(riskage, which = c("McFadden"))

riskagese <- glm(HFCSriskad ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskagese)
coeftest(riskagese, vcov = vcovHC(riskagese, type = "HC0"))
exp(coef(riskagese))
AIC(riskagese)
PseudoR2(riskagese, which = c("McFadden"))
riskagee <- glm(HFCSriskad ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskagee)
coeftest(riskagee, vcov = vcovHC(riskagee, type = "HC0"))
exp(coef(riskagee))
PseudoR2(riskagee, which = c("McFadden"))
AIC(riskagee)


riskassetage <- glm(riskyassetsd ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassetage)
coeftest(riskassetage, vcov = vcovHC(riskassetage, type = "HC0"))
exp(coef(riskassetage))
AIC(riskassetage)
PseudoR2(riskassetage, which = c("McFadden"))
riskassetagese <- glm(riskyassetsd ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassetagese)
coeftest(riskassetagese, vcov = vcovHC(riskassetagese, type = "HC0"))
exp(coef(riskassetagese))
AIC(riskassetagese)
PseudoR2(riskassetagese, which = c("McFadden"))
riskassetagee <- glm(riskyassetsd ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassetagee)
coeftest(riskassetagee, vcov = vcovHC(riskassetagee, type = "HC0"))
exp(coef(riskassetagee))
AIC(riskassetagee)
PseudoR2(riskassetagee, which = c("McFadden"))

#higher risk for higher educated?
riskhigheduc <- glm(HFCSriskad ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskhigheduc)
coeftest(riskhigheduc, vcov = vcovHC(riskhigheduc, type = "HC0"))
exp(coef(riskhigheduc))
AIC(riskhigheduc)
PseudoR2(riskhigheduc, which = c("McFadden"))
riskhigheducse <- glm(HFCSriskad ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskhigheducse)
coeftest(riskhigheducse, vcov = vcovHC(riskhigheducse, type = "HC0"))
exp(coef(riskhigheducse))
AIC(riskhigheducse)
PseudoR2(riskhigheducse, which = c("McFadden"))
riskhigheduce <- glm(HFCSriskad ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskhigheduce)
coeftest(riskhigheduce, vcov = vcovHC(riskhigheduce, type = "HC0"))
exp(coef(riskhigheduce))
AIC(riskhigheduce)
PseudoR2(riskhigheduce, which = c("McFadden"))

riskassethigheduc <- glm(riskyassetsd ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassethigheduc)
coeftest(riskassethigheduc, vcov = vcovHC(riskassethigheduc, type = "HC0"))
exp(coef(riskassethigheduc))
AIC(riskassethigheduc)
PseudoR2(riskassethigheduc, which = c("McFadden"))
riskassethigheducse <- glm(riskyassetsd ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassethigheducse)
coeftest(riskassethigheducse, vcov = vcovHC(riskassethigheducse, type = "HC0"))
exp(coef(riskassethigheducse))
AIC(riskassethigheducse)
PseudoR2(riskassethigheducse, which = c("McFadden"))
riskassethigheduce <- glm(riskyassetsd ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassethigheduce)
coeftest(riskassethigheduce, vcov = vcovHC(riskassethigheduce, type = "HC0"))
exp(coef(riskassethigheduce))
AIC(riskassethigheduce)
PseudoR2(riskassethigheduce, which = c("McFadden"))


#higher risk for males?
riskgender <- glm(HFCSriskad ~ gender, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
exp(coef(riskgender))
AIC(riskgender)
PseudoR2(riskgender, which = c("McFadden"))
riskgenderse <- glm(HFCSriskad ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
exp(coef(riskgenderse))
AIC(riskgenderse)
PseudoR2(riskgenderse, which = c("McFadden"))
riskgendere <- glm(HFCSriskad ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))
exp(coef(riskgendere))
AIC(riskgendere)
PseudoR2(riskgendere, which = c("McFadden"))

riskassetmaled <- glm(riskyassetsd ~ maled, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassetmaled)
coeftest(riskassetmaled, vcov = vcovHC(riskassetmaled, type = "HC0"))
exp(coef(riskassetmaled))
AIC(riskassetmaled)
PseudoR2(riskassetmaled, which = c("McFadden"))
riskassetmaledse <- glm(riskyassetsd ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassetmaledse)
coeftest(riskassetmaledse, vcov = vcovHC(riskassetmaledse, type = "HC0"))
exp(coef(riskassetmaledse))
AIC(riskassetmaledse)
PseudoR2(riskassetmaledse, which = c("McFadden"))
riskassetmalede <- glm(riskyassetsd ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassetmalede)
coeftest(riskassetmalede, vcov = vcovHC(riskassetmalede, type = "HC0"))
exp(coef(riskassetmalede))
AIC(riskassetmalede)
PseudoR2(riskassetmalede, which = c("McFadden"))



riskgender <- glm(numericHFCSrisk ~ maled, data=ASFL7 , weights=ASFL7$wght)
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
riskgenderse <- glm(numericHFCSrisk ~ maled, data=ASFL7se , weights=ASFL7se$wght)
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
riskgendere <- glm(numericHFCSrisk ~ maled, data=ASFL7e , weights=ASFL7e$wght)
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))




finlitriskpropensitygender <- glm(finlit ~ maled, data=ASFL7risk, weights=ASFL7risk$wght)
summary(finlitriskpropensitygender)  
coeftest(finlitriskpropensitygender, vcov = vcovHC(finlitriskpropensitygender, type = "HC0"))
finlitriskpropensitygender2 <- glm(finlit ~ maled, data=ASFL7nrisk, weights=ASFL7nrisk$wght)
summary(finlitriskpropensitygender2)  
coeftest(finlitriskpropensitygender2, vcov = vcovHC(finlitriskpropensitygender2, type = "HC0"))





###########################MODEL EVALUATION###########################
#always exclude one group - otherwise: perfect collinearity! (zB:maled + femaled = 1)-> error would not occur for variables with missings but exclude one! 
finlitmodelfull <- lm(finlit ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 +  singled +childd +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfull)
shapiro.test(finlitmodelfull$residuals)
coeftest(finlitmodelfull, vcov = vcovHC(finlitmodelfull, type = "HC0"))
AIC(finlitmodelfull)
#model testing
#wald.test(Sigma = vcov(model), b = coef(model), Terms = 3:4)-p> .05, we fail to reject the null hypothesis of the Wald test.=> tested regression coefficients are both equal to zero.-> exclude from analysis
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 4)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 5)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 6)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7:8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 9)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 10)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11:13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 12)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 14) #riskpropensity

##for individual components
finknowmodelfull <- lm(fin_know ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 +  singled +childd +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelfull)
shapiro.test(finknowmodelfull$residuals)
coeftest(finknowmodelfull, vcov = vcovHC(finknowmodelfull, type = "HC0"))
AIC(finknowmodelfull)

finbehmodelfull <- lm(fin_beh ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 + singled +childd + incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelfull)
shapiro.test(finbehmodelfull$residuals)
coeftest(finbehmodelfull, vcov = vcovHC(finbehmodelfull, type = "HC0"))
AIC(finbehmodelfull)

finattmodelfull <- lm(fin_att ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 +  singled +childd +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finattmodelfull)
shapiro.test(finattmodelfull$residuals)
coeftest(finattmodelfull, vcov = vcovHC(finattmodelfull, type = "HC0"))
AIC(finattmodelfull)
##

#finlitmodel2 <- lm(finlit ~ employment1_2+ age + gender + higheduc + childd + singled +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
#summary(finlitmodel2)
#coeftest(finlitmodel2, vcov = vcovHC(finlitmodel2, type = "HC0"))
#AIC(finlitmodel2)
finlitmodel2 <- lm(finlit ~ employment1_2+ age + gender + higheduc  +livingcommgroup_1+incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel2)
coeftest(finlitmodel2, vcov = vcovHC(finlitmodel2, type = "HC0"))
AIC(finlitmodel2)
finlitmodel <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel)
coeftest(finlitmodel, vcov = vcovHC(finlitmodel, type = "HC0"))
AIC(finlitmodel)
par(mfrow=c(1,2))
##residual checking
plot(finlitmodel$residuals, main="",ylab="Residuen")
abline(h=0, col="red")
bptest(finlitmodel)#heterogeneity issues
qqnorm(finlitmodel$residuals, main="") #QQ-Residual-plot
qqline(finlitmodel$residuals, col="red") 
shapiro.test(finlitmodel$residuals) #not normally distributed

############model comparison
modelcomp <- list(finlitmodelfull, finlitmodel2, finlitmodel)
model.names <- c("1", "2", "3")
modelcomp <- aictab(modelcomp, modnames = model.names)
modelcomp
xtable(modelcomp, type = "latex", file = "modelcomp", digits=3)

finlitmodel4 <- lm(finlit ~employment1_2+ age  + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel4)
coeftest(finlitmodel4, vcov = vcovHC(finlitmodel4, type = "HC0"))
AIC(finlitmodel4)


modelcomp2 <- list(finlitmodelfull, finlitmodel2, finlitmodel,finlitmodel4)
model.names2 <- c("1", "2", "3", "4")
modelcomp2 <-aictab(modelcomp2, modnames = model.names2)
xtable(modelcomp2, type = "latex", file = "modelcomp2", digits=3)

####final model for individual components
finknowmodel <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

####enlarged financial knowledge score
finlitaddmodel <- lm(finlitadd ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitaddmodel)
coeftest(finlitaddmodel, vcov = vcovHC(finlitaddmodel, type = "HC0"))
AIC(finlitaddmodel)
finknowaddmodel <- lm(fin_know_add ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowaddmodel)
coeftest(finknowaddmodel, vcov = vcovHC(finknowaddmodel, type = "HC0"))
AIC(finknowaddmodel)

####with unemployed as employed
finlitmodel_eu <- lm(finlit ~ employmentunempl_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel_eu)
coeftest(finlitmodel_eu, vcov = vcovHC(finlitmodel_eu, type = "HC0"))
AIC(finlitmodel_eu)
finknowmodel <- lm(fin_know ~ employmentunempl_2 +age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~ employmentunempl_2 +age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~ employmentunempl_2 +age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

####only for working respondents #considerably smaller sample size
finlitmodel_empl <- lm(finlit ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finlitmodel_empl)
coeftest(finlitmodel_empl, vcov = vcovHC(finlitmodel_empl, type = "HC0"))
AIC(finlitmodel_empl)

finknowmodel_empl <- lm(fin_know ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finknowmodel_empl)
coeftest(finknowmodel_empl, vcov = vcovHC(finknowmodel_empl, type = "HC0"))
AIC(finknowmodel_empl)

finbehmodel_empl <- lm(fin_beh ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finbehmodel_empl)
coeftest(finbehmodel_empl, vcov = vcovHC(finbehmodel_empl, type = "HC0"))
AIC(finbehmodel_empl)

finattmodel_empl <- lm(fin_att ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finattmodel_empl)
coeftest(finattmodel_empl, vcov = vcovHC(finattmodel_empl, type = "HC0"))
AIC(finattmodel_empl)

####without employment
finlitmodel_woempl <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel_woempl)
coeftest(finlitmodel_woempl, vcov = vcovHC(finlitmodel_woempl, type = "HC0"))
AIC(finlitmodel_woempl)
finknowmodel <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

#for self-employed
finlitmodel_se <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodel_se)
coeftest(finlitmodel_se, vcov = vcovHC(finlitmodel_se, type = "HC0"))
AIC(finlitmodel_se)
finknowmodel_se <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodel_se)
coeftest(finknowmodel_se, vcov = vcovHC(finknowmodel_se, type = "HC0"))
AIC(finknowmodel_se)
finbehmodel_se <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodel_se)
coeftest(finbehmodel_se, vcov = vcovHC(finbehmodel_se, type = "HC0"))
AIC(finbehmodel_se)
finattmodel_se <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodel_se)
coeftest(finattmodel_se, vcov = vcovHC(finattmodel_se, type = "HC0"))
AIC(finattmodel_se)

#employed
finlitmodel_e <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodel_e)
coeftest(finlitmodel_e, vcov = vcovHC(finlitmodel_e, type = "HC0"))
AIC(finlitmodel_e)
finknowmodel_e <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodel_e)
coeftest(finknowmodel_e, vcov = vcovHC(finknowmodel_e, type = "HC0"))
AIC(finknowmodel_e)
finbehmodel_e <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodel_e)
coeftest(finbehmodel_e, vcov = vcovHC(finbehmodel_e, type = "HC0"))
AIC(finbehmodel_e)
finattmodel_e <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodel_e)
coeftest(finattmodel_e, vcov = vcovHC(finattmodel_e, type = "HC0"))
AIC(finattmodel_e)

####interaction check
#age and higher education ; gender and risk ; education and gender ;
finlitmodelinteractageeducriskgender <- lm(finlit ~ employment1_2+ age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc)
coeftest(finlitmodelinteractageeduc, vcov = vcovHC(finlitmodelinteractageeduc, type = "HC0"))
AIC(finlitmodelinteractageeduc)
finlitmodelinteractageeduc <- lm(finlit ~ employment1_2+ age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc)
coeftest(finlitmodelinteractageeduc, vcov = vcovHC(finlitmodelinteractageeduc, type = "HC0"))
AIC(finlitmodelinteractageeduc)
finlitmodelinteractageeduc3 <- lm(finlit ~ employment1_2+ age + gender + higheduc + age * higheduc + gender * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad * gender + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc3)
coeftest(finlitmodelinteractageeduc3, vcov = vcovHC(finlitmodelinteractageeduc3, type = "HC0"))
AIC(finlitmodelinteractageeduc3)
finlitmodelinteractageeduc4 <- lm(finlit ~ employment1_2+ age + gender + higheduc  + gender * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad * gender + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc4)
coeftest(finlitmodelinteractageeduc4, vcov = vcovHC(finlitmodelinteractageeduc4, type = "HC0"))
AIC(finlitmodelinteractageeduc4)
finlitmodelinteractageeduc5<- lm(finlit ~ employment1_2+ age + gender + higheduc  + gender * higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc5)
coeftest(finlitmodelinteractageeduc5, vcov = vcovHC(finlitmodelinteractageeduc5, type = "HC0"))
AIC(finlitmodelinteractageeduc5)
finlitmodelinteractageeduc6<- lm(finlit ~ (employment1_2+ age + gender + higheduc)^3   +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc6)
coeftest(finlitmodelinteractageeduc6, vcov = vcovHC(finlitmodelinteractageeduc6, type = "HC0"))
AIC(finlitmodelinteractageeduc6)
finlitmodelinteractageeduc7<- lm(finlit ~ employment1_2+ age  + higheduc   +incomegroup_1+ (gender +HFCSriskad + riskyassetsd)^2, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc7)
coeftest(finlitmodelinteractageeduc7, vcov = vcovHC(finlitmodelinteractageeduc7, type = "HC0"))
AIC(finlitmodelinteractageeduc7)
finlitmodelinteractageeduc8<- lm(finlit ~  age  + higheduc   +incomegroup_1+ (employment1_2+gender +HFCSriskad + riskyassetsd)^3, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc8)
coeftest(finlitmodelinteractageeduc8, vcov = vcovHC(finlitmodelinteractageeduc8, type = "HC0"))
AIC(finlitmodelinteractageeduc8)



#self-employed
finlitmodelinteractageeduc_se <- lm(finlit ~ age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractageeduc_se)
coeftest(finlitmodelinteractageeduc_se, vcov = vcovHC(finlitmodelinteractageeduc_se, type = "HC0"))
AIC(finlitmodelinteractageeduc_se)
finlitmodelinteractageeduc_se2 <- lm(finlit ~  age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractageeduc2)
coeftest(finlitmodelinteractageeduc2, vcov = vcovHC(finlitmodelinteractageeduc2, type = "HC0"))
AIC(finlitmodelinteractageeduc2)

#employed
finlitmodelinteractageeduc_e <- lm(finlit ~  age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractageeduc_e)
coeftest(finlitmodelinteractageeduc_e, vcov = vcovHC(finlitmodelinteractageeduc_e, type = "HC0"))
AIC(finlitmodelinteractageeduc_e)
finlitmodelinteractageeduc_e2 <- lm(finlit ~  age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractageeduc_e2)
coeftest(finlitmodelinteractageeduc_e2, vcov = vcovHC(finlitmodelinteractageeduc_e2, type = "HC0"))
AIC(finlitmodelinteractageeduc_e2)

#gender and financial risk
#full sample
finlitmodelinteractgenrisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk)
coeftest(finlitmodelinteractgenrisk, vcov = vcovHC(finlitmodelinteractgenrisk, type = "HC0"))
AIC(finlitmodelinteractgenrisk)
finlitmodelinteractgenrisk2 <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk2)
coeftest(finlitmodelinteractgenrisk2, vcov = vcovHC(finlitmodelinteractgenrisk2, type = "HC0"))
AIC(finlitmodelinteractgenrisk2)
finlitmodelinteractgenrisk3 <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk3)
coeftest(finlitmodelinteractgenrisk3, vcov = vcovHC(finlitmodelinteractgenrisk3, type = "HC0"))
AIC(finlitmodelinteractgenrisk3)

#self-employed
finlitmodelinteractgenrisk_se <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se)
coeftest(finlitmodelinteractgenrisk_se, vcov = vcovHC(finlitmodelinteractgenrisk_se, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se)
finlitmodelinteractgenrisk_se2 <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se2)
coeftest(finlitmodelinteractgenrisk_se2, vcov = vcovHC(finlitmodelinteractgenrisk_se2, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se2)
finlitmodelinteractgenrisk_se3 <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se3)
coeftest(finlitmodelinteractgenrisk_se3, vcov = vcovHC(finlitmodelinteractgenrisk_se3, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se3)

#employed
finlitmodelinteractgenrisk_e <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e)
coeftest(finlitmodelinteractgenrisk_e, vcov = vcovHC(finlitmodelinteractgenrisk_e, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e)
finlitmodelinteractgenrisk_e2 <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e2)
coeftest(finlitmodelinteractgenrisk_e2, vcov = vcovHC(finlitmodelinteractgenrisk_e2, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e2)
finlitmodelinteractgenrisk_e3 <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e3)
coeftest(finlitmodelinteractgenrisk_e3, vcov = vcovHC(finlitmodelinteractgenrisk_e3, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e3)

#age and financial risk
finlitmodelinteractagerisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*age+riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractagerisk)
coeftest(finlitmodelinteractagerisk, vcov = vcovHC(finlitmodelinteractagerisk, type = "HC0"))
AIC(finlitmodelinteractagerisk)





###########################SUBGROUP DIFFERENCES###########################
###########################AGE###########################
###########################Nonlinear age effect###########################
emplage <- lm(age ~ employment1_2,  data=ASFL7, weights=ASFL7$wght)
summary(emplage)
coeftest(emplage, vcov = vcovHC(emplage, type = "HC0"))
AIC(emplage)

#full sample
finlitage <- lm(finlit ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)

finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)
finlitage4 <- lm(finlit ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage4)
coeftest(finlitage4, vcov = vcovHC(finlitage4, type = "HC0"))
AIC(finlitage4)

finknowage <- lm(fin_know ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)
finknowage4 <- lm(fin_know ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage4)
coeftest(finknowage4, vcov = vcovHC(finknowage4, type = "HC0"))
AIC(finknowage4)

finbehage <- lm(fin_beh ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)
finbehage4 <- lm(fin_beh ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage4)
coeftest(finbehage4, vcov = vcovHC(finbehage4, type = "HC0"))
AIC(finbehage4)


finattage <- lm(fin_att ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
finattage4 <- lm(fin_att ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finattage4)
coeftest(finattage4, vcov = vcovHC(finattage4, type = "HC0"))
AIC(finattage4)

#employment groups full sample
selfemployedage <- glm(selfemployedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedage)  
coeftest(selfemployedage, vcov = vcovHC(selfemployedage, type = "HC0"))
(adjR2(selfemployedage))
employedage <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedage)  
coeftest(employedage, vcov = vcovHC(employedage, type = "HC0"))
PseudoR2(employedage, which = c("McFadden"))

#multi_emplage <- multinom(employment1_2 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplage <- multinom(employment1_1 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage)
exp(coef(multi_emplage))
#coeftest(multi_emplage, vcov = vcovHC(multi_emplage))
se <- summary(multi_emplage)$coefficients/summary(multi_emplage)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage, type="text", out="multi_emplage.htm", star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage, which = c("McFadden"))

multi_emplage2 <- multinom(employment1_1 ~  age +age2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage2)
exp(coef(multi_emplage2))
se <- summary(multi_emplage2)$coefficients/summary(multi_emplage2)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage2, type="text", out="multi_emplage2.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage2, which = c("McFadden"))

multi_emplage3 <- multinom(employment1_1 ~  rootage,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage3)
exp(coef(multi_emplage3))
se <- summary(multi_emplage3)$coefficients/summary(multi_emplage3)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage3, type="text", out="multi_emplage3.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage3, which = c("McFadden"))

multi_emplage4 <- multinom(employment1_1 ~  age_group,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage4)
exp(coef(multi_emplage4))
se <- summary(multi_emplage4)$coefficients/summary(multi_emplage4)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage4, type="text", out="multi_emplage4.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage4, which = c("McFadden"))

#selfemployed
finlitage <- lm(finlit ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)
finlitage4 <- lm(finlit ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage4)
coeftest(finlitage4, vcov = vcovHC(finlitage4, type = "HC0"))
AIC(finlitage4)

finknowage <- lm(fin_know ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)
finknowage4 <- lm(fin_know ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage4)
coeftest(finknowage4, vcov = vcovHC(finknowage4, type = "HC0"))
AIC(finknowage4)

finbehage <- lm(fin_beh ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)
finbehage4 <- lm(fin_beh ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage4)
coeftest(finbehage4, vcov = vcovHC(finbehage4, type = "HC0"))
AIC(finbehage4)

finattage <- lm(fin_att ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
finattage4 <- lm(fin_att ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage4)
coeftest(finattage4, vcov = vcovHC(finattage4, type = "HC0"))
AIC(finattage4)


#employed
finlitage <- lm(finlit ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)
finlitage4 <- lm(finlit ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage4)
coeftest(finlitage4, vcov = vcovHC(finlitage4, type = "HC0"))
AIC(finlitage4)

finknowage <- lm(fin_know ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)
finknowage4 <- lm(fin_know ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage4)
coeftest(finknowage4, vcov = vcovHC(finknowage4, type = "HC0"))
AIC(finknowage4)


finbehage <- lm(fin_beh ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)
finbehage4 <- lm(fin_beh ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage4)
coeftest(finbehage4, vcov = vcovHC(finbehage4, type = "HC0"))
AIC(finbehage4)

finattage <- lm(fin_att ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
finattage4 <- lm(fin_att ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage4)
coeftest(finattage4, vcov = vcovHC(finattage4, type = "HC0"))
AIC(finattage4)

###########################EDUCATION###########################
empleduc <- lm(higheduc ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(empleduc)
coeftest(empleduc, vcov = vcovHC(empleduc, type = "HC0"))
exp(coef(empleduc)) #exponentiated coefficients
AIC(empleduc)

multi_educspecific <- multinom(educationspecific_1 ~ employment1_2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_educspecific)
exp(coef(multi_educspecific))
se <- summary(multi_educspecific)$coefficients/summary(multi_educspecific)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_educspecific, type="text", out="multi_educspecific.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_educspecific, which = c("McFadden"))



#full sample
finlithigheduc <- lm(finlit ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finlithigheduc)  
coeftest(finlithigheduc, vcov = vcovHC(finlithigheduc, type = "HC0"))
AIC(finlithigheduc)
finlithigheducspecific <- lm(finlit ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlithigheducspecific)  
coeftest(finlithigheducspecific, vcov = vcovHC(finlithigheducspecific, type = "HC0"))
AIC(finlithigheducspecific)


finknowhigheduc <- lm(fin_know ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finknowhigheduc)  
coeftest(finknowhigheduc, vcov = vcovHC(finknowhigheduc, type = "HC0"))
AIC(finknowhigheduc)
finknowhigheducspecific <- lm(fin_know ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowhigheducspecific)  
coeftest(finknowhigheducspecific, vcov = vcovHC(finknowhigheducspecific, type = "HC0"))
AIC(finknowhigheducspecific)

finbehhigheduc <- lm(fin_beh ~ higheduc,data=ASFL7, weights=ASFL7$wght)
summary(finbehhigheduc)  
coeftest(finbehhigheduc, vcov = vcovHC(finbehhigheduc, type = "HC0"))
AIC(finbehhigheduc)
finbehhigheduceducspecific <- lm(fin_beh ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finbehhigheduceducspecific)  
coeftest(finbehhigheduceducspecific, vcov = vcovHC(finbehhigheduceducspecific, type = "HC0"))
AIC(finbehhigheduceducspecific)

finatthigheduc <- lm(fin_att ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finatthigheduc)  
coeftest(finatthigheduc, vcov = vcovHC(finatthigheduc, type = "HC0"))
AIC(finatthigheduc)
finatthigheduceducspecific <- lm(fin_att ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finatthigheduceducspecific)  
coeftest(finatthigheduceducspecific, vcov = vcovHC(finatthigheduceducspecific, type = "HC0"))
AIC(finatthigheduceducspecific)

selfemployedhigheduc <- glm(selfemployedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedhigheduc)  
coeftest(selfemployedhigheduc, vcov = vcovHC(selfemployedhigheduc, type = "HC0"))
(adjR2(selfemployedhigheduc))
employedhigheduc <- glm(employedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedhigheduc)  
coeftest(employedhigheduc, vcov = vcovHC(employedhigheduc, type = "HC0"))

#multi_emplhigheduc <- multinom(employment1_2 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplhigheduc <- multinom(employment1_1 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplhigheduc)
exp(coef(multi_emplhigheduc))
se <- summary(multi_emplhigheduc)$coefficients/summary(multi_emplhigheduc)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplhigheduc, type="text", out="multi_emplhigheduc.htm", star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplhigheduc, which = c("McFadden"))
#specific employment separation
multi_emplhigheducspecific <- multinom(employment1_1 ~  educationspecific_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplhigheducspecific)
exp(coef(multi_emplhigheducspecific))
se <- summary(multi_emplhigheducspecific)$coefficients/summary(multi_emplhigheducspecific)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplhigheducspecific, type="text", out="multi_emplhigheduc.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplhigheducspecific, which = c("McFadden"))

#self-employed
finlithigheducse <- lm(finlit ~ higheducse,data=ASFL7se, weights=ASFL7se$wght) 
summary(finlithigheducse)  
coeftest(finlithigheducse, vcov = vcovHC(finlithigheducse, type = "HC0"))
AIC(finlithigheducse)
finlithigheducsespecificse <- lm(finlit ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finlithigheducsespecificse)  
coeftest(finlithigheducsespecificse, vcov = vcovHC(finlithigheducsespecificse, type = "HC0"))
AIC(finlithigheducsespecificse)


finknowhigheducse <- lm(fin_know ~ higheducse,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowhigheducse)  
coeftest(finknowhigheducse, vcov = vcovHC(finknowhigheducse, type = "HC0"))
AIC(finknowhigheducse)
finknowhigheducsespecificse <- lm(fin_know ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowhigheducsespecificse)  
coeftest(finknowhigheducsespecificse, vcov = vcovHC(finknowhigheducsespecificse, type = "HC0"))
AIC(finknowhigheducsespecificse)

finbehhigheducse <- lm(fin_beh ~ higheducse,data=ASFL7se, weights=ASFL7se$wght)
summary(finbehhigheducse)  
coeftest(finbehhigheducse, vcov = vcovHC(finbehhigheducse, type = "HC0"))
AIC(finbehhigheducse)
finbehhigheducseeducspecificse <- lm(fin_beh ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehhigheducseeducspecificse)  
coeftest(finbehhigheducseeducspecificse, vcov = vcovHC(finbehhigheducseeducspecificse, type = "HC0"))
AIC(finbehhigheducseeducspecificse)

finatthigheducse <- lm(fin_att ~ higheducse,data=ASFL7se, weights=ASFL7se$wght) 
summary(finatthigheducse)  
coeftest(finatthigheducse, vcov = vcovHC(finatthigheducse, type = "HC0"))
AIC(finatthigheducse)
finatthigheducseeducspecificse <- lm(fin_att ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finatthigheducseeducspecificse)  
coeftest(finatthigheducseeducspecificse, vcov = vcovHC(finatthigheducseeducspecificse, type = "HC0"))
AIC(finatthigheducseeducspecificse)

#employed
finlithigheduce <- lm(finlit ~ higheduce,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlithigheduce)  
coeftest(finlithigheduce, vcov = vcovHC(finlithigheduce, type = "HC0"))
AIC(finlithigheduce)
finlithigheducespecifice <- lm(finlit ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlithigheducespecifice)  
coeftest(finlithigheducespecifice, vcov = vcovHC(finlithigheducespecifice, type = "HC0"))
AIC(finlithigheducespecifice)


finknowhigheduce <- lm(fin_know ~ higheduce,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowhigheduce)  
coeftest(finknowhigheduce, vcov = vcovHC(finknowhigheduce, type = "HC0"))
AIC(finknowhigheduce)
finknowhigheducespecifice <- lm(fin_know ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowhigheducespecifice)  
coeftest(finknowhigheducespecifice, vcov = vcovHC(finknowhigheducespecifice, type = "HC0"))
AIC(finknowhigheducespecifice)

finbehhigheduce <- lm(fin_beh ~ higheduce,data=ASFL7e, weights=ASFL7e$wght)
summary(finbehhigheduce)  
coeftest(finbehhigheduce, vcov = vcovHC(finbehhigheduce, type = "HC0"))
AIC(finbehhigheduce)
finbehhigheduceeducspecifice <- lm(fin_beh ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehhigheduceeducspecifice)  
coeftest(finbehhigheduceeducspecifice, vcov = vcovHC(finbehhigheduceeducspecifice, type = "HC0"))
AIC(finbehhigheduceeducspecifice)

finatthigheduce <- lm(fin_att ~ higheduce,data=ASFL7e, weights=ASFL7e$wght) 
summary(finatthigheduce)  
coeftest(finatthigheduce, vcov = vcovHC(finatthigheduce, type = "HC0"))
AIC(finatthigheduce)
finatthigheduceeducspecifice <- lm(fin_att ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finatthigheduceeducspecifice)  
coeftest(finatthigheduceeducspecifice, vcov = vcovHC(finatthigheduceeducspecifice, type = "HC0"))
AIC(finatthigheduceeducspecifice)

###########################GENDER###########################
emplgender <- lm(maled ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(emplgender) #im Vergleich zu employed mehr Männer
coeftest(emplgender, vcov = vcovHC(emplgender, type = "HC0"))
exp(coef(emplgender))
AIC(emplgender)

#full sample
finlitgender <- lm(finlit ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finlitgender)  
coeftest(finlitgender, vcov = vcovHC(finlitgender, type = "HC0"))
AIC(finlitgender)
finknowgender <- lm(fin_know ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finknowgender)  
coeftest(finknowgender, vcov = vcovHC(finknowgender, type = "HC0"))
AIC(finknowgender)
finbehgender <- lm(fin_beh ~ gender,data=ASFL7, weights=ASFL7$wght)
summary(finbehgender)  
coeftest(finbehgender, vcov = vcovHC(finbehgender, type = "HC0"))
AIC(finbehgender)
finattgender <- lm(fin_att ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finattgender)  
coeftest(finattgender, vcov = vcovHC(finattgender, type = "HC0"))
AIC(finattgender)

selfemployedgender <- glm(selfemployedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedgender)  
coeftest(selfemployedgender, vcov = vcovHC(selfemployedgender, type = "HC0"))
(adjR2(selfemployedgender))
employedgender <- glm(employedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedgender)  
coeftest(employedgender, vcov = vcovHC(employedgender, type = "HC0"))

#multi_emplgender <- multinom(employment1_2 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplgender <- multinom(employment1_1 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplgender)
exp(coef(multi_emplgender))
se <- summary(multi_emplgender)$coefficients/summary(multi_emplgender)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplgender, type="text", out="multi_emplgender.htm",
          star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplgender, which = c("McFadden"))

#self-employed
finlitgenderse <- lm(finlit ~ gender,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitgenderse)  
coeftest(finlitgenderse, vcov = vcovHC(finlitgenderse, type = "HC0"))
AIC(finlitgenderse)
finknowgenderse <- lm(fin_know ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowgenderse)  
coeftest(finknowgenderse, vcov = vcovHC(finknowgenderse, type = "HC0"))
AIC(finknowgenderse)
finbehgenderse <- lm(fin_beh ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehgenderse)  
coeftest(finbehgenderse, vcov = vcovHC(finbehgenderse, type = "HC0"))
AIC(finbehgenderse)
finattgenderse <- lm(fin_att ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattgenderse)  
coeftest(finattgenderse, vcov = vcovHC(finattgenderse, type = "HC0"))
AIC(finattgenderse)

#employed
finlitgendere <- lm(finlit ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitgendere)
coeftest(finlitgendere, vcov = vcovHC(finlitgendere, type = "HC0"))
AIC(finlitgendere)
finknowgendere <- lm(fin_know ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowgendere)  
coeftest(finknowgendere, vcov = vcovHC(finknowgendere, type = "HC0"))
AIC(finknowgendere)
finbehgendere <- lm(fin_beh ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehgendere)  
coeftest(finbehgendere, vcov = vcovHC(finbehgendere, type = "HC0"))
AIC(finbehgendere)
finattgendere <- lm(fin_att ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattgendere)  
coeftest(finattgendere, vcov = vcovHC(finattgendere, type = "HC0"))
AIC(finattgendere)


#####################################################################EXTENSIONS & ROBUSTNESS######################################################################################
##########################alternative income group (without Ref/Dont know) - full sample###########################################
#full sample
finlitmodelincomealt <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

#self-employed
finlitmodelincomealt <- lm(finlit ~age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

#employed
finlitmodelincomealt <- lm(finlit ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

##########################alternative age groups - full sample###########################################
#full sample
finlitmodelage_groupalt <- lm(finlit ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#self-employed
finlitmodelage_groupalt <- lm(finlit ~age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#employed
finlitmodelage_groupalt <- lm(finlit ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)


##########################alternative age effect quadratic - full sample###########################################
#full sample
finlitmodelage2alt <- lm(finlit ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelage2alt)
coeftest(finlitmodelage2alt, vcov = vcovHC(finlitmodelage2alt, type = "HC0"))
AIC(finlitmodelage2alt)
finknowmodelage2alt <- lm(fin_know ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelage2alt)
coeftest(finknowmodelage2alt, vcov = vcovHC(finknowmodelage2alt, type = "HC0"))
AIC(finknowmodelage2alt)
finbehmodelage2alt <- lm(fin_beh ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelage2alt)
coeftest(finbehmodelage2alt, vcov = vcovHC(finbehmodelage2alt, type = "HC0"))
AIC(finbehmodelage2alt)
finattmodelage2alt <- lm(fin_att ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelage2alt)
coeftest(finattmodelage2alt, vcov = vcovHC(finattmodelage2alt, type = "HC0"))
AIC(finattmodelage2alt)

#self-employed
finlitmodelage2alt <- lm(finlit ~ age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelage2alt)
coeftest(finlitmodelage2alt, vcov = vcovHC(finlitmodelage2alt, type = "HC0"))
AIC(finlitmodelage2alt)
finknowmodelage2alt <- lm(fin_know ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelage2alt)
coeftest(finknowmodelage2alt, vcov = vcovHC(finknowmodelage2alt, type = "HC0"))
AIC(finknowmodelage2alt)
finbehmodelage2alt <- lm(fin_beh ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelage2alt)
coeftest(finbehmodelage2alt, vcov = vcovHC(finbehmodelage2alt, type = "HC0"))
AIC(finbehmodelage2alt)
finattmodelage2alt <- lm(fin_att ~ age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelage2alt)
coeftest(finattmodelage2alt, vcov = vcovHC(finattmodelage2alt, type = "HC0"))
AIC(finattmodelage2alt)

#employed
finlitmodelage2alt <- lm(finlit ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelage2alt)
coeftest(finlitmodelage2alt, vcov = vcovHC(finlitmodelage2alt, type = "HC0"))
AIC(finlitmodelage2alt)
finknowmodelage2alt <- lm(fin_know ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelage2alt)
coeftest(finknowmodelage2alt, vcov = vcovHC(finknowmodelage2alt, type = "HC0"))
AIC(finknowmodelage2alt)
finbehmodelage2alt <- lm(fin_beh ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelage2alt)
coeftest(finbehmodelage2alt, vcov = vcovHC(finbehmodelage2alt, type = "HC0"))
AIC(finbehmodelage2alt)
finattmodelage2alt <- lm(fin_att ~ age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelage2alt)
coeftest(finattmodelage2alt, vcov = vcovHC(finattmodelage2alt, type = "HC0"))
AIC(finattmodelage2alt)

##########################alternative age root - full sample###########################################
#full sample
finlitmodelage_groupalt <- lm(finlit ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#self-employed
finlitmodelage_groupalt <- lm(finlit ~rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#employed
finlitmodelage_groupalt <- lm(finlit ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

##########################alternative education groups (four instead of two groups) - full sample###########################################
#full sample
finlitmodeleducationalt <- lm(finlit ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#self-employed
finlitmodeleducationalt <- lm(finlit ~age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#employed
finlitmodeleducationalt <- lm(finlit ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

##########################alternative education groups (five (Akademie separately) instead of two groups) - full sample###########################################
#full sample
finlitmodeleducationalt <- lm(finlit ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#self-employed
finlitmodeleducationalt <- lm(finlit ~age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#employed
finlitmodeleducationalt <- lm(finlit ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)


##########################alternative education groups (without tertiary educated) - full sample###########################################
#full sample
finlitmodeleducationalt <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#self-employed
finlitmodeleducationalt <- lm(finlit ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#employed
finlitmodeleducationalt <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)


##########################alternative risk evaluation - full sample###########################################
#HFCSriskd 
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#QS1_2risk
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#HFCSriskgroup
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#QS1_2risk_group_1 # again: no risk as reference category!
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#without HFCSrisk!
#full sample
finlitmodelworiskprop <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelworiskprop)
coeftest(finlitmodelworiskprop, vcov = vcovHC(finlitmodelworiskprop, type = "HC0"))
AIC(finlitmodelworiskprop)
finknowmodelworiskprop <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelworiskprop)
coeftest(finknowmodelworiskprop, vcov = vcovHC(finknowmodelworiskprop, type = "HC0"))
AIC(finknowmodelworiskprop)
finbehmodelworiskprop <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelworiskprop)
coeftest(finbehmodelworiskprop, vcov = vcovHC(finbehmodelworiskprop, type = "HC0"))
AIC(finbehmodelworiskprop)
finattmodelworiskprop <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelworiskprop)
coeftest(finattmodelworiskprop, vcov = vcovHC(finattmodelworiskprop, type = "HC0"))
AIC(finattmodelworiskprop)

#self-employed
finlitmodelworiskpropse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelworiskpropse)
coeftest(finlitmodelworiskpropse, vcov = vcovHC(finlitmodelworiskpropse, type = "HC0"))
AIC(finlitmodelworiskpropse)
finknowmodelworiskpropse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelworiskpropse)
coeftest(finknowmodelworiskpropse, vcov = vcovHC(finknowmodelworiskpropse, type = "HC0"))
AIC(finknowmodelworiskpropse)
finbehmodelworiskpropse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelworiskpropse)
coeftest(finbehmodelworiskpropse, vcov = vcovHC(finbehmodelworiskpropse, type = "HC0"))
AIC(finbehmodelworiskpropse)
finattmodelworiskpropse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelworiskpropse)
coeftest(finattmodelworiskpropse, vcov = vcovHC(finattmodelworiskpropse, type = "HC0"))
AIC(finattmodelworiskpropse)

#employed
finlitmodelworiskprope <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelworiskprope)
coeftest(finlitmodelworiskprope, vcov = vcovHC(finlitmodelworiskprope, type = "HC0"))
AIC(finlitmodelworiskprope)
finknowmodelworiskprope <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelworiskprope)
coeftest(finknowmodelworiskprope, vcov = vcovHC(finknowmodelworiskprope, type = "HC0"))
AIC(finknowmodelworiskprope)
finbehmodelworiskprope <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelworiskprope)
coeftest(finbehmodelworiskprope, vcov = vcovHC(finbehmodelworiskprope, type = "HC0"))
AIC(finbehmodelworiskprope)
finattmodelworiskprope <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelworiskprope)
coeftest(finattmodelworiskprope, vcov = vcovHC(finattmodelworiskprope, type = "HC0"))
AIC(finattmodelworiskprope)

#without riskyassets!
#full sample
finlitmodelwoasset <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelwoasset)
coeftest(finlitmodelwoasset, vcov = vcovHC(finlitmodelwoasset, type = "HC0"))
AIC(finlitmodelwoasset)
finknowmodelwoasset <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelwoasset)
coeftest(finknowmodelwoasset, vcov = vcovHC(finknowmodelwoasset, type = "HC0"))
AIC(finknowmodelwoasset)
finbehmodelwoasset <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelwoasset)
coeftest(finbehmodelwoasset, vcov = vcovHC(finbehmodelwoasset, type = "HC0"))
AIC(finbehmodelwoasset)
finattmodelwoasset <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelwoasset)
coeftest(finattmodelwoasset, vcov = vcovHC(finattmodelwoasset, type = "HC0"))
AIC(finattmodelwoasset)

#self-employed
finlitmodelwoassetse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelwoassetse)
coeftest(finlitmodelwoassetse, vcov = vcovHC(finlitmodelwoassetse, type = "HC0"))
AIC(finlitmodelwoassetse)
finknowmodelwoassetse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelwoassetse)
coeftest(finknowmodelwoassetse, vcov = vcovHC(finknowmodelwoassetse, type = "HC0"))
AIC(finknowmodelwoassetse)
finbehmodelwoassetse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelwoassetse)
coeftest(finbehmodelwoassetse, vcov = vcovHC(finbehmodelwoassetse, type = "HC0"))
AIC(finbehmodelwoassetse)
finattmodelwoassetse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelwoassetse)
coeftest(finattmodelwoassetse, vcov = vcovHC(finattmodelwoassetse, type = "HC0"))
AIC(finattmodelwoassetse)

#employed
finlitmodelwoassete <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelwoassete)
coeftest(finlitmodelwoassete, vcov = vcovHC(finlitmodelwoassete, type = "HC0"))
AIC(finlitmodelwoassete)
finknowmodelwoassete <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelwoassete)
coeftest(finknowmodelwoassete, vcov = vcovHC(finknowmodelwoassete, type = "HC0"))
AIC(finknowmodelwoassete)
finbehmodelwoassete <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelwoassete)
coeftest(finbehmodelwoassete, vcov = vcovHC(finbehmodelwoassete, type = "HC0"))
AIC(finbehmodelwoassete)
finattmodelwoassete <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelwoassete)
coeftest(finattmodelwoassete, vcov = vcovHC(finattmodelwoassete, type = "HC0"))
AIC(finattmodelwoassete)


#risk propensity asset holding interaction 
finlitmodelriskinteract <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskinteract)
coeftest(finlitmodelriskinteract, vcov = vcovHC(finlitmodelriskinteract, type = "HC0"))
AIC(finlitmodelriskinteract)
finknowmodelriskinteract <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskinteract)
coeftest(finknowmodelriskinteract, vcov = vcovHC(finknowmodelriskinteract, type = "HC0"))
AIC(finknowmodelriskinteract)
finbehmodelriskinteract <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskinteract)
coeftest(finbehmodelriskinteract, vcov = vcovHC(finbehmodelriskinteract, type = "HC0"))
AIC(finbehmodelriskinteract)
finattmodelriskinteract <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskinteract)
coeftest(finattmodelriskinteract, vcov = vcovHC(finattmodelriskinteract, type = "HC0"))
AIC(finattmodelriskinteract)

#self-employed
finlitmodelriskinteractse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelriskinteractse)
coeftest(finlitmodelriskinteractse, vcov = vcovHC(finlitmodelriskinteractse, type = "HC0"))
AIC(finlitmodelriskinteractse)
finknowmodelriskinteractse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelriskinteractse)
coeftest(finknowmodelriskinteractse, vcov = vcovHC(finknowmodelriskinteractse, type = "HC0"))
AIC(finknowmodelriskinteractse)
finbehmodelriskinteractse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelriskinteractse)
coeftest(finbehmodelriskinteractse, vcov = vcovHC(finbehmodelriskinteractse, type = "HC0"))
AIC(finbehmodelriskinteractse)
finattmodelriskinteractse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelriskinteractse)
coeftest(finattmodelriskinteractse, vcov = vcovHC(finattmodelriskinteractse, type = "HC0"))
AIC(finattmodelriskinteractse)

#employed
finlitmodelriskinteracte <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelriskinteracte)
coeftest(finlitmodelriskinteracte, vcov = vcovHC(finlitmodelriskinteracte, type = "HC0"))
AIC(finlitmodelriskinteracte)
finknowmodelriskinteracte <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelriskinteracte)
coeftest(finknowmodelriskinteracte, vcov = vcovHC(finknowmodelriskinteracte, type = "HC0"))
AIC(finknowmodelriskinteracte)
finbehmodelriskinteracte <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelriskinteracte)
coeftest(finbehmodelriskinteracte, vcov = vcovHC(finbehmodelriskinteracte, type = "HC0"))
AIC(finbehmodelriskinteracte)
finattmodelriskinteracte <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelriskinteracte)
coeftest(finattmodelriskinteracte, vcov = vcovHC(finattmodelriskinteracte, type = "HC0"))
AIC(finattmodelriskinteracte)

###########################Interaction gender and education###########################
finlitmodelgendereducinteract <- lm(finlit ~employment1_2+ age + gender + gender * higheduc+ higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelgendereducinteract)
coeftest(finlitmodelgendereducinteract, vcov = vcovHC(finlitmodelgendereducinteract, type = "HC0"))
AIC(finlitmodelgendereducinteract)
finknowmodelgendereducinteract <- lm(fin_know ~employment1_2+ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelgendereducinteract)
coeftest(finknowmodelgendereducinteract, vcov = vcovHC(finknowmodelgendereducinteract, type = "HC0"))
AIC(finknowmodelgendereducinteract)
finbehmodelgendereducinteract <- lm(fin_beh ~employment1_2+ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelgendereducinteract)
coeftest(finbehmodelgendereducinteract, vcov = vcovHC(finbehmodelgendereducinteract, type = "HC0"))
AIC(finbehmodelgendereducinteract)
finattmodelgendereducinteract <- lm(fin_att ~employment1_2+ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelgendereducinteract)
coeftest(finattmodelgendereducinteract, vcov = vcovHC(finattmodelgendereducinteract, type = "HC0"))
AIC(finattmodelgendereducinteract)

#self-employed
finlitmodelgendereducinteractse <- lm(finlit ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelgendereducinteractse)
coeftest(finlitmodelgendereducinteractse, vcov = vcovHC(finlitmodelgendereducinteractse, type = "HC0"))
AIC(finlitmodelgendereducinteractse)
finknowmodelgendereducinteractse <- lm(fin_know ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelgendereducinteractse)
coeftest(finknowmodelgendereducinteractse, vcov = vcovHC(finknowmodelgendereducinteractse, type = "HC0"))
AIC(finknowmodelgendereducinteractse)
finbehmodelgendereducinteractse <- lm(fin_beh ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelgendereducinteractse)
coeftest(finbehmodelgendereducinteractse, vcov = vcovHC(finbehmodelgendereducinteractse, type = "HC0"))
AIC(finbehmodelgendereducinteractse)
finattmodelgendereducinteractse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelgendereducinteractse)
coeftest(finattmodelgendereducinteractse, vcov = vcovHC(finattmodelgendereducinteractse, type = "HC0"))
AIC(finattmodelgendereducinteractse)

#employed
finlitmodelgendereducinteracte <- lm(finlit ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelgendereducinteracte)
coeftest(finlitmodelgendereducinteracte, vcov = vcovHC(finlitmodelgendereducinteracte, type = "HC0"))
AIC(finlitmodelgendereducinteracte)
finknowmodelgendereducinteracte <- lm(fin_know ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad +  riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelgendereducinteracte)
coeftest(finknowmodelgendereducinteracte, vcov = vcovHC(finknowmodelgendereducinteracte, type = "HC0"))
AIC(finknowmodelgendereducinteracte)
finbehmodelgendereducinteracte <- lm(fin_beh ~age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad +riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelgendereducinteracte)
coeftest(finbehmodelgendereducinteracte, vcov = vcovHC(finbehmodelgendereducinteracte, type = "HC0"))
AIC(finbehmodelgendereducinteracte)
finattmodelgendereducinteracte <- lm(fin_att ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelgendereducinteracte)
coeftest(finattmodelgendereducinteracte, vcov = vcovHC(finattmodelgendereducinteracte, type = "HC0"))
AIC(finattmodelgendereducinteracte)

###########################FULLY INTERACTED MODEL########################### lm(a ~ (b + c + d)^2)
finlitmodelfullinteract <- lm(finlit ~ (employment1_2+ age + gender + higheduc+ incomegroup_1+ HFCSriskad+ riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
#controlvariablesfullinteraction
finlitmodelfullinteract <- lm(finlit ~ employment1_2+ (age + gender + higheduc+ incomegroup_1+ HFCSriskad+ riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
finlitmodelfullinteract <- lm(fin_know ~ employment1_2+ (age + gender + higheduc+ incomegroup_1+ HFCSriskad+ riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
#employmentfullinteractions
finlitmodelfullinteractempl <- lm(finlit ~ employment1_2+ age +age*employment1_2 + gender + employment1_2*gender + higheduc+ employment1_2*higheduc+ incomegroup_1+ employment1_2*incomegroup_1 + HFCSriskad+  employment1_2*HFCSriskad + riskyassetsd + employment1_2*riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteractempl)
coeftest(finlitmodelfullinteractempl, vcov = vcovHC(finlitmodelfullinteractempl, type = "HC0")) #reveals no significant effects!
AIC(finlitmodelfullinteract)


#reasonable full interactions model - !
finlitmodelfullinteract <- lm(finlit ~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)

finknowmodelfullinteract <- lm(fin_know ~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelfullinteract)
coeftest(finknowmodelfullinteract, vcov = vcovHC(finknowmodelfullinteract, type = "HC0"))
AIC(finknowmodelfullinteract)

finbehmodelfullinteract <- lm(fin_beh~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelfullinteract)
coeftest(finbehmodelfullinteract, vcov = vcovHC(finbehmodelfullinteract, type = "HC0"))
AIC(finbehmodelfullinteract)

finattmodelfullinteract <- lm(fin_att~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finattmodelfullinteract)
coeftest(finattmodelfullinteract, vcov = vcovHC(finattmodelfullinteract, type = "HC0"))
AIC(finattmodelfullinteract)


#selfemployed
#reasonable interactions!
finlitmodelfullinteractse <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelfullinteractse)
shapiro.test(finlitmodelfullinteractse$residuals)
coeftest(finlitmodelfullinteractse, vcov = vcovHC(finlitmodelfullinteractse, type = "HC0"))
AIC(finlitmodelfullinteractse)

finknowmodelfullinteractse <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelfullinteractse)
coeftest(finknowmodelfullinteractse, vcov = vcovHC(finknowmodelfullinteractse, type = "HC0"))
AIC(finknowmodelfullinteractse)

finbehmodelfullinteractse <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelfullinteractse)
coeftest(finbehmodelfullinteractse, vcov = vcovHC(finbehmodelfullinteractse, type = "HC0"))
AIC(finbehmodelfullinteractse)

finattmodelfullinteractse <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelfullinteractse)
coeftest(finattmodelfullinteractse, vcov = vcovHC(finattmodelfullinteractse, type = "HC0"))
AIC(finattmodelfullinteractse)

#employed
finlitmodelfullinteracte <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelfullinteracte)
shapiro.test(finlitmodelfullinteracte$residuals)
coeftest(finlitmodelfullinteracte, vcov = vcovHC(finlitmodelfullinteracte, type = "HC0"))
AIC(finlitmodelfullinteracte)

finknowmodelfullinteracte <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelfullinteracte)
coeftest(finknowmodelfullinteracte, vcov = vcovHC(finknowmodelfullinteracte, type = "HC0"))
AIC(finknowmodelfullinteracte)

finbehmodelfullinteracte <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelfullinteracte)
coeftest(finbehmodelfullinteracte, vcov = vcovHC(finbehmodelfullinteracte, type = "HC0"))
AIC(finbehmodelfullinteracte)

finattmodelfullinteracte <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelfullinteracte)
coeftest(finattmodelfullinteracte, vcov = vcovHC(finattmodelfullinteracte, type = "HC0"))
AIC(finattmodelfullinteracte)

####finally interactions model 
###only reasonable full interactions model - !
finlitmodelfullinteract <- lm(finlit ~ employment1_2+incomegroup_1+ age + gender + higheduc +higheduc*age+ HFCSriskad+HFCSriskad*gender+riskyassetsd+riskyassetsd*higheduc+HFCSriskad*riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
#alternative
finlitmodelfullinteract <- lm(finlit ~ employment1_2+incomegroup_1+ age + gender + higheduc +higheduc*age+ HFCSriskad+HFCSriskad*gender+riskyassetsd+riskyassetsd*higheduc , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)

finknowmodelfullinteract <- lm(fin_know ~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelfullinteract)
coeftest(finknowmodelfullinteract, vcov = vcovHC(finknowmodelfullinteract, type = "HC0"))
AIC(finknowmodelfullinteract)

finbehmodelfullinteract <- lm(fin_beh~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelfullinteract)
coeftest(finbehmodelfullinteract, vcov = vcovHC(finbehmodelfullinteract, type = "HC0"))
AIC(finbehmodelfullinteract)

finattmodelfullinteract <- lm(fin_att~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finattmodelfullinteract)
coeftest(finattmodelfullinteract, vcov = vcovHC(finattmodelfullinteract, type = "HC0"))
AIC(finattmodelfullinteract)


#selfemployed
#reasonable interactions!
finlitmodelfullinteractse <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelfullinteractse)
shapiro.test(finlitmodelfullinteractse$residuals)
coeftest(finlitmodelfullinteractse, vcov = vcovHC(finlitmodelfullinteractse, type = "HC0"))
AIC(finlitmodelfullinteractse)

finknowmodelfullinteractse <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelfullinteractse)
coeftest(finknowmodelfullinteractse, vcov = vcovHC(finknowmodelfullinteractse, type = "HC0"))
AIC(finknowmodelfullinteractse)

finbehmodelfullinteractse <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelfullinteractse)
coeftest(finbehmodelfullinteractse, vcov = vcovHC(finbehmodelfullinteractse, type = "HC0"))
AIC(finbehmodelfullinteractse)

finattmodelfullinteractse <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelfullinteractse)
coeftest(finattmodelfullinteractse, vcov = vcovHC(finattmodelfullinteractse, type = "HC0"))
AIC(finattmodelfullinteractse)

#employed
finlitmodelfullinteracte <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelfullinteracte)
shapiro.test(finlitmodelfullinteracte$residuals)
coeftest(finlitmodelfullinteracte, vcov = vcovHC(finlitmodelfullinteracte, type = "HC0"))
AIC(finlitmodelfullinteracte)

finknowmodelfullinteracte <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelfullinteracte)
coeftest(finknowmodelfullinteracte, vcov = vcovHC(finknowmodelfullinteracte, type = "HC0"))
AIC(finknowmodelfullinteracte)

finbehmodelfullinteracte <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelfullinteracte)
coeftest(finbehmodelfullinteracte, vcov = vcovHC(finbehmodelfullinteracte, type = "HC0"))
AIC(finbehmodelfullinteracte)

finattmodelfullinteracte <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelfullinteracte)
coeftest(finattmodelfullinteracte, vcov = vcovHC(finattmodelfullinteracte, type = "HC0"))
AIC(finattmodelfullinteracte)

###########################MULTINOMIAL logit model###########################
multi_finlitempl <- multinom(finlit_group ~ employment1_2 , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
#specify Hess = TRUE to save something called the Hessian matrix which helps with the calculation of standard errors, and set trace = FALSE to suppress the printing of convergence progress.
summary(multi_finlitempl)
exp(coef(multi_finlitempl))
se <- summary(multi_finlitempl)$coefficients/summary(multi_finlitempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlitempl, type="text", out="multi_finlitempl.htm",star.cutoffs = c(.05, .01, .001)) # type="html"otherwise!
PseudoR2(multi_finlitempl, which = c("McFadden"))


multi_finlit <- multinom(finlit_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit)
se <- summary(multi_finlit)$coefficients/summary(multi_finlit)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlit, type="text", out="multi_finlit.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finlit, which = c("McFadden"))

multi_finknow <- multinom(fin_know_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finknow)
stargazer(multi_finknow, type="text", out="multi_finknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finknow, which = c("McFadden"))

multi_finbeh <- multinom(fin_beh_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finbeh)
stargazer(multi_finbeh, type="text", out="multi_finknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finbeh, which = c("McFadden"))

multi_finatt <- multinom(fin_att_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finatt)
stargazer(multi_finatt, type="text", out="multi_finatt.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finatt, which = c("McFadden"))

#####full reverse causality model 
multi_fullreverse <- multinom(employment1_1 ~ finlit + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreverse)
se <- summary(multi_fullreverse)$coefficients/summary(multi_fullreverse)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_fullreverse, type="text", out="multi_finlit.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreverse, which = c("McFadden"))

#individual components reverse causality
multi_fullreverseknow <- multinom(employment1_1 ~ fin_know + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreverseknow)
stargazer(multi_fullreverseknow, type="text", out="multi_fullreverseknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreverseknow, which = c("McFadden"))

multi_fullreversebeh <- multinom(employment1_1 ~ fin_beh + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreversebeh)
stargazer(multi_fullreversebeh, type="text", out="multi_fullreversebeh.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreversebeh, which = c("McFadden"))

multi_fullreverseatt <- multinom(employment1_1 ~ fin_att + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreverseatt)
stargazer(multi_fullreverseatt, type="text", out="multi_fullreverseatt.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreverseatt, which = c("McFadden"))


multi_finlit_se <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7se, weights=ASFL7se$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_se)
stargazer(multi_finlit_se, type="text", out="multi_finlit_se.htm",star.cutoffs = c(.05, .01, .001))

multi_finlit_e <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7e, weights=ASFL7e$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_e)
stargazer(multi_finlit_e, type="text", out="multi_finlit_e",star.cutoffs = c(.05, .01, .001))
PseudoR2(multi_finlit_e, which = c("McFadden"))


###########################FULL MODEL OTHER INDICATORS###########################
####financial wellbeing
finwellbeingmodel <- lm(finwellbeing ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finwellbeingmodel)
coeftest(finwellbeingmodel, vcov = vcovHC(finwellbeingmodel, type = "HC0"))
AIC(finwellbeingmodel)
finwellbeingmodel_se <- lm(finwellbeing ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finwellbeingmodel_se)
coeftest(finwellbeingmodel_se, vcov = vcovHC(finwellbeingmodel_se, type = "HC0"))
AIC(finwellbeingmodel_se)
finwellbeingmodel_e <- lm(finwellbeing ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finwellbeingmodel_e)
coeftest(finwellbeingmodel_e, vcov = vcovHC(finwellbeingmodel_e, type = "HC0"))
AIC(finwellbeingmodel_e)

####product awareness
produsemodel <- lm(produse~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(produsemodel)
coeftest(produsemodel, vcov = vcovHC(produsemodel, type = "HC0"))
AIC(produsemodel)
produsemodel_se <- lm(produse~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(produsemodel_se)
coeftest(produsemodel_se, vcov = vcovHC(produsemodel_se, type = "HC0"))
AIC(produsemodel_se)
produsemodel_e <- lm(produse~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(produsemodel_e)
coeftest(produsemodel_e, vcov = vcovHC(produsemodel_e, type = "HC0"))
AIC(produsemodel_e)

####numeric selfassessment
####self-assessed financial literady
selfassessmodel <- lm(numericsaknow~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(selfassessmodel)
coeftest(selfassessmodel, vcov = vcovHC(selfassessmodel, type = "HC0"))
AIC(selfassessmodel)
#alternative
selfassessmodel_2 <- lm(numericsaknow_2~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(selfassessmodel_2)
coeftest(selfassessmodel_2, vcov = vcovHC(selfassessmodel_2, type = "HC0"))
AIC(selfassessmodel_2)

selfassessmodel_se <- lm(numericsaknow~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(selfassessmodel_se)
coeftest(selfassessmodel_se, vcov = vcovHC(selfassessmodel_se, type = "HC0"))
AIC(selfassessmodel_se)
selfassessmodel_e <- lm(numericsaknow~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(selfassessmodel_e)
coeftest(selfassessmodel_e, vcov = vcovHC(selfassessmodel_e, type = "HC0"))
AIC(selfassessmodel_e)
