###########################EMPLOYMENT REGRESSION###########################
ASFL7se <- ASFL7[(ASFL7$QD10 %in% se),] 
ASFL7e <- ASFL7[(ASFL7$QD10 %in% e),] 
ASFL7eu <- ASFL7[(ASFL7$QD10 %in% eu),] 
empl <- c("In paid employment [work for someone else]","Self-employed [work for myself]")
ASFL7empl <- ASFL7[(ASFL7$QD10 %in% empl),] 
ASFL7oth <-  ASFL7[(ASFL7$QD10 %in% oth),] 
ASFL7othworet <-  ASFL7[(ASFL7$QD10 %in% othworet),] 
ASFL7ret <-  ASFL7[(ASFL7$QD10 %in% ret),] 
ASFL7unempl <-  ASFL7[(ASFL7$QD10 %in% unempl),] 
ASFL7entrepreneurs <-  ASFL7[(ASFL7$QF9_11 %in% entrepreneurs),] 
ASFL7nontertiary <- ASFL7[!(ASFL7$educationspecific_1 %in% tertiary),] 
ASFL7nonprimary <- ASFL7[!(ASFL7$educationspecific_1 %in% primary),]
ASFL7nontertiarye <- ASFL7e[!(ASFL7e$educationspecific_1 %in% tertiary),] 
ASFL7nontertiaryse <- ASFL7se[!(ASFL7se$educationspecific_1 %in% tertiary),] 

finlitempl <- lm(finlit ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl)
coeftest(finlitempl, vcov = vcovHC(finlitempl, type = "HC0"))
#coeftest(finlitempl, vcov. = vcovHC) #alternative - also provides robust standard errors
AIC(finlitempl)
finlitempl2 <- lm(finlit ~ employment2_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl2)
coeftest(finlitempl2, vcov = vcovHC(finlitempl2, type = "HC0"))
AIC(finlitempl2)
finlitempl2_robustness <- lm(finlit ~ employment1_1, data=ASFL7empl, weights=ASFL7empl$wght)#robustness with predefined set
summary(finlitempl2_robustness)
coeftest(finlitempl2_robustness, vcov = vcovHC(finlitempl2_robustness, type = "HC0"))
AIC(finlitempl2_robustness)
finlitempl3 <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght) #excluding others-> smaller sample size
summary(finlitempl3)
coeftest(finlitempl3, vcov = vcovHC(finlitempl3, type = "HC0"))
AIC(finlitempl3)

##residual checking
par(mfrow=(1,2))
plot(finlitempl$residuals, main="Residual plot")
abline(h=0, col="red")
bptest(finlitempl)#heterogeneity issues
qqnorm(finlitempl$residuals, main="QQ-Residual plot") 
qqline(finlitempl$residuals, col="red") 
shapiro.test(finlitempl$residuals) #not normally distributed

finlitempl_full <- lm(finlit ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_full)
coeftest(finlitempl_full, vcov = vcovHC(finlitempl_full, type = "HC0"))
AIC(finlitempl_full)
finknowempl_full <- lm(fin_know ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finknowempl_full)
coeftest(finknowempl_full, vcov = vcovHC(finknowempl_full, type = "HC0"))
AIC(finknowempl_full)
finbehempl_full <- lm(fin_beh ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finbehempl_full)
coeftest(finbehempl_full, vcov = vcovHC(finbehempl_full, type = "HC0"))
AIC(finbehempl_full)
finattempl_full <- lm(fin_att ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finattempl_full)
coeftest(finattempl_full, vcov = vcovHC(finattempl_full, type = "HC0"))
AIC(finattempl_full)


finlitempl_fullalt <- lm(finlit ~ QD10, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_fullalt)
coeftest(finlitempl_fullalt, vcov = vcovHC(finlitempl_fullalt, type = "HC0"))
AIC(finlitempl_fullalt)
finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitsee <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght)
summary(finlitsee)
coeftest(finlitsee, vcov = vcovHC(finlitsee, type = "HC0"))
AIC(finlitsee)

finlitse <- lm(finlit ~ selfemployedd, data=ASFL7, weights=ASFL7$wght)
summary(finlitse)
coeftest(finlitse, vcov = vcovHC(finlitse, type = "HC0"))
AIC(finlitse)
finlite <- lm(finlit ~ employedd, data=ASFL7, weights=ASFL7$wght)
summary(finlite)
coeftest(finlite, vcov = vcovHC(finlite, type = "HC0"))
AIC(finlite)
finlitoth <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght)
summary(finlitoth)
coeftest(finlitoth, vcov = vcovHC(finlitoth, type = "HC0"))
AIC(finlitoth)

#######for individual indicators
fin_knowempl <- lm(fin_know ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_knowempl)
coeftest(fin_knowempl, vcov = vcovHC(fin_knowempl, type = "HC0"))
AIC(fin_knowempl)

fin_behempl <- lm(fin_beh ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_behempl)
coeftest(fin_behempl, vcov = vcovHC(fin_behempl, type = "HC0"))
AIC(fin_behempl)

fin_attempl <- lm(fin_att ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_attempl)
coeftest(fin_attempl, vcov = vcovHC(fin_attempl, type = "HC0"))
AIC(fin_attempl)

###########################REVERSE CAUSALITY EFFECT###########################
revselfempl <- lm(selfemployedd ~ finlit,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(revselfempl)  
exp(coef(revselfempl))
coeftest(revselfempl, vcov = vcovHC(revselfempl, type = "HC0"))
(adjR2(revselfempl))
revselfempl <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(revselfempl)  
coeftest(revselfempl, vcov = vcovHC(revselfempl, type = "HC0"))
(adjR2(revselfempl))

multi_revempl <- multinom(employment1_1 ~  finlit,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revempl)
exp(coef(multi_revempl))
se <- summary(multi_revempl)$coefficients/summary(multi_revempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_revempl, type="text", out="multi_revempl.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revempl, which = c("McFadden"))#PseudoR2(multi_mo, which = c("CoxSnell","Nagelkerke","McFadden"))

multi_revemplfull <- multinom(employment1_1 ~  finlit+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd ,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplfull)
exp(coef(multi_revemplfull))
se <- summary(multi_revemplfull)$coefficients/summary(multi_revemplfull)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_revemplfull, type="text", out="multi_revemplfull.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplfull, which = c("McFadden"))#PseudoR2(multi_mo, which = c("CoxSnell","Nagelkerke","McFadden"))

#simple reverse causality components
multi_revemplknow <- multinom(employment1_1 ~  fin_know,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplknow)
exp(coef(multi_revemplknow))
stargazer(multi_revemplknow, type="text", out="multi_revemplknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplknow, which = c("McFadden"))

multi_revemplbeh <- multinom(employment1_1 ~  fin_beh,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplbeh)
exp(coef(multi_revemplbeh))
stargazer(multi_revemplbeh, type="text", out="multi_revemplbeh.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplbeh, which = c("McFadden"))

multi_revemplatt <- multinom(employment1_1 ~  fin_att,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revemplatt)
exp(coef(multi_revemplatt))
stargazer(multi_revemplatt, type="text", out="multi_revemplatt.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_revemplatt, which = c("McFadden"))

###########################FINANCIAL RISK EVALUATION###########################
#financial literacy risk propensity HFCSriskad
#full sample
finlitrisk <- lm(finlit ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSriskad,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)
#alternative1 HFCSriskd
#full sample
finlitrisk <- lm(finlit ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))

multi_emplriskalt1 <- multinom(employment1_1 ~  HFCSriskd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplriskalt1)
stargazer(multi_emplriskalt1, type="text", out="multi_emplriskalt1.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplriskalt1, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)

#alternative2 QS1_2risk
#full sample
finlitrisk <- lm(finlit ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  QS1_2risk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)

#alternative numericHFCSrisk
#full sample
finlitrisk <- lm(finlit ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))

multi_emplrisk <- multinom(employment1_1 ~  numericHFCSrisk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative numericQSrisk
#full sample
finlitrisk <- lm(finlit ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~numericQS1_2,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~numericQS1_2,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~numericQS1_2,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~ numericQS1_2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative HFCSriskgroup_1
#full sample
finlitrisk <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSrisk_group_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)


#alternative QS1_2risk_group
#full sample
finlitrisk <- lm(finlit ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know~ QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att~ QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd~ QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~ QS1_2risk_group_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att~ QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att~ QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)
#rboustness: riskyassets 
#full sample
finlitriskyassets <- lm(finlit ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitriskyassets)  
coeftest(finlitriskyassets, vcov = vcovHC(finlitriskyassets, type = "HC0"))
AIC(finlitriskyassets)
finknowriskyassets <- lm(fin_know ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowriskyassets)  
coeftest(finknowriskyassets, vcov = vcovHC(finknowriskyassets, type = "HC0"))
AIC(finknowriskyassets)
finbehriskyassets <- lm(fin_beh ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght)
summary(finbehriskyassets)  
coeftest(finbehriskyassets, vcov = vcovHC(finbehriskyassets, type = "HC0"))
AIC(finbehriskyassets)
finattriskyassets <- lm(fin_att ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finattriskyassets)  
coeftest(finattriskyassets, vcov = vcovHC(finattriskyassets, type = "HC0"))
AIC(finattriskyassets)

selfemployedriskyassets <- glm(selfemployedd ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedriskyassets)  
coeftest(selfemployedriskyassets, vcov = vcovHC(selfemployedriskyassets, type = "HC0"))
(adjR2(selfemployedriskyassets))
employedriskyassets <- glm(employedd ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedriskyassets)  
coeftest(employedriskyassets, vcov = vcovHC(employedriskyassets, type = "HC0"))

multi_emplriskyassets <- multinom(employment1_1 ~  riskyassetsd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplriskyassets)
stargazer(multi_emplriskyassets, type="text", out="multi_emplriskyassets.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplriskyassets, which = c("McFadden"))

#self-employed
finlitriskyassetsse <- lm(finlit ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskyassetsse)  
coeftest(finlitriskyassetsse, vcov = vcovHC(finlitriskyassetsse, type = "HC0"))
AIC(finlitriskyassetsse)
finknowriskyassetsse <- lm(fin_know ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskyassetsse)  
coeftest(finknowriskyassetsse, vcov = vcovHC(finknowriskyassetsse, type = "HC0"))
AIC(finknowriskyassetsse)
finbehriskyassetsse <- lm(fin_beh ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskyassetsse)  
coeftest(finbehriskyassetsse, vcov = vcovHC(finbehriskyassetsse, type = "HC0"))
AIC(finbehriskyassetsse)
finattriskyassetsse <- lm(fin_att ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskyassetsse)  
coeftest(finattriskyassetsse, vcov = vcovHC(finattriskyassetsse, type = "HC0"))
AIC(finattriskyassetsse)

#employed
finlitriskyassetse <- lm(finlit ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriskyassetse)
coeftest(finlitriskyassetse, vcov = vcovHC(finlitriskyassetse, type = "HC0"))
AIC(finlitriskyassetse)
finknowriskyassetse <- lm(fin_know ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriskyassetse)  
coeftest(finknowriskyassetse, vcov = vcovHC(finknowriskyassetse, type = "HC0"))
AIC(finknowriskyassetse)
finbehriskyassetse <- lm(fin_beh ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriskyassetse)  
coeftest(finbehriskyassetse, vcov = vcovHC(finbehriskyassetse, type = "HC0"))
AIC(finbehriskyassetse)
finattriskyassetse <- lm(fin_att ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriskyassetse)  
coeftest(finattriskyassetse, vcov = vcovHC(finattriskyassetse, type = "HC0"))
AIC(finattriskyassetse)
#higher risk for older?
riskage <- glm(HFCSriskad ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskage)
coeftest(riskage, vcov = vcovHC(riskage, type = "HC0"))
exp(coef(riskage))
AIC(riskage)
PseudoR2(riskage, which = c("McFadden"))

riskagese <- glm(HFCSriskad ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskagese)
coeftest(riskagese, vcov = vcovHC(riskagese, type = "HC0"))
exp(coef(riskagese))
AIC(riskagese)
PseudoR2(riskagese, which = c("McFadden"))
riskagee <- glm(HFCSriskad ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskagee)
coeftest(riskagee, vcov = vcovHC(riskagee, type = "HC0"))
exp(coef(riskagee))
PseudoR2(riskagee, which = c("McFadden"))
AIC(riskagee)


riskassetage <- glm(riskyassetsd ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassetage)
coeftest(riskassetage, vcov = vcovHC(riskassetage, type = "HC0"))
exp(coef(riskassetage))
AIC(riskassetage)
PseudoR2(riskassetage, which = c("McFadden"))
riskassetagese <- glm(riskyassetsd ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassetagese)
coeftest(riskassetagese, vcov = vcovHC(riskassetagese, type = "HC0"))
exp(coef(riskassetagese))
AIC(riskassetagese)
PseudoR2(riskassetagese, which = c("McFadden"))
riskassetagee <- glm(riskyassetsd ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassetagee)
coeftest(riskassetagee, vcov = vcovHC(riskassetagee, type = "HC0"))
exp(coef(riskassetagee))
AIC(riskassetagee)
PseudoR2(riskassetagee, which = c("McFadden"))

#higher risk for higher educated?
riskhigheduc <- glm(HFCSriskad ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskhigheduc)
coeftest(riskhigheduc, vcov = vcovHC(riskhigheduc, type = "HC0"))
exp(coef(riskhigheduc))
AIC(riskhigheduc)
PseudoR2(riskhigheduc, which = c("McFadden"))
riskhigheducse <- glm(HFCSriskad ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskhigheducse)
coeftest(riskhigheducse, vcov = vcovHC(riskhigheducse, type = "HC0"))
exp(coef(riskhigheducse))
AIC(riskhigheducse)
PseudoR2(riskhigheducse, which = c("McFadden"))
riskhigheduce <- glm(HFCSriskad ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskhigheduce)
coeftest(riskhigheduce, vcov = vcovHC(riskhigheduce, type = "HC0"))
exp(coef(riskhigheduce))
AIC(riskhigheduce)
PseudoR2(riskhigheduce, which = c("McFadden"))

riskassethigheduc <- glm(riskyassetsd ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassethigheduc)
coeftest(riskassethigheduc, vcov = vcovHC(riskassethigheduc, type = "HC0"))
exp(coef(riskassethigheduc))
AIC(riskassethigheduc)
PseudoR2(riskassethigheduc, which = c("McFadden"))
riskassethigheducse <- glm(riskyassetsd ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassethigheducse)
coeftest(riskassethigheducse, vcov = vcovHC(riskassethigheducse, type = "HC0"))
exp(coef(riskassethigheducse))
AIC(riskassethigheducse)
PseudoR2(riskassethigheducse, which = c("McFadden"))
riskassethigheduce <- glm(riskyassetsd ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassethigheduce)
coeftest(riskassethigheduce, vcov = vcovHC(riskassethigheduce, type = "HC0"))
exp(coef(riskassethigheduce))
AIC(riskassethigheduce)
PseudoR2(riskassethigheduce, which = c("McFadden"))


#higher risk for males?
riskgender <- glm(HFCSriskad ~ gender, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
exp(coef(riskgender))
AIC(riskgender)
PseudoR2(riskgender, which = c("McFadden"))
riskgenderse <- glm(HFCSriskad ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
exp(coef(riskgenderse))
AIC(riskgenderse)
PseudoR2(riskgenderse, which = c("McFadden"))
riskgendere <- glm(HFCSriskad ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))
exp(coef(riskgendere))
AIC(riskgendere)
PseudoR2(riskgendere, which = c("McFadden"))

riskassetmaled <- glm(riskyassetsd ~ maled, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassetmaled)
coeftest(riskassetmaled, vcov = vcovHC(riskassetmaled, type = "HC0"))
exp(coef(riskassetmaled))
AIC(riskassetmaled)
PseudoR2(riskassetmaled, which = c("McFadden"))
riskassetmaledse <- glm(riskyassetsd ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassetmaledse)
coeftest(riskassetmaledse, vcov = vcovHC(riskassetmaledse, type = "HC0"))
exp(coef(riskassetmaledse))
AIC(riskassetmaledse)
PseudoR2(riskassetmaledse, which = c("McFadden"))
riskassetmalede <- glm(riskyassetsd ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassetmalede)
coeftest(riskassetmalede, vcov = vcovHC(riskassetmalede, type = "HC0"))
exp(coef(riskassetmalede))
AIC(riskassetmalede)
PseudoR2(riskassetmalede, which = c("McFadden"))



riskgender <- glm(numericHFCSrisk ~ maled, data=ASFL7 , weights=ASFL7$wght)
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
riskgenderse <- glm(numericHFCSrisk ~ maled, data=ASFL7se , weights=ASFL7se$wght)
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
riskgendere <- glm(numericHFCSrisk ~ maled, data=ASFL7e , weights=ASFL7e$wght)
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))




finlitriskpropensitygender <- glm(finlit ~ maled, data=ASFL7risk, weights=ASFL7risk$wght)
summary(finlitriskpropensitygender)  
coeftest(finlitriskpropensitygender, vcov = vcovHC(finlitriskpropensitygender, type = "HC0"))
finlitriskpropensitygender2 <- glm(finlit ~ maled, data=ASFL7nrisk, weights=ASFL7nrisk$wght)
summary(finlitriskpropensitygender2)  
coeftest(finlitriskpropensitygender2, vcov = vcovHC(finlitriskpropensitygender2, type = "HC0"))





###########################MODEL EVALUATION###########################
#always exclude one group - otherwise: perfect collinearity! (zB:maled + femaled = 1)-> error would not occur for variables with missings but exclude one! 
finlitmodelfull <- lm(finlit ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 +  singled +childd +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfull)
shapiro.test(finlitmodelfull$residuals)
coeftest(finlitmodelfull, vcov = vcovHC(finlitmodelfull, type = "HC0"))
AIC(finlitmodelfull)
#model testing
#wald.test(Sigma = vcov(model), b = coef(model), Terms = 3:4)-p> .05, we fail to reject the null hypothesis of the Wald test.=> tested regression coefficients are both equal to zero.-> exclude from analysis
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 4)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 5)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 6)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7:8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 9)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 10)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11:13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 12)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 14) #riskpropensity

##for individual components
finknowmodelfull <- lm(fin_know ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 +  singled +childd +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelfull)
shapiro.test(finknowmodelfull$residuals)
coeftest(finknowmodelfull, vcov = vcovHC(finknowmodelfull, type = "HC0"))
AIC(finknowmodelfull)

finbehmodelfull <- lm(fin_beh ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 + singled +childd + incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelfull)
shapiro.test(finbehmodelfull$residuals)
coeftest(finbehmodelfull, vcov = vcovHC(finbehmodelfull, type = "HC0"))
AIC(finbehmodelfull)

finattmodelfull <- lm(fin_att ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 +  singled +childd +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finattmodelfull)
shapiro.test(finattmodelfull$residuals)
coeftest(finattmodelfull, vcov = vcovHC(finattmodelfull, type = "HC0"))
AIC(finattmodelfull)
##

#finlitmodel2 <- lm(finlit ~ employment1_2+ age + gender + higheduc + childd + singled +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
#summary(finlitmodel2)
#coeftest(finlitmodel2, vcov = vcovHC(finlitmodel2, type = "HC0"))
#AIC(finlitmodel2)
finlitmodel2 <- lm(finlit ~ employment1_2+ age + gender + higheduc  +livingcommgroup_1+incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel2)
coeftest(finlitmodel2, vcov = vcovHC(finlitmodel2, type = "HC0"))
AIC(finlitmodel2)
finlitmodel <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel)
coeftest(finlitmodel, vcov = vcovHC(finlitmodel, type = "HC0"))
AIC(finlitmodel)
par(mfrow=c(1,2))
##residual checking
plot(finlitmodel$residuals, main="",ylab="Residuen")
abline(h=0, col="red")
bptest(finlitmodel)#heterogeneity issues
qqnorm(finlitmodel$residuals, main="") #QQ-Residual-plot
qqline(finlitmodel$residuals, col="red") 
shapiro.test(finlitmodel$residuals) #not normally distributed

############model comparison
modelcomp <- list(finlitmodelfull, finlitmodel2, finlitmodel)
model.names <- c("1", "2", "3")
modelcomp <- aictab(modelcomp, modnames = model.names)
modelcomp
xtable(modelcomp, type = "latex", file = "modelcomp", digits=3)

finlitmodel4 <- lm(finlit ~employment1_2+ age  + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel4)
coeftest(finlitmodel4, vcov = vcovHC(finlitmodel4, type = "HC0"))
AIC(finlitmodel4)


modelcomp2 <- list(finlitmodelfull, finlitmodel2, finlitmodel,finlitmodel4)
model.names2 <- c("1", "2", "3", "4")
modelcomp2 <-aictab(modelcomp2, modnames = model.names2)
xtable(modelcomp2, type = "latex", file = "modelcomp2", digits=3)

####final model for individual components
finknowmodel <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

####enlarged financial knowledge score
finlitaddmodel <- lm(finlitadd ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitaddmodel)
coeftest(finlitaddmodel, vcov = vcovHC(finlitaddmodel, type = "HC0"))
AIC(finlitaddmodel)
finknowaddmodel <- lm(fin_know_add ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowaddmodel)
coeftest(finknowaddmodel, vcov = vcovHC(finknowaddmodel, type = "HC0"))
AIC(finknowaddmodel)

####with unemployed as employed
finlitmodel_eu <- lm(finlit ~ employmentunempl_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel_eu)
coeftest(finlitmodel_eu, vcov = vcovHC(finlitmodel_eu, type = "HC0"))
AIC(finlitmodel_eu)
finknowmodel <- lm(fin_know ~ employmentunempl_2 +age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~ employmentunempl_2 +age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~ employmentunempl_2 +age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

####only for working respondents #considerably smaller sample size
finlitmodel_empl <- lm(finlit ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finlitmodel_empl)
coeftest(finlitmodel_empl, vcov = vcovHC(finlitmodel_empl, type = "HC0"))
AIC(finlitmodel_empl)

finknowmodel_empl <- lm(fin_know ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finknowmodel_empl)
coeftest(finknowmodel_empl, vcov = vcovHC(finknowmodel_empl, type = "HC0"))
AIC(finknowmodel_empl)

finbehmodel_empl <- lm(fin_beh ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finbehmodel_empl)
coeftest(finbehmodel_empl, vcov = vcovHC(finbehmodel_empl, type = "HC0"))
AIC(finbehmodel_empl)

finattmodel_empl <- lm(fin_att ~ employment1_2 + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7empl, weights=ASFL7empl$wght)
summary(finattmodel_empl)
coeftest(finattmodel_empl, vcov = vcovHC(finattmodel_empl, type = "HC0"))
AIC(finattmodel_empl)

####without employment
finlitmodel_woempl <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel_woempl)
coeftest(finlitmodel_woempl, vcov = vcovHC(finlitmodel_woempl, type = "HC0"))
AIC(finlitmodel_woempl)
finknowmodel <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

#for self-employed
finlitmodel_se <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodel_se)
coeftest(finlitmodel_se, vcov = vcovHC(finlitmodel_se, type = "HC0"))
AIC(finlitmodel_se)
finknowmodel_se <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodel_se)
coeftest(finknowmodel_se, vcov = vcovHC(finknowmodel_se, type = "HC0"))
AIC(finknowmodel_se)
finbehmodel_se <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodel_se)
coeftest(finbehmodel_se, vcov = vcovHC(finbehmodel_se, type = "HC0"))
AIC(finbehmodel_se)
finattmodel_se <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodel_se)
coeftest(finattmodel_se, vcov = vcovHC(finattmodel_se, type = "HC0"))
AIC(finattmodel_se)

#employed
finlitmodel_e <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodel_e)
coeftest(finlitmodel_e, vcov = vcovHC(finlitmodel_e, type = "HC0"))
AIC(finlitmodel_e)
finknowmodel_e <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodel_e)
coeftest(finknowmodel_e, vcov = vcovHC(finknowmodel_e, type = "HC0"))
AIC(finknowmodel_e)
finbehmodel_e <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodel_e)
coeftest(finbehmodel_e, vcov = vcovHC(finbehmodel_e, type = "HC0"))
AIC(finbehmodel_e)
finattmodel_e <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodel_e)
coeftest(finattmodel_e, vcov = vcovHC(finattmodel_e, type = "HC0"))
AIC(finattmodel_e)

####interaction check
#age and higher education ; gender and risk ; education and gender ;
finlitmodelinteractageeducriskgender <- lm(finlit ~ employment1_2+ age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc)
coeftest(finlitmodelinteractageeduc, vcov = vcovHC(finlitmodelinteractageeduc, type = "HC0"))
AIC(finlitmodelinteractageeduc)
finlitmodelinteractageeduc <- lm(finlit ~ employment1_2+ age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc)
coeftest(finlitmodelinteractageeduc, vcov = vcovHC(finlitmodelinteractageeduc, type = "HC0"))
AIC(finlitmodelinteractageeduc)
finlitmodelinteractageeduc3 <- lm(finlit ~ employment1_2+ age + gender + higheduc + age * higheduc + gender * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad * gender + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc3)
coeftest(finlitmodelinteractageeduc3, vcov = vcovHC(finlitmodelinteractageeduc3, type = "HC0"))
AIC(finlitmodelinteractageeduc3)
finlitmodelinteractageeduc4 <- lm(finlit ~ employment1_2+ age + gender + higheduc  + gender * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad * gender + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc4)
coeftest(finlitmodelinteractageeduc4, vcov = vcovHC(finlitmodelinteractageeduc4, type = "HC0"))
AIC(finlitmodelinteractageeduc4)
finlitmodelinteractageeduc5<- lm(finlit ~ employment1_2+ age + gender + higheduc  + gender * higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc5)
coeftest(finlitmodelinteractageeduc5, vcov = vcovHC(finlitmodelinteractageeduc5, type = "HC0"))
AIC(finlitmodelinteractageeduc5)
finlitmodelinteractageeduc6<- lm(finlit ~ (employment1_2+ age + gender + higheduc)^3   +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc6)
coeftest(finlitmodelinteractageeduc6, vcov = vcovHC(finlitmodelinteractageeduc6, type = "HC0"))
AIC(finlitmodelinteractageeduc6)
finlitmodelinteractageeduc7<- lm(finlit ~ employment1_2+ age  + higheduc   +incomegroup_1+ (gender +HFCSriskad + riskyassetsd)^2, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc7)
coeftest(finlitmodelinteractageeduc7, vcov = vcovHC(finlitmodelinteractageeduc7, type = "HC0"))
AIC(finlitmodelinteractageeduc7)
finlitmodelinteractageeduc8<- lm(finlit ~  age  + higheduc   +incomegroup_1+ (employment1_2+gender +HFCSriskad + riskyassetsd)^3, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractageeduc8)
coeftest(finlitmodelinteractageeduc8, vcov = vcovHC(finlitmodelinteractageeduc8, type = "HC0"))
AIC(finlitmodelinteractageeduc8)



#self-employed
finlitmodelinteractageeduc_se <- lm(finlit ~ age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractageeduc_se)
coeftest(finlitmodelinteractageeduc_se, vcov = vcovHC(finlitmodelinteractageeduc_se, type = "HC0"))
AIC(finlitmodelinteractageeduc_se)
finlitmodelinteractageeduc_se2 <- lm(finlit ~  age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractageeduc2)
coeftest(finlitmodelinteractageeduc2, vcov = vcovHC(finlitmodelinteractageeduc2, type = "HC0"))
AIC(finlitmodelinteractageeduc2)

#employed
finlitmodelinteractageeduc_e <- lm(finlit ~  age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractageeduc_e)
coeftest(finlitmodelinteractageeduc_e, vcov = vcovHC(finlitmodelinteractageeduc_e, type = "HC0"))
AIC(finlitmodelinteractageeduc_e)
finlitmodelinteractageeduc_e2 <- lm(finlit ~  age + gender + higheduc + age * higheduc +incomegroup_1+ HFCSriskad+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractageeduc_e2)
coeftest(finlitmodelinteractageeduc_e2, vcov = vcovHC(finlitmodelinteractageeduc_e2, type = "HC0"))
AIC(finlitmodelinteractageeduc_e2)

#gender and financial risk
#full sample
finlitmodelinteractgenrisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk)
coeftest(finlitmodelinteractgenrisk, vcov = vcovHC(finlitmodelinteractgenrisk, type = "HC0"))
AIC(finlitmodelinteractgenrisk)
finlitmodelinteractgenrisk2 <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk2)
coeftest(finlitmodelinteractgenrisk2, vcov = vcovHC(finlitmodelinteractgenrisk2, type = "HC0"))
AIC(finlitmodelinteractgenrisk2)
finlitmodelinteractgenrisk3 <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk3)
coeftest(finlitmodelinteractgenrisk3, vcov = vcovHC(finlitmodelinteractgenrisk3, type = "HC0"))
AIC(finlitmodelinteractgenrisk3)

#self-employed
finlitmodelinteractgenrisk_se <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se)
coeftest(finlitmodelinteractgenrisk_se, vcov = vcovHC(finlitmodelinteractgenrisk_se, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se)
finlitmodelinteractgenrisk_se2 <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se2)
coeftest(finlitmodelinteractgenrisk_se2, vcov = vcovHC(finlitmodelinteractgenrisk_se2, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se2)
finlitmodelinteractgenrisk_se3 <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se3)
coeftest(finlitmodelinteractgenrisk_se3, vcov = vcovHC(finlitmodelinteractgenrisk_se3, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se3)

#employed
finlitmodelinteractgenrisk_e <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e)
coeftest(finlitmodelinteractgenrisk_e, vcov = vcovHC(finlitmodelinteractgenrisk_e, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e)
finlitmodelinteractgenrisk_e2 <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e2)
coeftest(finlitmodelinteractgenrisk_e2, vcov = vcovHC(finlitmodelinteractgenrisk_e2, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e2)
finlitmodelinteractgenrisk_e3 <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e3)
coeftest(finlitmodelinteractgenrisk_e3, vcov = vcovHC(finlitmodelinteractgenrisk_e3, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e3)

#age and financial risk
finlitmodelinteractagerisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*age+riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractagerisk)
coeftest(finlitmodelinteractagerisk, vcov = vcovHC(finlitmodelinteractagerisk, type = "HC0"))
AIC(finlitmodelinteractagerisk)





###########################SUBGROUP DIFFERENCES###########################
###########################AGE###########################
###########################Nonlinear age effect###########################
emplage <- lm(age ~ employment1_2,  data=ASFL7, weights=ASFL7$wght)
summary(emplage)
coeftest(emplage, vcov = vcovHC(emplage, type = "HC0"))
AIC(emplage)

#full sample
finlitage <- lm(finlit ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)

finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)
finlitage4 <- lm(finlit ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage4)
coeftest(finlitage4, vcov = vcovHC(finlitage4, type = "HC0"))
AIC(finlitage4)

finknowage <- lm(fin_know ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)
finknowage4 <- lm(fin_know ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage4)
coeftest(finknowage4, vcov = vcovHC(finknowage4, type = "HC0"))
AIC(finknowage4)

finbehage <- lm(fin_beh ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)
finbehage4 <- lm(fin_beh ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage4)
coeftest(finbehage4, vcov = vcovHC(finbehage4, type = "HC0"))
AIC(finbehage4)


finattage <- lm(fin_att ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
finattage4 <- lm(fin_att ~ age_group,  data=ASFL7, weights=ASFL7$wght)
summary(finattage4)
coeftest(finattage4, vcov = vcovHC(finattage4, type = "HC0"))
AIC(finattage4)

#employment groups full sample
selfemployedage <- glm(selfemployedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedage)  
coeftest(selfemployedage, vcov = vcovHC(selfemployedage, type = "HC0"))
(adjR2(selfemployedage))
employedage <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedage)  
coeftest(employedage, vcov = vcovHC(employedage, type = "HC0"))
PseudoR2(employedage, which = c("McFadden"))

#multi_emplage <- multinom(employment1_2 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplage <- multinom(employment1_1 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage)
exp(coef(multi_emplage))
#coeftest(multi_emplage, vcov = vcovHC(multi_emplage))
se <- summary(multi_emplage)$coefficients/summary(multi_emplage)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage, type="text", out="multi_emplage.htm", star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage, which = c("McFadden"))

multi_emplage2 <- multinom(employment1_1 ~  age +age2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage2)
exp(coef(multi_emplage2))
se <- summary(multi_emplage2)$coefficients/summary(multi_emplage2)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage2, type="text", out="multi_emplage2.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage2, which = c("McFadden"))

multi_emplage3 <- multinom(employment1_1 ~  rootage,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage3)
exp(coef(multi_emplage3))
se <- summary(multi_emplage3)$coefficients/summary(multi_emplage3)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage3, type="text", out="multi_emplage3.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage3, which = c("McFadden"))

multi_emplage4 <- multinom(employment1_1 ~  age_group,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage4)
exp(coef(multi_emplage4))
se <- summary(multi_emplage4)$coefficients/summary(multi_emplage4)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage4, type="text", out="multi_emplage4.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplage4, which = c("McFadden"))

#selfemployed
finlitage <- lm(finlit ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)
finlitage4 <- lm(finlit ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage4)
coeftest(finlitage4, vcov = vcovHC(finlitage4, type = "HC0"))
AIC(finlitage4)

finknowage <- lm(fin_know ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)
finknowage4 <- lm(fin_know ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage4)
coeftest(finknowage4, vcov = vcovHC(finknowage4, type = "HC0"))
AIC(finknowage4)

finbehage <- lm(fin_beh ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)
finbehage4 <- lm(fin_beh ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage4)
coeftest(finbehage4, vcov = vcovHC(finbehage4, type = "HC0"))
AIC(finbehage4)

finattage <- lm(fin_att ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
finattage4 <- lm(fin_att ~ age_group,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage4)
coeftest(finattage4, vcov = vcovHC(finattage4, type = "HC0"))
AIC(finattage4)


#employed
finlitage <- lm(finlit ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)
finlitage4 <- lm(finlit ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage4)
coeftest(finlitage4, vcov = vcovHC(finlitage4, type = "HC0"))
AIC(finlitage4)

finknowage <- lm(fin_know ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)
finknowage4 <- lm(fin_know ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage4)
coeftest(finknowage4, vcov = vcovHC(finknowage4, type = "HC0"))
AIC(finknowage4)


finbehage <- lm(fin_beh ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)
finbehage4 <- lm(fin_beh ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage4)
coeftest(finbehage4, vcov = vcovHC(finbehage4, type = "HC0"))
AIC(finbehage4)

finattage <- lm(fin_att ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
finattage4 <- lm(fin_att ~ age_group,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage4)
coeftest(finattage4, vcov = vcovHC(finattage4, type = "HC0"))
AIC(finattage4)

###########################EDUCATION###########################
empleduc <- lm(higheduc ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(empleduc)
coeftest(empleduc, vcov = vcovHC(empleduc, type = "HC0"))
exp(coef(empleduc)) #exponentiated coefficients
AIC(empleduc)

multi_educspecific <- multinom(educationspecific_1 ~ employment1_2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_educspecific)
exp(coef(multi_educspecific))
se <- summary(multi_educspecific)$coefficients/summary(multi_educspecific)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_educspecific, type="text", out="multi_educspecific.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_educspecific, which = c("McFadden"))



#full sample
finlithigheduc <- lm(finlit ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finlithigheduc)  
coeftest(finlithigheduc, vcov = vcovHC(finlithigheduc, type = "HC0"))
AIC(finlithigheduc)
finlithigheducspecific <- lm(finlit ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlithigheducspecific)  
coeftest(finlithigheducspecific, vcov = vcovHC(finlithigheducspecific, type = "HC0"))
AIC(finlithigheducspecific)


finknowhigheduc <- lm(fin_know ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finknowhigheduc)  
coeftest(finknowhigheduc, vcov = vcovHC(finknowhigheduc, type = "HC0"))
AIC(finknowhigheduc)
finknowhigheducspecific <- lm(fin_know ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowhigheducspecific)  
coeftest(finknowhigheducspecific, vcov = vcovHC(finknowhigheducspecific, type = "HC0"))
AIC(finknowhigheducspecific)

finbehhigheduc <- lm(fin_beh ~ higheduc,data=ASFL7, weights=ASFL7$wght)
summary(finbehhigheduc)  
coeftest(finbehhigheduc, vcov = vcovHC(finbehhigheduc, type = "HC0"))
AIC(finbehhigheduc)
finbehhigheduceducspecific <- lm(fin_beh ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finbehhigheduceducspecific)  
coeftest(finbehhigheduceducspecific, vcov = vcovHC(finbehhigheduceducspecific, type = "HC0"))
AIC(finbehhigheduceducspecific)

finatthigheduc <- lm(fin_att ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finatthigheduc)  
coeftest(finatthigheduc, vcov = vcovHC(finatthigheduc, type = "HC0"))
AIC(finatthigheduc)
finatthigheduceducspecific <- lm(fin_att ~ educationspecific_1,data=ASFL7, weights=ASFL7$wght) 
summary(finatthigheduceducspecific)  
coeftest(finatthigheduceducspecific, vcov = vcovHC(finatthigheduceducspecific, type = "HC0"))
AIC(finatthigheduceducspecific)

selfemployedhigheduc <- glm(selfemployedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedhigheduc)  
coeftest(selfemployedhigheduc, vcov = vcovHC(selfemployedhigheduc, type = "HC0"))
(adjR2(selfemployedhigheduc))
employedhigheduc <- glm(employedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedhigheduc)  
coeftest(employedhigheduc, vcov = vcovHC(employedhigheduc, type = "HC0"))

#multi_emplhigheduc <- multinom(employment1_2 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplhigheduc <- multinom(employment1_1 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplhigheduc)
exp(coef(multi_emplhigheduc))
se <- summary(multi_emplhigheduc)$coefficients/summary(multi_emplhigheduc)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplhigheduc, type="text", out="multi_emplhigheduc.htm", star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplhigheduc, which = c("McFadden"))
#specific employment separation
multi_emplhigheducspecific <- multinom(employment1_1 ~  educationspecific_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplhigheducspecific)
exp(coef(multi_emplhigheducspecific))
se <- summary(multi_emplhigheducspecific)$coefficients/summary(multi_emplhigheducspecific)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplhigheducspecific, type="text", out="multi_emplhigheduc.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplhigheducspecific, which = c("McFadden"))

#self-employed
finlithigheducse <- lm(finlit ~ higheducse,data=ASFL7se, weights=ASFL7se$wght) 
summary(finlithigheducse)  
coeftest(finlithigheducse, vcov = vcovHC(finlithigheducse, type = "HC0"))
AIC(finlithigheducse)
finlithigheducsespecificse <- lm(finlit ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finlithigheducsespecificse)  
coeftest(finlithigheducsespecificse, vcov = vcovHC(finlithigheducsespecificse, type = "HC0"))
AIC(finlithigheducsespecificse)


finknowhigheducse <- lm(fin_know ~ higheducse,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowhigheducse)  
coeftest(finknowhigheducse, vcov = vcovHC(finknowhigheducse, type = "HC0"))
AIC(finknowhigheducse)
finknowhigheducsespecificse <- lm(fin_know ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowhigheducsespecificse)  
coeftest(finknowhigheducsespecificse, vcov = vcovHC(finknowhigheducsespecificse, type = "HC0"))
AIC(finknowhigheducsespecificse)

finbehhigheducse <- lm(fin_beh ~ higheducse,data=ASFL7se, weights=ASFL7se$wght)
summary(finbehhigheducse)  
coeftest(finbehhigheducse, vcov = vcovHC(finbehhigheducse, type = "HC0"))
AIC(finbehhigheducse)
finbehhigheducseeducspecificse <- lm(fin_beh ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehhigheducseeducspecificse)  
coeftest(finbehhigheducseeducspecificse, vcov = vcovHC(finbehhigheducseeducspecificse, type = "HC0"))
AIC(finbehhigheducseeducspecificse)

finatthigheducse <- lm(fin_att ~ higheducse,data=ASFL7se, weights=ASFL7se$wght) 
summary(finatthigheducse)  
coeftest(finatthigheducse, vcov = vcovHC(finatthigheducse, type = "HC0"))
AIC(finatthigheducse)
finatthigheducseeducspecificse <- lm(fin_att ~ educationspecific_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finatthigheducseeducspecificse)  
coeftest(finatthigheducseeducspecificse, vcov = vcovHC(finatthigheducseeducspecificse, type = "HC0"))
AIC(finatthigheducseeducspecificse)

#employed
finlithigheduce <- lm(finlit ~ higheduce,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlithigheduce)  
coeftest(finlithigheduce, vcov = vcovHC(finlithigheduce, type = "HC0"))
AIC(finlithigheduce)
finlithigheducespecifice <- lm(finlit ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlithigheducespecifice)  
coeftest(finlithigheducespecifice, vcov = vcovHC(finlithigheducespecifice, type = "HC0"))
AIC(finlithigheducespecifice)


finknowhigheduce <- lm(fin_know ~ higheduce,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowhigheduce)  
coeftest(finknowhigheduce, vcov = vcovHC(finknowhigheduce, type = "HC0"))
AIC(finknowhigheduce)
finknowhigheducespecifice <- lm(fin_know ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowhigheducespecifice)  
coeftest(finknowhigheducespecifice, vcov = vcovHC(finknowhigheducespecifice, type = "HC0"))
AIC(finknowhigheducespecifice)

finbehhigheduce <- lm(fin_beh ~ higheduce,data=ASFL7e, weights=ASFL7e$wght)
summary(finbehhigheduce)  
coeftest(finbehhigheduce, vcov = vcovHC(finbehhigheduce, type = "HC0"))
AIC(finbehhigheduce)
finbehhigheduceeducspecifice <- lm(fin_beh ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehhigheduceeducspecifice)  
coeftest(finbehhigheduceeducspecifice, vcov = vcovHC(finbehhigheduceeducspecifice, type = "HC0"))
AIC(finbehhigheduceeducspecifice)

finatthigheduce <- lm(fin_att ~ higheduce,data=ASFL7e, weights=ASFL7e$wght) 
summary(finatthigheduce)  
coeftest(finatthigheduce, vcov = vcovHC(finatthigheduce, type = "HC0"))
AIC(finatthigheduce)
finatthigheduceeducspecifice <- lm(fin_att ~ educationspecific_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finatthigheduceeducspecifice)  
coeftest(finatthigheduceeducspecifice, vcov = vcovHC(finatthigheduceeducspecifice, type = "HC0"))
AIC(finatthigheduceeducspecifice)

###########################GENDER###########################
emplgender <- lm(maled ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(emplgender) #im Vergleich zu employed mehr Mnner
coeftest(emplgender, vcov = vcovHC(emplgender, type = "HC0"))
exp(coef(emplgender))
AIC(emplgender)

#full sample
finlitgender <- lm(finlit ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finlitgender)  
coeftest(finlitgender, vcov = vcovHC(finlitgender, type = "HC0"))
AIC(finlitgender)
finknowgender <- lm(fin_know ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finknowgender)  
coeftest(finknowgender, vcov = vcovHC(finknowgender, type = "HC0"))
AIC(finknowgender)
finbehgender <- lm(fin_beh ~ gender,data=ASFL7, weights=ASFL7$wght)
summary(finbehgender)  
coeftest(finbehgender, vcov = vcovHC(finbehgender, type = "HC0"))
AIC(finbehgender)
finattgender <- lm(fin_att ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finattgender)  
coeftest(finattgender, vcov = vcovHC(finattgender, type = "HC0"))
AIC(finattgender)

selfemployedgender <- glm(selfemployedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedgender)  
coeftest(selfemployedgender, vcov = vcovHC(selfemployedgender, type = "HC0"))
(adjR2(selfemployedgender))
employedgender <- glm(employedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedgender)  
coeftest(employedgender, vcov = vcovHC(employedgender, type = "HC0"))

#multi_emplgender <- multinom(employment1_2 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplgender <- multinom(employment1_1 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplgender)
exp(coef(multi_emplgender))
se <- summary(multi_emplgender)$coefficients/summary(multi_emplgender)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplgender, type="text", out="multi_emplgender.htm",
          star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_emplgender, which = c("McFadden"))

#self-employed
finlitgenderse <- lm(finlit ~ gender,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitgenderse)  
coeftest(finlitgenderse, vcov = vcovHC(finlitgenderse, type = "HC0"))
AIC(finlitgenderse)
finknowgenderse <- lm(fin_know ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowgenderse)  
coeftest(finknowgenderse, vcov = vcovHC(finknowgenderse, type = "HC0"))
AIC(finknowgenderse)
finbehgenderse <- lm(fin_beh ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehgenderse)  
coeftest(finbehgenderse, vcov = vcovHC(finbehgenderse, type = "HC0"))
AIC(finbehgenderse)
finattgenderse <- lm(fin_att ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattgenderse)  
coeftest(finattgenderse, vcov = vcovHC(finattgenderse, type = "HC0"))
AIC(finattgenderse)

#employed
finlitgendere <- lm(finlit ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitgendere)
coeftest(finlitgendere, vcov = vcovHC(finlitgendere, type = "HC0"))
AIC(finlitgendere)
finknowgendere <- lm(fin_know ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowgendere)  
coeftest(finknowgendere, vcov = vcovHC(finknowgendere, type = "HC0"))
AIC(finknowgendere)
finbehgendere <- lm(fin_beh ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehgendere)  
coeftest(finbehgendere, vcov = vcovHC(finbehgendere, type = "HC0"))
AIC(finbehgendere)
finattgendere <- lm(fin_att ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattgendere)  
coeftest(finattgendere, vcov = vcovHC(finattgendere, type = "HC0"))
AIC(finattgendere)


#####################################################################EXTENSIONS & ROBUSTNESS######################################################################################
##########################alternative income group (without Ref/Dont know) - full sample###########################################
#full sample
finlitmodelincomealt <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

#self-employed
finlitmodelincomealt <- lm(finlit ~age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

#employed
finlitmodelincomealt <- lm(finlit ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

##########################alternative age groups - full sample###########################################
#full sample
finlitmodelage_groupalt <- lm(finlit ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~employment1_2+ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#self-employed
finlitmodelage_groupalt <- lm(finlit ~age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#employed
finlitmodelage_groupalt <- lm(finlit ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~ age_group + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)


##########################alternative age effect quadratic - full sample###########################################
#full sample
finlitmodelage2alt <- lm(finlit ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelage2alt)
coeftest(finlitmodelage2alt, vcov = vcovHC(finlitmodelage2alt, type = "HC0"))
AIC(finlitmodelage2alt)
finknowmodelage2alt <- lm(fin_know ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelage2alt)
coeftest(finknowmodelage2alt, vcov = vcovHC(finknowmodelage2alt, type = "HC0"))
AIC(finknowmodelage2alt)
finbehmodelage2alt <- lm(fin_beh ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelage2alt)
coeftest(finbehmodelage2alt, vcov = vcovHC(finbehmodelage2alt, type = "HC0"))
AIC(finbehmodelage2alt)
finattmodelage2alt <- lm(fin_att ~employment1_2+  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelage2alt)
coeftest(finattmodelage2alt, vcov = vcovHC(finattmodelage2alt, type = "HC0"))
AIC(finattmodelage2alt)

#self-employed
finlitmodelage2alt <- lm(finlit ~ age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelage2alt)
coeftest(finlitmodelage2alt, vcov = vcovHC(finlitmodelage2alt, type = "HC0"))
AIC(finlitmodelage2alt)
finknowmodelage2alt <- lm(fin_know ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelage2alt)
coeftest(finknowmodelage2alt, vcov = vcovHC(finknowmodelage2alt, type = "HC0"))
AIC(finknowmodelage2alt)
finbehmodelage2alt <- lm(fin_beh ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelage2alt)
coeftest(finbehmodelage2alt, vcov = vcovHC(finbehmodelage2alt, type = "HC0"))
AIC(finbehmodelage2alt)
finattmodelage2alt <- lm(fin_att ~ age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelage2alt)
coeftest(finattmodelage2alt, vcov = vcovHC(finattmodelage2alt, type = "HC0"))
AIC(finattmodelage2alt)

#employed
finlitmodelage2alt <- lm(finlit ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelage2alt)
coeftest(finlitmodelage2alt, vcov = vcovHC(finlitmodelage2alt, type = "HC0"))
AIC(finlitmodelage2alt)
finknowmodelage2alt <- lm(fin_know ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelage2alt)
coeftest(finknowmodelage2alt, vcov = vcovHC(finknowmodelage2alt, type = "HC0"))
AIC(finknowmodelage2alt)
finbehmodelage2alt <- lm(fin_beh ~  age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelage2alt)
coeftest(finbehmodelage2alt, vcov = vcovHC(finbehmodelage2alt, type = "HC0"))
AIC(finbehmodelage2alt)
finattmodelage2alt <- lm(fin_att ~ age + age2 + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelage2alt)
coeftest(finattmodelage2alt, vcov = vcovHC(finattmodelage2alt, type = "HC0"))
AIC(finattmodelage2alt)

##########################alternative age root - full sample###########################################
#full sample
finlitmodelage_groupalt <- lm(finlit ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~employment1_2+ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#self-employed
finlitmodelage_groupalt <- lm(finlit ~rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

#employed
finlitmodelage_groupalt <- lm(finlit ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelage_groupalt)
coeftest(finlitmodelage_groupalt, vcov = vcovHC(finlitmodelage_groupalt, type = "HC0"))
AIC(finlitmodelage_groupalt)
finknowmodelage_groupalt <- lm(fin_know ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelage_groupalt)
coeftest(finknowmodelage_groupalt, vcov = vcovHC(finknowmodelage_groupalt, type = "HC0"))
AIC(finknowmodelage_groupalt)
finbehmodelage_groupalt <- lm(fin_beh ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelage_groupalt)
coeftest(finbehmodelage_groupalt, vcov = vcovHC(finbehmodelage_groupalt, type = "HC0"))
AIC(finbehmodelage_groupalt)
finattmodelage_groupalt <- lm(fin_att ~ rootage+ gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelage_groupalt)
coeftest(finattmodelage_groupalt, vcov = vcovHC(finattmodelage_groupalt, type = "HC0"))
AIC(finattmodelage_groupalt)

##########################alternative education groups (four instead of two groups) - full sample###########################################
#full sample
finlitmodeleducationalt <- lm(finlit ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~employment1_2+ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#self-employed
finlitmodeleducationalt <- lm(finlit ~age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#employed
finlitmodeleducationalt <- lm(finlit ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~ age + gender + educspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

##########################alternative education groups (five (Akademie separately) instead of two groups) - full sample###########################################
#full sample
finlitmodeleducationalt <- lm(finlit ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~employment1_2+ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#self-employed
finlitmodeleducationalt <- lm(finlit ~age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#employed
finlitmodeleducationalt <- lm(finlit ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~ age + gender + educationspecific_1 +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)


##########################alternative education groups (without tertiary educated) - full sample###########################################
#full sample
finlitmodeleducationalt <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiary, weights=ASFL7nontertiary$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#self-employed
finlitmodeleducationalt <- lm(finlit ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiaryse, weights=ASFL7nontertiaryse$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)

#employed
finlitmodeleducationalt <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finlitmodeleducationalt)
coeftest(finlitmodeleducationalt, vcov = vcovHC(finlitmodeleducationalt, type = "HC0"))
AIC(finlitmodeleducationalt)
finknowmodeleducationalt <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finknowmodeleducationalt)
coeftest(finknowmodeleducationalt, vcov = vcovHC(finknowmodeleducationalt, type = "HC0"))
AIC(finknowmodeleducationalt)
finbehmodeleducationalt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finbehmodeleducationalt)
coeftest(finbehmodeleducationalt, vcov = vcovHC(finbehmodeleducationalt, type = "HC0"))
AIC(finbehmodeleducationalt)
finattmodeleducationalt <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7nontertiarye, weights=ASFL7nontertiarye$wght)
summary(finattmodeleducationalt)
coeftest(finattmodeleducationalt, vcov = vcovHC(finattmodeleducationalt, type = "HC0"))
AIC(finattmodeleducationalt)


##########################alternative risk evaluation - full sample###########################################
#HFCSriskd 
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#QS1_2risk
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#HFCSriskgroup
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#QS1_2risk_group_1 # again: no risk as reference category!
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#without HFCSrisk!
#full sample
finlitmodelworiskprop <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelworiskprop)
coeftest(finlitmodelworiskprop, vcov = vcovHC(finlitmodelworiskprop, type = "HC0"))
AIC(finlitmodelworiskprop)
finknowmodelworiskprop <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelworiskprop)
coeftest(finknowmodelworiskprop, vcov = vcovHC(finknowmodelworiskprop, type = "HC0"))
AIC(finknowmodelworiskprop)
finbehmodelworiskprop <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelworiskprop)
coeftest(finbehmodelworiskprop, vcov = vcovHC(finbehmodelworiskprop, type = "HC0"))
AIC(finbehmodelworiskprop)
finattmodelworiskprop <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelworiskprop)
coeftest(finattmodelworiskprop, vcov = vcovHC(finattmodelworiskprop, type = "HC0"))
AIC(finattmodelworiskprop)

#self-employed
finlitmodelworiskpropse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelworiskpropse)
coeftest(finlitmodelworiskpropse, vcov = vcovHC(finlitmodelworiskpropse, type = "HC0"))
AIC(finlitmodelworiskpropse)
finknowmodelworiskpropse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelworiskpropse)
coeftest(finknowmodelworiskpropse, vcov = vcovHC(finknowmodelworiskpropse, type = "HC0"))
AIC(finknowmodelworiskpropse)
finbehmodelworiskpropse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelworiskpropse)
coeftest(finbehmodelworiskpropse, vcov = vcovHC(finbehmodelworiskpropse, type = "HC0"))
AIC(finbehmodelworiskpropse)
finattmodelworiskpropse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelworiskpropse)
coeftest(finattmodelworiskpropse, vcov = vcovHC(finattmodelworiskpropse, type = "HC0"))
AIC(finattmodelworiskpropse)

#employed
finlitmodelworiskprope <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelworiskprope)
coeftest(finlitmodelworiskprope, vcov = vcovHC(finlitmodelworiskprope, type = "HC0"))
AIC(finlitmodelworiskprope)
finknowmodelworiskprope <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelworiskprope)
coeftest(finknowmodelworiskprope, vcov = vcovHC(finknowmodelworiskprope, type = "HC0"))
AIC(finknowmodelworiskprope)
finbehmodelworiskprope <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelworiskprope)
coeftest(finbehmodelworiskprope, vcov = vcovHC(finbehmodelworiskprope, type = "HC0"))
AIC(finbehmodelworiskprope)
finattmodelworiskprope <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelworiskprope)
coeftest(finattmodelworiskprope, vcov = vcovHC(finattmodelworiskprope, type = "HC0"))
AIC(finattmodelworiskprope)

#without riskyassets!
#full sample
finlitmodelwoasset <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelwoasset)
coeftest(finlitmodelwoasset, vcov = vcovHC(finlitmodelwoasset, type = "HC0"))
AIC(finlitmodelwoasset)
finknowmodelwoasset <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelwoasset)
coeftest(finknowmodelwoasset, vcov = vcovHC(finknowmodelwoasset, type = "HC0"))
AIC(finknowmodelwoasset)
finbehmodelwoasset <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelwoasset)
coeftest(finbehmodelwoasset, vcov = vcovHC(finbehmodelwoasset, type = "HC0"))
AIC(finbehmodelwoasset)
finattmodelwoasset <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelwoasset)
coeftest(finattmodelwoasset, vcov = vcovHC(finattmodelwoasset, type = "HC0"))
AIC(finattmodelwoasset)

#self-employed
finlitmodelwoassetse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelwoassetse)
coeftest(finlitmodelwoassetse, vcov = vcovHC(finlitmodelwoassetse, type = "HC0"))
AIC(finlitmodelwoassetse)
finknowmodelwoassetse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelwoassetse)
coeftest(finknowmodelwoassetse, vcov = vcovHC(finknowmodelwoassetse, type = "HC0"))
AIC(finknowmodelwoassetse)
finbehmodelwoassetse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelwoassetse)
coeftest(finbehmodelwoassetse, vcov = vcovHC(finbehmodelwoassetse, type = "HC0"))
AIC(finbehmodelwoassetse)
finattmodelwoassetse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelwoassetse)
coeftest(finattmodelwoassetse, vcov = vcovHC(finattmodelwoassetse, type = "HC0"))
AIC(finattmodelwoassetse)

#employed
finlitmodelwoassete <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelwoassete)
coeftest(finlitmodelwoassete, vcov = vcovHC(finlitmodelwoassete, type = "HC0"))
AIC(finlitmodelwoassete)
finknowmodelwoassete <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelwoassete)
coeftest(finknowmodelwoassete, vcov = vcovHC(finknowmodelwoassete, type = "HC0"))
AIC(finknowmodelwoassete)
finbehmodelwoassete <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelwoassete)
coeftest(finbehmodelwoassete, vcov = vcovHC(finbehmodelwoassete, type = "HC0"))
AIC(finbehmodelwoassete)
finattmodelwoassete <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelwoassete)
coeftest(finattmodelwoassete, vcov = vcovHC(finattmodelwoassete, type = "HC0"))
AIC(finattmodelwoassete)


#risk propensity asset holding interaction 
finlitmodelriskinteract <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskinteract)
coeftest(finlitmodelriskinteract, vcov = vcovHC(finlitmodelriskinteract, type = "HC0"))
AIC(finlitmodelriskinteract)
finknowmodelriskinteract <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskinteract)
coeftest(finknowmodelriskinteract, vcov = vcovHC(finknowmodelriskinteract, type = "HC0"))
AIC(finknowmodelriskinteract)
finbehmodelriskinteract <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskinteract)
coeftest(finbehmodelriskinteract, vcov = vcovHC(finbehmodelriskinteract, type = "HC0"))
AIC(finbehmodelriskinteract)
finattmodelriskinteract <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskinteract)
coeftest(finattmodelriskinteract, vcov = vcovHC(finattmodelriskinteract, type = "HC0"))
AIC(finattmodelriskinteract)

#self-employed
finlitmodelriskinteractse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelriskinteractse)
coeftest(finlitmodelriskinteractse, vcov = vcovHC(finlitmodelriskinteractse, type = "HC0"))
AIC(finlitmodelriskinteractse)
finknowmodelriskinteractse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelriskinteractse)
coeftest(finknowmodelriskinteractse, vcov = vcovHC(finknowmodelriskinteractse, type = "HC0"))
AIC(finknowmodelriskinteractse)
finbehmodelriskinteractse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelriskinteractse)
coeftest(finbehmodelriskinteractse, vcov = vcovHC(finbehmodelriskinteractse, type = "HC0"))
AIC(finbehmodelriskinteractse)
finattmodelriskinteractse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelriskinteractse)
coeftest(finattmodelriskinteractse, vcov = vcovHC(finattmodelriskinteractse, type = "HC0"))
AIC(finattmodelriskinteractse)

#employed
finlitmodelriskinteracte <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelriskinteracte)
coeftest(finlitmodelriskinteracte, vcov = vcovHC(finlitmodelriskinteracte, type = "HC0"))
AIC(finlitmodelriskinteracte)
finknowmodelriskinteracte <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelriskinteracte)
coeftest(finknowmodelriskinteracte, vcov = vcovHC(finknowmodelriskinteracte, type = "HC0"))
AIC(finknowmodelriskinteracte)
finbehmodelriskinteracte <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelriskinteracte)
coeftest(finbehmodelriskinteracte, vcov = vcovHC(finbehmodelriskinteracte, type = "HC0"))
AIC(finbehmodelriskinteracte)
finattmodelriskinteracte <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelriskinteracte)
coeftest(finattmodelriskinteracte, vcov = vcovHC(finattmodelriskinteracte, type = "HC0"))
AIC(finattmodelriskinteracte)

###########################Interaction gender and education###########################
finlitmodelgendereducinteract <- lm(finlit ~employment1_2+ age + gender + gender * higheduc+ higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelgendereducinteract)
coeftest(finlitmodelgendereducinteract, vcov = vcovHC(finlitmodelgendereducinteract, type = "HC0"))
AIC(finlitmodelgendereducinteract)
finknowmodelgendereducinteract <- lm(fin_know ~employment1_2+ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelgendereducinteract)
coeftest(finknowmodelgendereducinteract, vcov = vcovHC(finknowmodelgendereducinteract, type = "HC0"))
AIC(finknowmodelgendereducinteract)
finbehmodelgendereducinteract <- lm(fin_beh ~employment1_2+ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelgendereducinteract)
coeftest(finbehmodelgendereducinteract, vcov = vcovHC(finbehmodelgendereducinteract, type = "HC0"))
AIC(finbehmodelgendereducinteract)
finattmodelgendereducinteract <- lm(fin_att ~employment1_2+ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelgendereducinteract)
coeftest(finattmodelgendereducinteract, vcov = vcovHC(finattmodelgendereducinteract, type = "HC0"))
AIC(finattmodelgendereducinteract)

#self-employed
finlitmodelgendereducinteractse <- lm(finlit ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelgendereducinteractse)
coeftest(finlitmodelgendereducinteractse, vcov = vcovHC(finlitmodelgendereducinteractse, type = "HC0"))
AIC(finlitmodelgendereducinteractse)
finknowmodelgendereducinteractse <- lm(fin_know ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelgendereducinteractse)
coeftest(finknowmodelgendereducinteractse, vcov = vcovHC(finknowmodelgendereducinteractse, type = "HC0"))
AIC(finknowmodelgendereducinteractse)
finbehmodelgendereducinteractse <- lm(fin_beh ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelgendereducinteractse)
coeftest(finbehmodelgendereducinteractse, vcov = vcovHC(finbehmodelgendereducinteractse, type = "HC0"))
AIC(finbehmodelgendereducinteractse)
finattmodelgendereducinteractse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelgendereducinteractse)
coeftest(finattmodelgendereducinteractse, vcov = vcovHC(finattmodelgendereducinteractse, type = "HC0"))
AIC(finattmodelgendereducinteractse)

#employed
finlitmodelgendereducinteracte <- lm(finlit ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelgendereducinteracte)
coeftest(finlitmodelgendereducinteracte, vcov = vcovHC(finlitmodelgendereducinteracte, type = "HC0"))
AIC(finlitmodelgendereducinteracte)
finknowmodelgendereducinteracte <- lm(fin_know ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad +  riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelgendereducinteracte)
coeftest(finknowmodelgendereducinteracte, vcov = vcovHC(finknowmodelgendereducinteracte, type = "HC0"))
AIC(finknowmodelgendereducinteracte)
finbehmodelgendereducinteracte <- lm(fin_beh ~age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad +riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelgendereducinteracte)
coeftest(finbehmodelgendereducinteracte, vcov = vcovHC(finbehmodelgendereducinteracte, type = "HC0"))
AIC(finbehmodelgendereducinteracte)
finattmodelgendereducinteracte <- lm(fin_att ~ age + gender + gender * higheduc + higheduc +incomegroup_1+ HFCSriskad + riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelgendereducinteracte)
coeftest(finattmodelgendereducinteracte, vcov = vcovHC(finattmodelgendereducinteracte, type = "HC0"))
AIC(finattmodelgendereducinteracte)

###########################FULLY INTERACTED MODEL########################### lm(a ~ (b + c + d)^2)
finlitmodelfullinteract <- lm(finlit ~ (employment1_2+ age + gender + higheduc+ incomegroup_1+ HFCSriskad+ riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
#controlvariablesfullinteraction
finlitmodelfullinteract <- lm(finlit ~ employment1_2+ (age + gender + higheduc+ incomegroup_1+ HFCSriskad+ riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
finlitmodelfullinteract <- lm(fin_know ~ employment1_2+ (age + gender + higheduc+ incomegroup_1+ HFCSriskad+ riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
#employmentfullinteractions
finlitmodelfullinteractempl <- lm(finlit ~ employment1_2+ age +age*employment1_2 + gender + employment1_2*gender + higheduc+ employment1_2*higheduc+ incomegroup_1+ employment1_2*incomegroup_1 + HFCSriskad+  employment1_2*HFCSriskad + riskyassetsd + employment1_2*riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteractempl)
coeftest(finlitmodelfullinteractempl, vcov = vcovHC(finlitmodelfullinteractempl, type = "HC0")) #reveals no significant effects!
AIC(finlitmodelfullinteract)


#reasonable full interactions model - !
finlitmodelfullinteract <- lm(finlit ~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)

finknowmodelfullinteract <- lm(fin_know ~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelfullinteract)
coeftest(finknowmodelfullinteract, vcov = vcovHC(finknowmodelfullinteract, type = "HC0"))
AIC(finknowmodelfullinteract)

finbehmodelfullinteract <- lm(fin_beh~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelfullinteract)
coeftest(finbehmodelfullinteract, vcov = vcovHC(finbehmodelfullinteract, type = "HC0"))
AIC(finbehmodelfullinteract)

finattmodelfullinteract <- lm(fin_att~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finattmodelfullinteract)
coeftest(finattmodelfullinteract, vcov = vcovHC(finattmodelfullinteract, type = "HC0"))
AIC(finattmodelfullinteract)


#selfemployed
#reasonable interactions!
finlitmodelfullinteractse <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelfullinteractse)
shapiro.test(finlitmodelfullinteractse$residuals)
coeftest(finlitmodelfullinteractse, vcov = vcovHC(finlitmodelfullinteractse, type = "HC0"))
AIC(finlitmodelfullinteractse)

finknowmodelfullinteractse <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelfullinteractse)
coeftest(finknowmodelfullinteractse, vcov = vcovHC(finknowmodelfullinteractse, type = "HC0"))
AIC(finknowmodelfullinteractse)

finbehmodelfullinteractse <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelfullinteractse)
coeftest(finbehmodelfullinteractse, vcov = vcovHC(finbehmodelfullinteractse, type = "HC0"))
AIC(finbehmodelfullinteractse)

finattmodelfullinteractse <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelfullinteractse)
coeftest(finattmodelfullinteractse, vcov = vcovHC(finattmodelfullinteractse, type = "HC0"))
AIC(finattmodelfullinteractse)

#employed
finlitmodelfullinteracte <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelfullinteracte)
shapiro.test(finlitmodelfullinteracte$residuals)
coeftest(finlitmodelfullinteracte, vcov = vcovHC(finlitmodelfullinteracte, type = "HC0"))
AIC(finlitmodelfullinteracte)

finknowmodelfullinteracte <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelfullinteracte)
coeftest(finknowmodelfullinteracte, vcov = vcovHC(finknowmodelfullinteracte, type = "HC0"))
AIC(finknowmodelfullinteracte)

finbehmodelfullinteracte <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelfullinteracte)
coeftest(finbehmodelfullinteracte, vcov = vcovHC(finbehmodelfullinteracte, type = "HC0"))
AIC(finbehmodelfullinteracte)

finattmodelfullinteracte <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelfullinteracte)
coeftest(finattmodelfullinteracte, vcov = vcovHC(finattmodelfullinteracte, type = "HC0"))
AIC(finattmodelfullinteracte)

####finally interactions model 
###only reasonable full interactions model - !
finlitmodelfullinteract <- lm(finlit ~ employment1_2+incomegroup_1+ age + gender + higheduc +higheduc*age+ HFCSriskad+HFCSriskad*gender+riskyassetsd+riskyassetsd*higheduc+HFCSriskad*riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)
#alternative
finlitmodelfullinteract <- lm(finlit ~ employment1_2+incomegroup_1+ age + gender + higheduc +higheduc*age+ HFCSriskad+HFCSriskad*gender+riskyassetsd+riskyassetsd*higheduc , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfullinteract)
shapiro.test(finlitmodelfullinteract$residuals)
coeftest(finlitmodelfullinteract, vcov = vcovHC(finlitmodelfullinteract, type = "HC0"))
AIC(finlitmodelfullinteract)

finknowmodelfullinteract <- lm(fin_know ~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelfullinteract)
coeftest(finknowmodelfullinteract, vcov = vcovHC(finknowmodelfullinteract, type = "HC0"))
AIC(finknowmodelfullinteract)

finbehmodelfullinteract <- lm(fin_beh~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelfullinteract)
coeftest(finbehmodelfullinteract, vcov = vcovHC(finbehmodelfullinteract, type = "HC0"))
AIC(finbehmodelfullinteract)

finattmodelfullinteract <- lm(fin_att~ employment1_2+incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7, weights=ASFL7$wght)
summary(finattmodelfullinteract)
coeftest(finattmodelfullinteract, vcov = vcovHC(finattmodelfullinteract, type = "HC0"))
AIC(finattmodelfullinteract)


#selfemployed
#reasonable interactions!
finlitmodelfullinteractse <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelfullinteractse)
shapiro.test(finlitmodelfullinteractse$residuals)
coeftest(finlitmodelfullinteractse, vcov = vcovHC(finlitmodelfullinteractse, type = "HC0"))
AIC(finlitmodelfullinteractse)

finknowmodelfullinteractse <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelfullinteractse)
coeftest(finknowmodelfullinteractse, vcov = vcovHC(finknowmodelfullinteractse, type = "HC0"))
AIC(finknowmodelfullinteractse)

finbehmodelfullinteractse <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelfullinteractse)
coeftest(finbehmodelfullinteractse, vcov = vcovHC(finbehmodelfullinteractse, type = "HC0"))
AIC(finbehmodelfullinteractse)

finattmodelfullinteractse <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelfullinteractse)
coeftest(finattmodelfullinteractse, vcov = vcovHC(finattmodelfullinteractse, type = "HC0"))
AIC(finattmodelfullinteractse)

#employed
finlitmodelfullinteracte <- lm(finlit ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelfullinteracte)
shapiro.test(finlitmodelfullinteracte$residuals)
coeftest(finlitmodelfullinteracte, vcov = vcovHC(finlitmodelfullinteracte, type = "HC0"))
AIC(finlitmodelfullinteracte)

finknowmodelfullinteracte <- lm(fin_know ~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelfullinteracte)
coeftest(finknowmodelfullinteracte, vcov = vcovHC(finknowmodelfullinteracte, type = "HC0"))
AIC(finknowmodelfullinteracte)

finbehmodelfullinteracte <- lm(fin_beh~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelfullinteracte)
coeftest(finbehmodelfullinteracte, vcov = vcovHC(finbehmodelfullinteracte, type = "HC0"))
AIC(finbehmodelfullinteracte)

finattmodelfullinteracte <- lm(fin_att~ incomegroup_1+ (age + gender + higheduc+ HFCSriskad+riskyassetsd)^2 , data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelfullinteracte)
coeftest(finattmodelfullinteracte, vcov = vcovHC(finattmodelfullinteracte, type = "HC0"))
AIC(finattmodelfullinteracte)



###########################MULTINOMIAL logit model###########################
multi_finlitempl <- multinom(finlit_group ~ employment1_2 , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
#specify Hess = TRUE to save something called the Hessian matrix which helps with the calculation of standard errors, and set trace = FALSE to suppress the printing of convergence progress.
summary(multi_finlitempl)
exp(coef(multi_finlitempl))
se <- summary(multi_finlitempl)$coefficients/summary(multi_finlitempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlitempl, type="text", out="multi_finlitempl.htm",star.cutoffs = c(.05, .01, .001)) # type="html"otherwise!
PseudoR2(multi_finlitempl, which = c("McFadden"))


multi_finlit <- multinom(finlit_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit)
se <- summary(multi_finlit)$coefficients/summary(multi_finlit)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlit, type="text", out="multi_finlit.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finlit, which = c("McFadden"))

multi_finknow <- multinom(fin_know_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finknow)
stargazer(multi_finknow, type="text", out="multi_finknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finknow, which = c("McFadden"))

multi_finbeh <- multinom(fin_beh_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finbeh)
stargazer(multi_finbeh, type="text", out="multi_finknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finbeh, which = c("McFadden"))

multi_finatt <- multinom(fin_att_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finatt)
stargazer(multi_finatt, type="text", out="multi_finatt.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_finatt, which = c("McFadden"))

#####full reverse causality model 
multi_fullreverse <- multinom(employment1_1 ~ finlit + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreverse)
se <- summary(multi_fullreverse)$coefficients/summary(multi_fullreverse)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_fullreverse, type="text", out="multi_finlit.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreverse, which = c("McFadden"))

#individual components reverse causality
multi_fullreverseknow <- multinom(employment1_1 ~ fin_know + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreverseknow)
stargazer(multi_fullreverseknow, type="text", out="multi_fullreverseknow.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreverseknow, which = c("McFadden"))

multi_fullreversebeh <- multinom(employment1_1 ~ fin_beh + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreversebeh)
stargazer(multi_fullreversebeh, type="text", out="multi_fullreversebeh.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreversebeh, which = c("McFadden"))

multi_fullreverseatt <- multinom(employment1_1 ~ fin_att + age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_fullreverseatt)
stargazer(multi_fullreverseatt, type="text", out="multi_fullreverseatt.htm",star.cutoffs = c(.05, .01, .001)) 
PseudoR2(multi_fullreverseatt, which = c("McFadden"))


multi_finlit_se <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7se, weights=ASFL7se$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_se)
stargazer(multi_finlit_se, type="text", out="multi_finlit_se.htm",star.cutoffs = c(.05, .01, .001))

multi_finlit_e <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7e, weights=ASFL7e$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_e)
stargazer(multi_finlit_e, type="text", out="multi_finlit_e",star.cutoffs = c(.05, .01, .001))
PseudoR2(multi_finlit_e, which = c("McFadden"))


###########################FULL MODEL OTHER INDICATORS###########################
####financial wellbeing
finwellbeingmodel <- lm(finwellbeing ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finwellbeingmodel)
coeftest(finwellbeingmodel, vcov = vcovHC(finwellbeingmodel, type = "HC0"))
AIC(finwellbeingmodel)
finwellbeingmodel_se <- lm(finwellbeing ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finwellbeingmodel_se)
coeftest(finwellbeingmodel_se, vcov = vcovHC(finwellbeingmodel_se, type = "HC0"))
AIC(finwellbeingmodel_se)
finwellbeingmodel_e <- lm(finwellbeing ~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finwellbeingmodel_e)
coeftest(finwellbeingmodel_e, vcov = vcovHC(finwellbeingmodel_e, type = "HC0"))
AIC(finwellbeingmodel_e)

####product awareness
produsemodel <- lm(produse~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(produsemodel)
coeftest(produsemodel, vcov = vcovHC(produsemodel, type = "HC0"))
AIC(produsemodel)
produsemodel_se <- lm(produse~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(produsemodel_se)
coeftest(produsemodel_se, vcov = vcovHC(produsemodel_se, type = "HC0"))
AIC(produsemodel_se)
produsemodel_e <- lm(produse~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(produsemodel_e)
coeftest(produsemodel_e, vcov = vcovHC(produsemodel_e, type = "HC0"))
AIC(produsemodel_e)

####numeric selfassessment
####self-assessed financial literady
selfassessmodel <- lm(numericsaknow~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(selfassessmodel)
coeftest(selfassessmodel, vcov = vcovHC(selfassessmodel, type = "HC0"))
AIC(selfassessmodel)
#alternative
selfassessmodel_2 <- lm(numericsaknow_2~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(selfassessmodel_2)
coeftest(selfassessmodel_2, vcov = vcovHC(selfassessmodel_2, type = "HC0"))
AIC(selfassessmodel_2)

selfassessmodel_se <- lm(numericsaknow~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(selfassessmodel_se)
coeftest(selfassessmodel_se, vcov = vcovHC(selfassessmodel_se, type = "HC0"))
AIC(selfassessmodel_se)
selfassessmodel_e <- lm(numericsaknow~age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(selfassessmodel_e)
coeftest(selfassessmodel_e, vcov = vcovHC(selfassessmodel_e, type = "HC0"))
AIC(selfassessmodel_e)
