###########################EMPLOYMENT REGRESSION###########################
ASFL7empl <- ASFL7[(ASFL7$QD10 %in% empl),] 

finlitempl <- lm(finlit ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl)
coeftest(finlitempl, vcov = vcovHC(finlitempl, type = "HC0"))
AIC(finlitempl)
finlitempl2 <- lm(finlit ~ employment2_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl2)
coeftest(finlitempl2, vcov = vcovHC(finlitempl2, type = "HC0"))
AIC(finlitempl2)
finlitempl2_robustness <- lm(finlit ~ employment1_1, data=ASFL7empl, weights=ASFL7empl$wght)#robustness with predefined set
summary(finlitempl2_robustness)
coeftest(finlitempl2_robustness, vcov = vcovHC(finlitempl2_robustness, type = "HC0"))
AIC(finlitempl2_robustness)
finlitempl3 <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght) #excluding others-> smaller sample size
summary(finlitempl3)
coeftest(finlitempl3, vcov = vcovHC(finlitempl3, type = "HC0"))
AIC(finlitempl3)

##residual checking
plot(finlitempl$residuals, main="Residual plot")
abline(h=0, col="red")
bptest(finlitempl)#heterogeneity issues
qqnorm(finlitempl$residuals, main="QQ-Residual plot") 
qqline(finlitempl$residuals, col="red") 
shapiro.test(finlitempl$residuals) #not normally distributed

finlitempl_full <- lm(finlit ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_full)
coeftest(finlitempl_full, vcov = vcovHC(finlitempl_full, type = "HC0"))
AIC(finlitempl_full)
finlitempl_fullalt <- lm(finlit ~ QD10, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_fullalt)
coeftest(finlitempl_fullalt, vcov = vcovHC(finlitempl_fullalt, type = "HC0"))
AIC(finlitempl_fullalt)
finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitse <- lm(finlit ~ selfemployedd, data=ASFL7, weights=ASFL7$wght)
summary(finlitse)
coeftest(finlitse, vcov = vcovHC(finlitse, type = "HC0"))
AIC(finlitse)
finlite <- lm(finlit ~ employedd, data=ASFL7, weights=ASFL7$wght)
summary(finlite)
coeftest(finlite, vcov = vcovHC(finlite, type = "HC0"))
AIC(finlite)
finlitoth <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght)
summary(finlitoth)
coeftest(finlitoth, vcov = vcovHC(finlitoth, type = "HC0"))
AIC(finlitoth)

#######for individual indicators
fin_knowempl <- lm(fin_know ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_knowempl)
coeftest(fin_knowempl, vcov = vcovHC(fin_knowempl, type = "HC0"))
AIC(fin_knowempl)

fin_behempl <- lm(fin_beh ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_behempl)
coeftest(fin_behempl, vcov = vcovHC(fin_behempl, type = "HC0"))
AIC(fin_behempl)

fin_attempl <- lm(fin_att ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_attempl)
coeftest(fin_attempl, vcov = vcovHC(fin_attempl, type = "HC0"))
AIC(fin_attempl)


###########################FINANCIAL RISK EVALUATION###########################
#financial literacy risk propensity HFCSriskad
#full sample
finlitrisk <- lm(finlit ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSriskad,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative1 HFCSriskd
#full sample
finlitrisk <- lm(finlit ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSriskd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative2 numericHFCSrisk
#full sample
finlitrisk <- lm(finlit ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSriskd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))


#alternative3 HFCSriskgroup_1
#full sample
finlitrisk <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSrisk_group_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 

#self-employed
finlitriskse <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative4 numericHFCSrisk
#full sample
finlitrisk <- lm(finlit ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  numericHFCSrisk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 

#self-employed
finlitriskse <- lm(finlit ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative4 QS1_2risk
#full sample
finlitrisk <- lm(finlit ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  QS1_2risk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 

#self-employed
finlitriskse <- lm(finlit ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))


#higher risk for older?
riskage <- glm(HFCSriskad ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskage)
coeftest(riskage, vcov = vcovHC(riskage, type = "HC0"))
exp(coef(riskage))
riskagese <- glm(HFCSriskad ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskagese)
coeftest(riskagese, vcov = vcovHC(riskagese, type = "HC0"))
exp(coef(riskagese))
riskagee <- glm(HFCSriskad ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskagee)
coeftest(riskagee, vcov = vcovHC(riskagee, type = "HC0"))
exp(coef(riskagee))

#higher risk for higher educated?
riskhigheduc <- glm(HFCSriskad ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskhigheduc)
coeftest(riskhigheduc, vcov = vcovHC(riskhigheduc, type = "HC0"))
exp(coef(riskhigheduc))
riskhigheducse <- glm(HFCSriskad ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskhigheducse)
coeftest(riskhigheducse, vcov = vcovHC(riskhigheducse, type = "HC0"))
exp(coef(riskhigheducse))
riskhigheduce <- glm(HFCSriskad ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskhigheduce)
coeftest(riskhigheduce, vcov = vcovHC(riskhigheduce, type = "HC0"))
exp(coef(riskhigheduce))


#higher risk for males?
riskgender <- glm(HFCSriskad ~ maled, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
exp(coef(riskgender))
riskgenderse <- glm(HFCSriskad ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
exp(coef(riskgenderse))
riskgendere <- glm(HFCSriskad ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))
exp(coef(riskgendere))

riskgender <- glm(numericHFCSrisk ~ maled, data=ASFL7 , weights=ASFL7$wght)
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
riskgenderse <- glm(numericHFCSrisk ~ maled, data=ASFL7se , weights=ASFL7se$wght)
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
riskgendere <- glm(numericHFCSrisk ~ maled, data=ASFL7e , weights=ASFL7e$wght)
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))




finlitriskpropensitygender <- glm(finlit ~ maled, data=ASFL7risk, weights=ASFL7risk$wght)
summary(finlitriskpropensitygender)  
coeftest(finlitriskpropensitygender, vcov = vcovHC(finlitriskpropensitygender, type = "HC0"))
finlitriskpropensitygender2 <- glm(finlit ~ maled, data=ASFL7nrisk, weights=ASFL7nrisk$wght)
summary(finlitriskpropensitygender2)  
coeftest(finlitriskpropensitygender2, vcov = vcovHC(finlitriskpropensitygender2, type = "HC0"))





###########################MODEL EVALUATION###########################
#always exclude one group - otherwise: perfect collinearity! (zB:maled + femaled = 1)-> error would not occur for variables with missings but exclude one! 
finlitmodelfull <- lm(finlit ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 + childd + singled +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfull)
shapiro.test(finlitmodelfull$residuals)
coeftest(finlitmodelfull, vcov = vcovHC(finlitmodelfull, type = "HC0"))
AIC(finlitmodelfull)
#model testing
#wald.test(Sigma = vcov(model), b = coef(model), Terms = 3:4)-p> .05, we fail to reject the null hypothesis of the Wald test.=> tested regression coefficients are both equal to zero.-> exclude from analysis
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 4)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 5)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 6)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7:8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 9)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 10)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11:13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 12)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 14) #riskpropensity


finlitmodel2 <- glm(finlit ~ employment1_2+ age + gender + higheduc + childd + singled +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel2)
coeftest(finlitmodel2, vcov = vcovHC(finlitmodel2, type = "HC0"))
AIC(finlitmodel2)
finlitmodel <- glm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel)
coeftest(finlitmodel, vcov = vcovHC(finlitmodel, type = "HC0"))
AIC(finlitmodel)
############model comparison
modelcomp <- list(finlitmodelfull, finlitmodel2, finlitmodel)
model.names <- c("1", "2", "3")
modelcomp <- aictab(modelcomp, modnames = model.names)
modelcomp
xtable(modelcomp, type = "latex", file = "modelcomp", digits=3)

finlitmodel4 <- lm(finlit ~employment1_2+ age  + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel4)
coeftest(finlitmodel4, vcov = vcovHC(finlitmodel4, type = "HC0"))
AIC(finlitmodel4)

modelcomp2 <- list(finlitmodelfull, finlitmodel2, finlitmodel,finlitmodel4)
model.names2 <- c("1", "2", "3", "4")
modelcomp2 <-aictab(modelcomp2, modnames = model.names2)
xtable(modelcomp2, type = "latex", file = "modelcomp2", digits=3)

####for individual components
finknowmodel <- glm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- glm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- glm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

####comparison self-employed and employed 
finlitmodel_woempl <- glm(finlit ~+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel_woempl)
coeftest(finlitmodel_woempl, vcov = vcovHC(finlitmodel_woempl, type = "HC0"))
AIC(finlitmodel_woempl)

finlitmodel_se <- glm(finlit ~+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodel_se)
coeftest(finlitmodel_se, vcov = vcovHC(finlitmodel_se, type = "HC0"))
AIC(finlitmodel_se)
finlitmodel_e <- glm(finlit ~+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodel_e)
coeftest(finlitmodel_e, vcov = vcovHC(finlitmodel_e, type = "HC0"))
AIC(finlitmodel_e)

####interaction check
finlitmodelinteractgenrisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk)
coeftest(finlitmodelinteractgenrisk, vcov = vcovHC(finlitmodelinteractgenrisk, type = "HC0"))
AIC(finlitmodelinteractgenrisk)
finlitmodelinteractgenrisk2 <- glm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk2)
coeftest(finlitmodelinteractgenrisk2, vcov = vcovHC(finlitmodelinteractgenrisk2, type = "HC0"))
AIC(finlitmodelinteractgenrisk2)

finlitmodelinteractagerisk <- glm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*age+riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractagerisk)
coeftest(finlitmodelinteractagerisk, vcov = vcovHC(finlitmodelinteractagerisk, type = "HC0"))
AIC(finlitmodelinteractagerisk)




###########################SUBGROUP DIFFERENCES###########################
###########################Age###########################
emplage <- lm(age ~ employment1_2,  data=ASFL7, weights=ASFL7$wght)
summary(emplage)
coeftest(emplage, vcov = vcovHC(emplage, type = "HC0"))
AIC(emplage)

multi_emplage <- multinom(employment1_1 ~ age , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage)
exp(coef(multi_emplage))
se <- summary(multi_emplage)$coefficients/summary(multi_emplage)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplage, type="text", out="multi_emplage.htm") 

#full sample
finlitage <- lm(finlit ~ age,data=ASFL7, weights=ASFL7$wght) 
summary(finlitage)  
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
finknowage <- lm(fin_know ~ age,data=ASFL7, weights=ASFL7$wght) 
summary(finknowage)  
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finbehage <- lm(fin_beh ~ age,data=ASFL7, weights=ASFL7$wght)
summary(finbehage)  
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finattage <- lm(fin_att ~ age,data=ASFL7, weights=ASFL7$wght) 
summary(finattage)  
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)

selfemployedage <- glm(selfemployedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedage)  
coeftest(selfemployedage, vcov = vcovHC(selfemployedage, type = "HC0"))
(adjR2(selfemployedage))
employedage <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedage)  
coeftest(employedage, vcov = vcovHC(employedage, type = "HC0"))
multi_emplage <- multinom(employment1_1 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage)
se <- summary(multi_emplage)$coefficients/summary(multi_emplage)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplage, type="text", out="multi_emplage.htm") 

#self-employed
finlitagese <- lm(finlit ~ age,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitagese)  
coeftest(finlitagese, vcov = vcovHC(finlitagese, type = "HC0"))
finknowagese <- lm(fin_know ~ age,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowagese)  
coeftest(finknowagese, vcov = vcovHC(finknowagese, type = "HC0"))
finbehagese <- lm(fin_beh ~ age,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehagese)  
coeftest(finbehagese, vcov = vcovHC(finbehagese, type = "HC0"))
finattagese <- lm(fin_att ~ age,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattagese)  
coeftest(finattagese, vcov = vcovHC(finattagese, type = "HC0"))

#employed
finlitagee <- lm(finlit ~ age,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitagee, vcov = vcovHC(finlitagee, type = "HC0"))
finknowagee <- lm(fin_know ~ age,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowagee)  
coeftest(finknowagee, vcov = vcovHC(finknowagee, type = "HC0"))
finbehagee <- lm(fin_beh ~ age,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehagee)  
coeftest(finbehagee, vcov = vcovHC(finbehagee, type = "HC0"))
finattagee <- lm(fin_att ~ age,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattagee)  
coeftest(finattagee, vcov = vcovHC(finattagee, type = "HC0"))


###########################Education###########################
empleduc <- glm(highigheduc ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(empleduc)
coeftest(empleduc, vcov = vcovHC(empleduc, type = "HC0"))
exp(coef(empleduc))


multi_empleduc <- multinom(employment1_1 ~ highigheduc , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_empleduc)
exp(coef(multi_empleduc))
se <- summary(multi_empleduc)$coefficients/summary(multi_empleduc)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_empleduc, type="text", out="multi_empleduc.htm") 


#full sample
finlithigheduc <- lm(finlit ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finlithigheduc)  
coeftest(finlithigheduc, vcov = vcovHC(finlithigheduc, type = "HC0"))
AIC(finlithigheduc)
finknowhigheduc <- lm(fin_know ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finknowhigheduc)  
coeftest(finknowhigheduc, vcov = vcovHC(finknowhigheduc, type = "HC0"))
AIC(finknowhigheduc)
finbehhigheduc <- lm(fin_beh ~ higheduc,data=ASFL7, weights=ASFL7$wght)
summary(finbehhigheduc)  
coeftest(finbehhigheduc, vcov = vcovHC(finbehhigheduc, type = "HC0"))
AIC(finbehhigheduc)
finatthigheduc <- lm(fin_att ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finatthigheduc)  
coeftest(finatthigheduc, vcov = vcovHC(finatthigheduc, type = "HC0"))
AIC(finatthigheduc)

selfemployedhigheduc <- glm(selfemployedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedhigheduc)  
coeftest(selfemployedhigheduc, vcov = vcovHC(selfemployedhigheduc, type = "HC0"))
(adjR2(selfemployedhigheduc))
employedhigheduc <- glm(employedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedhigheduc)  
coeftest(employedhigheduc, vcov = vcovHC(employedhigheduc, type = "HC0"))
multi_emplhigheduc <- multinom(employment1_1 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplhigheduc)
se <- summary(multi_emplhigheduc)$coefficients/summary(multi_emplhigheduc)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplhigheduc, type="text", out="multi_emplhigheduc.htm") 

#self-employed
finlithigheducse <- lm(finlit ~ higheduc,data=ASFL7se, weights=ASFL7se$wght)
summary(finlithigheducse)  
coeftest(finlithigheducse, vcov = vcovHC(finlithigheducse, type = "HC0"))
finknowhigheducse <- lm(fin_know ~ higheduc,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowhigheducse)  
coeftest(finknowhigheducse, vcov = vcovHC(finknowhigheducse, type = "HC0"))
finbehhigheducse <- lm(fin_beh ~ higheduc,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehhigheducse)  
coeftest(finbehhigheducse, vcov = vcovHC(finbehhigheducse, type = "HC0"))
finatthigheducse <- lm(fin_att ~ higheduc,data=ASFL7se, weights=ASFL7se$wght) 
summary(finatthigheducse)  
coeftest(finatthigheducse, vcov = vcovHC(finatthigheducse, type = "HC0"))

#employed
finlithigheduce <- lm(finlit ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlithigheduce, vcov = vcovHC(finlithigheduce, type = "HC0"))
finknowhigheduce <- lm(fin_know ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowhigheduce)  
coeftest(finknowhigheduce, vcov = vcovHC(finknowhigheduce, type = "HC0"))
finbehhigheduce <- lm(fin_beh ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehhigheduce)  
coeftest(finbehhigheduce, vcov = vcovHC(finbehhigheduce, type = "HC0"))
finatthigheduce <- lm(fin_att ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finatthigheduce)  
coeftest(finatthigheduce, vcov = vcovHC(finatthigheduce, type = "HC0"))
AIC(finlithigheduce,finknowhigheduce,finbehhigheduce,finatthigheduce)

###########################Gender###########################
emplgender <- glm(maled ~ employment2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(emplgender) #im Vergleich zu employed mehr MÃ¤nner
coeftest(emplgender, vcov = vcovHC(emplgender, type = "HC0"))
exp(coef(emplgender))

multi_emplgender <- multinom(employment1_1 ~ gender , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplgender)
exp(coef(multi_emplgender))
se <- summary(multi_emplgender)$coefficients/summary(multi_emplgender)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplgender, type="text", out="multi_emplgender.htm") 


#full sample
finlitgender <- lm(finlit ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finlitgender)  
coeftest(finlitgender, vcov = vcovHC(finlitgender, type = "HC0"))
AIC(finlitgender)
finknowgender <- lm(fin_know ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finknowgender)  
coeftest(finknowgender, vcov = vcovHC(finknowgender, type = "HC0"))
AIC(finknowgender)
finbehgender <- lm(fin_beh ~ gender,data=ASFL7, weights=ASFL7$wght)
summary(finbehgender)  
coeftest(finbehgender, vcov = vcovHC(finbehgender, type = "HC0"))
AIC(finbehgender)
finattgender <- lm(fin_att ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finattgender)  
coeftest(finattgender, vcov = vcovHC(finattgender, type = "HC0"))
AIC(finattgender)

selfemployedgender <- glm(selfemployedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedgender)  
coeftest(selfemployedgender, vcov = vcovHC(selfemployedgender, type = "HC0"))
(adjR2(selfemployedgender))
employedgender <- glm(employedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedgender)  
coeftest(employedgender, vcov = vcovHC(employedgender, type = "HC0"))
multi_emplgender <- multinom(employment1_1 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplgender)
se <- summary(multi_emplgender)$coefficients/summary(multi_emplgender)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplgender, type="text", out="multi_emplgender.htm") 

#self-employed
finlitgenderse <- lm(finlit ~ gender,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitgenderse)  
coeftest(finlitgenderse, vcov = vcovHC(finlitgenderse, type = "HC0"))
finknowgenderse <- lm(fin_know ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowgenderse)  
coeftest(finknowgenderse, vcov = vcovHC(finknowgenderse, type = "HC0"))
finbehgenderse <- lm(fin_beh ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehgenderse)  
coeftest(finbehgenderse, vcov = vcovHC(finbehgenderse, type = "HC0"))
finattgenderse <- lm(fin_att ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattgenderse)  
coeftest(finattgenderse, vcov = vcovHC(finattgenderse, type = "HC0"))

#employed
finlitgendere <- lm(finlit ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitgendere, vcov = vcovHC(finlitgendere, type = "HC0"))
finknowgendere <- lm(fin_know ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowgendere)  
coeftest(finknowgendere, vcov = vcovHC(finknowgendere, type = "HC0"))
finbehgendere <- lm(fin_beh ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehgendere)  
coeftest(finbehgendere, vcov = vcovHC(finbehgendere, type = "HC0"))
finattgendere <- lm(fin_att ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattgendere)  
coeftest(finattgendere, vcov = vcovHC(finattgendere, type = "HC0"))
AIC(finlitgendere,finknowgendere,finbehgendere,finattgendere)

##########################EXTENSIONS###########################################
##########################alternative detailed/categorical HFCSvariable - full sample###########################################
finlitmodelriskgroup <- glm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- glm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- glm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- glm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)


###########################MULTINOMIAL logit model###########################
multi_finlitempl <- multinom(finlit_group ~ employment1_2 , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
#specify Hess = TRUE to save something called the Hessian matrix which helps with the calculation of standard errors, and set trace = FALSE to suppress the printing of convergence progress.
summary(multi_finlitempl)
se <- summary(multi_finlitempl)$coefficients/summary(multi_finlitempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlitempl, type="text", out="multi_finlitempl.htm") # type="html"otherwise!


multi_finlit <- multinom(finlit_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit)
se <- summary(multi_finlit)$coefficients/summary(multi_finlit)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlit, type="text", out="multi_finlit.htm") 

multi_finlit_se <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7se, weights=ASFL7se$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_se)
stargazer(multi_finlit_se, type="text", out="multi_finlit_se.htm")

multi_finlit_e <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7e, weights=ASFL7e$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_e)
stargazer(multi_finlit_e, type="text", out="multi_finlit_e")


