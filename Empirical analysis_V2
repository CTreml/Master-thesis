###########################EMPLOYMENT REGRESSION###########################
ASFL7empl <- ASFL7[(ASFL7$QD10 %in% empl),] 

finlitempl <- lm(finlit ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl)
coeftest(finlitempl, vcov = vcovHC(finlitempl, type = "HC0"))
coeftest(finlitempl, vcov. = vcovHC) #alternative - also provides robust standard errors
AIC(finlitempl)
finlitempl2 <- lm(finlit ~ employment2_2, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl2)
coeftest(finlitempl2, vcov = vcovHC(finlitempl2, type = "HC0"))
AIC(finlitempl2)
finlitempl2_robustness <- lm(finlit ~ employment1_1, data=ASFL7empl, weights=ASFL7empl$wght)#robustness with predefined set
summary(finlitempl2_robustness)
coeftest(finlitempl2_robustness, vcov = vcovHC(finlitempl2_robustness, type = "HC0"))
AIC(finlitempl2_robustness)
finlitempl3 <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght) #excluding others-> smaller sample size
summary(finlitempl3)
coeftest(finlitempl3, vcov = vcovHC(finlitempl3, type = "HC0"))
AIC(finlitempl3)

##residual checking
plot(finlitempl$residuals, main="Residual plot")
abline(h=0, col="red")
bptest(finlitempl)#heterogeneity issues
qqnorm(finlitempl$residuals, main="QQ-Residual plot") 
qqline(finlitempl$residuals, col="red") 
shapiro.test(finlitempl$residuals) #not normally distributed

finlitempl_full <- lm(finlit ~ employmentfull_full, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_full)
coeftest(finlitempl_full, vcov = vcovHC(finlitempl_full, type = "HC0"))
AIC(finlitempl_full)
finlitempl_fullalt <- lm(finlit ~ QD10, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_fullalt)
coeftest(finlitempl_fullalt, vcov = vcovHC(finlitempl_fullalt, type = "HC0"))
AIC(finlitempl_fullalt)
finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitempl_special <- lm(finlit ~ employmentalt_alt, data=ASFL7, weights=ASFL7$wght)
summary(finlitempl_special)
coeftest(finlitempl_special, vcov = vcovHC(finlitempl_special, type = "HC0"))
AIC(finlitempl_special)

finlitse <- lm(finlit ~ selfemployedd, data=ASFL7, weights=ASFL7$wght)
summary(finlitse)
coeftest(finlitse, vcov = vcovHC(finlitse, type = "HC0"))
AIC(finlitse)
finlite <- lm(finlit ~ employedd, data=ASFL7, weights=ASFL7$wght)
summary(finlite)
coeftest(finlite, vcov = vcovHC(finlite, type = "HC0"))
AIC(finlite)
finlitoth <- lm(finlit ~ employment1_1, data=ASFL7, weights=ASFL7$wght)
summary(finlitoth)
coeftest(finlitoth, vcov = vcovHC(finlitoth, type = "HC0"))
AIC(finlitoth)

#######for individual indicators
fin_knowempl <- lm(fin_know ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_knowempl)
coeftest(fin_knowempl, vcov = vcovHC(fin_knowempl, type = "HC0"))
AIC(fin_knowempl)

fin_behempl <- lm(fin_beh ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_behempl)
coeftest(fin_behempl, vcov = vcovHC(fin_behempl, type = "HC0"))
AIC(fin_behempl)

fin_attempl <- lm(fin_att ~ employment1_2, data=ASFL7, weights=ASFL7$wght)
summary(fin_attempl)
coeftest(fin_attempl, vcov = vcovHC(fin_attempl, type = "HC0"))
AIC(fin_attempl)

###########################Reverse causality###########################
revselfempl <- lm(selfemployedd ~ finlit,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(revselfempl)  
exp(coef(revselfempl))
coeftest(revselfempl, vcov = vcovHC(revselfempl, type = "HC0"))
(adjR2(revselfempl))
revselfempl <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(revselfempl)  
coeftest(revselfempl, vcov = vcovHC(revselfempl, type = "HC0"))
(adjR2(revselfempl))

multi_revempl <- multinom(employment1_1 ~  finlit,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_revempl)
exp(coef(multi_revempl))
se <- summary(multi_revempl)$coefficients/summary(multi_revempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_revempl, type="text", out="multi_revempl.htm") 
PseudoR2(multi_revempl, which = c("McFadden"))#PseudoR2(multi_mo, which = c("CoxSnell","Nagelkerke","McFadden"))

###########################FINANCIAL RISK EVALUATION###########################
#financial literacy risk propensity HFCSriskad
#full sample
finlitrisk <- lm(finlit ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskad,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSriskad,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSriskad,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSriskad,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)
#alternative1 HFCSriskd
#full sample
finlitrisk <- lm(finlit ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSriskd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))

multi_emplriskalt1 <- multinom(employment1_1 ~  HFCSriskd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplriskalt1)
se <- summary(multi_emplriskalt1)$coefficients/summary(multi_emplriskalt1)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplriskalt1, type="text", out="multi_emplriskalt1.htm") 
PseudoR2(multi_emplriskalt1, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSriskd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSriskd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)

#alternative2 QS1_2risk
#full sample
finlitrisk <- lm(finlit ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ QS1_2risk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  QS1_2risk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ QS1_2risk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ QS1_2risk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)

#alternative3 numericHFCSrisk
#full sample
finlitrisk <- lm(finlit ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ numericHFCSrisk,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))

multi_emplrisk <- multinom(employment1_1 ~  numericHFCSrisk,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~ numericHFCSrisk,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~ numericHFCSrisk,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative numericQSrisk
#full sample
finlitrisk <- lm(finlit ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~numericQS1_2,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~numericQS1_2,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~numericQS1_2,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~numericQS1_2,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~ numericQS1_2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att ~numericQS1_2,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att ~numericQS1_2,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#alternative4 HFCSriskgroup_1
#full sample
finlitrisk <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd ~ HFCSrisk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~  HFCSrisk_group_1,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
AIC(finlitriskse)
finknowriskse <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
AIC(finknowriskse)
finbehriskse <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
AIC(finbehriskse)
finattriskse <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))
AIC(finattriskse)

#employed
finlitriske <- lm(finlit ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriske)
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
AIC(finlitriske)
finknowriske <- lm(fin_know ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
AIC(finknowriske)
finbehriske <- lm(fin_beh ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
AIC(finbehriske)
finattriske <- lm(fin_att ~ HFCSrisk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))
AIC(finattriske)


#alternative QS1_2risk_group
#full sample
finlitrisk <- lm(finlit ~QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finlitrisk)  
coeftest(finlitrisk, vcov = vcovHC(finlitrisk, type = "HC0"))
AIC(finlitrisk)
finknowrisk <- lm(fin_know QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finknowrisk)  
coeftest(finknowrisk, vcov = vcovHC(finknowrisk, type = "HC0"))
AIC(finknowrisk)
finbehrisk <- lm(fin_beh QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght)
summary(finbehrisk)  
coeftest(finbehrisk, vcov = vcovHC(finbehrisk, type = "HC0"))
AIC(finbehrisk)
finattrisk <- lm(fin_att QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght) 
summary(finattrisk)  
coeftest(finattrisk, vcov = vcovHC(finattrisk, type = "HC0"))
AIC(finattrisk)

selfemployedrisk <- glm(selfemployedd QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedrisk)  
coeftest(selfemployedrisk, vcov = vcovHC(selfemployedrisk, type = "HC0"))
(adjR2(selfemployedrisk))
employedrisk <- glm(employedd QS1_2risk_group_1,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedrisk)  
coeftest(employedrisk, vcov = vcovHC(employedrisk, type = "HC0"))
multi_emplrisk <- multinom(employment1_1 ~ QS1_2risk_group,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplrisk)
se <- summary(multi_emplrisk)$coefficients/summary(multi_emplrisk)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplrisk, type="text", out="multi_emplrisk.htm") 
PseudoR2(multi_emplrisk, which = c("McFadden"))

#self-employed
finlitriskse <- lm(finlit QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskse)  
coeftest(finlitriskse, vcov = vcovHC(finlitriskse, type = "HC0"))
finknowriskse <- lm(fin_know QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskse)  
coeftest(finknowriskse, vcov = vcovHC(finknowriskse, type = "HC0"))
finbehriskse <- lm(fin_beh QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskse)  
coeftest(finbehriskse, vcov = vcovHC(finbehriskse, type = "HC0"))
finattriskse <- lm(fin_att QS1_2risk_group_1,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskse)  
coeftest(finattriskse, vcov = vcovHC(finattriskse, type = "HC0"))

#employed
finlitriske <- lm(finlit QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
coeftest(finlitriske, vcov = vcovHC(finlitriske, type = "HC0"))
finknowriske <- lm(fin_know QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriske)  
coeftest(finknowriske, vcov = vcovHC(finknowriske, type = "HC0"))
finbehriske <- lm(fin_beh QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriske)  
coeftest(finbehriske, vcov = vcovHC(finbehriske, type = "HC0"))
finattriske <- lm(fin_att QS1_2risk_group_1,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriske)  
coeftest(finattriske, vcov = vcovHC(finattriske, type = "HC0"))

#rboustness: riskyassets 
#full sample
finlitriskyassets <- lm(finlit ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finlitriskyassets)  
coeftest(finlitriskyassets, vcov = vcovHC(finlitriskyassets, type = "HC0"))
AIC(finlitriskyassets)
finknowriskyassets <- lm(fin_know ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finknowriskyassets)  
coeftest(finknowriskyassets, vcov = vcovHC(finknowriskyassets, type = "HC0"))
AIC(finknowriskyassets)
finbehriskyassets <- lm(fin_beh ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght)
summary(finbehriskyassets)  
coeftest(finbehriskyassets, vcov = vcovHC(finbehriskyassets, type = "HC0"))
AIC(finbehriskyassets)
finattriskyassets <- lm(fin_att ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght) 
summary(finattriskyassets)  
coeftest(finattriskyassets, vcov = vcovHC(finattriskyassets, type = "HC0"))
AIC(finattriskyassets)

selfemployedriskyassets <- glm(selfemployedd ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedriskyassets)  
coeftest(selfemployedriskyassets, vcov = vcovHC(selfemployedriskyassets, type = "HC0"))
(adjR2(selfemployedriskyassets))
employedriskyassets <- glm(employedd ~ riskyassetsd,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedriskyassets)  
coeftest(employedriskyassets, vcov = vcovHC(employedriskyassets, type = "HC0"))

multi_emplriskyassets <- multinom(employment1_1 ~  riskyassetsd,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplriskyassets)
se <- summary(multi_emplriskyassets)$coefficients/summary(multi_emplriskyassets)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplriskyassets, type="text", out="multi_emplriskyassets.htm") 
PseudoR2(multi_emplriskyassets, which = c("McFadden"))

#self-employed
finlitriskyassetsse <- lm(finlit ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitriskyassetsse)  
coeftest(finlitriskyassetsse, vcov = vcovHC(finlitriskyassetsse, type = "HC0"))
AIC(finlitriskyassetsse)
finknowriskyassetsse <- lm(fin_know ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowriskyassetsse)  
coeftest(finknowriskyassetsse, vcov = vcovHC(finknowriskyassetsse, type = "HC0"))
AIC(finknowriskyassetsse)
finbehriskyassetsse <- lm(fin_beh ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehriskyassetsse)  
coeftest(finbehriskyassetsse, vcov = vcovHC(finbehriskyassetsse, type = "HC0"))
AIC(finbehriskyassetsse)
finattriskyassetsse <- lm(fin_att ~ riskyassetsd,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattriskyassetsse)  
coeftest(finattriskyassetsse, vcov = vcovHC(finattriskyassetsse, type = "HC0"))
AIC(finattriskyassetsse)

#employed
finlitriskyassetse <- lm(finlit ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitriskyassetse)
coeftest(finlitriskyassetse, vcov = vcovHC(finlitriskyassetse, type = "HC0"))
AIC(finlitriskyassetse)
finknowriskyassetse <- lm(fin_know ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowriskyassetse)  
coeftest(finknowriskyassetse, vcov = vcovHC(finknowriskyassetse, type = "HC0"))
AIC(finknowriskyassetse)
finbehriskyassetse <- lm(fin_beh ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehriskyassetse)  
coeftest(finbehriskyassetse, vcov = vcovHC(finbehriskyassetse, type = "HC0"))
AIC(finbehriskyassetse)
finattriskyassetse <- lm(fin_att ~ riskyassetsd,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattriskyassetse)  
coeftest(finattriskyassetse, vcov = vcovHC(finattriskyassetse, type = "HC0"))
AIC(finattriskyassetse)
#higher risk for older?
riskage <- glm(HFCSriskad ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskage)
coeftest(riskage, vcov = vcovHC(riskage, type = "HC0"))
exp(coef(riskage))
AIC(riskage)
PseudoR2(riskage, which = c("McFadden"))

riskagese <- glm(HFCSriskad ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskagese)
coeftest(riskagese, vcov = vcovHC(riskagese, type = "HC0"))
exp(coef(riskagese))
AIC(riskagese)
PseudoR2(riskagese, which = c("McFadden"))
riskagee <- glm(HFCSriskad ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskagee)
coeftest(riskagee, vcov = vcovHC(riskagee, type = "HC0"))
exp(coef(riskagee))
PseudoR2(riskagee, which = c("McFadden"))
AIC(riskagee)


riskassetage <- glm(riskyassetsd ~ age, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassetage)
coeftest(riskassetage, vcov = vcovHC(riskassetage, type = "HC0"))
exp(coef(riskassetage))
AIC(riskassetage)
PseudoR2(riskassetage, which = c("McFadden"))
riskassetagese <- glm(riskyassetsd ~ age, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassetagese)
coeftest(riskassetagese, vcov = vcovHC(riskassetagese, type = "HC0"))
exp(coef(riskassetagese))
AIC(riskassetagese)
PseudoR2(riskassetagese, which = c("McFadden"))
riskassetagee <- glm(riskyassetsd ~ age, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassetagee)
coeftest(riskassetagee, vcov = vcovHC(riskassetagee, type = "HC0"))
exp(coef(riskassetagee))
AIC(riskassetagee)
PseudoR2(riskassetagee, which = c("McFadden"))

#higher risk for higher educated?
riskhigheduc <- glm(HFCSriskad ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskhigheduc)
coeftest(riskhigheduc, vcov = vcovHC(riskhigheduc, type = "HC0"))
exp(coef(riskhigheduc))
AIC(riskhigheduc)
PseudoR2(riskhigheduc, which = c("McFadden"))
riskhigheducse <- glm(HFCSriskad ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskhigheducse)
coeftest(riskhigheducse, vcov = vcovHC(riskhigheducse, type = "HC0"))
exp(coef(riskhigheducse))
AIC(riskhigheducse)
PseudoR2(riskhigheducse, which = c("McFadden"))
riskhigheduce <- glm(HFCSriskad ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskhigheduce)
coeftest(riskhigheduce, vcov = vcovHC(riskhigheduce, type = "HC0"))
exp(coef(riskhigheduce))
AIC(riskhigheduce)
PseudoR2(riskhigheduce, which = c("McFadden"))

riskassethigheduc <- glm(riskyassetsd ~ higheduc, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassethigheduc)
coeftest(riskassethigheduc, vcov = vcovHC(riskassethigheduc, type = "HC0"))
exp(coef(riskassethigheduc))
AIC(riskassethigheduc)
PseudoR2(riskassethigheduc, which = c("McFadden"))
riskassethigheducse <- glm(riskyassetsd ~ higheduc, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassethigheducse)
coeftest(riskassethigheducse, vcov = vcovHC(riskassethigheducse, type = "HC0"))
exp(coef(riskassethigheducse))
AIC(riskassethigheducse)
PseudoR2(riskassethigheducse, which = c("McFadden"))
riskassethigheduce <- glm(riskyassetsd ~ higheduc, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassethigheduce)
coeftest(riskassethigheduce, vcov = vcovHC(riskassethigheduce, type = "HC0"))
exp(coef(riskassethigheduce))
AIC(riskassethigheduce)
PseudoR2(riskassethigheduce, which = c("McFadden"))


#higher risk for males?
riskgender <- glm(HFCSriskad ~ maled, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
exp(coef(riskgender))
AIC(riskgender)
PseudoR2(riskgender, which = c("McFadden"))
riskgenderse <- glm(HFCSriskad ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
exp(coef(riskgenderse))
AIC(riskgenderse)
PseudoR2(riskgenderse, which = c("McFadden"))
riskgendere <- glm(HFCSriskad ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))
exp(coef(riskgendere))
AIC(riskgendere)
PseudoR2(riskgendere, which = c("McFadden"))

riskassetmaled <- glm(riskyassetsd ~ maled, data=ASFL7 , weights=ASFL7$wght, family="binomial")
summary(riskassetmaled)
coeftest(riskassetmaled, vcov = vcovHC(riskassetmaled, type = "HC0"))
exp(coef(riskassetmaled))
AIC(riskassetmaled)
PseudoR2(riskassetmaled, which = c("McFadden"))
riskassetmaledse <- glm(riskyassetsd ~ maled, data=ASFL7se , weights=ASFL7se$wght, family="binomial")
summary(riskassetmaledse)
coeftest(riskassetmaledse, vcov = vcovHC(riskassetmaledse, type = "HC0"))
exp(coef(riskassetmaledse))
AIC(riskassetmaledse)
PseudoR2(riskassetmaledse, which = c("McFadden"))
riskassetmalede <- glm(riskyassetsd ~ maled, data=ASFL7e , weights=ASFL7e$wght, family="binomial")
summary(riskassetmalede)
coeftest(riskassetmalede, vcov = vcovHC(riskassetmalede, type = "HC0"))
exp(coef(riskassetmalede))
AIC(riskassetmalede)
PseudoR2(riskassetmalede, which = c("McFadden"))



riskgender <- glm(numericHFCSrisk ~ maled, data=ASFL7 , weights=ASFL7$wght)
summary(riskgender)
coeftest(riskgender, vcov = vcovHC(riskgender, type = "HC0"))
riskgenderse <- glm(numericHFCSrisk ~ maled, data=ASFL7se , weights=ASFL7se$wght)
summary(riskgenderse)
coeftest(riskgenderse, vcov = vcovHC(riskgenderse, type = "HC0"))
riskgendere <- glm(numericHFCSrisk ~ maled, data=ASFL7e , weights=ASFL7e$wght)
summary(riskgendere)
coeftest(riskgendere, vcov = vcovHC(riskgendere, type = "HC0"))




finlitriskpropensitygender <- glm(finlit ~ maled, data=ASFL7risk, weights=ASFL7risk$wght)
summary(finlitriskpropensitygender)  
coeftest(finlitriskpropensitygender, vcov = vcovHC(finlitriskpropensitygender, type = "HC0"))
finlitriskpropensitygender2 <- glm(finlit ~ maled, data=ASFL7nrisk, weights=ASFL7nrisk$wght)
summary(finlitriskpropensitygender2)  
coeftest(finlitriskpropensitygender2, vcov = vcovHC(finlitriskpropensitygender2, type = "HC0"))





###########################MODEL EVALUATION###########################
#always exclude one group - otherwise: perfect collinearity! (zB:maled + femaled = 1)-> error would not occur for variables with missings but exclude one! 
finlitmodelfull <- lm(finlit ~ employment1_2+ age + gender + higheduc+ livingcommgroup_1 + childd + singled +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelfull)
shapiro.test(finlitmodelfull$residuals)
coeftest(finlitmodelfull, vcov = vcovHC(finlitmodelfull, type = "HC0"))
AIC(finlitmodelfull)
#model testing
#wald.test(Sigma = vcov(model), b = coef(model), Terms = 3:4)-p> .05, we fail to reject the null hypothesis of the Wald test.=> tested regression coefficients are both equal to zero.-> exclude from analysis
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 4)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 5)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 6)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 7:8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 8)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 9)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 10)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11:13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 11)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 12)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 13)
wald.test(Sigma = vcov(finlitmodelfull), b = coef(finlitmodelfull), Terms = 14) #riskpropensity


finlitmodel2 <- lm(finlit ~ employment1_2+ age + gender + higheduc + childd + singled +incomegroup_1+ HFCSriskad+ riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel2)
coeftest(finlitmodel2, vcov = vcovHC(finlitmodel2, type = "HC0"))
AIC(finlitmodel2)
finlitmodel <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel)
coeftest(finlitmodel, vcov = vcovHC(finlitmodel, type = "HC0"))
AIC(finlitmodel)
############model comparison
modelcomp <- list(finlitmodelfull, finlitmodel2, finlitmodel)
model.names <- c("1", "2", "3")
modelcomp <- aictab(modelcomp, modnames = model.names)
modelcomp
xtable(modelcomp, type = "latex", file = "modelcomp", digits=3)

finlitmodel4 <- lm(finlit ~employment1_2+ age  + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel4)
coeftest(finlitmodel4, vcov = vcovHC(finlitmodel4, type = "HC0"))
AIC(finlitmodel4)


modelcomp2 <- list(finlitmodelfull, finlitmodel2, finlitmodel,finlitmodel4)
model.names2 <- c("1", "2", "3", "4")
modelcomp2 <-aictab(modelcomp2, modnames = model.names2)
xtable(modelcomp2, type = "latex", file = "modelcomp2", digits=3)

####for individual components
finknowmodel <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)

####enlarged financial knowledge score
finlitaddmodel <- lm(finlitadd ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitaddmodel)
coeftest(finlitaddmodel, vcov = vcovHC(finlitaddmodel, type = "HC0"))
AIC(finlitaddmodel)
finknowaddmodel <- lm(fin_know_add ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowaddmodel)
coeftest(finknowaddmodel, vcov = vcovHC(finknowaddmodel, type = "HC0"))
AIC(finknowaddmodel)

####without employment
finlitmodel_woempl <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodel_woempl)
coeftest(finlitmodel_woempl, vcov = vcovHC(finlitmodel_woempl, type = "HC0"))
AIC(finlitmodel_woempl)
finknowmodel <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodel)
coeftest(finknowmodel, vcov = vcovHC(finknowmodel, type = "HC0"))
AIC(finknowmodel)
finbehmodel <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodel)
coeftest(finbehmodel, vcov = vcovHC(finbehmodel, type = "HC0"))
AIC(finbehmodel)
finattmodel <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodel)
coeftest(finattmodel, vcov = vcovHC(finattmodel, type = "HC0"))
AIC(finattmodel)


finlitmodel_se <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodel_se)
coeftest(finlitmodel_se, vcov = vcovHC(finlitmodel_se, type = "HC0"))
AIC(finlitmodel_se)
finknowmodel_se <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodel_se)
coeftest(finknowmodel_se, vcov = vcovHC(finknowmodel_se, type = "HC0"))
AIC(finknowmodel_se)
finbehmodel_se <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodel_se)
coeftest(finbehmodel_se, vcov = vcovHC(finbehmodel_se, type = "HC0"))
AIC(finbehmodel_se)
finattmodel_se <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodel_se)
coeftest(finattmodel_se, vcov = vcovHC(finattmodel_se, type = "HC0"))
AIC(finattmodel_se)


finlitmodel_e <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodel_e)
coeftest(finlitmodel_e, vcov = vcovHC(finlitmodel_e, type = "HC0"))
AIC(finlitmodel_e)
finknowmodel_e <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodel_e)
coeftest(finknowmodel_e, vcov = vcovHC(finknowmodel_e, type = "HC0"))
AIC(finknowmodel_e)
finbehmodel_e <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodel_e)
coeftest(finbehmodel_e, vcov = vcovHC(finbehmodel_e, type = "HC0"))
AIC(finbehmodel_e)
finattmodel_e <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodel_e)
coeftest(finattmodel_e, vcov = vcovHC(finattmodel_e, type = "HC0"))
AIC(finattmodel_e)

####interaction check
#gender and financial risk
#full sample
finlitmodelinteractgenrisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk)
coeftest(finlitmodelinteractgenrisk, vcov = vcovHC(finlitmodelinteractgenrisk, type = "HC0"))
AIC(finlitmodelinteractgenrisk)
finlitmodelinteractgenrisk2 <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk2)
coeftest(finlitmodelinteractgenrisk2, vcov = vcovHC(finlitmodelinteractgenrisk2, type = "HC0"))
AIC(finlitmodelinteractgenrisk2)
finlitmodelinteractgenrisk3 <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractgenrisk3)
coeftest(finlitmodelinteractgenrisk3, vcov = vcovHC(finlitmodelinteractgenrisk3, type = "HC0"))
AIC(finlitmodelinteractgenrisk3)

#self-employed
finlitmodelinteractgenrisk_se <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se)
coeftest(finlitmodelinteractgenrisk_se, vcov = vcovHC(finlitmodelinteractgenrisk_se, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se)
finlitmodelinteractgenrisk_se2 <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se2)
coeftest(finlitmodelinteractgenrisk_se2, vcov = vcovHC(finlitmodelinteractgenrisk_se2, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se2)
finlitmodelinteractgenrisk_se3 <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelinteractgenrisk_se3)
coeftest(finlitmodelinteractgenrisk_se3, vcov = vcovHC(finlitmodelinteractgenrisk_se3, type = "HC0"))
AIC(finlitmodelinteractgenrisk_se3)

#employed
finlitmodelinteractgenrisk_e <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e)
coeftest(finlitmodelinteractgenrisk_e, vcov = vcovHC(finlitmodelinteractgenrisk_e, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e)
finlitmodelinteractgenrisk_e2 <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*gender+riskyassetsd + riskyassetsd*gender, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e2)
coeftest(finlitmodelinteractgenrisk_e2, vcov = vcovHC(finlitmodelinteractgenrisk_e2, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e2)
finlitmodelinteractgenrisk_e3 <- lm(finlit ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+riskyassetsd + riskyassetsd*gender, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelinteractgenrisk_e3)
coeftest(finlitmodelinteractgenrisk_e3, vcov = vcovHC(finlitmodelinteractgenrisk_e3, type = "HC0"))
AIC(finlitmodelinteractgenrisk_e3)

#age and financial risk
finlitmodelinteractagerisk <- lm(finlit ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+HFCSriskad*age+riskyassetsd , data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelinteractagerisk)
coeftest(finlitmodelinteractagerisk, vcov = vcovHC(finlitmodelinteractagerisk, type = "HC0"))
AIC(finlitmodelinteractagerisk)




###########################SUBGROUP DIFFERENCES###########################
###########################Age###########################
emplage <- lm(age ~ employment1_2,  data=ASFL7, weights=ASFL7$wght)
summary(emplage)
coeftest(emplage, vcov = vcovHC(emplage, type = "HC0"))
AIC(emplage)

#full sample
finlitage <- lm(finlit ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)

finknowage <- lm(fin_know ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)

finbehage <- lm(fin_beh ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)

finattage <- lm(fin_att ~ age,  data=ASFL7, weights=ASFL7$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7, weights=ASFL7$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7, weights=ASFL7$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)

#employment groups full sample
selfemployedage <- glm(selfemployedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedage)  
coeftest(selfemployedage, vcov = vcovHC(selfemployedage, type = "HC0"))
(adjR2(selfemployedage))
employedage <- glm(employedd ~ age,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedage)  
coeftest(employedage, vcov = vcovHC(employedage, type = "HC0"))
PseudoR2(employedage, which = c("McFadden"))

#multi_emplage <- multinom(employment1_2 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplage <- multinom(employment1_1 ~  age,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage)
exp(coef(multi_emplage))
#coeftest(multi_emplage, vcov = vcovHC(multi_emplage))
se <- summary(multi_emplage)$coefficients/summary(multi_emplage)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage, type="text", out="multi_emplage.htm") 
PseudoR2(multi_emplage, which = c("McFadden"))

multi_emplage2 <- multinom(employment1_1 ~  age +age2,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage2)
exp(coef(multi_emplage2))
#coeftest(multi_emplage, vcov = vcovHC(multi_emplage))
se <- summary(multi_emplage2)$coefficients/summary(multi_emplage2)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage2, type="text", out="multi_emplage2.htm") 
PseudoR2(multi_emplage2, which = c("McFadden"))

multi_emplage3 <- multinom(employment1_1 ~  rootage,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplage3)
exp(coef(multi_emplage3))
#coeftest(multi_emplage, vcov = vcovHC(multi_emplage))
se <- summary(multi_emplage3)$coefficients/summary(multi_emplage3)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 
p
stargazer(multi_emplage3, type="text", out="multi_emplage3.htm") 
PseudoR2(multi_emplage3, which = c("McFadden"))

#selfemployed
finlitage <- lm(finlit ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)

finknowage <- lm(fin_know ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)

finbehage <- lm(fin_beh ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)

finattage <- lm(fin_att ~ age,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7se, weights=ASFL7se$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)
#employed
finlitage <- lm(finlit ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage)
shapiro.test(finlitage$residuals)
coeftest(finlitage, vcov = vcovHC(finlitage, type = "HC0"))
AIC(finlitage)
plot(finlitage$residuals)
finlitage2 <- lm(finlit ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage2)
coeftest(finlitage2, vcov = vcovHC(finlitage2, type = "HC0"))
AIC(finlitage2)
finlitage3 <- lm(finlit ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finlitage3)
coeftest(finlitage3, vcov = vcovHC(finlitage3, type = "HC0"))
AIC(finlitage3)

finknowage <- lm(fin_know ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage)
coeftest(finknowage, vcov = vcovHC(finknowage, type = "HC0"))
AIC(finknowage)
finknowage2 <- lm(fin_know ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage2)
coeftest(finknowage2, vcov = vcovHC(finknowage2, type = "HC0"))
AIC(finknowage2)
finknowage3 <- lm(fin_know ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finknowage3)
coeftest(finknowage3, vcov = vcovHC(finknowage3, type = "HC0"))
AIC(finknowage3)

finbehage <- lm(fin_beh ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage)
coeftest(finbehage, vcov = vcovHC(finbehage, type = "HC0"))
AIC(finbehage)
finbehage2 <- lm(fin_beh ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage2)
coeftest(finbehage2, vcov = vcovHC(finbehage2, type = "HC0"))
AIC(finbehage2)
finbehage3 <- lm(fin_beh ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finbehage3)
coeftest(finbehage3, vcov = vcovHC(finbehage3, type = "HC0"))
AIC(finbehage3)

finattage <- lm(fin_att ~ age,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage)
coeftest(finattage, vcov = vcovHC(finattage, type = "HC0"))
AIC(finattage)
finattage2 <- lm(fin_att ~ age + age2,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage2)
coeftest(finattage2, vcov = vcovHC(finattage2, type = "HC0"))
AIC(finattage2)
finattage3 <- lm(fin_att ~ rootage,  data=ASFL7e, weights=ASFL7e$wght)
summary(finattage3)
coeftest(finattage3, vcov = vcovHC(finattage3, type = "HC0"))
AIC(finattage3)

###########################Education###########################
empleduc <- lm(higheduc ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(empleduc)
coeftest(empleduc, vcov = vcovHC(empleduc, type = "HC0"))
exp(coef(empleduc)) #exponentiated coefficients
AIC(empleduc)


#full sample
finlithigheduc <- lm(finlit ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finlithigheduc)  
coeftest(finlithigheduc, vcov = vcovHC(finlithigheduc, type = "HC0"))
AIC(finlithigheduc)
finknowhigheduc <- lm(fin_know ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finknowhigheduc)  
coeftest(finknowhigheduc, vcov = vcovHC(finknowhigheduc, type = "HC0"))
AIC(finknowhigheduc)
finbehhigheduc <- lm(fin_beh ~ higheduc,data=ASFL7, weights=ASFL7$wght)
summary(finbehhigheduc)  
coeftest(finbehhigheduc, vcov = vcovHC(finbehhigheduc, type = "HC0"))
AIC(finbehhigheduc)
finatthigheduc <- lm(fin_att ~ higheduc,data=ASFL7, weights=ASFL7$wght) 
summary(finatthigheduc)  
coeftest(finatthigheduc, vcov = vcovHC(finatthigheduc, type = "HC0"))
AIC(finatthigheduc)

selfemployedhigheduc <- glm(selfemployedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedhigheduc)  
coeftest(selfemployedhigheduc, vcov = vcovHC(selfemployedhigheduc, type = "HC0"))
(adjR2(selfemployedhigheduc))
employedhigheduc <- glm(employedd ~ higheduc,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedhigheduc)  
coeftest(employedhigheduc, vcov = vcovHC(employedhigheduc, type = "HC0"))

#multi_emplhigheduc <- multinom(employment1_2 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplhigheduc <- multinom(employment1_1 ~  higheduc,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplhigheduc)
exp(coef(multi_emplhigheduc))
se <- summary(multi_emplhigheduc)$coefficients/summary(multi_emplhigheduc)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplhigheduc, type="text", out="multi_emplhigheduc.htm") 
PseudoR2(multi_emplhigheduc, which = c("McFadden"))

#self-employed
finlithigheducse <- lm(finlit ~ higheduc,data=ASFL7se, weights=ASFL7se$wght)
summary(finlithigheducse)  
coeftest(finlithigheducse, vcov = vcovHC(finlithigheducse, type = "HC0"))
AIC(finlithigheducse)
finknowhigheducse <- lm(fin_know ~ higheduc,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowhigheducse)  
coeftest(finknowhigheducse, vcov = vcovHC(finknowhigheducse, type = "HC0"))
AIC(finknowhigheducse)
finbehhigheducse <- lm(fin_beh ~ higheduc,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehhigheducse)  
coeftest(finbehhigheducse, vcov = vcovHC(finbehhigheducse, type = "HC0"))
AIC(finbehhigheducse)
finatthigheducse <- lm(fin_att ~ higheduc,data=ASFL7se, weights=ASFL7se$wght) 
summary(finatthigheducse)  
coeftest(finatthigheducse, vcov = vcovHC(finatthigheducse, type = "HC0"))
AIC(finatthigheducse)

#employed
finlithigheduce <- lm(finlit ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlithigheduce)
coeftest(finlithigheduce, vcov = vcovHC(finlithigheduce, type = "HC0"))
AIC(finlithigheduce)
finknowhigheduce <- lm(fin_know ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowhigheduce)  
coeftest(finknowhigheduce, vcov = vcovHC(finknowhigheduce, type = "HC0"))
AIC(finknowhigheduce)
finbehhigheduce <- lm(fin_beh ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehhigheduce)  
coeftest(finbehhigheduce, vcov = vcovHC(finbehhigheduce, type = "HC0"))
AIC(finbehhigheduce)
finatthigheduce <- lm(fin_att ~ higheduc,data=ASFL7e, weights=ASFL7e$wght) 
summary(finatthigheduce)  
coeftest(finatthigheduce, vcov = vcovHC(finatthigheduce, type = "HC0"))
AIC(finatthigheduce)

###########################Gender###########################
emplgender <- lm(maled ~ employment1_2,  data=ASFL7, weights=ASFL7$wght, family="binomial")
summary(emplgender) #im Vergleich zu employed mehr Männer
coeftest(emplgender, vcov = vcovHC(emplgender, type = "HC0"))
exp(coef(emplgender))
AIC(emplgender)

#full sample
finlitgender <- lm(finlit ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finlitgender)  
coeftest(finlitgender, vcov = vcovHC(finlitgender, type = "HC0"))
AIC(finlitgender)
finknowgender <- lm(fin_know ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finknowgender)  
coeftest(finknowgender, vcov = vcovHC(finknowgender, type = "HC0"))
AIC(finknowgender)
finbehgender <- lm(fin_beh ~ gender,data=ASFL7, weights=ASFL7$wght)
summary(finbehgender)  
coeftest(finbehgender, vcov = vcovHC(finbehgender, type = "HC0"))
AIC(finbehgender)
finattgender <- lm(fin_att ~ gender,data=ASFL7, weights=ASFL7$wght) 
summary(finattgender)  
coeftest(finattgender, vcov = vcovHC(finattgender, type = "HC0"))
AIC(finattgender)

selfemployedgender <- glm(selfemployedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(selfemployedgender)  
coeftest(selfemployedgender, vcov = vcovHC(selfemployedgender, type = "HC0"))
(adjR2(selfemployedgender))
employedgender <- glm(employedd ~ gender,data=ASFL7, weights=ASFL7$wght, family="binomial") 
summary(employedgender)  
coeftest(employedgender, vcov = vcovHC(employedgender, type = "HC0"))

#multi_emplgender <- multinom(employment1_2 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
multi_emplgender <- multinom(employment1_1 ~  gender,data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_emplgender)
exp(coef(multi_emplgender))
se <- summary(multi_emplgender)$coefficients/summary(multi_emplgender)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_emplgender, type="text", out="multi_emplgender.htm") 
PseudoR2(multi_emplgender, which = c("McFadden"))

#self-employed
finlitgenderse <- lm(finlit ~ gender,data=ASFL7se, weights=ASFL7se$wght)
summary(finlitgenderse)  
coeftest(finlitgenderse, vcov = vcovHC(finlitgenderse, type = "HC0"))
AIC(finlitgenderse)
finknowgenderse <- lm(fin_know ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finknowgenderse)  
coeftest(finknowgenderse, vcov = vcovHC(finknowgenderse, type = "HC0"))
AIC(finknowgenderse)
finbehgenderse <- lm(fin_beh ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finbehgenderse)  
coeftest(finbehgenderse, vcov = vcovHC(finbehgenderse, type = "HC0"))
AIC(finbehgenderse)
finattgenderse <- lm(fin_att ~ gender,data=ASFL7se, weights=ASFL7se$wght) 
summary(finattgenderse)  
coeftest(finattgenderse, vcov = vcovHC(finattgenderse, type = "HC0"))
AIC(finattgenderse)

#employed
finlitgendere <- lm(finlit ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finlitgendere)
coeftest(finlitgendere, vcov = vcovHC(finlitgendere, type = "HC0"))
AIC(finlitgendere)
finknowgendere <- lm(fin_know ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finknowgendere)  
coeftest(finknowgendere, vcov = vcovHC(finknowgendere, type = "HC0"))
AIC(finknowgendere)
finbehgendere <- lm(fin_beh ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finbehgendere)  
coeftest(finbehgendere, vcov = vcovHC(finbehgendere, type = "HC0"))
AIC(finbehgendere)
finattgendere <- lm(fin_att ~ gender,data=ASFL7e, weights=ASFL7e$wght) 
summary(finattgendere)  
coeftest(finattgendere, vcov = vcovHC(finattgendere, type = "HC0"))
AIC(finattgendere)


##########################EXTENSIONS###########################################
##########################alternative income group (without Ref/Dont know) - full sample###########################################
#full sample
finlitmodelincomealt <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

#self-employed
finlitmodelincomealt <- lm(finlit ~age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

#employed
finlitmodelincomealt <- lm(finlit ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelincomealt)
coeftest(finlitmodelincomealt, vcov = vcovHC(finlitmodelincomealt, type = "HC0"))
AIC(finlitmodelincomealt)
finknowmodelincomealt <- lm(fin_know ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelincomealt)
coeftest(finknowmodelincomealt, vcov = vcovHC(finknowmodelincomealt, type = "HC0"))
AIC(finknowmodelincomealt)
finbehmodelincomealt <- lm(fin_beh ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelincomealt)
coeftest(finbehmodelincomealt, vcov = vcovHC(finbehmodelincomealt, type = "HC0"))
AIC(finbehmodelincomealt)
finattmodelincomealt <- lm(fin_att ~ age + gender + higheduc +incomegroup_simple_1+ HFCSriskad+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelincomealt)
coeftest(finattmodelincomealt, vcov = vcovHC(finattmodelincomealt, type = "HC0"))
AIC(finattmodelincomealt)

##########################alternative risk evaluation - full sample###########################################
#QS1_2risk
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#HFCSriskgroup
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSrisk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#QS1_2risk_group_1 # again: no risk as reference category!
finlitmodelriskgroup <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskgroup)
coeftest(finlitmodelriskgroup, vcov = vcovHC(finlitmodelriskgroup, type = "HC0"))
AIC(finlitmodelriskgroup)
finknowmodelriskgroup <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskgroup)
coeftest(finknowmodelriskgroup, vcov = vcovHC(finknowmodelriskgroup, type = "HC0"))
AIC(finknowmodelriskgroup)
finbehmodelriskgroup <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskgroup)
coeftest(finbehmodelriskgroup, vcov = vcovHC(finbehmodelriskgroup, type = "HC0"))
AIC(finbehmodelriskgroup)
finattmodelriskgroup <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ QS1_2risk_group_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskgroup)
coeftest(finattmodelriskgroup, vcov = vcovHC(finattmodelriskgroup, type = "HC0"))
AIC(finattmodelriskgroup)

#without HFCSrisk!
#full sample
finlitmodelworiskprop <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelworiskprop)
coeftest(finlitmodelworiskprop, vcov = vcovHC(finlitmodelworiskprop, type = "HC0"))
AIC(finlitmodelworiskprop)
finknowmodelworiskprop <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelworiskprop)
coeftest(finknowmodelworiskprop, vcov = vcovHC(finknowmodelworiskprop, type = "HC0"))
AIC(finknowmodelworiskprop)
finbehmodelworiskprop <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelworiskprop)
coeftest(finbehmodelworiskprop, vcov = vcovHC(finbehmodelworiskprop, type = "HC0"))
AIC(finbehmodelworiskprop)
finattmodelworiskprop <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelworiskprop)
coeftest(finattmodelworiskprop, vcov = vcovHC(finattmodelworiskprop, type = "HC0"))
AIC(finattmodelworiskprop)

#self-employed
finlitmodelworiskpropse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelworiskpropse)
coeftest(finlitmodelworiskpropse, vcov = vcovHC(finlitmodelworiskpropse, type = "HC0"))
AIC(finlitmodelworiskpropse)
finknowmodelworiskpropse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelworiskpropse)
coeftest(finknowmodelworiskpropse, vcov = vcovHC(finknowmodelworiskpropse, type = "HC0"))
AIC(finknowmodelworiskpropse)
finbehmodelworiskpropse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelworiskpropse)
coeftest(finbehmodelworiskpropse, vcov = vcovHC(finbehmodelworiskpropse, type = "HC0"))
AIC(finbehmodelworiskpropse)
finattmodelworiskpropse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelworiskpropse)
coeftest(finattmodelworiskpropse, vcov = vcovHC(finattmodelworiskpropse, type = "HC0"))
AIC(finattmodelworiskpropse)

#employed
finlitmodelworiskprope <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelworiskprope)
coeftest(finlitmodelworiskprope, vcov = vcovHC(finlitmodelworiskprope, type = "HC0"))
AIC(finlitmodelworiskprope)
finknowmodelworiskprope <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelworiskprope)
coeftest(finknowmodelworiskprope, vcov = vcovHC(finknowmodelworiskprope, type = "HC0"))
AIC(finknowmodelworiskprope)
finbehmodelworiskprope <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelworiskprope)
coeftest(finbehmodelworiskprope, vcov = vcovHC(finbehmodelworiskprope, type = "HC0"))
AIC(finbehmodelworiskprope)
finattmodelworiskprope <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelworiskprope)
coeftest(finattmodelworiskprope, vcov = vcovHC(finattmodelworiskprope, type = "HC0"))
AIC(finattmodelworiskprope)

#without riskyassets!
#full sample
finlitmodelwoasset <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelwoasset)
coeftest(finlitmodelwoasset, vcov = vcovHC(finlitmodelwoasset, type = "HC0"))
AIC(finlitmodelwoasset)
finknowmodelwoasset <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelwoasset)
coeftest(finknowmodelwoasset, vcov = vcovHC(finknowmodelwoasset, type = "HC0"))
AIC(finknowmodelwoasset)
finbehmodelwoasset <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelwoasset)
coeftest(finbehmodelwoasset, vcov = vcovHC(finbehmodelwoasset, type = "HC0"))
AIC(finbehmodelwoasset)
finattmodelwoasset <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelwoasset)
coeftest(finattmodelwoasset, vcov = vcovHC(finattmodelwoasset, type = "HC0"))
AIC(finattmodelwoasset)

#self-employed
finlitmodelwoassetse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelwoassetse)
coeftest(finlitmodelwoassetse, vcov = vcovHC(finlitmodelwoassetse, type = "HC0"))
AIC(finlitmodelwoassetse)
finknowmodelwoassetse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelwoassetse)
coeftest(finknowmodelwoassetse, vcov = vcovHC(finknowmodelwoassetse, type = "HC0"))
AIC(finknowmodelwoassetse)
finbehmodelwoassetse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelwoassetse)
coeftest(finbehmodelwoassetse, vcov = vcovHC(finbehmodelwoassetse, type = "HC0"))
AIC(finbehmodelwoassetse)
finattmodelwoassetse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelwoassetse)
coeftest(finattmodelwoassetse, vcov = vcovHC(finattmodelwoassetse, type = "HC0"))
AIC(finattmodelwoassetse)

#employed
finlitmodelwoassete <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelwoassete)
coeftest(finlitmodelwoassete, vcov = vcovHC(finlitmodelwoassete, type = "HC0"))
AIC(finlitmodelwoassete)
finknowmodelwoassete <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelwoassete)
coeftest(finknowmodelwoassete, vcov = vcovHC(finknowmodelwoassete, type = "HC0"))
AIC(finknowmodelwoassete)
finbehmodelwoassete <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelwoassete)
coeftest(finbehmodelwoassete, vcov = vcovHC(finbehmodelwoassete, type = "HC0"))
AIC(finbehmodelwoassete)
finattmodelwoassete <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelwoassete)
coeftest(finattmodelwoassete, vcov = vcovHC(finattmodelwoassete, type = "HC0"))
AIC(finattmodelwoassete)


#risk propensity asset holding interaction 
finlitmodelriskinteract <- lm(finlit ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finlitmodelriskinteract)
coeftest(finlitmodelriskinteract, vcov = vcovHC(finlitmodelriskinteract, type = "HC0"))
AIC(finlitmodelriskinteract)
finknowmodelriskinteract <- lm(fin_know ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finknowmodelriskinteract)
coeftest(finknowmodelriskinteract, vcov = vcovHC(finknowmodelriskinteract, type = "HC0"))
AIC(finknowmodelriskinteract)
finbehmodelriskinteract <- lm(fin_beh ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finbehmodelriskinteract)
coeftest(finbehmodelriskinteract, vcov = vcovHC(finbehmodelriskinteract, type = "HC0"))
AIC(finbehmodelriskinteract)
finattmodelriskinteract <- lm(fin_att ~employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7, weights=ASFL7$wght)
summary(finattmodelriskinteract)
coeftest(finattmodelriskinteract, vcov = vcovHC(finattmodelriskinteract, type = "HC0"))
AIC(finattmodelriskinteract)

#self-employed
finlitmodelriskinteractse <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finlitmodelriskinteractse)
coeftest(finlitmodelriskinteractse, vcov = vcovHC(finlitmodelriskinteractse, type = "HC0"))
AIC(finlitmodelriskinteractse)
finknowmodelriskinteractse <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finknowmodelriskinteractse)
coeftest(finknowmodelriskinteractse, vcov = vcovHC(finknowmodelriskinteractse, type = "HC0"))
AIC(finknowmodelriskinteractse)
finbehmodelriskinteractse <- lm(fin_beh ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finbehmodelriskinteractse)
coeftest(finbehmodelriskinteractse, vcov = vcovHC(finbehmodelriskinteractse, type = "HC0"))
AIC(finbehmodelriskinteractse)
finattmodelriskinteractse <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd +riskyassetsd, data=ASFL7se, weights=ASFL7se$wght)
summary(finattmodelriskinteractse)
coeftest(finattmodelriskinteractse, vcov = vcovHC(finattmodelriskinteractse, type = "HC0"))
AIC(finattmodelriskinteractse)

#employed
finlitmodelriskinteracte <- lm(finlit ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finlitmodelriskinteracte)
coeftest(finlitmodelriskinteracte, vcov = vcovHC(finlitmodelriskinteracte, type = "HC0"))
AIC(finlitmodelriskinteracte)
finknowmodelriskinteracte <- lm(fin_know ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finknowmodelriskinteracte)
coeftest(finknowmodelriskinteracte, vcov = vcovHC(finknowmodelriskinteracte, type = "HC0"))
AIC(finknowmodelriskinteracte)
finbehmodelriskinteracte <- lm(fin_beh ~age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd+ riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finbehmodelriskinteracte)
coeftest(finbehmodelriskinteracte, vcov = vcovHC(finbehmodelriskinteracte, type = "HC0"))
AIC(finbehmodelriskinteracte)
finattmodelriskinteracte <- lm(fin_att ~ age + gender + higheduc +incomegroup_1+ HFCSriskad + HFCSriskad * riskyassetsd riskyassetsd, data=ASFL7e, weights=ASFL7e$wght)
summary(finattmodelriskinteracte)
coeftest(finattmodelriskinteracte, vcov = vcovHC(finattmodelriskinteracte, type = "HC0"))
AIC(finattmodelriskinteracte)
###########################MULTINOMIAL logit model###########################
multi_finlitempl <- multinom(finlit_group ~ employment1_2 , data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
#specify Hess = TRUE to save something called the Hessian matrix which helps with the calculation of standard errors, and set trace = FALSE to suppress the printing of convergence progress.
summary(multi_finlitempl)
exp(coef(multi_finlitempl))
se <- summary(multi_finlitempl)$coefficients/summary(multi_finlitempl)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlitempl, type="text", out="multi_finlitempl.htm") # type="html"otherwise!
PseudoR2(multi_finlitempl, which = c("McFadden"))


multi_finlit <- multinom(finlit_group ~ employment1_2+ age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7, weights=ASFL7$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit)
se <- summary(multi_finlit)$coefficients/summary(multi_finlit)$standard.errors
se
p <- (1 - pnorm(abs(se), 0, 1)) * 2 #p-Wert Berechnung!!
p
stargazer(multi_finlit, type="text", out="multi_finlit.htm") 
coeftest(multi_finlit, vcov = vcovHC(multi_finlit))
PseudoR2(multi_finlit, which = c("McFadden"))

multi_finlit_se <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7se, weights=ASFL7se$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_se)
stargazer(multi_finlit_se, type="text", out="multi_finlit_se.htm")

multi_finlit_e <- multinom(finlit_group ~  age + gender + higheduc +incomegroup_1+ HFCSriskad+ riskyassetsd, data = ASFL7e, weights=ASFL7e$wght,Hess = TRUE, trace = FALSE)
summary(multi_finlit_e)
stargazer(multi_finlit_e, type="text", out="multi_finlit_e")
PseudoR2(multi_finlit_e, which = c("McFadden"))





